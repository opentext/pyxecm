
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://opentext.github.io/pyxecm/pyxecm-customizer/m365/">
      
      
        <link rel="prev" href="../k8s/">
      
      
        <link rel="next" href="../salesforce/">
      
      
      <link rel="icon" href="https://avatars.githubusercontent.com/u/6463527?s=200&v=4">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Microsoft 365 - pyxecm</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyxecm_customizer.m365" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pyxecm" class="md-header__button md-logo" aria-label="pyxecm" data-md-component="logo">
      
  <img src="https://avatars.githubusercontent.com/u/6463527?s=200&v=4" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyxecm
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Microsoft 365
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/opentext/pyxecm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    opentext/pyxecm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pyxecm" class="md-nav__button md-logo" aria-label="pyxecm" data-md-component="logo">
      
  <img src="https://avatars.githubusercontent.com/u/6463527?s=200&v=4" alt="logo">

    </a>
    pyxecm
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/opentext/pyxecm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    opentext/pyxecm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pyxecm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            pyxecm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/otac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Archive Center (OTAC)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/avts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aviator Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/otcs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Content Server (OTCS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/coreshare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Share
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/otds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Directory Services (OTDS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/otiv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intelligent Viewing (OTIV)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/otmm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Media Management (OTMM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/otpd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PowerDocs (OTPD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm/helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Helper Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pyxecm-api
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            pyxecm-api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyxecm-api/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Settings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pyxecm-customizer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            pyxecm-customizer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customizer Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../browser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Browser Automation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../payload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Payload
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../payload-syntax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Payload Syntax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K8s
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Microsoft 365
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365" class="md-nav__link">
    <span class="md-ellipsis">
      m365
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365" class="md-nav__link">
    <span class="md-ellipsis">
      M365
    </span>
  </a>
  
    <nav class="md-nav" aria-label="M365">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_app_registration" class="md-nav__link">
    <span class="md-ellipsis">
      add_app_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_group" class="md-nav__link">
    <span class="md-ellipsis">
      add_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_group_member" class="md-nav__link">
    <span class="md-ellipsis">
      add_group_member
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_group_owner" class="md-nav__link">
    <span class="md-ellipsis">
      add_group_owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sensitivity_label" class="md-nav__link">
    <span class="md-ellipsis">
      add_sensitivity_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sharepoint_page" class="md-nav__link">
    <span class="md-ellipsis">
      add_sharepoint_page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sharepoint_section" class="md-nav__link">
    <span class="md-ellipsis">
      add_sharepoint_section
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sharepoint_webpart" class="md-nav__link">
    <span class="md-ellipsis">
      add_sharepoint_webpart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_team" class="md-nav__link">
    <span class="md-ellipsis">
      add_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_teams_app_to_channel" class="md-nav__link">
    <span class="md-ellipsis">
      add_teams_app_to_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_user" class="md-nav__link">
    <span class="md-ellipsis">
      add_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_license_to_user" class="md-nav__link">
    <span class="md-ellipsis">
      assign_license_to_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_sensitivity_label_to_user" class="md-nav__link">
    <span class="md-ellipsis">
      assign_sensitivity_label_to_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_teams_app_to_team" class="md-nav__link">
    <span class="md-ellipsis">
      assign_teams_app_to_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_teams_app_to_user" class="md-nav__link">
    <span class="md-ellipsis">
      assign_teams_app_to_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.authenticate" class="md-nav__link">
    <span class="md-ellipsis">
      authenticate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.authenticate_user" class="md-nav__link">
    <span class="md-ellipsis">
      authenticate_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.credentials" class="md-nav__link">
    <span class="md-ellipsis">
      credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.credentials_user" class="md-nav__link">
    <span class="md-ellipsis">
      credentials_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_all_teams" class="md-nav__link">
    <span class="md-ellipsis">
      delete_all_teams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_mail" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_sharepoint_section" class="md-nav__link">
    <span class="md-ellipsis">
      delete_sharepoint_section
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_team" class="md-nav__link">
    <span class="md-ellipsis">
      delete_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_teams" class="md-nav__link">
    <span class="md-ellipsis">
      delete_teams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_teams_app_from_channel" class="md-nav__link">
    <span class="md-ellipsis">
      delete_teams_app_from_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.do_request" class="md-nav__link">
    <span class="md-ellipsis">
      do_request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.download_user_photo" class="md-nav__link">
    <span class="md-ellipsis">
      download_user_photo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.email_verification" class="md-nav__link">
    <span class="md-ellipsis">
      email_verification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.exist_result_item" class="md-nav__link">
    <span class="md-ellipsis">
      exist_result_item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.extract_url_from_message_body" class="md-nav__link">
    <span class="md-ellipsis">
      extract_url_from_message_body
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.extract_version_from_app_manifest" class="md-nav__link">
    <span class="md-ellipsis">
      extract_version_from_app_manifest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.follow_sharepoint_site" class="md-nav__link">
    <span class="md-ellipsis">
      follow_sharepoint_site
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_app_registration" class="md-nav__link">
    <span class="md-ellipsis">
      get_app_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_group" class="md-nav__link">
    <span class="md-ellipsis">
      get_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_group_members" class="md-nav__link">
    <span class="md-ellipsis">
      get_group_members
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_group_owners" class="md-nav__link">
    <span class="md-ellipsis">
      get_group_owners
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_groups" class="md-nav__link">
    <span class="md-ellipsis">
      get_groups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_groups_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      get_groups_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_mail" class="md-nav__link">
    <span class="md-ellipsis">
      get_mail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_mail_body" class="md-nav__link">
    <span class="md-ellipsis">
      get_mail_body
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_result_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_result_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_page" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_pages" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_root_sites" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_root_sites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_section
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_sections" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_site" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_site
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_site_by_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_site_by_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_site_for_group" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_site_for_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_sites" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_sites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_sites_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_sites_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_webpart" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_webpart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_webparts" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_webparts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_team" class="md-nav__link">
    <span class="md-ellipsis">
      get_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_team_channel_tabs" class="md-nav__link">
    <span class="md-ellipsis">
      get_team_channel_tabs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_team_channels" class="md-nav__link">
    <span class="md-ellipsis">
      get_team_channels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_app" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_apps" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_apps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_apps_of_team" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_apps_of_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_apps_of_user" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_apps_of_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user" class="md-nav__link">
    <span class="md-ellipsis">
      get_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user_drive" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_drive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user_licenses" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_licenses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user_photo" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_photo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_users" class="md-nav__link">
    <span class="md-ellipsis">
      get_users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_users_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      get_users_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.has_team" class="md-nav__link">
    <span class="md-ellipsis">
      has_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.is_member" class="md-nav__link">
    <span class="md-ellipsis">
      is_member
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.lookup_result_value" class="md-nav__link">
    <span class="md-ellipsis">
      lookup_result_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.parse_request_response" class="md-nav__link">
    <span class="md-ellipsis">
      parse_request_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.publish_sharepoint_page" class="md-nav__link">
    <span class="md-ellipsis">
      publish_sharepoint_page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.purge_deleted_item" class="md-nav__link">
    <span class="md-ellipsis">
      purge_deleted_item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.purge_deleted_items" class="md-nav__link">
    <span class="md-ellipsis">
      purge_deleted_items
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.remove_teams_app" class="md-nav__link">
    <span class="md-ellipsis">
      remove_teams_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.remove_teams_app_from_user" class="md-nav__link">
    <span class="md-ellipsis">
      remove_teams_app_from_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.request_header" class="md-nav__link">
    <span class="md-ellipsis">
      request_header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.request_header_user" class="md-nav__link">
    <span class="md-ellipsis">
      request_header_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_app_registration" class="md-nav__link">
    <span class="md-ellipsis">
      update_app_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_sharepoint_webpart" class="md-nav__link">
    <span class="md-ellipsis">
      update_sharepoint_webpart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_teams_app_of_channel" class="md-nav__link">
    <span class="md-ellipsis">
      update_teams_app_of_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_user" class="md-nav__link">
    <span class="md-ellipsis">
      update_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_user_photo" class="md-nav__link">
    <span class="md-ellipsis">
      update_user_photo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upgrade_teams_app_of_team" class="md-nav__link">
    <span class="md-ellipsis">
      upgrade_teams_app_of_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upgrade_teams_app_of_user" class="md-nav__link">
    <span class="md-ellipsis">
      upgrade_teams_app_of_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upload_outlook_app" class="md-nav__link">
    <span class="md-ellipsis">
      upload_outlook_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upload_teams_app" class="md-nav__link">
    <span class="md-ellipsis">
      upload_teams_app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../salesforce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Salesforce
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SAP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../successfactors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SuccessFactors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../translate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Translate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365" class="md-nav__link">
    <span class="md-ellipsis">
      m365
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365" class="md-nav__link">
    <span class="md-ellipsis">
      M365
    </span>
  </a>
  
    <nav class="md-nav" aria-label="M365">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_app_registration" class="md-nav__link">
    <span class="md-ellipsis">
      add_app_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_group" class="md-nav__link">
    <span class="md-ellipsis">
      add_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_group_member" class="md-nav__link">
    <span class="md-ellipsis">
      add_group_member
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_group_owner" class="md-nav__link">
    <span class="md-ellipsis">
      add_group_owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sensitivity_label" class="md-nav__link">
    <span class="md-ellipsis">
      add_sensitivity_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sharepoint_page" class="md-nav__link">
    <span class="md-ellipsis">
      add_sharepoint_page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sharepoint_section" class="md-nav__link">
    <span class="md-ellipsis">
      add_sharepoint_section
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_sharepoint_webpart" class="md-nav__link">
    <span class="md-ellipsis">
      add_sharepoint_webpart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_team" class="md-nav__link">
    <span class="md-ellipsis">
      add_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_teams_app_to_channel" class="md-nav__link">
    <span class="md-ellipsis">
      add_teams_app_to_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.add_user" class="md-nav__link">
    <span class="md-ellipsis">
      add_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_license_to_user" class="md-nav__link">
    <span class="md-ellipsis">
      assign_license_to_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_sensitivity_label_to_user" class="md-nav__link">
    <span class="md-ellipsis">
      assign_sensitivity_label_to_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_teams_app_to_team" class="md-nav__link">
    <span class="md-ellipsis">
      assign_teams_app_to_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.assign_teams_app_to_user" class="md-nav__link">
    <span class="md-ellipsis">
      assign_teams_app_to_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.authenticate" class="md-nav__link">
    <span class="md-ellipsis">
      authenticate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.authenticate_user" class="md-nav__link">
    <span class="md-ellipsis">
      authenticate_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.credentials" class="md-nav__link">
    <span class="md-ellipsis">
      credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.credentials_user" class="md-nav__link">
    <span class="md-ellipsis">
      credentials_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_all_teams" class="md-nav__link">
    <span class="md-ellipsis">
      delete_all_teams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_mail" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_sharepoint_section" class="md-nav__link">
    <span class="md-ellipsis">
      delete_sharepoint_section
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_team" class="md-nav__link">
    <span class="md-ellipsis">
      delete_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_teams" class="md-nav__link">
    <span class="md-ellipsis">
      delete_teams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.delete_teams_app_from_channel" class="md-nav__link">
    <span class="md-ellipsis">
      delete_teams_app_from_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.do_request" class="md-nav__link">
    <span class="md-ellipsis">
      do_request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.download_user_photo" class="md-nav__link">
    <span class="md-ellipsis">
      download_user_photo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.email_verification" class="md-nav__link">
    <span class="md-ellipsis">
      email_verification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.exist_result_item" class="md-nav__link">
    <span class="md-ellipsis">
      exist_result_item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.extract_url_from_message_body" class="md-nav__link">
    <span class="md-ellipsis">
      extract_url_from_message_body
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.extract_version_from_app_manifest" class="md-nav__link">
    <span class="md-ellipsis">
      extract_version_from_app_manifest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.follow_sharepoint_site" class="md-nav__link">
    <span class="md-ellipsis">
      follow_sharepoint_site
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_app_registration" class="md-nav__link">
    <span class="md-ellipsis">
      get_app_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_group" class="md-nav__link">
    <span class="md-ellipsis">
      get_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_group_members" class="md-nav__link">
    <span class="md-ellipsis">
      get_group_members
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_group_owners" class="md-nav__link">
    <span class="md-ellipsis">
      get_group_owners
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_groups" class="md-nav__link">
    <span class="md-ellipsis">
      get_groups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_groups_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      get_groups_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_mail" class="md-nav__link">
    <span class="md-ellipsis">
      get_mail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_mail_body" class="md-nav__link">
    <span class="md-ellipsis">
      get_mail_body
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_result_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_result_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_page" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_pages" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_root_sites" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_root_sites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_section
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_sections" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_site" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_site
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_site_by_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_site_by_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_site_for_group" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_site_for_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_sites" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_sites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_sites_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_sites_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_webpart" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_webpart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_sharepoint_webparts" class="md-nav__link">
    <span class="md-ellipsis">
      get_sharepoint_webparts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_team" class="md-nav__link">
    <span class="md-ellipsis">
      get_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_team_channel_tabs" class="md-nav__link">
    <span class="md-ellipsis">
      get_team_channel_tabs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_team_channels" class="md-nav__link">
    <span class="md-ellipsis">
      get_team_channels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_app" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_apps" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_apps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_apps_of_team" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_apps_of_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_teams_apps_of_user" class="md-nav__link">
    <span class="md-ellipsis">
      get_teams_apps_of_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user" class="md-nav__link">
    <span class="md-ellipsis">
      get_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user_drive" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_drive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user_licenses" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_licenses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_user_photo" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_photo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_users" class="md-nav__link">
    <span class="md-ellipsis">
      get_users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.get_users_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      get_users_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.has_team" class="md-nav__link">
    <span class="md-ellipsis">
      has_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.is_member" class="md-nav__link">
    <span class="md-ellipsis">
      is_member
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.lookup_result_value" class="md-nav__link">
    <span class="md-ellipsis">
      lookup_result_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.parse_request_response" class="md-nav__link">
    <span class="md-ellipsis">
      parse_request_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.publish_sharepoint_page" class="md-nav__link">
    <span class="md-ellipsis">
      publish_sharepoint_page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.purge_deleted_item" class="md-nav__link">
    <span class="md-ellipsis">
      purge_deleted_item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.purge_deleted_items" class="md-nav__link">
    <span class="md-ellipsis">
      purge_deleted_items
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.remove_teams_app" class="md-nav__link">
    <span class="md-ellipsis">
      remove_teams_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.remove_teams_app_from_user" class="md-nav__link">
    <span class="md-ellipsis">
      remove_teams_app_from_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.request_header" class="md-nav__link">
    <span class="md-ellipsis">
      request_header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.request_header_user" class="md-nav__link">
    <span class="md-ellipsis">
      request_header_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_app_registration" class="md-nav__link">
    <span class="md-ellipsis">
      update_app_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_sharepoint_webpart" class="md-nav__link">
    <span class="md-ellipsis">
      update_sharepoint_webpart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_teams_app_of_channel" class="md-nav__link">
    <span class="md-ellipsis">
      update_teams_app_of_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_user" class="md-nav__link">
    <span class="md-ellipsis">
      update_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.update_user_photo" class="md-nav__link">
    <span class="md-ellipsis">
      update_user_photo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upgrade_teams_app_of_team" class="md-nav__link">
    <span class="md-ellipsis">
      upgrade_teams_app_of_team
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upgrade_teams_app_of_user" class="md-nav__link">
    <span class="md-ellipsis">
      upgrade_teams_app_of_user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upload_outlook_app" class="md-nav__link">
    <span class="md-ellipsis">
      upload_outlook_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyxecm_customizer.m365.M365.upload_teams_app" class="md-nav__link">
    <span class="md-ellipsis">
      upload_teams_app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/opentext/pyxecm/edit/main/docs/pyxecm-customizer/m365.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


  <h1>Microsoft 365</h1>

<div class="doc doc-object doc-module">



<a id="pyxecm_customizer.m365"></a>
    <div class="doc doc-contents first">

        <p>M365 Module to interact with the MS Graph API.</p>
<p>See also https://learn.microsoft.com/en-us/graph/</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="pyxecm_customizer.m365.M365" class="doc doc-heading">
            <code>M365</code>


</h2>


    <div class="doc doc-contents ">


        <p>Used to automate stettings in Microsoft 365 via the Graph API.</p>








              <details class="quote">
                <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40">  40</a></span>
<span class="normal"><a href="#__codelineno-0-41">  41</a></span>
<span class="normal"><a href="#__codelineno-0-42">  42</a></span>
<span class="normal"><a href="#__codelineno-0-43">  43</a></span>
<span class="normal"><a href="#__codelineno-0-44">  44</a></span>
<span class="normal"><a href="#__codelineno-0-45">  45</a></span>
<span class="normal"><a href="#__codelineno-0-46">  46</a></span>
<span class="normal"><a href="#__codelineno-0-47">  47</a></span>
<span class="normal"><a href="#__codelineno-0-48">  48</a></span>
<span class="normal"><a href="#__codelineno-0-49">  49</a></span>
<span class="normal"><a href="#__codelineno-0-50">  50</a></span>
<span class="normal"><a href="#__codelineno-0-51">  51</a></span>
<span class="normal"><a href="#__codelineno-0-52">  52</a></span>
<span class="normal"><a href="#__codelineno-0-53">  53</a></span>
<span class="normal"><a href="#__codelineno-0-54">  54</a></span>
<span class="normal"><a href="#__codelineno-0-55">  55</a></span>
<span class="normal"><a href="#__codelineno-0-56">  56</a></span>
<span class="normal"><a href="#__codelineno-0-57">  57</a></span>
<span class="normal"><a href="#__codelineno-0-58">  58</a></span>
<span class="normal"><a href="#__codelineno-0-59">  59</a></span>
<span class="normal"><a href="#__codelineno-0-60">  60</a></span>
<span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span>
<span class="normal"><a href="#__codelineno-0-2744">2744</a></span>
<span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span>
<span class="normal"><a href="#__codelineno-0-2752">2752</a></span>
<span class="normal"><a href="#__codelineno-0-2753">2753</a></span>
<span class="normal"><a href="#__codelineno-0-2754">2754</a></span>
<span class="normal"><a href="#__codelineno-0-2755">2755</a></span>
<span class="normal"><a href="#__codelineno-0-2756">2756</a></span>
<span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span>
<span class="normal"><a href="#__codelineno-0-2764">2764</a></span>
<span class="normal"><a href="#__codelineno-0-2765">2765</a></span>
<span class="normal"><a href="#__codelineno-0-2766">2766</a></span>
<span class="normal"><a href="#__codelineno-0-2767">2767</a></span>
<span class="normal"><a href="#__codelineno-0-2768">2768</a></span>
<span class="normal"><a href="#__codelineno-0-2769">2769</a></span>
<span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span>
<span class="normal"><a href="#__codelineno-0-2807">2807</a></span>
<span class="normal"><a href="#__codelineno-0-2808">2808</a></span>
<span class="normal"><a href="#__codelineno-0-2809">2809</a></span>
<span class="normal"><a href="#__codelineno-0-2810">2810</a></span>
<span class="normal"><a href="#__codelineno-0-2811">2811</a></span>
<span class="normal"><a href="#__codelineno-0-2812">2812</a></span>
<span class="normal"><a href="#__codelineno-0-2813">2813</a></span>
<span class="normal"><a href="#__codelineno-0-2814">2814</a></span>
<span class="normal"><a href="#__codelineno-0-2815">2815</a></span>
<span class="normal"><a href="#__codelineno-0-2816">2816</a></span>
<span class="normal"><a href="#__codelineno-0-2817">2817</a></span>
<span class="normal"><a href="#__codelineno-0-2818">2818</a></span>
<span class="normal"><a href="#__codelineno-0-2819">2819</a></span>
<span class="normal"><a href="#__codelineno-0-2820">2820</a></span>
<span class="normal"><a href="#__codelineno-0-2821">2821</a></span>
<span class="normal"><a href="#__codelineno-0-2822">2822</a></span>
<span class="normal"><a href="#__codelineno-0-2823">2823</a></span>
<span class="normal"><a href="#__codelineno-0-2824">2824</a></span>
<span class="normal"><a href="#__codelineno-0-2825">2825</a></span>
<span class="normal"><a href="#__codelineno-0-2826">2826</a></span>
<span class="normal"><a href="#__codelineno-0-2827">2827</a></span>
<span class="normal"><a href="#__codelineno-0-2828">2828</a></span>
<span class="normal"><a href="#__codelineno-0-2829">2829</a></span>
<span class="normal"><a href="#__codelineno-0-2830">2830</a></span>
<span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span>
<span class="normal"><a href="#__codelineno-0-2837">2837</a></span>
<span class="normal"><a href="#__codelineno-0-2838">2838</a></span>
<span class="normal"><a href="#__codelineno-0-2839">2839</a></span>
<span class="normal"><a href="#__codelineno-0-2840">2840</a></span>
<span class="normal"><a href="#__codelineno-0-2841">2841</a></span>
<span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span>
<span class="normal"><a href="#__codelineno-0-2851">2851</a></span>
<span class="normal"><a href="#__codelineno-0-2852">2852</a></span>
<span class="normal"><a href="#__codelineno-0-2853">2853</a></span>
<span class="normal"><a href="#__codelineno-0-2854">2854</a></span>
<span class="normal"><a href="#__codelineno-0-2855">2855</a></span>
<span class="normal"><a href="#__codelineno-0-2856">2856</a></span>
<span class="normal"><a href="#__codelineno-0-2857">2857</a></span>
<span class="normal"><a href="#__codelineno-0-2858">2858</a></span>
<span class="normal"><a href="#__codelineno-0-2859">2859</a></span>
<span class="normal"><a href="#__codelineno-0-2860">2860</a></span>
<span class="normal"><a href="#__codelineno-0-2861">2861</a></span>
<span class="normal"><a href="#__codelineno-0-2862">2862</a></span>
<span class="normal"><a href="#__codelineno-0-2863">2863</a></span>
<span class="normal"><a href="#__codelineno-0-2864">2864</a></span>
<span class="normal"><a href="#__codelineno-0-2865">2865</a></span>
<span class="normal"><a href="#__codelineno-0-2866">2866</a></span>
<span class="normal"><a href="#__codelineno-0-2867">2867</a></span>
<span class="normal"><a href="#__codelineno-0-2868">2868</a></span>
<span class="normal"><a href="#__codelineno-0-2869">2869</a></span>
<span class="normal"><a href="#__codelineno-0-2870">2870</a></span>
<span class="normal"><a href="#__codelineno-0-2871">2871</a></span>
<span class="normal"><a href="#__codelineno-0-2872">2872</a></span>
<span class="normal"><a href="#__codelineno-0-2873">2873</a></span>
<span class="normal"><a href="#__codelineno-0-2874">2874</a></span>
<span class="normal"><a href="#__codelineno-0-2875">2875</a></span>
<span class="normal"><a href="#__codelineno-0-2876">2876</a></span>
<span class="normal"><a href="#__codelineno-0-2877">2877</a></span>
<span class="normal"><a href="#__codelineno-0-2878">2878</a></span>
<span class="normal"><a href="#__codelineno-0-2879">2879</a></span>
<span class="normal"><a href="#__codelineno-0-2880">2880</a></span>
<span class="normal"><a href="#__codelineno-0-2881">2881</a></span>
<span class="normal"><a href="#__codelineno-0-2882">2882</a></span>
<span class="normal"><a href="#__codelineno-0-2883">2883</a></span>
<span class="normal"><a href="#__codelineno-0-2884">2884</a></span>
<span class="normal"><a href="#__codelineno-0-2885">2885</a></span>
<span class="normal"><a href="#__codelineno-0-2886">2886</a></span>
<span class="normal"><a href="#__codelineno-0-2887">2887</a></span>
<span class="normal"><a href="#__codelineno-0-2888">2888</a></span>
<span class="normal"><a href="#__codelineno-0-2889">2889</a></span>
<span class="normal"><a href="#__codelineno-0-2890">2890</a></span>
<span class="normal"><a href="#__codelineno-0-2891">2891</a></span>
<span class="normal"><a href="#__codelineno-0-2892">2892</a></span>
<span class="normal"><a href="#__codelineno-0-2893">2893</a></span>
<span class="normal"><a href="#__codelineno-0-2894">2894</a></span>
<span class="normal"><a href="#__codelineno-0-2895">2895</a></span>
<span class="normal"><a href="#__codelineno-0-2896">2896</a></span>
<span class="normal"><a href="#__codelineno-0-2897">2897</a></span>
<span class="normal"><a href="#__codelineno-0-2898">2898</a></span>
<span class="normal"><a href="#__codelineno-0-2899">2899</a></span>
<span class="normal"><a href="#__codelineno-0-2900">2900</a></span>
<span class="normal"><a href="#__codelineno-0-2901">2901</a></span>
<span class="normal"><a href="#__codelineno-0-2902">2902</a></span>
<span class="normal"><a href="#__codelineno-0-2903">2903</a></span>
<span class="normal"><a href="#__codelineno-0-2904">2904</a></span>
<span class="normal"><a href="#__codelineno-0-2905">2905</a></span>
<span class="normal"><a href="#__codelineno-0-2906">2906</a></span>
<span class="normal"><a href="#__codelineno-0-2907">2907</a></span>
<span class="normal"><a href="#__codelineno-0-2908">2908</a></span>
<span class="normal"><a href="#__codelineno-0-2909">2909</a></span>
<span class="normal"><a href="#__codelineno-0-2910">2910</a></span>
<span class="normal"><a href="#__codelineno-0-2911">2911</a></span>
<span class="normal"><a href="#__codelineno-0-2912">2912</a></span>
<span class="normal"><a href="#__codelineno-0-2913">2913</a></span>
<span class="normal"><a href="#__codelineno-0-2914">2914</a></span>
<span class="normal"><a href="#__codelineno-0-2915">2915</a></span>
<span class="normal"><a href="#__codelineno-0-2916">2916</a></span>
<span class="normal"><a href="#__codelineno-0-2917">2917</a></span>
<span class="normal"><a href="#__codelineno-0-2918">2918</a></span>
<span class="normal"><a href="#__codelineno-0-2919">2919</a></span>
<span class="normal"><a href="#__codelineno-0-2920">2920</a></span>
<span class="normal"><a href="#__codelineno-0-2921">2921</a></span>
<span class="normal"><a href="#__codelineno-0-2922">2922</a></span>
<span class="normal"><a href="#__codelineno-0-2923">2923</a></span>
<span class="normal"><a href="#__codelineno-0-2924">2924</a></span>
<span class="normal"><a href="#__codelineno-0-2925">2925</a></span>
<span class="normal"><a href="#__codelineno-0-2926">2926</a></span>
<span class="normal"><a href="#__codelineno-0-2927">2927</a></span>
<span class="normal"><a href="#__codelineno-0-2928">2928</a></span>
<span class="normal"><a href="#__codelineno-0-2929">2929</a></span>
<span class="normal"><a href="#__codelineno-0-2930">2930</a></span>
<span class="normal"><a href="#__codelineno-0-2931">2931</a></span>
<span class="normal"><a href="#__codelineno-0-2932">2932</a></span>
<span class="normal"><a href="#__codelineno-0-2933">2933</a></span>
<span class="normal"><a href="#__codelineno-0-2934">2934</a></span>
<span class="normal"><a href="#__codelineno-0-2935">2935</a></span>
<span class="normal"><a href="#__codelineno-0-2936">2936</a></span>
<span class="normal"><a href="#__codelineno-0-2937">2937</a></span>
<span class="normal"><a href="#__codelineno-0-2938">2938</a></span>
<span class="normal"><a href="#__codelineno-0-2939">2939</a></span>
<span class="normal"><a href="#__codelineno-0-2940">2940</a></span>
<span class="normal"><a href="#__codelineno-0-2941">2941</a></span>
<span class="normal"><a href="#__codelineno-0-2942">2942</a></span>
<span class="normal"><a href="#__codelineno-0-2943">2943</a></span>
<span class="normal"><a href="#__codelineno-0-2944">2944</a></span>
<span class="normal"><a href="#__codelineno-0-2945">2945</a></span>
<span class="normal"><a href="#__codelineno-0-2946">2946</a></span>
<span class="normal"><a href="#__codelineno-0-2947">2947</a></span>
<span class="normal"><a href="#__codelineno-0-2948">2948</a></span>
<span class="normal"><a href="#__codelineno-0-2949">2949</a></span>
<span class="normal"><a href="#__codelineno-0-2950">2950</a></span>
<span class="normal"><a href="#__codelineno-0-2951">2951</a></span>
<span class="normal"><a href="#__codelineno-0-2952">2952</a></span>
<span class="normal"><a href="#__codelineno-0-2953">2953</a></span>
<span class="normal"><a href="#__codelineno-0-2954">2954</a></span>
<span class="normal"><a href="#__codelineno-0-2955">2955</a></span>
<span class="normal"><a href="#__codelineno-0-2956">2956</a></span>
<span class="normal"><a href="#__codelineno-0-2957">2957</a></span>
<span class="normal"><a href="#__codelineno-0-2958">2958</a></span>
<span class="normal"><a href="#__codelineno-0-2959">2959</a></span>
<span class="normal"><a href="#__codelineno-0-2960">2960</a></span>
<span class="normal"><a href="#__codelineno-0-2961">2961</a></span>
<span class="normal"><a href="#__codelineno-0-2962">2962</a></span>
<span class="normal"><a href="#__codelineno-0-2963">2963</a></span>
<span class="normal"><a href="#__codelineno-0-2964">2964</a></span>
<span class="normal"><a href="#__codelineno-0-2965">2965</a></span>
<span class="normal"><a href="#__codelineno-0-2966">2966</a></span>
<span class="normal"><a href="#__codelineno-0-2967">2967</a></span>
<span class="normal"><a href="#__codelineno-0-2968">2968</a></span>
<span class="normal"><a href="#__codelineno-0-2969">2969</a></span>
<span class="normal"><a href="#__codelineno-0-2970">2970</a></span>
<span class="normal"><a href="#__codelineno-0-2971">2971</a></span>
<span class="normal"><a href="#__codelineno-0-2972">2972</a></span>
<span class="normal"><a href="#__codelineno-0-2973">2973</a></span>
<span class="normal"><a href="#__codelineno-0-2974">2974</a></span>
<span class="normal"><a href="#__codelineno-0-2975">2975</a></span>
<span class="normal"><a href="#__codelineno-0-2976">2976</a></span>
<span class="normal"><a href="#__codelineno-0-2977">2977</a></span>
<span class="normal"><a href="#__codelineno-0-2978">2978</a></span>
<span class="normal"><a href="#__codelineno-0-2979">2979</a></span>
<span class="normal"><a href="#__codelineno-0-2980">2980</a></span>
<span class="normal"><a href="#__codelineno-0-2981">2981</a></span>
<span class="normal"><a href="#__codelineno-0-2982">2982</a></span>
<span class="normal"><a href="#__codelineno-0-2983">2983</a></span>
<span class="normal"><a href="#__codelineno-0-2984">2984</a></span>
<span class="normal"><a href="#__codelineno-0-2985">2985</a></span>
<span class="normal"><a href="#__codelineno-0-2986">2986</a></span>
<span class="normal"><a href="#__codelineno-0-2987">2987</a></span>
<span class="normal"><a href="#__codelineno-0-2988">2988</a></span>
<span class="normal"><a href="#__codelineno-0-2989">2989</a></span>
<span class="normal"><a href="#__codelineno-0-2990">2990</a></span>
<span class="normal"><a href="#__codelineno-0-2991">2991</a></span>
<span class="normal"><a href="#__codelineno-0-2992">2992</a></span>
<span class="normal"><a href="#__codelineno-0-2993">2993</a></span>
<span class="normal"><a href="#__codelineno-0-2994">2994</a></span>
<span class="normal"><a href="#__codelineno-0-2995">2995</a></span>
<span class="normal"><a href="#__codelineno-0-2996">2996</a></span>
<span class="normal"><a href="#__codelineno-0-2997">2997</a></span>
<span class="normal"><a href="#__codelineno-0-2998">2998</a></span>
<span class="normal"><a href="#__codelineno-0-2999">2999</a></span>
<span class="normal"><a href="#__codelineno-0-3000">3000</a></span>
<span class="normal"><a href="#__codelineno-0-3001">3001</a></span>
<span class="normal"><a href="#__codelineno-0-3002">3002</a></span>
<span class="normal"><a href="#__codelineno-0-3003">3003</a></span>
<span class="normal"><a href="#__codelineno-0-3004">3004</a></span>
<span class="normal"><a href="#__codelineno-0-3005">3005</a></span>
<span class="normal"><a href="#__codelineno-0-3006">3006</a></span>
<span class="normal"><a href="#__codelineno-0-3007">3007</a></span>
<span class="normal"><a href="#__codelineno-0-3008">3008</a></span>
<span class="normal"><a href="#__codelineno-0-3009">3009</a></span>
<span class="normal"><a href="#__codelineno-0-3010">3010</a></span>
<span class="normal"><a href="#__codelineno-0-3011">3011</a></span>
<span class="normal"><a href="#__codelineno-0-3012">3012</a></span>
<span class="normal"><a href="#__codelineno-0-3013">3013</a></span>
<span class="normal"><a href="#__codelineno-0-3014">3014</a></span>
<span class="normal"><a href="#__codelineno-0-3015">3015</a></span>
<span class="normal"><a href="#__codelineno-0-3016">3016</a></span>
<span class="normal"><a href="#__codelineno-0-3017">3017</a></span>
<span class="normal"><a href="#__codelineno-0-3018">3018</a></span>
<span class="normal"><a href="#__codelineno-0-3019">3019</a></span>
<span class="normal"><a href="#__codelineno-0-3020">3020</a></span>
<span class="normal"><a href="#__codelineno-0-3021">3021</a></span>
<span class="normal"><a href="#__codelineno-0-3022">3022</a></span>
<span class="normal"><a href="#__codelineno-0-3023">3023</a></span>
<span class="normal"><a href="#__codelineno-0-3024">3024</a></span>
<span class="normal"><a href="#__codelineno-0-3025">3025</a></span>
<span class="normal"><a href="#__codelineno-0-3026">3026</a></span>
<span class="normal"><a href="#__codelineno-0-3027">3027</a></span>
<span class="normal"><a href="#__codelineno-0-3028">3028</a></span>
<span class="normal"><a href="#__codelineno-0-3029">3029</a></span>
<span class="normal"><a href="#__codelineno-0-3030">3030</a></span>
<span class="normal"><a href="#__codelineno-0-3031">3031</a></span>
<span class="normal"><a href="#__codelineno-0-3032">3032</a></span>
<span class="normal"><a href="#__codelineno-0-3033">3033</a></span>
<span class="normal"><a href="#__codelineno-0-3034">3034</a></span>
<span class="normal"><a href="#__codelineno-0-3035">3035</a></span>
<span class="normal"><a href="#__codelineno-0-3036">3036</a></span>
<span class="normal"><a href="#__codelineno-0-3037">3037</a></span>
<span class="normal"><a href="#__codelineno-0-3038">3038</a></span>
<span class="normal"><a href="#__codelineno-0-3039">3039</a></span>
<span class="normal"><a href="#__codelineno-0-3040">3040</a></span>
<span class="normal"><a href="#__codelineno-0-3041">3041</a></span>
<span class="normal"><a href="#__codelineno-0-3042">3042</a></span>
<span class="normal"><a href="#__codelineno-0-3043">3043</a></span>
<span class="normal"><a href="#__codelineno-0-3044">3044</a></span>
<span class="normal"><a href="#__codelineno-0-3045">3045</a></span>
<span class="normal"><a href="#__codelineno-0-3046">3046</a></span>
<span class="normal"><a href="#__codelineno-0-3047">3047</a></span>
<span class="normal"><a href="#__codelineno-0-3048">3048</a></span>
<span class="normal"><a href="#__codelineno-0-3049">3049</a></span>
<span class="normal"><a href="#__codelineno-0-3050">3050</a></span>
<span class="normal"><a href="#__codelineno-0-3051">3051</a></span>
<span class="normal"><a href="#__codelineno-0-3052">3052</a></span>
<span class="normal"><a href="#__codelineno-0-3053">3053</a></span>
<span class="normal"><a href="#__codelineno-0-3054">3054</a></span>
<span class="normal"><a href="#__codelineno-0-3055">3055</a></span>
<span class="normal"><a href="#__codelineno-0-3056">3056</a></span>
<span class="normal"><a href="#__codelineno-0-3057">3057</a></span>
<span class="normal"><a href="#__codelineno-0-3058">3058</a></span>
<span class="normal"><a href="#__codelineno-0-3059">3059</a></span>
<span class="normal"><a href="#__codelineno-0-3060">3060</a></span>
<span class="normal"><a href="#__codelineno-0-3061">3061</a></span>
<span class="normal"><a href="#__codelineno-0-3062">3062</a></span>
<span class="normal"><a href="#__codelineno-0-3063">3063</a></span>
<span class="normal"><a href="#__codelineno-0-3064">3064</a></span>
<span class="normal"><a href="#__codelineno-0-3065">3065</a></span>
<span class="normal"><a href="#__codelineno-0-3066">3066</a></span>
<span class="normal"><a href="#__codelineno-0-3067">3067</a></span>
<span class="normal"><a href="#__codelineno-0-3068">3068</a></span>
<span class="normal"><a href="#__codelineno-0-3069">3069</a></span>
<span class="normal"><a href="#__codelineno-0-3070">3070</a></span>
<span class="normal"><a href="#__codelineno-0-3071">3071</a></span>
<span class="normal"><a href="#__codelineno-0-3072">3072</a></span>
<span class="normal"><a href="#__codelineno-0-3073">3073</a></span>
<span class="normal"><a href="#__codelineno-0-3074">3074</a></span>
<span class="normal"><a href="#__codelineno-0-3075">3075</a></span>
<span class="normal"><a href="#__codelineno-0-3076">3076</a></span>
<span class="normal"><a href="#__codelineno-0-3077">3077</a></span>
<span class="normal"><a href="#__codelineno-0-3078">3078</a></span>
<span class="normal"><a href="#__codelineno-0-3079">3079</a></span>
<span class="normal"><a href="#__codelineno-0-3080">3080</a></span>
<span class="normal"><a href="#__codelineno-0-3081">3081</a></span>
<span class="normal"><a href="#__codelineno-0-3082">3082</a></span>
<span class="normal"><a href="#__codelineno-0-3083">3083</a></span>
<span class="normal"><a href="#__codelineno-0-3084">3084</a></span>
<span class="normal"><a href="#__codelineno-0-3085">3085</a></span>
<span class="normal"><a href="#__codelineno-0-3086">3086</a></span>
<span class="normal"><a href="#__codelineno-0-3087">3087</a></span>
<span class="normal"><a href="#__codelineno-0-3088">3088</a></span>
<span class="normal"><a href="#__codelineno-0-3089">3089</a></span>
<span class="normal"><a href="#__codelineno-0-3090">3090</a></span>
<span class="normal"><a href="#__codelineno-0-3091">3091</a></span>
<span class="normal"><a href="#__codelineno-0-3092">3092</a></span>
<span class="normal"><a href="#__codelineno-0-3093">3093</a></span>
<span class="normal"><a href="#__codelineno-0-3094">3094</a></span>
<span class="normal"><a href="#__codelineno-0-3095">3095</a></span>
<span class="normal"><a href="#__codelineno-0-3096">3096</a></span>
<span class="normal"><a href="#__codelineno-0-3097">3097</a></span>
<span class="normal"><a href="#__codelineno-0-3098">3098</a></span>
<span class="normal"><a href="#__codelineno-0-3099">3099</a></span>
<span class="normal"><a href="#__codelineno-0-3100">3100</a></span>
<span class="normal"><a href="#__codelineno-0-3101">3101</a></span>
<span class="normal"><a href="#__codelineno-0-3102">3102</a></span>
<span class="normal"><a href="#__codelineno-0-3103">3103</a></span>
<span class="normal"><a href="#__codelineno-0-3104">3104</a></span>
<span class="normal"><a href="#__codelineno-0-3105">3105</a></span>
<span class="normal"><a href="#__codelineno-0-3106">3106</a></span>
<span class="normal"><a href="#__codelineno-0-3107">3107</a></span>
<span class="normal"><a href="#__codelineno-0-3108">3108</a></span>
<span class="normal"><a href="#__codelineno-0-3109">3109</a></span>
<span class="normal"><a href="#__codelineno-0-3110">3110</a></span>
<span class="normal"><a href="#__codelineno-0-3111">3111</a></span>
<span class="normal"><a href="#__codelineno-0-3112">3112</a></span>
<span class="normal"><a href="#__codelineno-0-3113">3113</a></span>
<span class="normal"><a href="#__codelineno-0-3114">3114</a></span>
<span class="normal"><a href="#__codelineno-0-3115">3115</a></span>
<span class="normal"><a href="#__codelineno-0-3116">3116</a></span>
<span class="normal"><a href="#__codelineno-0-3117">3117</a></span>
<span class="normal"><a href="#__codelineno-0-3118">3118</a></span>
<span class="normal"><a href="#__codelineno-0-3119">3119</a></span>
<span class="normal"><a href="#__codelineno-0-3120">3120</a></span>
<span class="normal"><a href="#__codelineno-0-3121">3121</a></span>
<span class="normal"><a href="#__codelineno-0-3122">3122</a></span>
<span class="normal"><a href="#__codelineno-0-3123">3123</a></span>
<span class="normal"><a href="#__codelineno-0-3124">3124</a></span>
<span class="normal"><a href="#__codelineno-0-3125">3125</a></span>
<span class="normal"><a href="#__codelineno-0-3126">3126</a></span>
<span class="normal"><a href="#__codelineno-0-3127">3127</a></span>
<span class="normal"><a href="#__codelineno-0-3128">3128</a></span>
<span class="normal"><a href="#__codelineno-0-3129">3129</a></span>
<span class="normal"><a href="#__codelineno-0-3130">3130</a></span>
<span class="normal"><a href="#__codelineno-0-3131">3131</a></span>
<span class="normal"><a href="#__codelineno-0-3132">3132</a></span>
<span class="normal"><a href="#__codelineno-0-3133">3133</a></span>
<span class="normal"><a href="#__codelineno-0-3134">3134</a></span>
<span class="normal"><a href="#__codelineno-0-3135">3135</a></span>
<span class="normal"><a href="#__codelineno-0-3136">3136</a></span>
<span class="normal"><a href="#__codelineno-0-3137">3137</a></span>
<span class="normal"><a href="#__codelineno-0-3138">3138</a></span>
<span class="normal"><a href="#__codelineno-0-3139">3139</a></span>
<span class="normal"><a href="#__codelineno-0-3140">3140</a></span>
<span class="normal"><a href="#__codelineno-0-3141">3141</a></span>
<span class="normal"><a href="#__codelineno-0-3142">3142</a></span>
<span class="normal"><a href="#__codelineno-0-3143">3143</a></span>
<span class="normal"><a href="#__codelineno-0-3144">3144</a></span>
<span class="normal"><a href="#__codelineno-0-3145">3145</a></span>
<span class="normal"><a href="#__codelineno-0-3146">3146</a></span>
<span class="normal"><a href="#__codelineno-0-3147">3147</a></span>
<span class="normal"><a href="#__codelineno-0-3148">3148</a></span>
<span class="normal"><a href="#__codelineno-0-3149">3149</a></span>
<span class="normal"><a href="#__codelineno-0-3150">3150</a></span>
<span class="normal"><a href="#__codelineno-0-3151">3151</a></span>
<span class="normal"><a href="#__codelineno-0-3152">3152</a></span>
<span class="normal"><a href="#__codelineno-0-3153">3153</a></span>
<span class="normal"><a href="#__codelineno-0-3154">3154</a></span>
<span class="normal"><a href="#__codelineno-0-3155">3155</a></span>
<span class="normal"><a href="#__codelineno-0-3156">3156</a></span>
<span class="normal"><a href="#__codelineno-0-3157">3157</a></span>
<span class="normal"><a href="#__codelineno-0-3158">3158</a></span>
<span class="normal"><a href="#__codelineno-0-3159">3159</a></span>
<span class="normal"><a href="#__codelineno-0-3160">3160</a></span>
<span class="normal"><a href="#__codelineno-0-3161">3161</a></span>
<span class="normal"><a href="#__codelineno-0-3162">3162</a></span>
<span class="normal"><a href="#__codelineno-0-3163">3163</a></span>
<span class="normal"><a href="#__codelineno-0-3164">3164</a></span>
<span class="normal"><a href="#__codelineno-0-3165">3165</a></span>
<span class="normal"><a href="#__codelineno-0-3166">3166</a></span>
<span class="normal"><a href="#__codelineno-0-3167">3167</a></span>
<span class="normal"><a href="#__codelineno-0-3168">3168</a></span>
<span class="normal"><a href="#__codelineno-0-3169">3169</a></span>
<span class="normal"><a href="#__codelineno-0-3170">3170</a></span>
<span class="normal"><a href="#__codelineno-0-3171">3171</a></span>
<span class="normal"><a href="#__codelineno-0-3172">3172</a></span>
<span class="normal"><a href="#__codelineno-0-3173">3173</a></span>
<span class="normal"><a href="#__codelineno-0-3174">3174</a></span>
<span class="normal"><a href="#__codelineno-0-3175">3175</a></span>
<span class="normal"><a href="#__codelineno-0-3176">3176</a></span>
<span class="normal"><a href="#__codelineno-0-3177">3177</a></span>
<span class="normal"><a href="#__codelineno-0-3178">3178</a></span>
<span class="normal"><a href="#__codelineno-0-3179">3179</a></span>
<span class="normal"><a href="#__codelineno-0-3180">3180</a></span>
<span class="normal"><a href="#__codelineno-0-3181">3181</a></span>
<span class="normal"><a href="#__codelineno-0-3182">3182</a></span>
<span class="normal"><a href="#__codelineno-0-3183">3183</a></span>
<span class="normal"><a href="#__codelineno-0-3184">3184</a></span>
<span class="normal"><a href="#__codelineno-0-3185">3185</a></span>
<span class="normal"><a href="#__codelineno-0-3186">3186</a></span>
<span class="normal"><a href="#__codelineno-0-3187">3187</a></span>
<span class="normal"><a href="#__codelineno-0-3188">3188</a></span>
<span class="normal"><a href="#__codelineno-0-3189">3189</a></span>
<span class="normal"><a href="#__codelineno-0-3190">3190</a></span>
<span class="normal"><a href="#__codelineno-0-3191">3191</a></span>
<span class="normal"><a href="#__codelineno-0-3192">3192</a></span>
<span class="normal"><a href="#__codelineno-0-3193">3193</a></span>
<span class="normal"><a href="#__codelineno-0-3194">3194</a></span>
<span class="normal"><a href="#__codelineno-0-3195">3195</a></span>
<span class="normal"><a href="#__codelineno-0-3196">3196</a></span>
<span class="normal"><a href="#__codelineno-0-3197">3197</a></span>
<span class="normal"><a href="#__codelineno-0-3198">3198</a></span>
<span class="normal"><a href="#__codelineno-0-3199">3199</a></span>
<span class="normal"><a href="#__codelineno-0-3200">3200</a></span>
<span class="normal"><a href="#__codelineno-0-3201">3201</a></span>
<span class="normal"><a href="#__codelineno-0-3202">3202</a></span>
<span class="normal"><a href="#__codelineno-0-3203">3203</a></span>
<span class="normal"><a href="#__codelineno-0-3204">3204</a></span>
<span class="normal"><a href="#__codelineno-0-3205">3205</a></span>
<span class="normal"><a href="#__codelineno-0-3206">3206</a></span>
<span class="normal"><a href="#__codelineno-0-3207">3207</a></span>
<span class="normal"><a href="#__codelineno-0-3208">3208</a></span>
<span class="normal"><a href="#__codelineno-0-3209">3209</a></span>
<span class="normal"><a href="#__codelineno-0-3210">3210</a></span>
<span class="normal"><a href="#__codelineno-0-3211">3211</a></span>
<span class="normal"><a href="#__codelineno-0-3212">3212</a></span>
<span class="normal"><a href="#__codelineno-0-3213">3213</a></span>
<span class="normal"><a href="#__codelineno-0-3214">3214</a></span>
<span class="normal"><a href="#__codelineno-0-3215">3215</a></span>
<span class="normal"><a href="#__codelineno-0-3216">3216</a></span>
<span class="normal"><a href="#__codelineno-0-3217">3217</a></span>
<span class="normal"><a href="#__codelineno-0-3218">3218</a></span>
<span class="normal"><a href="#__codelineno-0-3219">3219</a></span>
<span class="normal"><a href="#__codelineno-0-3220">3220</a></span>
<span class="normal"><a href="#__codelineno-0-3221">3221</a></span>
<span class="normal"><a href="#__codelineno-0-3222">3222</a></span>
<span class="normal"><a href="#__codelineno-0-3223">3223</a></span>
<span class="normal"><a href="#__codelineno-0-3224">3224</a></span>
<span class="normal"><a href="#__codelineno-0-3225">3225</a></span>
<span class="normal"><a href="#__codelineno-0-3226">3226</a></span>
<span class="normal"><a href="#__codelineno-0-3227">3227</a></span>
<span class="normal"><a href="#__codelineno-0-3228">3228</a></span>
<span class="normal"><a href="#__codelineno-0-3229">3229</a></span>
<span class="normal"><a href="#__codelineno-0-3230">3230</a></span>
<span class="normal"><a href="#__codelineno-0-3231">3231</a></span>
<span class="normal"><a href="#__codelineno-0-3232">3232</a></span>
<span class="normal"><a href="#__codelineno-0-3233">3233</a></span>
<span class="normal"><a href="#__codelineno-0-3234">3234</a></span>
<span class="normal"><a href="#__codelineno-0-3235">3235</a></span>
<span class="normal"><a href="#__codelineno-0-3236">3236</a></span>
<span class="normal"><a href="#__codelineno-0-3237">3237</a></span>
<span class="normal"><a href="#__codelineno-0-3238">3238</a></span>
<span class="normal"><a href="#__codelineno-0-3239">3239</a></span>
<span class="normal"><a href="#__codelineno-0-3240">3240</a></span>
<span class="normal"><a href="#__codelineno-0-3241">3241</a></span>
<span class="normal"><a href="#__codelineno-0-3242">3242</a></span>
<span class="normal"><a href="#__codelineno-0-3243">3243</a></span>
<span class="normal"><a href="#__codelineno-0-3244">3244</a></span>
<span class="normal"><a href="#__codelineno-0-3245">3245</a></span>
<span class="normal"><a href="#__codelineno-0-3246">3246</a></span>
<span class="normal"><a href="#__codelineno-0-3247">3247</a></span>
<span class="normal"><a href="#__codelineno-0-3248">3248</a></span>
<span class="normal"><a href="#__codelineno-0-3249">3249</a></span>
<span class="normal"><a href="#__codelineno-0-3250">3250</a></span>
<span class="normal"><a href="#__codelineno-0-3251">3251</a></span>
<span class="normal"><a href="#__codelineno-0-3252">3252</a></span>
<span class="normal"><a href="#__codelineno-0-3253">3253</a></span>
<span class="normal"><a href="#__codelineno-0-3254">3254</a></span>
<span class="normal"><a href="#__codelineno-0-3255">3255</a></span>
<span class="normal"><a href="#__codelineno-0-3256">3256</a></span>
<span class="normal"><a href="#__codelineno-0-3257">3257</a></span>
<span class="normal"><a href="#__codelineno-0-3258">3258</a></span>
<span class="normal"><a href="#__codelineno-0-3259">3259</a></span>
<span class="normal"><a href="#__codelineno-0-3260">3260</a></span>
<span class="normal"><a href="#__codelineno-0-3261">3261</a></span>
<span class="normal"><a href="#__codelineno-0-3262">3262</a></span>
<span class="normal"><a href="#__codelineno-0-3263">3263</a></span>
<span class="normal"><a href="#__codelineno-0-3264">3264</a></span>
<span class="normal"><a href="#__codelineno-0-3265">3265</a></span>
<span class="normal"><a href="#__codelineno-0-3266">3266</a></span>
<span class="normal"><a href="#__codelineno-0-3267">3267</a></span>
<span class="normal"><a href="#__codelineno-0-3268">3268</a></span>
<span class="normal"><a href="#__codelineno-0-3269">3269</a></span>
<span class="normal"><a href="#__codelineno-0-3270">3270</a></span>
<span class="normal"><a href="#__codelineno-0-3271">3271</a></span>
<span class="normal"><a href="#__codelineno-0-3272">3272</a></span>
<span class="normal"><a href="#__codelineno-0-3273">3273</a></span>
<span class="normal"><a href="#__codelineno-0-3274">3274</a></span>
<span class="normal"><a href="#__codelineno-0-3275">3275</a></span>
<span class="normal"><a href="#__codelineno-0-3276">3276</a></span>
<span class="normal"><a href="#__codelineno-0-3277">3277</a></span>
<span class="normal"><a href="#__codelineno-0-3278">3278</a></span>
<span class="normal"><a href="#__codelineno-0-3279">3279</a></span>
<span class="normal"><a href="#__codelineno-0-3280">3280</a></span>
<span class="normal"><a href="#__codelineno-0-3281">3281</a></span>
<span class="normal"><a href="#__codelineno-0-3282">3282</a></span>
<span class="normal"><a href="#__codelineno-0-3283">3283</a></span>
<span class="normal"><a href="#__codelineno-0-3284">3284</a></span>
<span class="normal"><a href="#__codelineno-0-3285">3285</a></span>
<span class="normal"><a href="#__codelineno-0-3286">3286</a></span>
<span class="normal"><a href="#__codelineno-0-3287">3287</a></span>
<span class="normal"><a href="#__codelineno-0-3288">3288</a></span>
<span class="normal"><a href="#__codelineno-0-3289">3289</a></span>
<span class="normal"><a href="#__codelineno-0-3290">3290</a></span>
<span class="normal"><a href="#__codelineno-0-3291">3291</a></span>
<span class="normal"><a href="#__codelineno-0-3292">3292</a></span>
<span class="normal"><a href="#__codelineno-0-3293">3293</a></span>
<span class="normal"><a href="#__codelineno-0-3294">3294</a></span>
<span class="normal"><a href="#__codelineno-0-3295">3295</a></span>
<span class="normal"><a href="#__codelineno-0-3296">3296</a></span>
<span class="normal"><a href="#__codelineno-0-3297">3297</a></span>
<span class="normal"><a href="#__codelineno-0-3298">3298</a></span>
<span class="normal"><a href="#__codelineno-0-3299">3299</a></span>
<span class="normal"><a href="#__codelineno-0-3300">3300</a></span>
<span class="normal"><a href="#__codelineno-0-3301">3301</a></span>
<span class="normal"><a href="#__codelineno-0-3302">3302</a></span>
<span class="normal"><a href="#__codelineno-0-3303">3303</a></span>
<span class="normal"><a href="#__codelineno-0-3304">3304</a></span>
<span class="normal"><a href="#__codelineno-0-3305">3305</a></span>
<span class="normal"><a href="#__codelineno-0-3306">3306</a></span>
<span class="normal"><a href="#__codelineno-0-3307">3307</a></span>
<span class="normal"><a href="#__codelineno-0-3308">3308</a></span>
<span class="normal"><a href="#__codelineno-0-3309">3309</a></span>
<span class="normal"><a href="#__codelineno-0-3310">3310</a></span>
<span class="normal"><a href="#__codelineno-0-3311">3311</a></span>
<span class="normal"><a href="#__codelineno-0-3312">3312</a></span>
<span class="normal"><a href="#__codelineno-0-3313">3313</a></span>
<span class="normal"><a href="#__codelineno-0-3314">3314</a></span>
<span class="normal"><a href="#__codelineno-0-3315">3315</a></span>
<span class="normal"><a href="#__codelineno-0-3316">3316</a></span>
<span class="normal"><a href="#__codelineno-0-3317">3317</a></span>
<span class="normal"><a href="#__codelineno-0-3318">3318</a></span>
<span class="normal"><a href="#__codelineno-0-3319">3319</a></span>
<span class="normal"><a href="#__codelineno-0-3320">3320</a></span>
<span class="normal"><a href="#__codelineno-0-3321">3321</a></span>
<span class="normal"><a href="#__codelineno-0-3322">3322</a></span>
<span class="normal"><a href="#__codelineno-0-3323">3323</a></span>
<span class="normal"><a href="#__codelineno-0-3324">3324</a></span>
<span class="normal"><a href="#__codelineno-0-3325">3325</a></span>
<span class="normal"><a href="#__codelineno-0-3326">3326</a></span>
<span class="normal"><a href="#__codelineno-0-3327">3327</a></span>
<span class="normal"><a href="#__codelineno-0-3328">3328</a></span>
<span class="normal"><a href="#__codelineno-0-3329">3329</a></span>
<span class="normal"><a href="#__codelineno-0-3330">3330</a></span>
<span class="normal"><a href="#__codelineno-0-3331">3331</a></span>
<span class="normal"><a href="#__codelineno-0-3332">3332</a></span>
<span class="normal"><a href="#__codelineno-0-3333">3333</a></span>
<span class="normal"><a href="#__codelineno-0-3334">3334</a></span>
<span class="normal"><a href="#__codelineno-0-3335">3335</a></span>
<span class="normal"><a href="#__codelineno-0-3336">3336</a></span>
<span class="normal"><a href="#__codelineno-0-3337">3337</a></span>
<span class="normal"><a href="#__codelineno-0-3338">3338</a></span>
<span class="normal"><a href="#__codelineno-0-3339">3339</a></span>
<span class="normal"><a href="#__codelineno-0-3340">3340</a></span>
<span class="normal"><a href="#__codelineno-0-3341">3341</a></span>
<span class="normal"><a href="#__codelineno-0-3342">3342</a></span>
<span class="normal"><a href="#__codelineno-0-3343">3343</a></span>
<span class="normal"><a href="#__codelineno-0-3344">3344</a></span>
<span class="normal"><a href="#__codelineno-0-3345">3345</a></span>
<span class="normal"><a href="#__codelineno-0-3346">3346</a></span>
<span class="normal"><a href="#__codelineno-0-3347">3347</a></span>
<span class="normal"><a href="#__codelineno-0-3348">3348</a></span>
<span class="normal"><a href="#__codelineno-0-3349">3349</a></span>
<span class="normal"><a href="#__codelineno-0-3350">3350</a></span>
<span class="normal"><a href="#__codelineno-0-3351">3351</a></span>
<span class="normal"><a href="#__codelineno-0-3352">3352</a></span>
<span class="normal"><a href="#__codelineno-0-3353">3353</a></span>
<span class="normal"><a href="#__codelineno-0-3354">3354</a></span>
<span class="normal"><a href="#__codelineno-0-3355">3355</a></span>
<span class="normal"><a href="#__codelineno-0-3356">3356</a></span>
<span class="normal"><a href="#__codelineno-0-3357">3357</a></span>
<span class="normal"><a href="#__codelineno-0-3358">3358</a></span>
<span class="normal"><a href="#__codelineno-0-3359">3359</a></span>
<span class="normal"><a href="#__codelineno-0-3360">3360</a></span>
<span class="normal"><a href="#__codelineno-0-3361">3361</a></span>
<span class="normal"><a href="#__codelineno-0-3362">3362</a></span>
<span class="normal"><a href="#__codelineno-0-3363">3363</a></span>
<span class="normal"><a href="#__codelineno-0-3364">3364</a></span>
<span class="normal"><a href="#__codelineno-0-3365">3365</a></span>
<span class="normal"><a href="#__codelineno-0-3366">3366</a></span>
<span class="normal"><a href="#__codelineno-0-3367">3367</a></span>
<span class="normal"><a href="#__codelineno-0-3368">3368</a></span>
<span class="normal"><a href="#__codelineno-0-3369">3369</a></span>
<span class="normal"><a href="#__codelineno-0-3370">3370</a></span>
<span class="normal"><a href="#__codelineno-0-3371">3371</a></span>
<span class="normal"><a href="#__codelineno-0-3372">3372</a></span>
<span class="normal"><a href="#__codelineno-0-3373">3373</a></span>
<span class="normal"><a href="#__codelineno-0-3374">3374</a></span>
<span class="normal"><a href="#__codelineno-0-3375">3375</a></span>
<span class="normal"><a href="#__codelineno-0-3376">3376</a></span>
<span class="normal"><a href="#__codelineno-0-3377">3377</a></span>
<span class="normal"><a href="#__codelineno-0-3378">3378</a></span>
<span class="normal"><a href="#__codelineno-0-3379">3379</a></span>
<span class="normal"><a href="#__codelineno-0-3380">3380</a></span>
<span class="normal"><a href="#__codelineno-0-3381">3381</a></span>
<span class="normal"><a href="#__codelineno-0-3382">3382</a></span>
<span class="normal"><a href="#__codelineno-0-3383">3383</a></span>
<span class="normal"><a href="#__codelineno-0-3384">3384</a></span>
<span class="normal"><a href="#__codelineno-0-3385">3385</a></span>
<span class="normal"><a href="#__codelineno-0-3386">3386</a></span>
<span class="normal"><a href="#__codelineno-0-3387">3387</a></span>
<span class="normal"><a href="#__codelineno-0-3388">3388</a></span>
<span class="normal"><a href="#__codelineno-0-3389">3389</a></span>
<span class="normal"><a href="#__codelineno-0-3390">3390</a></span>
<span class="normal"><a href="#__codelineno-0-3391">3391</a></span>
<span class="normal"><a href="#__codelineno-0-3392">3392</a></span>
<span class="normal"><a href="#__codelineno-0-3393">3393</a></span>
<span class="normal"><a href="#__codelineno-0-3394">3394</a></span>
<span class="normal"><a href="#__codelineno-0-3395">3395</a></span>
<span class="normal"><a href="#__codelineno-0-3396">3396</a></span>
<span class="normal"><a href="#__codelineno-0-3397">3397</a></span>
<span class="normal"><a href="#__codelineno-0-3398">3398</a></span>
<span class="normal"><a href="#__codelineno-0-3399">3399</a></span>
<span class="normal"><a href="#__codelineno-0-3400">3400</a></span>
<span class="normal"><a href="#__codelineno-0-3401">3401</a></span>
<span class="normal"><a href="#__codelineno-0-3402">3402</a></span>
<span class="normal"><a href="#__codelineno-0-3403">3403</a></span>
<span class="normal"><a href="#__codelineno-0-3404">3404</a></span>
<span class="normal"><a href="#__codelineno-0-3405">3405</a></span>
<span class="normal"><a href="#__codelineno-0-3406">3406</a></span>
<span class="normal"><a href="#__codelineno-0-3407">3407</a></span>
<span class="normal"><a href="#__codelineno-0-3408">3408</a></span>
<span class="normal"><a href="#__codelineno-0-3409">3409</a></span>
<span class="normal"><a href="#__codelineno-0-3410">3410</a></span>
<span class="normal"><a href="#__codelineno-0-3411">3411</a></span>
<span class="normal"><a href="#__codelineno-0-3412">3412</a></span>
<span class="normal"><a href="#__codelineno-0-3413">3413</a></span>
<span class="normal"><a href="#__codelineno-0-3414">3414</a></span>
<span class="normal"><a href="#__codelineno-0-3415">3415</a></span>
<span class="normal"><a href="#__codelineno-0-3416">3416</a></span>
<span class="normal"><a href="#__codelineno-0-3417">3417</a></span>
<span class="normal"><a href="#__codelineno-0-3418">3418</a></span>
<span class="normal"><a href="#__codelineno-0-3419">3419</a></span>
<span class="normal"><a href="#__codelineno-0-3420">3420</a></span>
<span class="normal"><a href="#__codelineno-0-3421">3421</a></span>
<span class="normal"><a href="#__codelineno-0-3422">3422</a></span>
<span class="normal"><a href="#__codelineno-0-3423">3423</a></span>
<span class="normal"><a href="#__codelineno-0-3424">3424</a></span>
<span class="normal"><a href="#__codelineno-0-3425">3425</a></span>
<span class="normal"><a href="#__codelineno-0-3426">3426</a></span>
<span class="normal"><a href="#__codelineno-0-3427">3427</a></span>
<span class="normal"><a href="#__codelineno-0-3428">3428</a></span>
<span class="normal"><a href="#__codelineno-0-3429">3429</a></span>
<span class="normal"><a href="#__codelineno-0-3430">3430</a></span>
<span class="normal"><a href="#__codelineno-0-3431">3431</a></span>
<span class="normal"><a href="#__codelineno-0-3432">3432</a></span>
<span class="normal"><a href="#__codelineno-0-3433">3433</a></span>
<span class="normal"><a href="#__codelineno-0-3434">3434</a></span>
<span class="normal"><a href="#__codelineno-0-3435">3435</a></span>
<span class="normal"><a href="#__codelineno-0-3436">3436</a></span>
<span class="normal"><a href="#__codelineno-0-3437">3437</a></span>
<span class="normal"><a href="#__codelineno-0-3438">3438</a></span>
<span class="normal"><a href="#__codelineno-0-3439">3439</a></span>
<span class="normal"><a href="#__codelineno-0-3440">3440</a></span>
<span class="normal"><a href="#__codelineno-0-3441">3441</a></span>
<span class="normal"><a href="#__codelineno-0-3442">3442</a></span>
<span class="normal"><a href="#__codelineno-0-3443">3443</a></span>
<span class="normal"><a href="#__codelineno-0-3444">3444</a></span>
<span class="normal"><a href="#__codelineno-0-3445">3445</a></span>
<span class="normal"><a href="#__codelineno-0-3446">3446</a></span>
<span class="normal"><a href="#__codelineno-0-3447">3447</a></span>
<span class="normal"><a href="#__codelineno-0-3448">3448</a></span>
<span class="normal"><a href="#__codelineno-0-3449">3449</a></span>
<span class="normal"><a href="#__codelineno-0-3450">3450</a></span>
<span class="normal"><a href="#__codelineno-0-3451">3451</a></span>
<span class="normal"><a href="#__codelineno-0-3452">3452</a></span>
<span class="normal"><a href="#__codelineno-0-3453">3453</a></span>
<span class="normal"><a href="#__codelineno-0-3454">3454</a></span>
<span class="normal"><a href="#__codelineno-0-3455">3455</a></span>
<span class="normal"><a href="#__codelineno-0-3456">3456</a></span>
<span class="normal"><a href="#__codelineno-0-3457">3457</a></span>
<span class="normal"><a href="#__codelineno-0-3458">3458</a></span>
<span class="normal"><a href="#__codelineno-0-3459">3459</a></span>
<span class="normal"><a href="#__codelineno-0-3460">3460</a></span>
<span class="normal"><a href="#__codelineno-0-3461">3461</a></span>
<span class="normal"><a href="#__codelineno-0-3462">3462</a></span>
<span class="normal"><a href="#__codelineno-0-3463">3463</a></span>
<span class="normal"><a href="#__codelineno-0-3464">3464</a></span>
<span class="normal"><a href="#__codelineno-0-3465">3465</a></span>
<span class="normal"><a href="#__codelineno-0-3466">3466</a></span>
<span class="normal"><a href="#__codelineno-0-3467">3467</a></span>
<span class="normal"><a href="#__codelineno-0-3468">3468</a></span>
<span class="normal"><a href="#__codelineno-0-3469">3469</a></span>
<span class="normal"><a href="#__codelineno-0-3470">3470</a></span>
<span class="normal"><a href="#__codelineno-0-3471">3471</a></span>
<span class="normal"><a href="#__codelineno-0-3472">3472</a></span>
<span class="normal"><a href="#__codelineno-0-3473">3473</a></span>
<span class="normal"><a href="#__codelineno-0-3474">3474</a></span>
<span class="normal"><a href="#__codelineno-0-3475">3475</a></span>
<span class="normal"><a href="#__codelineno-0-3476">3476</a></span>
<span class="normal"><a href="#__codelineno-0-3477">3477</a></span>
<span class="normal"><a href="#__codelineno-0-3478">3478</a></span>
<span class="normal"><a href="#__codelineno-0-3479">3479</a></span>
<span class="normal"><a href="#__codelineno-0-3480">3480</a></span>
<span class="normal"><a href="#__codelineno-0-3481">3481</a></span>
<span class="normal"><a href="#__codelineno-0-3482">3482</a></span>
<span class="normal"><a href="#__codelineno-0-3483">3483</a></span>
<span class="normal"><a href="#__codelineno-0-3484">3484</a></span>
<span class="normal"><a href="#__codelineno-0-3485">3485</a></span>
<span class="normal"><a href="#__codelineno-0-3486">3486</a></span>
<span class="normal"><a href="#__codelineno-0-3487">3487</a></span>
<span class="normal"><a href="#__codelineno-0-3488">3488</a></span>
<span class="normal"><a href="#__codelineno-0-3489">3489</a></span>
<span class="normal"><a href="#__codelineno-0-3490">3490</a></span>
<span class="normal"><a href="#__codelineno-0-3491">3491</a></span>
<span class="normal"><a href="#__codelineno-0-3492">3492</a></span>
<span class="normal"><a href="#__codelineno-0-3493">3493</a></span>
<span class="normal"><a href="#__codelineno-0-3494">3494</a></span>
<span class="normal"><a href="#__codelineno-0-3495">3495</a></span>
<span class="normal"><a href="#__codelineno-0-3496">3496</a></span>
<span class="normal"><a href="#__codelineno-0-3497">3497</a></span>
<span class="normal"><a href="#__codelineno-0-3498">3498</a></span>
<span class="normal"><a href="#__codelineno-0-3499">3499</a></span>
<span class="normal"><a href="#__codelineno-0-3500">3500</a></span>
<span class="normal"><a href="#__codelineno-0-3501">3501</a></span>
<span class="normal"><a href="#__codelineno-0-3502">3502</a></span>
<span class="normal"><a href="#__codelineno-0-3503">3503</a></span>
<span class="normal"><a href="#__codelineno-0-3504">3504</a></span>
<span class="normal"><a href="#__codelineno-0-3505">3505</a></span>
<span class="normal"><a href="#__codelineno-0-3506">3506</a></span>
<span class="normal"><a href="#__codelineno-0-3507">3507</a></span>
<span class="normal"><a href="#__codelineno-0-3508">3508</a></span>
<span class="normal"><a href="#__codelineno-0-3509">3509</a></span>
<span class="normal"><a href="#__codelineno-0-3510">3510</a></span>
<span class="normal"><a href="#__codelineno-0-3511">3511</a></span>
<span class="normal"><a href="#__codelineno-0-3512">3512</a></span>
<span class="normal"><a href="#__codelineno-0-3513">3513</a></span>
<span class="normal"><a href="#__codelineno-0-3514">3514</a></span>
<span class="normal"><a href="#__codelineno-0-3515">3515</a></span>
<span class="normal"><a href="#__codelineno-0-3516">3516</a></span>
<span class="normal"><a href="#__codelineno-0-3517">3517</a></span>
<span class="normal"><a href="#__codelineno-0-3518">3518</a></span>
<span class="normal"><a href="#__codelineno-0-3519">3519</a></span>
<span class="normal"><a href="#__codelineno-0-3520">3520</a></span>
<span class="normal"><a href="#__codelineno-0-3521">3521</a></span>
<span class="normal"><a href="#__codelineno-0-3522">3522</a></span>
<span class="normal"><a href="#__codelineno-0-3523">3523</a></span>
<span class="normal"><a href="#__codelineno-0-3524">3524</a></span>
<span class="normal"><a href="#__codelineno-0-3525">3525</a></span>
<span class="normal"><a href="#__codelineno-0-3526">3526</a></span>
<span class="normal"><a href="#__codelineno-0-3527">3527</a></span>
<span class="normal"><a href="#__codelineno-0-3528">3528</a></span>
<span class="normal"><a href="#__codelineno-0-3529">3529</a></span>
<span class="normal"><a href="#__codelineno-0-3530">3530</a></span>
<span class="normal"><a href="#__codelineno-0-3531">3531</a></span>
<span class="normal"><a href="#__codelineno-0-3532">3532</a></span>
<span class="normal"><a href="#__codelineno-0-3533">3533</a></span>
<span class="normal"><a href="#__codelineno-0-3534">3534</a></span>
<span class="normal"><a href="#__codelineno-0-3535">3535</a></span>
<span class="normal"><a href="#__codelineno-0-3536">3536</a></span>
<span class="normal"><a href="#__codelineno-0-3537">3537</a></span>
<span class="normal"><a href="#__codelineno-0-3538">3538</a></span>
<span class="normal"><a href="#__codelineno-0-3539">3539</a></span>
<span class="normal"><a href="#__codelineno-0-3540">3540</a></span>
<span class="normal"><a href="#__codelineno-0-3541">3541</a></span>
<span class="normal"><a href="#__codelineno-0-3542">3542</a></span>
<span class="normal"><a href="#__codelineno-0-3543">3543</a></span>
<span class="normal"><a href="#__codelineno-0-3544">3544</a></span>
<span class="normal"><a href="#__codelineno-0-3545">3545</a></span>
<span class="normal"><a href="#__codelineno-0-3546">3546</a></span>
<span class="normal"><a href="#__codelineno-0-3547">3547</a></span>
<span class="normal"><a href="#__codelineno-0-3548">3548</a></span>
<span class="normal"><a href="#__codelineno-0-3549">3549</a></span>
<span class="normal"><a href="#__codelineno-0-3550">3550</a></span>
<span class="normal"><a href="#__codelineno-0-3551">3551</a></span>
<span class="normal"><a href="#__codelineno-0-3552">3552</a></span>
<span class="normal"><a href="#__codelineno-0-3553">3553</a></span>
<span class="normal"><a href="#__codelineno-0-3554">3554</a></span>
<span class="normal"><a href="#__codelineno-0-3555">3555</a></span>
<span class="normal"><a href="#__codelineno-0-3556">3556</a></span>
<span class="normal"><a href="#__codelineno-0-3557">3557</a></span>
<span class="normal"><a href="#__codelineno-0-3558">3558</a></span>
<span class="normal"><a href="#__codelineno-0-3559">3559</a></span>
<span class="normal"><a href="#__codelineno-0-3560">3560</a></span>
<span class="normal"><a href="#__codelineno-0-3561">3561</a></span>
<span class="normal"><a href="#__codelineno-0-3562">3562</a></span>
<span class="normal"><a href="#__codelineno-0-3563">3563</a></span>
<span class="normal"><a href="#__codelineno-0-3564">3564</a></span>
<span class="normal"><a href="#__codelineno-0-3565">3565</a></span>
<span class="normal"><a href="#__codelineno-0-3566">3566</a></span>
<span class="normal"><a href="#__codelineno-0-3567">3567</a></span>
<span class="normal"><a href="#__codelineno-0-3568">3568</a></span>
<span class="normal"><a href="#__codelineno-0-3569">3569</a></span>
<span class="normal"><a href="#__codelineno-0-3570">3570</a></span>
<span class="normal"><a href="#__codelineno-0-3571">3571</a></span>
<span class="normal"><a href="#__codelineno-0-3572">3572</a></span>
<span class="normal"><a href="#__codelineno-0-3573">3573</a></span>
<span class="normal"><a href="#__codelineno-0-3574">3574</a></span>
<span class="normal"><a href="#__codelineno-0-3575">3575</a></span>
<span class="normal"><a href="#__codelineno-0-3576">3576</a></span>
<span class="normal"><a href="#__codelineno-0-3577">3577</a></span>
<span class="normal"><a href="#__codelineno-0-3578">3578</a></span>
<span class="normal"><a href="#__codelineno-0-3579">3579</a></span>
<span class="normal"><a href="#__codelineno-0-3580">3580</a></span>
<span class="normal"><a href="#__codelineno-0-3581">3581</a></span>
<span class="normal"><a href="#__codelineno-0-3582">3582</a></span>
<span class="normal"><a href="#__codelineno-0-3583">3583</a></span>
<span class="normal"><a href="#__codelineno-0-3584">3584</a></span>
<span class="normal"><a href="#__codelineno-0-3585">3585</a></span>
<span class="normal"><a href="#__codelineno-0-3586">3586</a></span>
<span class="normal"><a href="#__codelineno-0-3587">3587</a></span>
<span class="normal"><a href="#__codelineno-0-3588">3588</a></span>
<span class="normal"><a href="#__codelineno-0-3589">3589</a></span>
<span class="normal"><a href="#__codelineno-0-3590">3590</a></span>
<span class="normal"><a href="#__codelineno-0-3591">3591</a></span>
<span class="normal"><a href="#__codelineno-0-3592">3592</a></span>
<span class="normal"><a href="#__codelineno-0-3593">3593</a></span>
<span class="normal"><a href="#__codelineno-0-3594">3594</a></span>
<span class="normal"><a href="#__codelineno-0-3595">3595</a></span>
<span class="normal"><a href="#__codelineno-0-3596">3596</a></span>
<span class="normal"><a href="#__codelineno-0-3597">3597</a></span>
<span class="normal"><a href="#__codelineno-0-3598">3598</a></span>
<span class="normal"><a href="#__codelineno-0-3599">3599</a></span>
<span class="normal"><a href="#__codelineno-0-3600">3600</a></span>
<span class="normal"><a href="#__codelineno-0-3601">3601</a></span>
<span class="normal"><a href="#__codelineno-0-3602">3602</a></span>
<span class="normal"><a href="#__codelineno-0-3603">3603</a></span>
<span class="normal"><a href="#__codelineno-0-3604">3604</a></span>
<span class="normal"><a href="#__codelineno-0-3605">3605</a></span>
<span class="normal"><a href="#__codelineno-0-3606">3606</a></span>
<span class="normal"><a href="#__codelineno-0-3607">3607</a></span>
<span class="normal"><a href="#__codelineno-0-3608">3608</a></span>
<span class="normal"><a href="#__codelineno-0-3609">3609</a></span>
<span class="normal"><a href="#__codelineno-0-3610">3610</a></span>
<span class="normal"><a href="#__codelineno-0-3611">3611</a></span>
<span class="normal"><a href="#__codelineno-0-3612">3612</a></span>
<span class="normal"><a href="#__codelineno-0-3613">3613</a></span>
<span class="normal"><a href="#__codelineno-0-3614">3614</a></span>
<span class="normal"><a href="#__codelineno-0-3615">3615</a></span>
<span class="normal"><a href="#__codelineno-0-3616">3616</a></span>
<span class="normal"><a href="#__codelineno-0-3617">3617</a></span>
<span class="normal"><a href="#__codelineno-0-3618">3618</a></span>
<span class="normal"><a href="#__codelineno-0-3619">3619</a></span>
<span class="normal"><a href="#__codelineno-0-3620">3620</a></span>
<span class="normal"><a href="#__codelineno-0-3621">3621</a></span>
<span class="normal"><a href="#__codelineno-0-3622">3622</a></span>
<span class="normal"><a href="#__codelineno-0-3623">3623</a></span>
<span class="normal"><a href="#__codelineno-0-3624">3624</a></span>
<span class="normal"><a href="#__codelineno-0-3625">3625</a></span>
<span class="normal"><a href="#__codelineno-0-3626">3626</a></span>
<span class="normal"><a href="#__codelineno-0-3627">3627</a></span>
<span class="normal"><a href="#__codelineno-0-3628">3628</a></span>
<span class="normal"><a href="#__codelineno-0-3629">3629</a></span>
<span class="normal"><a href="#__codelineno-0-3630">3630</a></span>
<span class="normal"><a href="#__codelineno-0-3631">3631</a></span>
<span class="normal"><a href="#__codelineno-0-3632">3632</a></span>
<span class="normal"><a href="#__codelineno-0-3633">3633</a></span>
<span class="normal"><a href="#__codelineno-0-3634">3634</a></span>
<span class="normal"><a href="#__codelineno-0-3635">3635</a></span>
<span class="normal"><a href="#__codelineno-0-3636">3636</a></span>
<span class="normal"><a href="#__codelineno-0-3637">3637</a></span>
<span class="normal"><a href="#__codelineno-0-3638">3638</a></span>
<span class="normal"><a href="#__codelineno-0-3639">3639</a></span>
<span class="normal"><a href="#__codelineno-0-3640">3640</a></span>
<span class="normal"><a href="#__codelineno-0-3641">3641</a></span>
<span class="normal"><a href="#__codelineno-0-3642">3642</a></span>
<span class="normal"><a href="#__codelineno-0-3643">3643</a></span>
<span class="normal"><a href="#__codelineno-0-3644">3644</a></span>
<span class="normal"><a href="#__codelineno-0-3645">3645</a></span>
<span class="normal"><a href="#__codelineno-0-3646">3646</a></span>
<span class="normal"><a href="#__codelineno-0-3647">3647</a></span>
<span class="normal"><a href="#__codelineno-0-3648">3648</a></span>
<span class="normal"><a href="#__codelineno-0-3649">3649</a></span>
<span class="normal"><a href="#__codelineno-0-3650">3650</a></span>
<span class="normal"><a href="#__codelineno-0-3651">3651</a></span>
<span class="normal"><a href="#__codelineno-0-3652">3652</a></span>
<span class="normal"><a href="#__codelineno-0-3653">3653</a></span>
<span class="normal"><a href="#__codelineno-0-3654">3654</a></span>
<span class="normal"><a href="#__codelineno-0-3655">3655</a></span>
<span class="normal"><a href="#__codelineno-0-3656">3656</a></span>
<span class="normal"><a href="#__codelineno-0-3657">3657</a></span>
<span class="normal"><a href="#__codelineno-0-3658">3658</a></span>
<span class="normal"><a href="#__codelineno-0-3659">3659</a></span>
<span class="normal"><a href="#__codelineno-0-3660">3660</a></span>
<span class="normal"><a href="#__codelineno-0-3661">3661</a></span>
<span class="normal"><a href="#__codelineno-0-3662">3662</a></span>
<span class="normal"><a href="#__codelineno-0-3663">3663</a></span>
<span class="normal"><a href="#__codelineno-0-3664">3664</a></span>
<span class="normal"><a href="#__codelineno-0-3665">3665</a></span>
<span class="normal"><a href="#__codelineno-0-3666">3666</a></span>
<span class="normal"><a href="#__codelineno-0-3667">3667</a></span>
<span class="normal"><a href="#__codelineno-0-3668">3668</a></span>
<span class="normal"><a href="#__codelineno-0-3669">3669</a></span>
<span class="normal"><a href="#__codelineno-0-3670">3670</a></span>
<span class="normal"><a href="#__codelineno-0-3671">3671</a></span>
<span class="normal"><a href="#__codelineno-0-3672">3672</a></span>
<span class="normal"><a href="#__codelineno-0-3673">3673</a></span>
<span class="normal"><a href="#__codelineno-0-3674">3674</a></span>
<span class="normal"><a href="#__codelineno-0-3675">3675</a></span>
<span class="normal"><a href="#__codelineno-0-3676">3676</a></span>
<span class="normal"><a href="#__codelineno-0-3677">3677</a></span>
<span class="normal"><a href="#__codelineno-0-3678">3678</a></span>
<span class="normal"><a href="#__codelineno-0-3679">3679</a></span>
<span class="normal"><a href="#__codelineno-0-3680">3680</a></span>
<span class="normal"><a href="#__codelineno-0-3681">3681</a></span>
<span class="normal"><a href="#__codelineno-0-3682">3682</a></span>
<span class="normal"><a href="#__codelineno-0-3683">3683</a></span>
<span class="normal"><a href="#__codelineno-0-3684">3684</a></span>
<span class="normal"><a href="#__codelineno-0-3685">3685</a></span>
<span class="normal"><a href="#__codelineno-0-3686">3686</a></span>
<span class="normal"><a href="#__codelineno-0-3687">3687</a></span>
<span class="normal"><a href="#__codelineno-0-3688">3688</a></span>
<span class="normal"><a href="#__codelineno-0-3689">3689</a></span>
<span class="normal"><a href="#__codelineno-0-3690">3690</a></span>
<span class="normal"><a href="#__codelineno-0-3691">3691</a></span>
<span class="normal"><a href="#__codelineno-0-3692">3692</a></span>
<span class="normal"><a href="#__codelineno-0-3693">3693</a></span>
<span class="normal"><a href="#__codelineno-0-3694">3694</a></span>
<span class="normal"><a href="#__codelineno-0-3695">3695</a></span>
<span class="normal"><a href="#__codelineno-0-3696">3696</a></span>
<span class="normal"><a href="#__codelineno-0-3697">3697</a></span>
<span class="normal"><a href="#__codelineno-0-3698">3698</a></span>
<span class="normal"><a href="#__codelineno-0-3699">3699</a></span>
<span class="normal"><a href="#__codelineno-0-3700">3700</a></span>
<span class="normal"><a href="#__codelineno-0-3701">3701</a></span>
<span class="normal"><a href="#__codelineno-0-3702">3702</a></span>
<span class="normal"><a href="#__codelineno-0-3703">3703</a></span>
<span class="normal"><a href="#__codelineno-0-3704">3704</a></span>
<span class="normal"><a href="#__codelineno-0-3705">3705</a></span>
<span class="normal"><a href="#__codelineno-0-3706">3706</a></span>
<span class="normal"><a href="#__codelineno-0-3707">3707</a></span>
<span class="normal"><a href="#__codelineno-0-3708">3708</a></span>
<span class="normal"><a href="#__codelineno-0-3709">3709</a></span>
<span class="normal"><a href="#__codelineno-0-3710">3710</a></span>
<span class="normal"><a href="#__codelineno-0-3711">3711</a></span>
<span class="normal"><a href="#__codelineno-0-3712">3712</a></span>
<span class="normal"><a href="#__codelineno-0-3713">3713</a></span>
<span class="normal"><a href="#__codelineno-0-3714">3714</a></span>
<span class="normal"><a href="#__codelineno-0-3715">3715</a></span>
<span class="normal"><a href="#__codelineno-0-3716">3716</a></span>
<span class="normal"><a href="#__codelineno-0-3717">3717</a></span>
<span class="normal"><a href="#__codelineno-0-3718">3718</a></span>
<span class="normal"><a href="#__codelineno-0-3719">3719</a></span>
<span class="normal"><a href="#__codelineno-0-3720">3720</a></span>
<span class="normal"><a href="#__codelineno-0-3721">3721</a></span>
<span class="normal"><a href="#__codelineno-0-3722">3722</a></span>
<span class="normal"><a href="#__codelineno-0-3723">3723</a></span>
<span class="normal"><a href="#__codelineno-0-3724">3724</a></span>
<span class="normal"><a href="#__codelineno-0-3725">3725</a></span>
<span class="normal"><a href="#__codelineno-0-3726">3726</a></span>
<span class="normal"><a href="#__codelineno-0-3727">3727</a></span>
<span class="normal"><a href="#__codelineno-0-3728">3728</a></span>
<span class="normal"><a href="#__codelineno-0-3729">3729</a></span>
<span class="normal"><a href="#__codelineno-0-3730">3730</a></span>
<span class="normal"><a href="#__codelineno-0-3731">3731</a></span>
<span class="normal"><a href="#__codelineno-0-3732">3732</a></span>
<span class="normal"><a href="#__codelineno-0-3733">3733</a></span>
<span class="normal"><a href="#__codelineno-0-3734">3734</a></span>
<span class="normal"><a href="#__codelineno-0-3735">3735</a></span>
<span class="normal"><a href="#__codelineno-0-3736">3736</a></span>
<span class="normal"><a href="#__codelineno-0-3737">3737</a></span>
<span class="normal"><a href="#__codelineno-0-3738">3738</a></span>
<span class="normal"><a href="#__codelineno-0-3739">3739</a></span>
<span class="normal"><a href="#__codelineno-0-3740">3740</a></span>
<span class="normal"><a href="#__codelineno-0-3741">3741</a></span>
<span class="normal"><a href="#__codelineno-0-3742">3742</a></span>
<span class="normal"><a href="#__codelineno-0-3743">3743</a></span>
<span class="normal"><a href="#__codelineno-0-3744">3744</a></span>
<span class="normal"><a href="#__codelineno-0-3745">3745</a></span>
<span class="normal"><a href="#__codelineno-0-3746">3746</a></span>
<span class="normal"><a href="#__codelineno-0-3747">3747</a></span>
<span class="normal"><a href="#__codelineno-0-3748">3748</a></span>
<span class="normal"><a href="#__codelineno-0-3749">3749</a></span>
<span class="normal"><a href="#__codelineno-0-3750">3750</a></span>
<span class="normal"><a href="#__codelineno-0-3751">3751</a></span>
<span class="normal"><a href="#__codelineno-0-3752">3752</a></span>
<span class="normal"><a href="#__codelineno-0-3753">3753</a></span>
<span class="normal"><a href="#__codelineno-0-3754">3754</a></span>
<span class="normal"><a href="#__codelineno-0-3755">3755</a></span>
<span class="normal"><a href="#__codelineno-0-3756">3756</a></span>
<span class="normal"><a href="#__codelineno-0-3757">3757</a></span>
<span class="normal"><a href="#__codelineno-0-3758">3758</a></span>
<span class="normal"><a href="#__codelineno-0-3759">3759</a></span>
<span class="normal"><a href="#__codelineno-0-3760">3760</a></span>
<span class="normal"><a href="#__codelineno-0-3761">3761</a></span>
<span class="normal"><a href="#__codelineno-0-3762">3762</a></span>
<span class="normal"><a href="#__codelineno-0-3763">3763</a></span>
<span class="normal"><a href="#__codelineno-0-3764">3764</a></span>
<span class="normal"><a href="#__codelineno-0-3765">3765</a></span>
<span class="normal"><a href="#__codelineno-0-3766">3766</a></span>
<span class="normal"><a href="#__codelineno-0-3767">3767</a></span>
<span class="normal"><a href="#__codelineno-0-3768">3768</a></span>
<span class="normal"><a href="#__codelineno-0-3769">3769</a></span>
<span class="normal"><a href="#__codelineno-0-3770">3770</a></span>
<span class="normal"><a href="#__codelineno-0-3771">3771</a></span>
<span class="normal"><a href="#__codelineno-0-3772">3772</a></span>
<span class="normal"><a href="#__codelineno-0-3773">3773</a></span>
<span class="normal"><a href="#__codelineno-0-3774">3774</a></span>
<span class="normal"><a href="#__codelineno-0-3775">3775</a></span>
<span class="normal"><a href="#__codelineno-0-3776">3776</a></span>
<span class="normal"><a href="#__codelineno-0-3777">3777</a></span>
<span class="normal"><a href="#__codelineno-0-3778">3778</a></span>
<span class="normal"><a href="#__codelineno-0-3779">3779</a></span>
<span class="normal"><a href="#__codelineno-0-3780">3780</a></span>
<span class="normal"><a href="#__codelineno-0-3781">3781</a></span>
<span class="normal"><a href="#__codelineno-0-3782">3782</a></span>
<span class="normal"><a href="#__codelineno-0-3783">3783</a></span>
<span class="normal"><a href="#__codelineno-0-3784">3784</a></span>
<span class="normal"><a href="#__codelineno-0-3785">3785</a></span>
<span class="normal"><a href="#__codelineno-0-3786">3786</a></span>
<span class="normal"><a href="#__codelineno-0-3787">3787</a></span>
<span class="normal"><a href="#__codelineno-0-3788">3788</a></span>
<span class="normal"><a href="#__codelineno-0-3789">3789</a></span>
<span class="normal"><a href="#__codelineno-0-3790">3790</a></span>
<span class="normal"><a href="#__codelineno-0-3791">3791</a></span>
<span class="normal"><a href="#__codelineno-0-3792">3792</a></span>
<span class="normal"><a href="#__codelineno-0-3793">3793</a></span>
<span class="normal"><a href="#__codelineno-0-3794">3794</a></span>
<span class="normal"><a href="#__codelineno-0-3795">3795</a></span>
<span class="normal"><a href="#__codelineno-0-3796">3796</a></span>
<span class="normal"><a href="#__codelineno-0-3797">3797</a></span>
<span class="normal"><a href="#__codelineno-0-3798">3798</a></span>
<span class="normal"><a href="#__codelineno-0-3799">3799</a></span>
<span class="normal"><a href="#__codelineno-0-3800">3800</a></span>
<span class="normal"><a href="#__codelineno-0-3801">3801</a></span>
<span class="normal"><a href="#__codelineno-0-3802">3802</a></span>
<span class="normal"><a href="#__codelineno-0-3803">3803</a></span>
<span class="normal"><a href="#__codelineno-0-3804">3804</a></span>
<span class="normal"><a href="#__codelineno-0-3805">3805</a></span>
<span class="normal"><a href="#__codelineno-0-3806">3806</a></span>
<span class="normal"><a href="#__codelineno-0-3807">3807</a></span>
<span class="normal"><a href="#__codelineno-0-3808">3808</a></span>
<span class="normal"><a href="#__codelineno-0-3809">3809</a></span>
<span class="normal"><a href="#__codelineno-0-3810">3810</a></span>
<span class="normal"><a href="#__codelineno-0-3811">3811</a></span>
<span class="normal"><a href="#__codelineno-0-3812">3812</a></span>
<span class="normal"><a href="#__codelineno-0-3813">3813</a></span>
<span class="normal"><a href="#__codelineno-0-3814">3814</a></span>
<span class="normal"><a href="#__codelineno-0-3815">3815</a></span>
<span class="normal"><a href="#__codelineno-0-3816">3816</a></span>
<span class="normal"><a href="#__codelineno-0-3817">3817</a></span>
<span class="normal"><a href="#__codelineno-0-3818">3818</a></span>
<span class="normal"><a href="#__codelineno-0-3819">3819</a></span>
<span class="normal"><a href="#__codelineno-0-3820">3820</a></span>
<span class="normal"><a href="#__codelineno-0-3821">3821</a></span>
<span class="normal"><a href="#__codelineno-0-3822">3822</a></span>
<span class="normal"><a href="#__codelineno-0-3823">3823</a></span>
<span class="normal"><a href="#__codelineno-0-3824">3824</a></span>
<span class="normal"><a href="#__codelineno-0-3825">3825</a></span>
<span class="normal"><a href="#__codelineno-0-3826">3826</a></span>
<span class="normal"><a href="#__codelineno-0-3827">3827</a></span>
<span class="normal"><a href="#__codelineno-0-3828">3828</a></span>
<span class="normal"><a href="#__codelineno-0-3829">3829</a></span>
<span class="normal"><a href="#__codelineno-0-3830">3830</a></span>
<span class="normal"><a href="#__codelineno-0-3831">3831</a></span>
<span class="normal"><a href="#__codelineno-0-3832">3832</a></span>
<span class="normal"><a href="#__codelineno-0-3833">3833</a></span>
<span class="normal"><a href="#__codelineno-0-3834">3834</a></span>
<span class="normal"><a href="#__codelineno-0-3835">3835</a></span>
<span class="normal"><a href="#__codelineno-0-3836">3836</a></span>
<span class="normal"><a href="#__codelineno-0-3837">3837</a></span>
<span class="normal"><a href="#__codelineno-0-3838">3838</a></span>
<span class="normal"><a href="#__codelineno-0-3839">3839</a></span>
<span class="normal"><a href="#__codelineno-0-3840">3840</a></span>
<span class="normal"><a href="#__codelineno-0-3841">3841</a></span>
<span class="normal"><a href="#__codelineno-0-3842">3842</a></span>
<span class="normal"><a href="#__codelineno-0-3843">3843</a></span>
<span class="normal"><a href="#__codelineno-0-3844">3844</a></span>
<span class="normal"><a href="#__codelineno-0-3845">3845</a></span>
<span class="normal"><a href="#__codelineno-0-3846">3846</a></span>
<span class="normal"><a href="#__codelineno-0-3847">3847</a></span>
<span class="normal"><a href="#__codelineno-0-3848">3848</a></span>
<span class="normal"><a href="#__codelineno-0-3849">3849</a></span>
<span class="normal"><a href="#__codelineno-0-3850">3850</a></span>
<span class="normal"><a href="#__codelineno-0-3851">3851</a></span>
<span class="normal"><a href="#__codelineno-0-3852">3852</a></span>
<span class="normal"><a href="#__codelineno-0-3853">3853</a></span>
<span class="normal"><a href="#__codelineno-0-3854">3854</a></span>
<span class="normal"><a href="#__codelineno-0-3855">3855</a></span>
<span class="normal"><a href="#__codelineno-0-3856">3856</a></span>
<span class="normal"><a href="#__codelineno-0-3857">3857</a></span>
<span class="normal"><a href="#__codelineno-0-3858">3858</a></span>
<span class="normal"><a href="#__codelineno-0-3859">3859</a></span>
<span class="normal"><a href="#__codelineno-0-3860">3860</a></span>
<span class="normal"><a href="#__codelineno-0-3861">3861</a></span>
<span class="normal"><a href="#__codelineno-0-3862">3862</a></span>
<span class="normal"><a href="#__codelineno-0-3863">3863</a></span>
<span class="normal"><a href="#__codelineno-0-3864">3864</a></span>
<span class="normal"><a href="#__codelineno-0-3865">3865</a></span>
<span class="normal"><a href="#__codelineno-0-3866">3866</a></span>
<span class="normal"><a href="#__codelineno-0-3867">3867</a></span>
<span class="normal"><a href="#__codelineno-0-3868">3868</a></span>
<span class="normal"><a href="#__codelineno-0-3869">3869</a></span>
<span class="normal"><a href="#__codelineno-0-3870">3870</a></span>
<span class="normal"><a href="#__codelineno-0-3871">3871</a></span>
<span class="normal"><a href="#__codelineno-0-3872">3872</a></span>
<span class="normal"><a href="#__codelineno-0-3873">3873</a></span>
<span class="normal"><a href="#__codelineno-0-3874">3874</a></span>
<span class="normal"><a href="#__codelineno-0-3875">3875</a></span>
<span class="normal"><a href="#__codelineno-0-3876">3876</a></span>
<span class="normal"><a href="#__codelineno-0-3877">3877</a></span>
<span class="normal"><a href="#__codelineno-0-3878">3878</a></span>
<span class="normal"><a href="#__codelineno-0-3879">3879</a></span>
<span class="normal"><a href="#__codelineno-0-3880">3880</a></span>
<span class="normal"><a href="#__codelineno-0-3881">3881</a></span>
<span class="normal"><a href="#__codelineno-0-3882">3882</a></span>
<span class="normal"><a href="#__codelineno-0-3883">3883</a></span>
<span class="normal"><a href="#__codelineno-0-3884">3884</a></span>
<span class="normal"><a href="#__codelineno-0-3885">3885</a></span>
<span class="normal"><a href="#__codelineno-0-3886">3886</a></span>
<span class="normal"><a href="#__codelineno-0-3887">3887</a></span>
<span class="normal"><a href="#__codelineno-0-3888">3888</a></span>
<span class="normal"><a href="#__codelineno-0-3889">3889</a></span>
<span class="normal"><a href="#__codelineno-0-3890">3890</a></span>
<span class="normal"><a href="#__codelineno-0-3891">3891</a></span>
<span class="normal"><a href="#__codelineno-0-3892">3892</a></span>
<span class="normal"><a href="#__codelineno-0-3893">3893</a></span>
<span class="normal"><a href="#__codelineno-0-3894">3894</a></span>
<span class="normal"><a href="#__codelineno-0-3895">3895</a></span>
<span class="normal"><a href="#__codelineno-0-3896">3896</a></span>
<span class="normal"><a href="#__codelineno-0-3897">3897</a></span>
<span class="normal"><a href="#__codelineno-0-3898">3898</a></span>
<span class="normal"><a href="#__codelineno-0-3899">3899</a></span>
<span class="normal"><a href="#__codelineno-0-3900">3900</a></span>
<span class="normal"><a href="#__codelineno-0-3901">3901</a></span>
<span class="normal"><a href="#__codelineno-0-3902">3902</a></span>
<span class="normal"><a href="#__codelineno-0-3903">3903</a></span>
<span class="normal"><a href="#__codelineno-0-3904">3904</a></span>
<span class="normal"><a href="#__codelineno-0-3905">3905</a></span>
<span class="normal"><a href="#__codelineno-0-3906">3906</a></span>
<span class="normal"><a href="#__codelineno-0-3907">3907</a></span>
<span class="normal"><a href="#__codelineno-0-3908">3908</a></span>
<span class="normal"><a href="#__codelineno-0-3909">3909</a></span>
<span class="normal"><a href="#__codelineno-0-3910">3910</a></span>
<span class="normal"><a href="#__codelineno-0-3911">3911</a></span>
<span class="normal"><a href="#__codelineno-0-3912">3912</a></span>
<span class="normal"><a href="#__codelineno-0-3913">3913</a></span>
<span class="normal"><a href="#__codelineno-0-3914">3914</a></span>
<span class="normal"><a href="#__codelineno-0-3915">3915</a></span>
<span class="normal"><a href="#__codelineno-0-3916">3916</a></span>
<span class="normal"><a href="#__codelineno-0-3917">3917</a></span>
<span class="normal"><a href="#__codelineno-0-3918">3918</a></span>
<span class="normal"><a href="#__codelineno-0-3919">3919</a></span>
<span class="normal"><a href="#__codelineno-0-3920">3920</a></span>
<span class="normal"><a href="#__codelineno-0-3921">3921</a></span>
<span class="normal"><a href="#__codelineno-0-3922">3922</a></span>
<span class="normal"><a href="#__codelineno-0-3923">3923</a></span>
<span class="normal"><a href="#__codelineno-0-3924">3924</a></span>
<span class="normal"><a href="#__codelineno-0-3925">3925</a></span>
<span class="normal"><a href="#__codelineno-0-3926">3926</a></span>
<span class="normal"><a href="#__codelineno-0-3927">3927</a></span>
<span class="normal"><a href="#__codelineno-0-3928">3928</a></span>
<span class="normal"><a href="#__codelineno-0-3929">3929</a></span>
<span class="normal"><a href="#__codelineno-0-3930">3930</a></span>
<span class="normal"><a href="#__codelineno-0-3931">3931</a></span>
<span class="normal"><a href="#__codelineno-0-3932">3932</a></span>
<span class="normal"><a href="#__codelineno-0-3933">3933</a></span>
<span class="normal"><a href="#__codelineno-0-3934">3934</a></span>
<span class="normal"><a href="#__codelineno-0-3935">3935</a></span>
<span class="normal"><a href="#__codelineno-0-3936">3936</a></span>
<span class="normal"><a href="#__codelineno-0-3937">3937</a></span>
<span class="normal"><a href="#__codelineno-0-3938">3938</a></span>
<span class="normal"><a href="#__codelineno-0-3939">3939</a></span>
<span class="normal"><a href="#__codelineno-0-3940">3940</a></span>
<span class="normal"><a href="#__codelineno-0-3941">3941</a></span>
<span class="normal"><a href="#__codelineno-0-3942">3942</a></span>
<span class="normal"><a href="#__codelineno-0-3943">3943</a></span>
<span class="normal"><a href="#__codelineno-0-3944">3944</a></span>
<span class="normal"><a href="#__codelineno-0-3945">3945</a></span>
<span class="normal"><a href="#__codelineno-0-3946">3946</a></span>
<span class="normal"><a href="#__codelineno-0-3947">3947</a></span>
<span class="normal"><a href="#__codelineno-0-3948">3948</a></span>
<span class="normal"><a href="#__codelineno-0-3949">3949</a></span>
<span class="normal"><a href="#__codelineno-0-3950">3950</a></span>
<span class="normal"><a href="#__codelineno-0-3951">3951</a></span>
<span class="normal"><a href="#__codelineno-0-3952">3952</a></span>
<span class="normal"><a href="#__codelineno-0-3953">3953</a></span>
<span class="normal"><a href="#__codelineno-0-3954">3954</a></span>
<span class="normal"><a href="#__codelineno-0-3955">3955</a></span>
<span class="normal"><a href="#__codelineno-0-3956">3956</a></span>
<span class="normal"><a href="#__codelineno-0-3957">3957</a></span>
<span class="normal"><a href="#__codelineno-0-3958">3958</a></span>
<span class="normal"><a href="#__codelineno-0-3959">3959</a></span>
<span class="normal"><a href="#__codelineno-0-3960">3960</a></span>
<span class="normal"><a href="#__codelineno-0-3961">3961</a></span>
<span class="normal"><a href="#__codelineno-0-3962">3962</a></span>
<span class="normal"><a href="#__codelineno-0-3963">3963</a></span>
<span class="normal"><a href="#__codelineno-0-3964">3964</a></span>
<span class="normal"><a href="#__codelineno-0-3965">3965</a></span>
<span class="normal"><a href="#__codelineno-0-3966">3966</a></span>
<span class="normal"><a href="#__codelineno-0-3967">3967</a></span>
<span class="normal"><a href="#__codelineno-0-3968">3968</a></span>
<span class="normal"><a href="#__codelineno-0-3969">3969</a></span>
<span class="normal"><a href="#__codelineno-0-3970">3970</a></span>
<span class="normal"><a href="#__codelineno-0-3971">3971</a></span>
<span class="normal"><a href="#__codelineno-0-3972">3972</a></span>
<span class="normal"><a href="#__codelineno-0-3973">3973</a></span>
<span class="normal"><a href="#__codelineno-0-3974">3974</a></span>
<span class="normal"><a href="#__codelineno-0-3975">3975</a></span>
<span class="normal"><a href="#__codelineno-0-3976">3976</a></span>
<span class="normal"><a href="#__codelineno-0-3977">3977</a></span>
<span class="normal"><a href="#__codelineno-0-3978">3978</a></span>
<span class="normal"><a href="#__codelineno-0-3979">3979</a></span>
<span class="normal"><a href="#__codelineno-0-3980">3980</a></span>
<span class="normal"><a href="#__codelineno-0-3981">3981</a></span>
<span class="normal"><a href="#__codelineno-0-3982">3982</a></span>
<span class="normal"><a href="#__codelineno-0-3983">3983</a></span>
<span class="normal"><a href="#__codelineno-0-3984">3984</a></span>
<span class="normal"><a href="#__codelineno-0-3985">3985</a></span>
<span class="normal"><a href="#__codelineno-0-3986">3986</a></span>
<span class="normal"><a href="#__codelineno-0-3987">3987</a></span>
<span class="normal"><a href="#__codelineno-0-3988">3988</a></span>
<span class="normal"><a href="#__codelineno-0-3989">3989</a></span>
<span class="normal"><a href="#__codelineno-0-3990">3990</a></span>
<span class="normal"><a href="#__codelineno-0-3991">3991</a></span>
<span class="normal"><a href="#__codelineno-0-3992">3992</a></span>
<span class="normal"><a href="#__codelineno-0-3993">3993</a></span>
<span class="normal"><a href="#__codelineno-0-3994">3994</a></span>
<span class="normal"><a href="#__codelineno-0-3995">3995</a></span>
<span class="normal"><a href="#__codelineno-0-3996">3996</a></span>
<span class="normal"><a href="#__codelineno-0-3997">3997</a></span>
<span class="normal"><a href="#__codelineno-0-3998">3998</a></span>
<span class="normal"><a href="#__codelineno-0-3999">3999</a></span>
<span class="normal"><a href="#__codelineno-0-4000">4000</a></span>
<span class="normal"><a href="#__codelineno-0-4001">4001</a></span>
<span class="normal"><a href="#__codelineno-0-4002">4002</a></span>
<span class="normal"><a href="#__codelineno-0-4003">4003</a></span>
<span class="normal"><a href="#__codelineno-0-4004">4004</a></span>
<span class="normal"><a href="#__codelineno-0-4005">4005</a></span>
<span class="normal"><a href="#__codelineno-0-4006">4006</a></span>
<span class="normal"><a href="#__codelineno-0-4007">4007</a></span>
<span class="normal"><a href="#__codelineno-0-4008">4008</a></span>
<span class="normal"><a href="#__codelineno-0-4009">4009</a></span>
<span class="normal"><a href="#__codelineno-0-4010">4010</a></span>
<span class="normal"><a href="#__codelineno-0-4011">4011</a></span>
<span class="normal"><a href="#__codelineno-0-4012">4012</a></span>
<span class="normal"><a href="#__codelineno-0-4013">4013</a></span>
<span class="normal"><a href="#__codelineno-0-4014">4014</a></span>
<span class="normal"><a href="#__codelineno-0-4015">4015</a></span>
<span class="normal"><a href="#__codelineno-0-4016">4016</a></span>
<span class="normal"><a href="#__codelineno-0-4017">4017</a></span>
<span class="normal"><a href="#__codelineno-0-4018">4018</a></span>
<span class="normal"><a href="#__codelineno-0-4019">4019</a></span>
<span class="normal"><a href="#__codelineno-0-4020">4020</a></span>
<span class="normal"><a href="#__codelineno-0-4021">4021</a></span>
<span class="normal"><a href="#__codelineno-0-4022">4022</a></span>
<span class="normal"><a href="#__codelineno-0-4023">4023</a></span>
<span class="normal"><a href="#__codelineno-0-4024">4024</a></span>
<span class="normal"><a href="#__codelineno-0-4025">4025</a></span>
<span class="normal"><a href="#__codelineno-0-4026">4026</a></span>
<span class="normal"><a href="#__codelineno-0-4027">4027</a></span>
<span class="normal"><a href="#__codelineno-0-4028">4028</a></span>
<span class="normal"><a href="#__codelineno-0-4029">4029</a></span>
<span class="normal"><a href="#__codelineno-0-4030">4030</a></span>
<span class="normal"><a href="#__codelineno-0-4031">4031</a></span>
<span class="normal"><a href="#__codelineno-0-4032">4032</a></span>
<span class="normal"><a href="#__codelineno-0-4033">4033</a></span>
<span class="normal"><a href="#__codelineno-0-4034">4034</a></span>
<span class="normal"><a href="#__codelineno-0-4035">4035</a></span>
<span class="normal"><a href="#__codelineno-0-4036">4036</a></span>
<span class="normal"><a href="#__codelineno-0-4037">4037</a></span>
<span class="normal"><a href="#__codelineno-0-4038">4038</a></span>
<span class="normal"><a href="#__codelineno-0-4039">4039</a></span>
<span class="normal"><a href="#__codelineno-0-4040">4040</a></span>
<span class="normal"><a href="#__codelineno-0-4041">4041</a></span>
<span class="normal"><a href="#__codelineno-0-4042">4042</a></span>
<span class="normal"><a href="#__codelineno-0-4043">4043</a></span>
<span class="normal"><a href="#__codelineno-0-4044">4044</a></span>
<span class="normal"><a href="#__codelineno-0-4045">4045</a></span>
<span class="normal"><a href="#__codelineno-0-4046">4046</a></span>
<span class="normal"><a href="#__codelineno-0-4047">4047</a></span>
<span class="normal"><a href="#__codelineno-0-4048">4048</a></span>
<span class="normal"><a href="#__codelineno-0-4049">4049</a></span>
<span class="normal"><a href="#__codelineno-0-4050">4050</a></span>
<span class="normal"><a href="#__codelineno-0-4051">4051</a></span>
<span class="normal"><a href="#__codelineno-0-4052">4052</a></span>
<span class="normal"><a href="#__codelineno-0-4053">4053</a></span>
<span class="normal"><a href="#__codelineno-0-4054">4054</a></span>
<span class="normal"><a href="#__codelineno-0-4055">4055</a></span>
<span class="normal"><a href="#__codelineno-0-4056">4056</a></span>
<span class="normal"><a href="#__codelineno-0-4057">4057</a></span>
<span class="normal"><a href="#__codelineno-0-4058">4058</a></span>
<span class="normal"><a href="#__codelineno-0-4059">4059</a></span>
<span class="normal"><a href="#__codelineno-0-4060">4060</a></span>
<span class="normal"><a href="#__codelineno-0-4061">4061</a></span>
<span class="normal"><a href="#__codelineno-0-4062">4062</a></span>
<span class="normal"><a href="#__codelineno-0-4063">4063</a></span>
<span class="normal"><a href="#__codelineno-0-4064">4064</a></span>
<span class="normal"><a href="#__codelineno-0-4065">4065</a></span>
<span class="normal"><a href="#__codelineno-0-4066">4066</a></span>
<span class="normal"><a href="#__codelineno-0-4067">4067</a></span>
<span class="normal"><a href="#__codelineno-0-4068">4068</a></span>
<span class="normal"><a href="#__codelineno-0-4069">4069</a></span>
<span class="normal"><a href="#__codelineno-0-4070">4070</a></span>
<span class="normal"><a href="#__codelineno-0-4071">4071</a></span>
<span class="normal"><a href="#__codelineno-0-4072">4072</a></span>
<span class="normal"><a href="#__codelineno-0-4073">4073</a></span>
<span class="normal"><a href="#__codelineno-0-4074">4074</a></span>
<span class="normal"><a href="#__codelineno-0-4075">4075</a></span>
<span class="normal"><a href="#__codelineno-0-4076">4076</a></span>
<span class="normal"><a href="#__codelineno-0-4077">4077</a></span>
<span class="normal"><a href="#__codelineno-0-4078">4078</a></span>
<span class="normal"><a href="#__codelineno-0-4079">4079</a></span>
<span class="normal"><a href="#__codelineno-0-4080">4080</a></span>
<span class="normal"><a href="#__codelineno-0-4081">4081</a></span>
<span class="normal"><a href="#__codelineno-0-4082">4082</a></span>
<span class="normal"><a href="#__codelineno-0-4083">4083</a></span>
<span class="normal"><a href="#__codelineno-0-4084">4084</a></span>
<span class="normal"><a href="#__codelineno-0-4085">4085</a></span>
<span class="normal"><a href="#__codelineno-0-4086">4086</a></span>
<span class="normal"><a href="#__codelineno-0-4087">4087</a></span>
<span class="normal"><a href="#__codelineno-0-4088">4088</a></span>
<span class="normal"><a href="#__codelineno-0-4089">4089</a></span>
<span class="normal"><a href="#__codelineno-0-4090">4090</a></span>
<span class="normal"><a href="#__codelineno-0-4091">4091</a></span>
<span class="normal"><a href="#__codelineno-0-4092">4092</a></span>
<span class="normal"><a href="#__codelineno-0-4093">4093</a></span>
<span class="normal"><a href="#__codelineno-0-4094">4094</a></span>
<span class="normal"><a href="#__codelineno-0-4095">4095</a></span>
<span class="normal"><a href="#__codelineno-0-4096">4096</a></span>
<span class="normal"><a href="#__codelineno-0-4097">4097</a></span>
<span class="normal"><a href="#__codelineno-0-4098">4098</a></span>
<span class="normal"><a href="#__codelineno-0-4099">4099</a></span>
<span class="normal"><a href="#__codelineno-0-4100">4100</a></span>
<span class="normal"><a href="#__codelineno-0-4101">4101</a></span>
<span class="normal"><a href="#__codelineno-0-4102">4102</a></span>
<span class="normal"><a href="#__codelineno-0-4103">4103</a></span>
<span class="normal"><a href="#__codelineno-0-4104">4104</a></span>
<span class="normal"><a href="#__codelineno-0-4105">4105</a></span>
<span class="normal"><a href="#__codelineno-0-4106">4106</a></span>
<span class="normal"><a href="#__codelineno-0-4107">4107</a></span>
<span class="normal"><a href="#__codelineno-0-4108">4108</a></span>
<span class="normal"><a href="#__codelineno-0-4109">4109</a></span>
<span class="normal"><a href="#__codelineno-0-4110">4110</a></span>
<span class="normal"><a href="#__codelineno-0-4111">4111</a></span>
<span class="normal"><a href="#__codelineno-0-4112">4112</a></span>
<span class="normal"><a href="#__codelineno-0-4113">4113</a></span>
<span class="normal"><a href="#__codelineno-0-4114">4114</a></span>
<span class="normal"><a href="#__codelineno-0-4115">4115</a></span>
<span class="normal"><a href="#__codelineno-0-4116">4116</a></span>
<span class="normal"><a href="#__codelineno-0-4117">4117</a></span>
<span class="normal"><a href="#__codelineno-0-4118">4118</a></span>
<span class="normal"><a href="#__codelineno-0-4119">4119</a></span>
<span class="normal"><a href="#__codelineno-0-4120">4120</a></span>
<span class="normal"><a href="#__codelineno-0-4121">4121</a></span>
<span class="normal"><a href="#__codelineno-0-4122">4122</a></span>
<span class="normal"><a href="#__codelineno-0-4123">4123</a></span>
<span class="normal"><a href="#__codelineno-0-4124">4124</a></span>
<span class="normal"><a href="#__codelineno-0-4125">4125</a></span>
<span class="normal"><a href="#__codelineno-0-4126">4126</a></span>
<span class="normal"><a href="#__codelineno-0-4127">4127</a></span>
<span class="normal"><a href="#__codelineno-0-4128">4128</a></span>
<span class="normal"><a href="#__codelineno-0-4129">4129</a></span>
<span class="normal"><a href="#__codelineno-0-4130">4130</a></span>
<span class="normal"><a href="#__codelineno-0-4131">4131</a></span>
<span class="normal"><a href="#__codelineno-0-4132">4132</a></span>
<span class="normal"><a href="#__codelineno-0-4133">4133</a></span>
<span class="normal"><a href="#__codelineno-0-4134">4134</a></span>
<span class="normal"><a href="#__codelineno-0-4135">4135</a></span>
<span class="normal"><a href="#__codelineno-0-4136">4136</a></span>
<span class="normal"><a href="#__codelineno-0-4137">4137</a></span>
<span class="normal"><a href="#__codelineno-0-4138">4138</a></span>
<span class="normal"><a href="#__codelineno-0-4139">4139</a></span>
<span class="normal"><a href="#__codelineno-0-4140">4140</a></span>
<span class="normal"><a href="#__codelineno-0-4141">4141</a></span>
<span class="normal"><a href="#__codelineno-0-4142">4142</a></span>
<span class="normal"><a href="#__codelineno-0-4143">4143</a></span>
<span class="normal"><a href="#__codelineno-0-4144">4144</a></span>
<span class="normal"><a href="#__codelineno-0-4145">4145</a></span>
<span class="normal"><a href="#__codelineno-0-4146">4146</a></span>
<span class="normal"><a href="#__codelineno-0-4147">4147</a></span>
<span class="normal"><a href="#__codelineno-0-4148">4148</a></span>
<span class="normal"><a href="#__codelineno-0-4149">4149</a></span>
<span class="normal"><a href="#__codelineno-0-4150">4150</a></span>
<span class="normal"><a href="#__codelineno-0-4151">4151</a></span>
<span class="normal"><a href="#__codelineno-0-4152">4152</a></span>
<span class="normal"><a href="#__codelineno-0-4153">4153</a></span>
<span class="normal"><a href="#__codelineno-0-4154">4154</a></span>
<span class="normal"><a href="#__codelineno-0-4155">4155</a></span>
<span class="normal"><a href="#__codelineno-0-4156">4156</a></span>
<span class="normal"><a href="#__codelineno-0-4157">4157</a></span>
<span class="normal"><a href="#__codelineno-0-4158">4158</a></span>
<span class="normal"><a href="#__codelineno-0-4159">4159</a></span>
<span class="normal"><a href="#__codelineno-0-4160">4160</a></span>
<span class="normal"><a href="#__codelineno-0-4161">4161</a></span>
<span class="normal"><a href="#__codelineno-0-4162">4162</a></span>
<span class="normal"><a href="#__codelineno-0-4163">4163</a></span>
<span class="normal"><a href="#__codelineno-0-4164">4164</a></span>
<span class="normal"><a href="#__codelineno-0-4165">4165</a></span>
<span class="normal"><a href="#__codelineno-0-4166">4166</a></span>
<span class="normal"><a href="#__codelineno-0-4167">4167</a></span>
<span class="normal"><a href="#__codelineno-0-4168">4168</a></span>
<span class="normal"><a href="#__codelineno-0-4169">4169</a></span>
<span class="normal"><a href="#__codelineno-0-4170">4170</a></span>
<span class="normal"><a href="#__codelineno-0-4171">4171</a></span>
<span class="normal"><a href="#__codelineno-0-4172">4172</a></span>
<span class="normal"><a href="#__codelineno-0-4173">4173</a></span>
<span class="normal"><a href="#__codelineno-0-4174">4174</a></span>
<span class="normal"><a href="#__codelineno-0-4175">4175</a></span>
<span class="normal"><a href="#__codelineno-0-4176">4176</a></span>
<span class="normal"><a href="#__codelineno-0-4177">4177</a></span>
<span class="normal"><a href="#__codelineno-0-4178">4178</a></span>
<span class="normal"><a href="#__codelineno-0-4179">4179</a></span>
<span class="normal"><a href="#__codelineno-0-4180">4180</a></span>
<span class="normal"><a href="#__codelineno-0-4181">4181</a></span>
<span class="normal"><a href="#__codelineno-0-4182">4182</a></span>
<span class="normal"><a href="#__codelineno-0-4183">4183</a></span>
<span class="normal"><a href="#__codelineno-0-4184">4184</a></span>
<span class="normal"><a href="#__codelineno-0-4185">4185</a></span>
<span class="normal"><a href="#__codelineno-0-4186">4186</a></span>
<span class="normal"><a href="#__codelineno-0-4187">4187</a></span>
<span class="normal"><a href="#__codelineno-0-4188">4188</a></span>
<span class="normal"><a href="#__codelineno-0-4189">4189</a></span>
<span class="normal"><a href="#__codelineno-0-4190">4190</a></span>
<span class="normal"><a href="#__codelineno-0-4191">4191</a></span>
<span class="normal"><a href="#__codelineno-0-4192">4192</a></span>
<span class="normal"><a href="#__codelineno-0-4193">4193</a></span>
<span class="normal"><a href="#__codelineno-0-4194">4194</a></span>
<span class="normal"><a href="#__codelineno-0-4195">4195</a></span>
<span class="normal"><a href="#__codelineno-0-4196">4196</a></span>
<span class="normal"><a href="#__codelineno-0-4197">4197</a></span>
<span class="normal"><a href="#__codelineno-0-4198">4198</a></span>
<span class="normal"><a href="#__codelineno-0-4199">4199</a></span>
<span class="normal"><a href="#__codelineno-0-4200">4200</a></span>
<span class="normal"><a href="#__codelineno-0-4201">4201</a></span>
<span class="normal"><a href="#__codelineno-0-4202">4202</a></span>
<span class="normal"><a href="#__codelineno-0-4203">4203</a></span>
<span class="normal"><a href="#__codelineno-0-4204">4204</a></span>
<span class="normal"><a href="#__codelineno-0-4205">4205</a></span>
<span class="normal"><a href="#__codelineno-0-4206">4206</a></span>
<span class="normal"><a href="#__codelineno-0-4207">4207</a></span>
<span class="normal"><a href="#__codelineno-0-4208">4208</a></span>
<span class="normal"><a href="#__codelineno-0-4209">4209</a></span>
<span class="normal"><a href="#__codelineno-0-4210">4210</a></span>
<span class="normal"><a href="#__codelineno-0-4211">4211</a></span>
<span class="normal"><a href="#__codelineno-0-4212">4212</a></span>
<span class="normal"><a href="#__codelineno-0-4213">4213</a></span>
<span class="normal"><a href="#__codelineno-0-4214">4214</a></span>
<span class="normal"><a href="#__codelineno-0-4215">4215</a></span>
<span class="normal"><a href="#__codelineno-0-4216">4216</a></span>
<span class="normal"><a href="#__codelineno-0-4217">4217</a></span>
<span class="normal"><a href="#__codelineno-0-4218">4218</a></span>
<span class="normal"><a href="#__codelineno-0-4219">4219</a></span>
<span class="normal"><a href="#__codelineno-0-4220">4220</a></span>
<span class="normal"><a href="#__codelineno-0-4221">4221</a></span>
<span class="normal"><a href="#__codelineno-0-4222">4222</a></span>
<span class="normal"><a href="#__codelineno-0-4223">4223</a></span>
<span class="normal"><a href="#__codelineno-0-4224">4224</a></span>
<span class="normal"><a href="#__codelineno-0-4225">4225</a></span>
<span class="normal"><a href="#__codelineno-0-4226">4226</a></span>
<span class="normal"><a href="#__codelineno-0-4227">4227</a></span>
<span class="normal"><a href="#__codelineno-0-4228">4228</a></span>
<span class="normal"><a href="#__codelineno-0-4229">4229</a></span>
<span class="normal"><a href="#__codelineno-0-4230">4230</a></span>
<span class="normal"><a href="#__codelineno-0-4231">4231</a></span>
<span class="normal"><a href="#__codelineno-0-4232">4232</a></span>
<span class="normal"><a href="#__codelineno-0-4233">4233</a></span>
<span class="normal"><a href="#__codelineno-0-4234">4234</a></span>
<span class="normal"><a href="#__codelineno-0-4235">4235</a></span>
<span class="normal"><a href="#__codelineno-0-4236">4236</a></span>
<span class="normal"><a href="#__codelineno-0-4237">4237</a></span>
<span class="normal"><a href="#__codelineno-0-4238">4238</a></span>
<span class="normal"><a href="#__codelineno-0-4239">4239</a></span>
<span class="normal"><a href="#__codelineno-0-4240">4240</a></span>
<span class="normal"><a href="#__codelineno-0-4241">4241</a></span>
<span class="normal"><a href="#__codelineno-0-4242">4242</a></span>
<span class="normal"><a href="#__codelineno-0-4243">4243</a></span>
<span class="normal"><a href="#__codelineno-0-4244">4244</a></span>
<span class="normal"><a href="#__codelineno-0-4245">4245</a></span>
<span class="normal"><a href="#__codelineno-0-4246">4246</a></span>
<span class="normal"><a href="#__codelineno-0-4247">4247</a></span>
<span class="normal"><a href="#__codelineno-0-4248">4248</a></span>
<span class="normal"><a href="#__codelineno-0-4249">4249</a></span>
<span class="normal"><a href="#__codelineno-0-4250">4250</a></span>
<span class="normal"><a href="#__codelineno-0-4251">4251</a></span>
<span class="normal"><a href="#__codelineno-0-4252">4252</a></span>
<span class="normal"><a href="#__codelineno-0-4253">4253</a></span>
<span class="normal"><a href="#__codelineno-0-4254">4254</a></span>
<span class="normal"><a href="#__codelineno-0-4255">4255</a></span>
<span class="normal"><a href="#__codelineno-0-4256">4256</a></span>
<span class="normal"><a href="#__codelineno-0-4257">4257</a></span>
<span class="normal"><a href="#__codelineno-0-4258">4258</a></span>
<span class="normal"><a href="#__codelineno-0-4259">4259</a></span>
<span class="normal"><a href="#__codelineno-0-4260">4260</a></span>
<span class="normal"><a href="#__codelineno-0-4261">4261</a></span>
<span class="normal"><a href="#__codelineno-0-4262">4262</a></span>
<span class="normal"><a href="#__codelineno-0-4263">4263</a></span>
<span class="normal"><a href="#__codelineno-0-4264">4264</a></span>
<span class="normal"><a href="#__codelineno-0-4265">4265</a></span>
<span class="normal"><a href="#__codelineno-0-4266">4266</a></span>
<span class="normal"><a href="#__codelineno-0-4267">4267</a></span>
<span class="normal"><a href="#__codelineno-0-4268">4268</a></span>
<span class="normal"><a href="#__codelineno-0-4269">4269</a></span>
<span class="normal"><a href="#__codelineno-0-4270">4270</a></span>
<span class="normal"><a href="#__codelineno-0-4271">4271</a></span>
<span class="normal"><a href="#__codelineno-0-4272">4272</a></span>
<span class="normal"><a href="#__codelineno-0-4273">4273</a></span>
<span class="normal"><a href="#__codelineno-0-4274">4274</a></span>
<span class="normal"><a href="#__codelineno-0-4275">4275</a></span>
<span class="normal"><a href="#__codelineno-0-4276">4276</a></span>
<span class="normal"><a href="#__codelineno-0-4277">4277</a></span>
<span class="normal"><a href="#__codelineno-0-4278">4278</a></span>
<span class="normal"><a href="#__codelineno-0-4279">4279</a></span>
<span class="normal"><a href="#__codelineno-0-4280">4280</a></span>
<span class="normal"><a href="#__codelineno-0-4281">4281</a></span>
<span class="normal"><a href="#__codelineno-0-4282">4282</a></span>
<span class="normal"><a href="#__codelineno-0-4283">4283</a></span>
<span class="normal"><a href="#__codelineno-0-4284">4284</a></span>
<span class="normal"><a href="#__codelineno-0-4285">4285</a></span>
<span class="normal"><a href="#__codelineno-0-4286">4286</a></span>
<span class="normal"><a href="#__codelineno-0-4287">4287</a></span>
<span class="normal"><a href="#__codelineno-0-4288">4288</a></span>
<span class="normal"><a href="#__codelineno-0-4289">4289</a></span>
<span class="normal"><a href="#__codelineno-0-4290">4290</a></span>
<span class="normal"><a href="#__codelineno-0-4291">4291</a></span>
<span class="normal"><a href="#__codelineno-0-4292">4292</a></span>
<span class="normal"><a href="#__codelineno-0-4293">4293</a></span>
<span class="normal"><a href="#__codelineno-0-4294">4294</a></span>
<span class="normal"><a href="#__codelineno-0-4295">4295</a></span>
<span class="normal"><a href="#__codelineno-0-4296">4296</a></span>
<span class="normal"><a href="#__codelineno-0-4297">4297</a></span>
<span class="normal"><a href="#__codelineno-0-4298">4298</a></span>
<span class="normal"><a href="#__codelineno-0-4299">4299</a></span>
<span class="normal"><a href="#__codelineno-0-4300">4300</a></span>
<span class="normal"><a href="#__codelineno-0-4301">4301</a></span>
<span class="normal"><a href="#__codelineno-0-4302">4302</a></span>
<span class="normal"><a href="#__codelineno-0-4303">4303</a></span>
<span class="normal"><a href="#__codelineno-0-4304">4304</a></span>
<span class="normal"><a href="#__codelineno-0-4305">4305</a></span>
<span class="normal"><a href="#__codelineno-0-4306">4306</a></span>
<span class="normal"><a href="#__codelineno-0-4307">4307</a></span>
<span class="normal"><a href="#__codelineno-0-4308">4308</a></span>
<span class="normal"><a href="#__codelineno-0-4309">4309</a></span>
<span class="normal"><a href="#__codelineno-0-4310">4310</a></span>
<span class="normal"><a href="#__codelineno-0-4311">4311</a></span>
<span class="normal"><a href="#__codelineno-0-4312">4312</a></span>
<span class="normal"><a href="#__codelineno-0-4313">4313</a></span>
<span class="normal"><a href="#__codelineno-0-4314">4314</a></span>
<span class="normal"><a href="#__codelineno-0-4315">4315</a></span>
<span class="normal"><a href="#__codelineno-0-4316">4316</a></span>
<span class="normal"><a href="#__codelineno-0-4317">4317</a></span>
<span class="normal"><a href="#__codelineno-0-4318">4318</a></span>
<span class="normal"><a href="#__codelineno-0-4319">4319</a></span>
<span class="normal"><a href="#__codelineno-0-4320">4320</a></span>
<span class="normal"><a href="#__codelineno-0-4321">4321</a></span>
<span class="normal"><a href="#__codelineno-0-4322">4322</a></span>
<span class="normal"><a href="#__codelineno-0-4323">4323</a></span>
<span class="normal"><a href="#__codelineno-0-4324">4324</a></span>
<span class="normal"><a href="#__codelineno-0-4325">4325</a></span>
<span class="normal"><a href="#__codelineno-0-4326">4326</a></span>
<span class="normal"><a href="#__codelineno-0-4327">4327</a></span>
<span class="normal"><a href="#__codelineno-0-4328">4328</a></span>
<span class="normal"><a href="#__codelineno-0-4329">4329</a></span>
<span class="normal"><a href="#__codelineno-0-4330">4330</a></span>
<span class="normal"><a href="#__codelineno-0-4331">4331</a></span>
<span class="normal"><a href="#__codelineno-0-4332">4332</a></span>
<span class="normal"><a href="#__codelineno-0-4333">4333</a></span>
<span class="normal"><a href="#__codelineno-0-4334">4334</a></span>
<span class="normal"><a href="#__codelineno-0-4335">4335</a></span>
<span class="normal"><a href="#__codelineno-0-4336">4336</a></span>
<span class="normal"><a href="#__codelineno-0-4337">4337</a></span>
<span class="normal"><a href="#__codelineno-0-4338">4338</a></span>
<span class="normal"><a href="#__codelineno-0-4339">4339</a></span>
<span class="normal"><a href="#__codelineno-0-4340">4340</a></span>
<span class="normal"><a href="#__codelineno-0-4341">4341</a></span>
<span class="normal"><a href="#__codelineno-0-4342">4342</a></span>
<span class="normal"><a href="#__codelineno-0-4343">4343</a></span>
<span class="normal"><a href="#__codelineno-0-4344">4344</a></span>
<span class="normal"><a href="#__codelineno-0-4345">4345</a></span>
<span class="normal"><a href="#__codelineno-0-4346">4346</a></span>
<span class="normal"><a href="#__codelineno-0-4347">4347</a></span>
<span class="normal"><a href="#__codelineno-0-4348">4348</a></span>
<span class="normal"><a href="#__codelineno-0-4349">4349</a></span>
<span class="normal"><a href="#__codelineno-0-4350">4350</a></span>
<span class="normal"><a href="#__codelineno-0-4351">4351</a></span>
<span class="normal"><a href="#__codelineno-0-4352">4352</a></span>
<span class="normal"><a href="#__codelineno-0-4353">4353</a></span>
<span class="normal"><a href="#__codelineno-0-4354">4354</a></span>
<span class="normal"><a href="#__codelineno-0-4355">4355</a></span>
<span class="normal"><a href="#__codelineno-0-4356">4356</a></span>
<span class="normal"><a href="#__codelineno-0-4357">4357</a></span>
<span class="normal"><a href="#__codelineno-0-4358">4358</a></span>
<span class="normal"><a href="#__codelineno-0-4359">4359</a></span>
<span class="normal"><a href="#__codelineno-0-4360">4360</a></span>
<span class="normal"><a href="#__codelineno-0-4361">4361</a></span>
<span class="normal"><a href="#__codelineno-0-4362">4362</a></span>
<span class="normal"><a href="#__codelineno-0-4363">4363</a></span>
<span class="normal"><a href="#__codelineno-0-4364">4364</a></span>
<span class="normal"><a href="#__codelineno-0-4365">4365</a></span>
<span class="normal"><a href="#__codelineno-0-4366">4366</a></span>
<span class="normal"><a href="#__codelineno-0-4367">4367</a></span>
<span class="normal"><a href="#__codelineno-0-4368">4368</a></span>
<span class="normal"><a href="#__codelineno-0-4369">4369</a></span>
<span class="normal"><a href="#__codelineno-0-4370">4370</a></span>
<span class="normal"><a href="#__codelineno-0-4371">4371</a></span>
<span class="normal"><a href="#__codelineno-0-4372">4372</a></span>
<span class="normal"><a href="#__codelineno-0-4373">4373</a></span>
<span class="normal"><a href="#__codelineno-0-4374">4374</a></span>
<span class="normal"><a href="#__codelineno-0-4375">4375</a></span>
<span class="normal"><a href="#__codelineno-0-4376">4376</a></span>
<span class="normal"><a href="#__codelineno-0-4377">4377</a></span>
<span class="normal"><a href="#__codelineno-0-4378">4378</a></span>
<span class="normal"><a href="#__codelineno-0-4379">4379</a></span>
<span class="normal"><a href="#__codelineno-0-4380">4380</a></span>
<span class="normal"><a href="#__codelineno-0-4381">4381</a></span>
<span class="normal"><a href="#__codelineno-0-4382">4382</a></span>
<span class="normal"><a href="#__codelineno-0-4383">4383</a></span>
<span class="normal"><a href="#__codelineno-0-4384">4384</a></span>
<span class="normal"><a href="#__codelineno-0-4385">4385</a></span>
<span class="normal"><a href="#__codelineno-0-4386">4386</a></span>
<span class="normal"><a href="#__codelineno-0-4387">4387</a></span>
<span class="normal"><a href="#__codelineno-0-4388">4388</a></span>
<span class="normal"><a href="#__codelineno-0-4389">4389</a></span>
<span class="normal"><a href="#__codelineno-0-4390">4390</a></span>
<span class="normal"><a href="#__codelineno-0-4391">4391</a></span>
<span class="normal"><a href="#__codelineno-0-4392">4392</a></span>
<span class="normal"><a href="#__codelineno-0-4393">4393</a></span>
<span class="normal"><a href="#__codelineno-0-4394">4394</a></span>
<span class="normal"><a href="#__codelineno-0-4395">4395</a></span>
<span class="normal"><a href="#__codelineno-0-4396">4396</a></span>
<span class="normal"><a href="#__codelineno-0-4397">4397</a></span>
<span class="normal"><a href="#__codelineno-0-4398">4398</a></span>
<span class="normal"><a href="#__codelineno-0-4399">4399</a></span>
<span class="normal"><a href="#__codelineno-0-4400">4400</a></span>
<span class="normal"><a href="#__codelineno-0-4401">4401</a></span>
<span class="normal"><a href="#__codelineno-0-4402">4402</a></span>
<span class="normal"><a href="#__codelineno-0-4403">4403</a></span>
<span class="normal"><a href="#__codelineno-0-4404">4404</a></span>
<span class="normal"><a href="#__codelineno-0-4405">4405</a></span>
<span class="normal"><a href="#__codelineno-0-4406">4406</a></span>
<span class="normal"><a href="#__codelineno-0-4407">4407</a></span>
<span class="normal"><a href="#__codelineno-0-4408">4408</a></span>
<span class="normal"><a href="#__codelineno-0-4409">4409</a></span>
<span class="normal"><a href="#__codelineno-0-4410">4410</a></span>
<span class="normal"><a href="#__codelineno-0-4411">4411</a></span>
<span class="normal"><a href="#__codelineno-0-4412">4412</a></span>
<span class="normal"><a href="#__codelineno-0-4413">4413</a></span>
<span class="normal"><a href="#__codelineno-0-4414">4414</a></span>
<span class="normal"><a href="#__codelineno-0-4415">4415</a></span>
<span class="normal"><a href="#__codelineno-0-4416">4416</a></span>
<span class="normal"><a href="#__codelineno-0-4417">4417</a></span>
<span class="normal"><a href="#__codelineno-0-4418">4418</a></span>
<span class="normal"><a href="#__codelineno-0-4419">4419</a></span>
<span class="normal"><a href="#__codelineno-0-4420">4420</a></span>
<span class="normal"><a href="#__codelineno-0-4421">4421</a></span>
<span class="normal"><a href="#__codelineno-0-4422">4422</a></span>
<span class="normal"><a href="#__codelineno-0-4423">4423</a></span>
<span class="normal"><a href="#__codelineno-0-4424">4424</a></span>
<span class="normal"><a href="#__codelineno-0-4425">4425</a></span>
<span class="normal"><a href="#__codelineno-0-4426">4426</a></span>
<span class="normal"><a href="#__codelineno-0-4427">4427</a></span>
<span class="normal"><a href="#__codelineno-0-4428">4428</a></span>
<span class="normal"><a href="#__codelineno-0-4429">4429</a></span>
<span class="normal"><a href="#__codelineno-0-4430">4430</a></span>
<span class="normal"><a href="#__codelineno-0-4431">4431</a></span>
<span class="normal"><a href="#__codelineno-0-4432">4432</a></span>
<span class="normal"><a href="#__codelineno-0-4433">4433</a></span>
<span class="normal"><a href="#__codelineno-0-4434">4434</a></span>
<span class="normal"><a href="#__codelineno-0-4435">4435</a></span>
<span class="normal"><a href="#__codelineno-0-4436">4436</a></span>
<span class="normal"><a href="#__codelineno-0-4437">4437</a></span>
<span class="normal"><a href="#__codelineno-0-4438">4438</a></span>
<span class="normal"><a href="#__codelineno-0-4439">4439</a></span>
<span class="normal"><a href="#__codelineno-0-4440">4440</a></span>
<span class="normal"><a href="#__codelineno-0-4441">4441</a></span>
<span class="normal"><a href="#__codelineno-0-4442">4442</a></span>
<span class="normal"><a href="#__codelineno-0-4443">4443</a></span>
<span class="normal"><a href="#__codelineno-0-4444">4444</a></span>
<span class="normal"><a href="#__codelineno-0-4445">4445</a></span>
<span class="normal"><a href="#__codelineno-0-4446">4446</a></span>
<span class="normal"><a href="#__codelineno-0-4447">4447</a></span>
<span class="normal"><a href="#__codelineno-0-4448">4448</a></span>
<span class="normal"><a href="#__codelineno-0-4449">4449</a></span>
<span class="normal"><a href="#__codelineno-0-4450">4450</a></span>
<span class="normal"><a href="#__codelineno-0-4451">4451</a></span>
<span class="normal"><a href="#__codelineno-0-4452">4452</a></span>
<span class="normal"><a href="#__codelineno-0-4453">4453</a></span>
<span class="normal"><a href="#__codelineno-0-4454">4454</a></span>
<span class="normal"><a href="#__codelineno-0-4455">4455</a></span>
<span class="normal"><a href="#__codelineno-0-4456">4456</a></span>
<span class="normal"><a href="#__codelineno-0-4457">4457</a></span>
<span class="normal"><a href="#__codelineno-0-4458">4458</a></span>
<span class="normal"><a href="#__codelineno-0-4459">4459</a></span>
<span class="normal"><a href="#__codelineno-0-4460">4460</a></span>
<span class="normal"><a href="#__codelineno-0-4461">4461</a></span>
<span class="normal"><a href="#__codelineno-0-4462">4462</a></span>
<span class="normal"><a href="#__codelineno-0-4463">4463</a></span>
<span class="normal"><a href="#__codelineno-0-4464">4464</a></span>
<span class="normal"><a href="#__codelineno-0-4465">4465</a></span>
<span class="normal"><a href="#__codelineno-0-4466">4466</a></span>
<span class="normal"><a href="#__codelineno-0-4467">4467</a></span>
<span class="normal"><a href="#__codelineno-0-4468">4468</a></span>
<span class="normal"><a href="#__codelineno-0-4469">4469</a></span>
<span class="normal"><a href="#__codelineno-0-4470">4470</a></span>
<span class="normal"><a href="#__codelineno-0-4471">4471</a></span>
<span class="normal"><a href="#__codelineno-0-4472">4472</a></span>
<span class="normal"><a href="#__codelineno-0-4473">4473</a></span>
<span class="normal"><a href="#__codelineno-0-4474">4474</a></span>
<span class="normal"><a href="#__codelineno-0-4475">4475</a></span>
<span class="normal"><a href="#__codelineno-0-4476">4476</a></span>
<span class="normal"><a href="#__codelineno-0-4477">4477</a></span>
<span class="normal"><a href="#__codelineno-0-4478">4478</a></span>
<span class="normal"><a href="#__codelineno-0-4479">4479</a></span>
<span class="normal"><a href="#__codelineno-0-4480">4480</a></span>
<span class="normal"><a href="#__codelineno-0-4481">4481</a></span>
<span class="normal"><a href="#__codelineno-0-4482">4482</a></span>
<span class="normal"><a href="#__codelineno-0-4483">4483</a></span>
<span class="normal"><a href="#__codelineno-0-4484">4484</a></span>
<span class="normal"><a href="#__codelineno-0-4485">4485</a></span>
<span class="normal"><a href="#__codelineno-0-4486">4486</a></span>
<span class="normal"><a href="#__codelineno-0-4487">4487</a></span>
<span class="normal"><a href="#__codelineno-0-4488">4488</a></span>
<span class="normal"><a href="#__codelineno-0-4489">4489</a></span>
<span class="normal"><a href="#__codelineno-0-4490">4490</a></span>
<span class="normal"><a href="#__codelineno-0-4491">4491</a></span>
<span class="normal"><a href="#__codelineno-0-4492">4492</a></span>
<span class="normal"><a href="#__codelineno-0-4493">4493</a></span>
<span class="normal"><a href="#__codelineno-0-4494">4494</a></span>
<span class="normal"><a href="#__codelineno-0-4495">4495</a></span>
<span class="normal"><a href="#__codelineno-0-4496">4496</a></span>
<span class="normal"><a href="#__codelineno-0-4497">4497</a></span>
<span class="normal"><a href="#__codelineno-0-4498">4498</a></span>
<span class="normal"><a href="#__codelineno-0-4499">4499</a></span>
<span class="normal"><a href="#__codelineno-0-4500">4500</a></span>
<span class="normal"><a href="#__codelineno-0-4501">4501</a></span>
<span class="normal"><a href="#__codelineno-0-4502">4502</a></span>
<span class="normal"><a href="#__codelineno-0-4503">4503</a></span>
<span class="normal"><a href="#__codelineno-0-4504">4504</a></span>
<span class="normal"><a href="#__codelineno-0-4505">4505</a></span>
<span class="normal"><a href="#__codelineno-0-4506">4506</a></span>
<span class="normal"><a href="#__codelineno-0-4507">4507</a></span>
<span class="normal"><a href="#__codelineno-0-4508">4508</a></span>
<span class="normal"><a href="#__codelineno-0-4509">4509</a></span>
<span class="normal"><a href="#__codelineno-0-4510">4510</a></span>
<span class="normal"><a href="#__codelineno-0-4511">4511</a></span>
<span class="normal"><a href="#__codelineno-0-4512">4512</a></span>
<span class="normal"><a href="#__codelineno-0-4513">4513</a></span>
<span class="normal"><a href="#__codelineno-0-4514">4514</a></span>
<span class="normal"><a href="#__codelineno-0-4515">4515</a></span>
<span class="normal"><a href="#__codelineno-0-4516">4516</a></span>
<span class="normal"><a href="#__codelineno-0-4517">4517</a></span>
<span class="normal"><a href="#__codelineno-0-4518">4518</a></span>
<span class="normal"><a href="#__codelineno-0-4519">4519</a></span>
<span class="normal"><a href="#__codelineno-0-4520">4520</a></span>
<span class="normal"><a href="#__codelineno-0-4521">4521</a></span>
<span class="normal"><a href="#__codelineno-0-4522">4522</a></span>
<span class="normal"><a href="#__codelineno-0-4523">4523</a></span>
<span class="normal"><a href="#__codelineno-0-4524">4524</a></span>
<span class="normal"><a href="#__codelineno-0-4525">4525</a></span>
<span class="normal"><a href="#__codelineno-0-4526">4526</a></span>
<span class="normal"><a href="#__codelineno-0-4527">4527</a></span>
<span class="normal"><a href="#__codelineno-0-4528">4528</a></span>
<span class="normal"><a href="#__codelineno-0-4529">4529</a></span>
<span class="normal"><a href="#__codelineno-0-4530">4530</a></span>
<span class="normal"><a href="#__codelineno-0-4531">4531</a></span>
<span class="normal"><a href="#__codelineno-0-4532">4532</a></span>
<span class="normal"><a href="#__codelineno-0-4533">4533</a></span>
<span class="normal"><a href="#__codelineno-0-4534">4534</a></span>
<span class="normal"><a href="#__codelineno-0-4535">4535</a></span>
<span class="normal"><a href="#__codelineno-0-4536">4536</a></span>
<span class="normal"><a href="#__codelineno-0-4537">4537</a></span>
<span class="normal"><a href="#__codelineno-0-4538">4538</a></span>
<span class="normal"><a href="#__codelineno-0-4539">4539</a></span>
<span class="normal"><a href="#__codelineno-0-4540">4540</a></span>
<span class="normal"><a href="#__codelineno-0-4541">4541</a></span>
<span class="normal"><a href="#__codelineno-0-4542">4542</a></span>
<span class="normal"><a href="#__codelineno-0-4543">4543</a></span>
<span class="normal"><a href="#__codelineno-0-4544">4544</a></span>
<span class="normal"><a href="#__codelineno-0-4545">4545</a></span>
<span class="normal"><a href="#__codelineno-0-4546">4546</a></span>
<span class="normal"><a href="#__codelineno-0-4547">4547</a></span>
<span class="normal"><a href="#__codelineno-0-4548">4548</a></span>
<span class="normal"><a href="#__codelineno-0-4549">4549</a></span>
<span class="normal"><a href="#__codelineno-0-4550">4550</a></span>
<span class="normal"><a href="#__codelineno-0-4551">4551</a></span>
<span class="normal"><a href="#__codelineno-0-4552">4552</a></span>
<span class="normal"><a href="#__codelineno-0-4553">4553</a></span>
<span class="normal"><a href="#__codelineno-0-4554">4554</a></span>
<span class="normal"><a href="#__codelineno-0-4555">4555</a></span>
<span class="normal"><a href="#__codelineno-0-4556">4556</a></span>
<span class="normal"><a href="#__codelineno-0-4557">4557</a></span>
<span class="normal"><a href="#__codelineno-0-4558">4558</a></span>
<span class="normal"><a href="#__codelineno-0-4559">4559</a></span>
<span class="normal"><a href="#__codelineno-0-4560">4560</a></span>
<span class="normal"><a href="#__codelineno-0-4561">4561</a></span>
<span class="normal"><a href="#__codelineno-0-4562">4562</a></span>
<span class="normal"><a href="#__codelineno-0-4563">4563</a></span>
<span class="normal"><a href="#__codelineno-0-4564">4564</a></span>
<span class="normal"><a href="#__codelineno-0-4565">4565</a></span>
<span class="normal"><a href="#__codelineno-0-4566">4566</a></span>
<span class="normal"><a href="#__codelineno-0-4567">4567</a></span>
<span class="normal"><a href="#__codelineno-0-4568">4568</a></span>
<span class="normal"><a href="#__codelineno-0-4569">4569</a></span>
<span class="normal"><a href="#__codelineno-0-4570">4570</a></span>
<span class="normal"><a href="#__codelineno-0-4571">4571</a></span>
<span class="normal"><a href="#__codelineno-0-4572">4572</a></span>
<span class="normal"><a href="#__codelineno-0-4573">4573</a></span>
<span class="normal"><a href="#__codelineno-0-4574">4574</a></span>
<span class="normal"><a href="#__codelineno-0-4575">4575</a></span>
<span class="normal"><a href="#__codelineno-0-4576">4576</a></span>
<span class="normal"><a href="#__codelineno-0-4577">4577</a></span>
<span class="normal"><a href="#__codelineno-0-4578">4578</a></span>
<span class="normal"><a href="#__codelineno-0-4579">4579</a></span>
<span class="normal"><a href="#__codelineno-0-4580">4580</a></span>
<span class="normal"><a href="#__codelineno-0-4581">4581</a></span>
<span class="normal"><a href="#__codelineno-0-4582">4582</a></span>
<span class="normal"><a href="#__codelineno-0-4583">4583</a></span>
<span class="normal"><a href="#__codelineno-0-4584">4584</a></span>
<span class="normal"><a href="#__codelineno-0-4585">4585</a></span>
<span class="normal"><a href="#__codelineno-0-4586">4586</a></span>
<span class="normal"><a href="#__codelineno-0-4587">4587</a></span>
<span class="normal"><a href="#__codelineno-0-4588">4588</a></span>
<span class="normal"><a href="#__codelineno-0-4589">4589</a></span>
<span class="normal"><a href="#__codelineno-0-4590">4590</a></span>
<span class="normal"><a href="#__codelineno-0-4591">4591</a></span>
<span class="normal"><a href="#__codelineno-0-4592">4592</a></span>
<span class="normal"><a href="#__codelineno-0-4593">4593</a></span>
<span class="normal"><a href="#__codelineno-0-4594">4594</a></span>
<span class="normal"><a href="#__codelineno-0-4595">4595</a></span>
<span class="normal"><a href="#__codelineno-0-4596">4596</a></span>
<span class="normal"><a href="#__codelineno-0-4597">4597</a></span>
<span class="normal"><a href="#__codelineno-0-4598">4598</a></span>
<span class="normal"><a href="#__codelineno-0-4599">4599</a></span>
<span class="normal"><a href="#__codelineno-0-4600">4600</a></span>
<span class="normal"><a href="#__codelineno-0-4601">4601</a></span>
<span class="normal"><a href="#__codelineno-0-4602">4602</a></span>
<span class="normal"><a href="#__codelineno-0-4603">4603</a></span>
<span class="normal"><a href="#__codelineno-0-4604">4604</a></span>
<span class="normal"><a href="#__codelineno-0-4605">4605</a></span>
<span class="normal"><a href="#__codelineno-0-4606">4606</a></span>
<span class="normal"><a href="#__codelineno-0-4607">4607</a></span>
<span class="normal"><a href="#__codelineno-0-4608">4608</a></span>
<span class="normal"><a href="#__codelineno-0-4609">4609</a></span>
<span class="normal"><a href="#__codelineno-0-4610">4610</a></span>
<span class="normal"><a href="#__codelineno-0-4611">4611</a></span>
<span class="normal"><a href="#__codelineno-0-4612">4612</a></span>
<span class="normal"><a href="#__codelineno-0-4613">4613</a></span>
<span class="normal"><a href="#__codelineno-0-4614">4614</a></span>
<span class="normal"><a href="#__codelineno-0-4615">4615</a></span>
<span class="normal"><a href="#__codelineno-0-4616">4616</a></span>
<span class="normal"><a href="#__codelineno-0-4617">4617</a></span>
<span class="normal"><a href="#__codelineno-0-4618">4618</a></span>
<span class="normal"><a href="#__codelineno-0-4619">4619</a></span>
<span class="normal"><a href="#__codelineno-0-4620">4620</a></span>
<span class="normal"><a href="#__codelineno-0-4621">4621</a></span>
<span class="normal"><a href="#__codelineno-0-4622">4622</a></span>
<span class="normal"><a href="#__codelineno-0-4623">4623</a></span>
<span class="normal"><a href="#__codelineno-0-4624">4624</a></span>
<span class="normal"><a href="#__codelineno-0-4625">4625</a></span>
<span class="normal"><a href="#__codelineno-0-4626">4626</a></span>
<span class="normal"><a href="#__codelineno-0-4627">4627</a></span>
<span class="normal"><a href="#__codelineno-0-4628">4628</a></span>
<span class="normal"><a href="#__codelineno-0-4629">4629</a></span>
<span class="normal"><a href="#__codelineno-0-4630">4630</a></span>
<span class="normal"><a href="#__codelineno-0-4631">4631</a></span>
<span class="normal"><a href="#__codelineno-0-4632">4632</a></span>
<span class="normal"><a href="#__codelineno-0-4633">4633</a></span>
<span class="normal"><a href="#__codelineno-0-4634">4634</a></span>
<span class="normal"><a href="#__codelineno-0-4635">4635</a></span>
<span class="normal"><a href="#__codelineno-0-4636">4636</a></span>
<span class="normal"><a href="#__codelineno-0-4637">4637</a></span>
<span class="normal"><a href="#__codelineno-0-4638">4638</a></span>
<span class="normal"><a href="#__codelineno-0-4639">4639</a></span>
<span class="normal"><a href="#__codelineno-0-4640">4640</a></span>
<span class="normal"><a href="#__codelineno-0-4641">4641</a></span>
<span class="normal"><a href="#__codelineno-0-4642">4642</a></span>
<span class="normal"><a href="#__codelineno-0-4643">4643</a></span>
<span class="normal"><a href="#__codelineno-0-4644">4644</a></span>
<span class="normal"><a href="#__codelineno-0-4645">4645</a></span>
<span class="normal"><a href="#__codelineno-0-4646">4646</a></span>
<span class="normal"><a href="#__codelineno-0-4647">4647</a></span>
<span class="normal"><a href="#__codelineno-0-4648">4648</a></span>
<span class="normal"><a href="#__codelineno-0-4649">4649</a></span>
<span class="normal"><a href="#__codelineno-0-4650">4650</a></span>
<span class="normal"><a href="#__codelineno-0-4651">4651</a></span>
<span class="normal"><a href="#__codelineno-0-4652">4652</a></span>
<span class="normal"><a href="#__codelineno-0-4653">4653</a></span>
<span class="normal"><a href="#__codelineno-0-4654">4654</a></span>
<span class="normal"><a href="#__codelineno-0-4655">4655</a></span>
<span class="normal"><a href="#__codelineno-0-4656">4656</a></span>
<span class="normal"><a href="#__codelineno-0-4657">4657</a></span>
<span class="normal"><a href="#__codelineno-0-4658">4658</a></span>
<span class="normal"><a href="#__codelineno-0-4659">4659</a></span>
<span class="normal"><a href="#__codelineno-0-4660">4660</a></span>
<span class="normal"><a href="#__codelineno-0-4661">4661</a></span>
<span class="normal"><a href="#__codelineno-0-4662">4662</a></span>
<span class="normal"><a href="#__codelineno-0-4663">4663</a></span>
<span class="normal"><a href="#__codelineno-0-4664">4664</a></span>
<span class="normal"><a href="#__codelineno-0-4665">4665</a></span>
<span class="normal"><a href="#__codelineno-0-4666">4666</a></span>
<span class="normal"><a href="#__codelineno-0-4667">4667</a></span>
<span class="normal"><a href="#__codelineno-0-4668">4668</a></span>
<span class="normal"><a href="#__codelineno-0-4669">4669</a></span>
<span class="normal"><a href="#__codelineno-0-4670">4670</a></span>
<span class="normal"><a href="#__codelineno-0-4671">4671</a></span>
<span class="normal"><a href="#__codelineno-0-4672">4672</a></span>
<span class="normal"><a href="#__codelineno-0-4673">4673</a></span>
<span class="normal"><a href="#__codelineno-0-4674">4674</a></span>
<span class="normal"><a href="#__codelineno-0-4675">4675</a></span>
<span class="normal"><a href="#__codelineno-0-4676">4676</a></span>
<span class="normal"><a href="#__codelineno-0-4677">4677</a></span>
<span class="normal"><a href="#__codelineno-0-4678">4678</a></span>
<span class="normal"><a href="#__codelineno-0-4679">4679</a></span>
<span class="normal"><a href="#__codelineno-0-4680">4680</a></span>
<span class="normal"><a href="#__codelineno-0-4681">4681</a></span>
<span class="normal"><a href="#__codelineno-0-4682">4682</a></span>
<span class="normal"><a href="#__codelineno-0-4683">4683</a></span>
<span class="normal"><a href="#__codelineno-0-4684">4684</a></span>
<span class="normal"><a href="#__codelineno-0-4685">4685</a></span>
<span class="normal"><a href="#__codelineno-0-4686">4686</a></span>
<span class="normal"><a href="#__codelineno-0-4687">4687</a></span>
<span class="normal"><a href="#__codelineno-0-4688">4688</a></span>
<span class="normal"><a href="#__codelineno-0-4689">4689</a></span>
<span class="normal"><a href="#__codelineno-0-4690">4690</a></span>
<span class="normal"><a href="#__codelineno-0-4691">4691</a></span>
<span class="normal"><a href="#__codelineno-0-4692">4692</a></span>
<span class="normal"><a href="#__codelineno-0-4693">4693</a></span>
<span class="normal"><a href="#__codelineno-0-4694">4694</a></span>
<span class="normal"><a href="#__codelineno-0-4695">4695</a></span>
<span class="normal"><a href="#__codelineno-0-4696">4696</a></span>
<span class="normal"><a href="#__codelineno-0-4697">4697</a></span>
<span class="normal"><a href="#__codelineno-0-4698">4698</a></span>
<span class="normal"><a href="#__codelineno-0-4699">4699</a></span>
<span class="normal"><a href="#__codelineno-0-4700">4700</a></span>
<span class="normal"><a href="#__codelineno-0-4701">4701</a></span>
<span class="normal"><a href="#__codelineno-0-4702">4702</a></span>
<span class="normal"><a href="#__codelineno-0-4703">4703</a></span>
<span class="normal"><a href="#__codelineno-0-4704">4704</a></span>
<span class="normal"><a href="#__codelineno-0-4705">4705</a></span>
<span class="normal"><a href="#__codelineno-0-4706">4706</a></span>
<span class="normal"><a href="#__codelineno-0-4707">4707</a></span>
<span class="normal"><a href="#__codelineno-0-4708">4708</a></span>
<span class="normal"><a href="#__codelineno-0-4709">4709</a></span>
<span class="normal"><a href="#__codelineno-0-4710">4710</a></span>
<span class="normal"><a href="#__codelineno-0-4711">4711</a></span>
<span class="normal"><a href="#__codelineno-0-4712">4712</a></span>
<span class="normal"><a href="#__codelineno-0-4713">4713</a></span>
<span class="normal"><a href="#__codelineno-0-4714">4714</a></span>
<span class="normal"><a href="#__codelineno-0-4715">4715</a></span>
<span class="normal"><a href="#__codelineno-0-4716">4716</a></span>
<span class="normal"><a href="#__codelineno-0-4717">4717</a></span>
<span class="normal"><a href="#__codelineno-0-4718">4718</a></span>
<span class="normal"><a href="#__codelineno-0-4719">4719</a></span>
<span class="normal"><a href="#__codelineno-0-4720">4720</a></span>
<span class="normal"><a href="#__codelineno-0-4721">4721</a></span>
<span class="normal"><a href="#__codelineno-0-4722">4722</a></span>
<span class="normal"><a href="#__codelineno-0-4723">4723</a></span>
<span class="normal"><a href="#__codelineno-0-4724">4724</a></span>
<span class="normal"><a href="#__codelineno-0-4725">4725</a></span>
<span class="normal"><a href="#__codelineno-0-4726">4726</a></span>
<span class="normal"><a href="#__codelineno-0-4727">4727</a></span>
<span class="normal"><a href="#__codelineno-0-4728">4728</a></span>
<span class="normal"><a href="#__codelineno-0-4729">4729</a></span>
<span class="normal"><a href="#__codelineno-0-4730">4730</a></span>
<span class="normal"><a href="#__codelineno-0-4731">4731</a></span>
<span class="normal"><a href="#__codelineno-0-4732">4732</a></span>
<span class="normal"><a href="#__codelineno-0-4733">4733</a></span>
<span class="normal"><a href="#__codelineno-0-4734">4734</a></span>
<span class="normal"><a href="#__codelineno-0-4735">4735</a></span>
<span class="normal"><a href="#__codelineno-0-4736">4736</a></span>
<span class="normal"><a href="#__codelineno-0-4737">4737</a></span>
<span class="normal"><a href="#__codelineno-0-4738">4738</a></span>
<span class="normal"><a href="#__codelineno-0-4739">4739</a></span>
<span class="normal"><a href="#__codelineno-0-4740">4740</a></span>
<span class="normal"><a href="#__codelineno-0-4741">4741</a></span>
<span class="normal"><a href="#__codelineno-0-4742">4742</a></span>
<span class="normal"><a href="#__codelineno-0-4743">4743</a></span>
<span class="normal"><a href="#__codelineno-0-4744">4744</a></span>
<span class="normal"><a href="#__codelineno-0-4745">4745</a></span>
<span class="normal"><a href="#__codelineno-0-4746">4746</a></span>
<span class="normal"><a href="#__codelineno-0-4747">4747</a></span>
<span class="normal"><a href="#__codelineno-0-4748">4748</a></span>
<span class="normal"><a href="#__codelineno-0-4749">4749</a></span>
<span class="normal"><a href="#__codelineno-0-4750">4750</a></span>
<span class="normal"><a href="#__codelineno-0-4751">4751</a></span>
<span class="normal"><a href="#__codelineno-0-4752">4752</a></span>
<span class="normal"><a href="#__codelineno-0-4753">4753</a></span>
<span class="normal"><a href="#__codelineno-0-4754">4754</a></span>
<span class="normal"><a href="#__codelineno-0-4755">4755</a></span>
<span class="normal"><a href="#__codelineno-0-4756">4756</a></span>
<span class="normal"><a href="#__codelineno-0-4757">4757</a></span>
<span class="normal"><a href="#__codelineno-0-4758">4758</a></span>
<span class="normal"><a href="#__codelineno-0-4759">4759</a></span>
<span class="normal"><a href="#__codelineno-0-4760">4760</a></span>
<span class="normal"><a href="#__codelineno-0-4761">4761</a></span>
<span class="normal"><a href="#__codelineno-0-4762">4762</a></span>
<span class="normal"><a href="#__codelineno-0-4763">4763</a></span>
<span class="normal"><a href="#__codelineno-0-4764">4764</a></span>
<span class="normal"><a href="#__codelineno-0-4765">4765</a></span>
<span class="normal"><a href="#__codelineno-0-4766">4766</a></span>
<span class="normal"><a href="#__codelineno-0-4767">4767</a></span>
<span class="normal"><a href="#__codelineno-0-4768">4768</a></span>
<span class="normal"><a href="#__codelineno-0-4769">4769</a></span>
<span class="normal"><a href="#__codelineno-0-4770">4770</a></span>
<span class="normal"><a href="#__codelineno-0-4771">4771</a></span>
<span class="normal"><a href="#__codelineno-0-4772">4772</a></span>
<span class="normal"><a href="#__codelineno-0-4773">4773</a></span>
<span class="normal"><a href="#__codelineno-0-4774">4774</a></span>
<span class="normal"><a href="#__codelineno-0-4775">4775</a></span>
<span class="normal"><a href="#__codelineno-0-4776">4776</a></span>
<span class="normal"><a href="#__codelineno-0-4777">4777</a></span>
<span class="normal"><a href="#__codelineno-0-4778">4778</a></span>
<span class="normal"><a href="#__codelineno-0-4779">4779</a></span>
<span class="normal"><a href="#__codelineno-0-4780">4780</a></span>
<span class="normal"><a href="#__codelineno-0-4781">4781</a></span>
<span class="normal"><a href="#__codelineno-0-4782">4782</a></span>
<span class="normal"><a href="#__codelineno-0-4783">4783</a></span>
<span class="normal"><a href="#__codelineno-0-4784">4784</a></span>
<span class="normal"><a href="#__codelineno-0-4785">4785</a></span>
<span class="normal"><a href="#__codelineno-0-4786">4786</a></span>
<span class="normal"><a href="#__codelineno-0-4787">4787</a></span>
<span class="normal"><a href="#__codelineno-0-4788">4788</a></span>
<span class="normal"><a href="#__codelineno-0-4789">4789</a></span>
<span class="normal"><a href="#__codelineno-0-4790">4790</a></span>
<span class="normal"><a href="#__codelineno-0-4791">4791</a></span>
<span class="normal"><a href="#__codelineno-0-4792">4792</a></span>
<span class="normal"><a href="#__codelineno-0-4793">4793</a></span>
<span class="normal"><a href="#__codelineno-0-4794">4794</a></span>
<span class="normal"><a href="#__codelineno-0-4795">4795</a></span>
<span class="normal"><a href="#__codelineno-0-4796">4796</a></span>
<span class="normal"><a href="#__codelineno-0-4797">4797</a></span>
<span class="normal"><a href="#__codelineno-0-4798">4798</a></span>
<span class="normal"><a href="#__codelineno-0-4799">4799</a></span>
<span class="normal"><a href="#__codelineno-0-4800">4800</a></span>
<span class="normal"><a href="#__codelineno-0-4801">4801</a></span>
<span class="normal"><a href="#__codelineno-0-4802">4802</a></span>
<span class="normal"><a href="#__codelineno-0-4803">4803</a></span>
<span class="normal"><a href="#__codelineno-0-4804">4804</a></span>
<span class="normal"><a href="#__codelineno-0-4805">4805</a></span>
<span class="normal"><a href="#__codelineno-0-4806">4806</a></span>
<span class="normal"><a href="#__codelineno-0-4807">4807</a></span>
<span class="normal"><a href="#__codelineno-0-4808">4808</a></span>
<span class="normal"><a href="#__codelineno-0-4809">4809</a></span>
<span class="normal"><a href="#__codelineno-0-4810">4810</a></span>
<span class="normal"><a href="#__codelineno-0-4811">4811</a></span>
<span class="normal"><a href="#__codelineno-0-4812">4812</a></span>
<span class="normal"><a href="#__codelineno-0-4813">4813</a></span>
<span class="normal"><a href="#__codelineno-0-4814">4814</a></span>
<span class="normal"><a href="#__codelineno-0-4815">4815</a></span>
<span class="normal"><a href="#__codelineno-0-4816">4816</a></span>
<span class="normal"><a href="#__codelineno-0-4817">4817</a></span>
<span class="normal"><a href="#__codelineno-0-4818">4818</a></span>
<span class="normal"><a href="#__codelineno-0-4819">4819</a></span>
<span class="normal"><a href="#__codelineno-0-4820">4820</a></span>
<span class="normal"><a href="#__codelineno-0-4821">4821</a></span>
<span class="normal"><a href="#__codelineno-0-4822">4822</a></span>
<span class="normal"><a href="#__codelineno-0-4823">4823</a></span>
<span class="normal"><a href="#__codelineno-0-4824">4824</a></span>
<span class="normal"><a href="#__codelineno-0-4825">4825</a></span>
<span class="normal"><a href="#__codelineno-0-4826">4826</a></span>
<span class="normal"><a href="#__codelineno-0-4827">4827</a></span>
<span class="normal"><a href="#__codelineno-0-4828">4828</a></span>
<span class="normal"><a href="#__codelineno-0-4829">4829</a></span>
<span class="normal"><a href="#__codelineno-0-4830">4830</a></span>
<span class="normal"><a href="#__codelineno-0-4831">4831</a></span>
<span class="normal"><a href="#__codelineno-0-4832">4832</a></span>
<span class="normal"><a href="#__codelineno-0-4833">4833</a></span>
<span class="normal"><a href="#__codelineno-0-4834">4834</a></span>
<span class="normal"><a href="#__codelineno-0-4835">4835</a></span>
<span class="normal"><a href="#__codelineno-0-4836">4836</a></span>
<span class="normal"><a href="#__codelineno-0-4837">4837</a></span>
<span class="normal"><a href="#__codelineno-0-4838">4838</a></span>
<span class="normal"><a href="#__codelineno-0-4839">4839</a></span>
<span class="normal"><a href="#__codelineno-0-4840">4840</a></span>
<span class="normal"><a href="#__codelineno-0-4841">4841</a></span>
<span class="normal"><a href="#__codelineno-0-4842">4842</a></span>
<span class="normal"><a href="#__codelineno-0-4843">4843</a></span>
<span class="normal"><a href="#__codelineno-0-4844">4844</a></span>
<span class="normal"><a href="#__codelineno-0-4845">4845</a></span>
<span class="normal"><a href="#__codelineno-0-4846">4846</a></span>
<span class="normal"><a href="#__codelineno-0-4847">4847</a></span>
<span class="normal"><a href="#__codelineno-0-4848">4848</a></span>
<span class="normal"><a href="#__codelineno-0-4849">4849</a></span>
<span class="normal"><a href="#__codelineno-0-4850">4850</a></span>
<span class="normal"><a href="#__codelineno-0-4851">4851</a></span>
<span class="normal"><a href="#__codelineno-0-4852">4852</a></span>
<span class="normal"><a href="#__codelineno-0-4853">4853</a></span>
<span class="normal"><a href="#__codelineno-0-4854">4854</a></span>
<span class="normal"><a href="#__codelineno-0-4855">4855</a></span>
<span class="normal"><a href="#__codelineno-0-4856">4856</a></span>
<span class="normal"><a href="#__codelineno-0-4857">4857</a></span>
<span class="normal"><a href="#__codelineno-0-4858">4858</a></span>
<span class="normal"><a href="#__codelineno-0-4859">4859</a></span>
<span class="normal"><a href="#__codelineno-0-4860">4860</a></span>
<span class="normal"><a href="#__codelineno-0-4861">4861</a></span>
<span class="normal"><a href="#__codelineno-0-4862">4862</a></span>
<span class="normal"><a href="#__codelineno-0-4863">4863</a></span>
<span class="normal"><a href="#__codelineno-0-4864">4864</a></span>
<span class="normal"><a href="#__codelineno-0-4865">4865</a></span>
<span class="normal"><a href="#__codelineno-0-4866">4866</a></span>
<span class="normal"><a href="#__codelineno-0-4867">4867</a></span>
<span class="normal"><a href="#__codelineno-0-4868">4868</a></span>
<span class="normal"><a href="#__codelineno-0-4869">4869</a></span>
<span class="normal"><a href="#__codelineno-0-4870">4870</a></span>
<span class="normal"><a href="#__codelineno-0-4871">4871</a></span>
<span class="normal"><a href="#__codelineno-0-4872">4872</a></span>
<span class="normal"><a href="#__codelineno-0-4873">4873</a></span>
<span class="normal"><a href="#__codelineno-0-4874">4874</a></span>
<span class="normal"><a href="#__codelineno-0-4875">4875</a></span>
<span class="normal"><a href="#__codelineno-0-4876">4876</a></span>
<span class="normal"><a href="#__codelineno-0-4877">4877</a></span>
<span class="normal"><a href="#__codelineno-0-4878">4878</a></span>
<span class="normal"><a href="#__codelineno-0-4879">4879</a></span>
<span class="normal"><a href="#__codelineno-0-4880">4880</a></span>
<span class="normal"><a href="#__codelineno-0-4881">4881</a></span>
<span class="normal"><a href="#__codelineno-0-4882">4882</a></span>
<span class="normal"><a href="#__codelineno-0-4883">4883</a></span>
<span class="normal"><a href="#__codelineno-0-4884">4884</a></span>
<span class="normal"><a href="#__codelineno-0-4885">4885</a></span>
<span class="normal"><a href="#__codelineno-0-4886">4886</a></span>
<span class="normal"><a href="#__codelineno-0-4887">4887</a></span>
<span class="normal"><a href="#__codelineno-0-4888">4888</a></span>
<span class="normal"><a href="#__codelineno-0-4889">4889</a></span>
<span class="normal"><a href="#__codelineno-0-4890">4890</a></span>
<span class="normal"><a href="#__codelineno-0-4891">4891</a></span>
<span class="normal"><a href="#__codelineno-0-4892">4892</a></span>
<span class="normal"><a href="#__codelineno-0-4893">4893</a></span>
<span class="normal"><a href="#__codelineno-0-4894">4894</a></span>
<span class="normal"><a href="#__codelineno-0-4895">4895</a></span>
<span class="normal"><a href="#__codelineno-0-4896">4896</a></span>
<span class="normal"><a href="#__codelineno-0-4897">4897</a></span>
<span class="normal"><a href="#__codelineno-0-4898">4898</a></span>
<span class="normal"><a href="#__codelineno-0-4899">4899</a></span>
<span class="normal"><a href="#__codelineno-0-4900">4900</a></span>
<span class="normal"><a href="#__codelineno-0-4901">4901</a></span>
<span class="normal"><a href="#__codelineno-0-4902">4902</a></span>
<span class="normal"><a href="#__codelineno-0-4903">4903</a></span>
<span class="normal"><a href="#__codelineno-0-4904">4904</a></span>
<span class="normal"><a href="#__codelineno-0-4905">4905</a></span>
<span class="normal"><a href="#__codelineno-0-4906">4906</a></span>
<span class="normal"><a href="#__codelineno-0-4907">4907</a></span>
<span class="normal"><a href="#__codelineno-0-4908">4908</a></span>
<span class="normal"><a href="#__codelineno-0-4909">4909</a></span>
<span class="normal"><a href="#__codelineno-0-4910">4910</a></span>
<span class="normal"><a href="#__codelineno-0-4911">4911</a></span>
<span class="normal"><a href="#__codelineno-0-4912">4912</a></span>
<span class="normal"><a href="#__codelineno-0-4913">4913</a></span>
<span class="normal"><a href="#__codelineno-0-4914">4914</a></span>
<span class="normal"><a href="#__codelineno-0-4915">4915</a></span>
<span class="normal"><a href="#__codelineno-0-4916">4916</a></span>
<span class="normal"><a href="#__codelineno-0-4917">4917</a></span>
<span class="normal"><a href="#__codelineno-0-4918">4918</a></span>
<span class="normal"><a href="#__codelineno-0-4919">4919</a></span>
<span class="normal"><a href="#__codelineno-0-4920">4920</a></span>
<span class="normal"><a href="#__codelineno-0-4921">4921</a></span>
<span class="normal"><a href="#__codelineno-0-4922">4922</a></span>
<span class="normal"><a href="#__codelineno-0-4923">4923</a></span>
<span class="normal"><a href="#__codelineno-0-4924">4924</a></span>
<span class="normal"><a href="#__codelineno-0-4925">4925</a></span>
<span class="normal"><a href="#__codelineno-0-4926">4926</a></span>
<span class="normal"><a href="#__codelineno-0-4927">4927</a></span>
<span class="normal"><a href="#__codelineno-0-4928">4928</a></span>
<span class="normal"><a href="#__codelineno-0-4929">4929</a></span>
<span class="normal"><a href="#__codelineno-0-4930">4930</a></span>
<span class="normal"><a href="#__codelineno-0-4931">4931</a></span>
<span class="normal"><a href="#__codelineno-0-4932">4932</a></span>
<span class="normal"><a href="#__codelineno-0-4933">4933</a></span>
<span class="normal"><a href="#__codelineno-0-4934">4934</a></span>
<span class="normal"><a href="#__codelineno-0-4935">4935</a></span>
<span class="normal"><a href="#__codelineno-0-4936">4936</a></span>
<span class="normal"><a href="#__codelineno-0-4937">4937</a></span>
<span class="normal"><a href="#__codelineno-0-4938">4938</a></span>
<span class="normal"><a href="#__codelineno-0-4939">4939</a></span>
<span class="normal"><a href="#__codelineno-0-4940">4940</a></span>
<span class="normal"><a href="#__codelineno-0-4941">4941</a></span>
<span class="normal"><a href="#__codelineno-0-4942">4942</a></span>
<span class="normal"><a href="#__codelineno-0-4943">4943</a></span>
<span class="normal"><a href="#__codelineno-0-4944">4944</a></span>
<span class="normal"><a href="#__codelineno-0-4945">4945</a></span>
<span class="normal"><a href="#__codelineno-0-4946">4946</a></span>
<span class="normal"><a href="#__codelineno-0-4947">4947</a></span>
<span class="normal"><a href="#__codelineno-0-4948">4948</a></span>
<span class="normal"><a href="#__codelineno-0-4949">4949</a></span>
<span class="normal"><a href="#__codelineno-0-4950">4950</a></span>
<span class="normal"><a href="#__codelineno-0-4951">4951</a></span>
<span class="normal"><a href="#__codelineno-0-4952">4952</a></span>
<span class="normal"><a href="#__codelineno-0-4953">4953</a></span>
<span class="normal"><a href="#__codelineno-0-4954">4954</a></span>
<span class="normal"><a href="#__codelineno-0-4955">4955</a></span>
<span class="normal"><a href="#__codelineno-0-4956">4956</a></span>
<span class="normal"><a href="#__codelineno-0-4957">4957</a></span>
<span class="normal"><a href="#__codelineno-0-4958">4958</a></span>
<span class="normal"><a href="#__codelineno-0-4959">4959</a></span>
<span class="normal"><a href="#__codelineno-0-4960">4960</a></span>
<span class="normal"><a href="#__codelineno-0-4961">4961</a></span>
<span class="normal"><a href="#__codelineno-0-4962">4962</a></span>
<span class="normal"><a href="#__codelineno-0-4963">4963</a></span>
<span class="normal"><a href="#__codelineno-0-4964">4964</a></span>
<span class="normal"><a href="#__codelineno-0-4965">4965</a></span>
<span class="normal"><a href="#__codelineno-0-4966">4966</a></span>
<span class="normal"><a href="#__codelineno-0-4967">4967</a></span>
<span class="normal"><a href="#__codelineno-0-4968">4968</a></span>
<span class="normal"><a href="#__codelineno-0-4969">4969</a></span>
<span class="normal"><a href="#__codelineno-0-4970">4970</a></span>
<span class="normal"><a href="#__codelineno-0-4971">4971</a></span>
<span class="normal"><a href="#__codelineno-0-4972">4972</a></span>
<span class="normal"><a href="#__codelineno-0-4973">4973</a></span>
<span class="normal"><a href="#__codelineno-0-4974">4974</a></span>
<span class="normal"><a href="#__codelineno-0-4975">4975</a></span>
<span class="normal"><a href="#__codelineno-0-4976">4976</a></span>
<span class="normal"><a href="#__codelineno-0-4977">4977</a></span>
<span class="normal"><a href="#__codelineno-0-4978">4978</a></span>
<span class="normal"><a href="#__codelineno-0-4979">4979</a></span>
<span class="normal"><a href="#__codelineno-0-4980">4980</a></span>
<span class="normal"><a href="#__codelineno-0-4981">4981</a></span>
<span class="normal"><a href="#__codelineno-0-4982">4982</a></span>
<span class="normal"><a href="#__codelineno-0-4983">4983</a></span>
<span class="normal"><a href="#__codelineno-0-4984">4984</a></span>
<span class="normal"><a href="#__codelineno-0-4985">4985</a></span>
<span class="normal"><a href="#__codelineno-0-4986">4986</a></span>
<span class="normal"><a href="#__codelineno-0-4987">4987</a></span>
<span class="normal"><a href="#__codelineno-0-4988">4988</a></span>
<span class="normal"><a href="#__codelineno-0-4989">4989</a></span>
<span class="normal"><a href="#__codelineno-0-4990">4990</a></span>
<span class="normal"><a href="#__codelineno-0-4991">4991</a></span>
<span class="normal"><a href="#__codelineno-0-4992">4992</a></span>
<span class="normal"><a href="#__codelineno-0-4993">4993</a></span>
<span class="normal"><a href="#__codelineno-0-4994">4994</a></span>
<span class="normal"><a href="#__codelineno-0-4995">4995</a></span>
<span class="normal"><a href="#__codelineno-0-4996">4996</a></span>
<span class="normal"><a href="#__codelineno-0-4997">4997</a></span>
<span class="normal"><a href="#__codelineno-0-4998">4998</a></span>
<span class="normal"><a href="#__codelineno-0-4999">4999</a></span>
<span class="normal"><a href="#__codelineno-0-5000">5000</a></span>
<span class="normal"><a href="#__codelineno-0-5001">5001</a></span>
<span class="normal"><a href="#__codelineno-0-5002">5002</a></span>
<span class="normal"><a href="#__codelineno-0-5003">5003</a></span>
<span class="normal"><a href="#__codelineno-0-5004">5004</a></span>
<span class="normal"><a href="#__codelineno-0-5005">5005</a></span>
<span class="normal"><a href="#__codelineno-0-5006">5006</a></span>
<span class="normal"><a href="#__codelineno-0-5007">5007</a></span>
<span class="normal"><a href="#__codelineno-0-5008">5008</a></span>
<span class="normal"><a href="#__codelineno-0-5009">5009</a></span>
<span class="normal"><a href="#__codelineno-0-5010">5010</a></span>
<span class="normal"><a href="#__codelineno-0-5011">5011</a></span>
<span class="normal"><a href="#__codelineno-0-5012">5012</a></span>
<span class="normal"><a href="#__codelineno-0-5013">5013</a></span>
<span class="normal"><a href="#__codelineno-0-5014">5014</a></span>
<span class="normal"><a href="#__codelineno-0-5015">5015</a></span>
<span class="normal"><a href="#__codelineno-0-5016">5016</a></span>
<span class="normal"><a href="#__codelineno-0-5017">5017</a></span>
<span class="normal"><a href="#__codelineno-0-5018">5018</a></span>
<span class="normal"><a href="#__codelineno-0-5019">5019</a></span>
<span class="normal"><a href="#__codelineno-0-5020">5020</a></span>
<span class="normal"><a href="#__codelineno-0-5021">5021</a></span>
<span class="normal"><a href="#__codelineno-0-5022">5022</a></span>
<span class="normal"><a href="#__codelineno-0-5023">5023</a></span>
<span class="normal"><a href="#__codelineno-0-5024">5024</a></span>
<span class="normal"><a href="#__codelineno-0-5025">5025</a></span>
<span class="normal"><a href="#__codelineno-0-5026">5026</a></span>
<span class="normal"><a href="#__codelineno-0-5027">5027</a></span>
<span class="normal"><a href="#__codelineno-0-5028">5028</a></span>
<span class="normal"><a href="#__codelineno-0-5029">5029</a></span>
<span class="normal"><a href="#__codelineno-0-5030">5030</a></span>
<span class="normal"><a href="#__codelineno-0-5031">5031</a></span>
<span class="normal"><a href="#__codelineno-0-5032">5032</a></span>
<span class="normal"><a href="#__codelineno-0-5033">5033</a></span>
<span class="normal"><a href="#__codelineno-0-5034">5034</a></span>
<span class="normal"><a href="#__codelineno-0-5035">5035</a></span>
<span class="normal"><a href="#__codelineno-0-5036">5036</a></span>
<span class="normal"><a href="#__codelineno-0-5037">5037</a></span>
<span class="normal"><a href="#__codelineno-0-5038">5038</a></span>
<span class="normal"><a href="#__codelineno-0-5039">5039</a></span>
<span class="normal"><a href="#__codelineno-0-5040">5040</a></span>
<span class="normal"><a href="#__codelineno-0-5041">5041</a></span>
<span class="normal"><a href="#__codelineno-0-5042">5042</a></span>
<span class="normal"><a href="#__codelineno-0-5043">5043</a></span>
<span class="normal"><a href="#__codelineno-0-5044">5044</a></span>
<span class="normal"><a href="#__codelineno-0-5045">5045</a></span>
<span class="normal"><a href="#__codelineno-0-5046">5046</a></span>
<span class="normal"><a href="#__codelineno-0-5047">5047</a></span>
<span class="normal"><a href="#__codelineno-0-5048">5048</a></span>
<span class="normal"><a href="#__codelineno-0-5049">5049</a></span>
<span class="normal"><a href="#__codelineno-0-5050">5050</a></span>
<span class="normal"><a href="#__codelineno-0-5051">5051</a></span>
<span class="normal"><a href="#__codelineno-0-5052">5052</a></span>
<span class="normal"><a href="#__codelineno-0-5053">5053</a></span>
<span class="normal"><a href="#__codelineno-0-5054">5054</a></span>
<span class="normal"><a href="#__codelineno-0-5055">5055</a></span>
<span class="normal"><a href="#__codelineno-0-5056">5056</a></span>
<span class="normal"><a href="#__codelineno-0-5057">5057</a></span>
<span class="normal"><a href="#__codelineno-0-5058">5058</a></span>
<span class="normal"><a href="#__codelineno-0-5059">5059</a></span>
<span class="normal"><a href="#__codelineno-0-5060">5060</a></span>
<span class="normal"><a href="#__codelineno-0-5061">5061</a></span>
<span class="normal"><a href="#__codelineno-0-5062">5062</a></span>
<span class="normal"><a href="#__codelineno-0-5063">5063</a></span>
<span class="normal"><a href="#__codelineno-0-5064">5064</a></span>
<span class="normal"><a href="#__codelineno-0-5065">5065</a></span>
<span class="normal"><a href="#__codelineno-0-5066">5066</a></span>
<span class="normal"><a href="#__codelineno-0-5067">5067</a></span>
<span class="normal"><a href="#__codelineno-0-5068">5068</a></span>
<span class="normal"><a href="#__codelineno-0-5069">5069</a></span>
<span class="normal"><a href="#__codelineno-0-5070">5070</a></span>
<span class="normal"><a href="#__codelineno-0-5071">5071</a></span>
<span class="normal"><a href="#__codelineno-0-5072">5072</a></span>
<span class="normal"><a href="#__codelineno-0-5073">5073</a></span>
<span class="normal"><a href="#__codelineno-0-5074">5074</a></span>
<span class="normal"><a href="#__codelineno-0-5075">5075</a></span>
<span class="normal"><a href="#__codelineno-0-5076">5076</a></span>
<span class="normal"><a href="#__codelineno-0-5077">5077</a></span>
<span class="normal"><a href="#__codelineno-0-5078">5078</a></span>
<span class="normal"><a href="#__codelineno-0-5079">5079</a></span>
<span class="normal"><a href="#__codelineno-0-5080">5080</a></span>
<span class="normal"><a href="#__codelineno-0-5081">5081</a></span>
<span class="normal"><a href="#__codelineno-0-5082">5082</a></span>
<span class="normal"><a href="#__codelineno-0-5083">5083</a></span>
<span class="normal"><a href="#__codelineno-0-5084">5084</a></span>
<span class="normal"><a href="#__codelineno-0-5085">5085</a></span>
<span class="normal"><a href="#__codelineno-0-5086">5086</a></span>
<span class="normal"><a href="#__codelineno-0-5087">5087</a></span>
<span class="normal"><a href="#__codelineno-0-5088">5088</a></span>
<span class="normal"><a href="#__codelineno-0-5089">5089</a></span>
<span class="normal"><a href="#__codelineno-0-5090">5090</a></span>
<span class="normal"><a href="#__codelineno-0-5091">5091</a></span>
<span class="normal"><a href="#__codelineno-0-5092">5092</a></span>
<span class="normal"><a href="#__codelineno-0-5093">5093</a></span>
<span class="normal"><a href="#__codelineno-0-5094">5094</a></span>
<span class="normal"><a href="#__codelineno-0-5095">5095</a></span>
<span class="normal"><a href="#__codelineno-0-5096">5096</a></span>
<span class="normal"><a href="#__codelineno-0-5097">5097</a></span>
<span class="normal"><a href="#__codelineno-0-5098">5098</a></span>
<span class="normal"><a href="#__codelineno-0-5099">5099</a></span>
<span class="normal"><a href="#__codelineno-0-5100">5100</a></span>
<span class="normal"><a href="#__codelineno-0-5101">5101</a></span>
<span class="normal"><a href="#__codelineno-0-5102">5102</a></span>
<span class="normal"><a href="#__codelineno-0-5103">5103</a></span>
<span class="normal"><a href="#__codelineno-0-5104">5104</a></span>
<span class="normal"><a href="#__codelineno-0-5105">5105</a></span>
<span class="normal"><a href="#__codelineno-0-5106">5106</a></span>
<span class="normal"><a href="#__codelineno-0-5107">5107</a></span>
<span class="normal"><a href="#__codelineno-0-5108">5108</a></span>
<span class="normal"><a href="#__codelineno-0-5109">5109</a></span>
<span class="normal"><a href="#__codelineno-0-5110">5110</a></span>
<span class="normal"><a href="#__codelineno-0-5111">5111</a></span>
<span class="normal"><a href="#__codelineno-0-5112">5112</a></span>
<span class="normal"><a href="#__codelineno-0-5113">5113</a></span>
<span class="normal"><a href="#__codelineno-0-5114">5114</a></span>
<span class="normal"><a href="#__codelineno-0-5115">5115</a></span>
<span class="normal"><a href="#__codelineno-0-5116">5116</a></span>
<span class="normal"><a href="#__codelineno-0-5117">5117</a></span>
<span class="normal"><a href="#__codelineno-0-5118">5118</a></span>
<span class="normal"><a href="#__codelineno-0-5119">5119</a></span>
<span class="normal"><a href="#__codelineno-0-5120">5120</a></span>
<span class="normal"><a href="#__codelineno-0-5121">5121</a></span>
<span class="normal"><a href="#__codelineno-0-5122">5122</a></span>
<span class="normal"><a href="#__codelineno-0-5123">5123</a></span>
<span class="normal"><a href="#__codelineno-0-5124">5124</a></span>
<span class="normal"><a href="#__codelineno-0-5125">5125</a></span>
<span class="normal"><a href="#__codelineno-0-5126">5126</a></span>
<span class="normal"><a href="#__codelineno-0-5127">5127</a></span>
<span class="normal"><a href="#__codelineno-0-5128">5128</a></span>
<span class="normal"><a href="#__codelineno-0-5129">5129</a></span>
<span class="normal"><a href="#__codelineno-0-5130">5130</a></span>
<span class="normal"><a href="#__codelineno-0-5131">5131</a></span>
<span class="normal"><a href="#__codelineno-0-5132">5132</a></span>
<span class="normal"><a href="#__codelineno-0-5133">5133</a></span>
<span class="normal"><a href="#__codelineno-0-5134">5134</a></span>
<span class="normal"><a href="#__codelineno-0-5135">5135</a></span>
<span class="normal"><a href="#__codelineno-0-5136">5136</a></span>
<span class="normal"><a href="#__codelineno-0-5137">5137</a></span>
<span class="normal"><a href="#__codelineno-0-5138">5138</a></span>
<span class="normal"><a href="#__codelineno-0-5139">5139</a></span>
<span class="normal"><a href="#__codelineno-0-5140">5140</a></span>
<span class="normal"><a href="#__codelineno-0-5141">5141</a></span>
<span class="normal"><a href="#__codelineno-0-5142">5142</a></span>
<span class="normal"><a href="#__codelineno-0-5143">5143</a></span>
<span class="normal"><a href="#__codelineno-0-5144">5144</a></span>
<span class="normal"><a href="#__codelineno-0-5145">5145</a></span>
<span class="normal"><a href="#__codelineno-0-5146">5146</a></span>
<span class="normal"><a href="#__codelineno-0-5147">5147</a></span>
<span class="normal"><a href="#__codelineno-0-5148">5148</a></span>
<span class="normal"><a href="#__codelineno-0-5149">5149</a></span>
<span class="normal"><a href="#__codelineno-0-5150">5150</a></span>
<span class="normal"><a href="#__codelineno-0-5151">5151</a></span>
<span class="normal"><a href="#__codelineno-0-5152">5152</a></span>
<span class="normal"><a href="#__codelineno-0-5153">5153</a></span>
<span class="normal"><a href="#__codelineno-0-5154">5154</a></span>
<span class="normal"><a href="#__codelineno-0-5155">5155</a></span>
<span class="normal"><a href="#__codelineno-0-5156">5156</a></span>
<span class="normal"><a href="#__codelineno-0-5157">5157</a></span>
<span class="normal"><a href="#__codelineno-0-5158">5158</a></span>
<span class="normal"><a href="#__codelineno-0-5159">5159</a></span>
<span class="normal"><a href="#__codelineno-0-5160">5160</a></span>
<span class="normal"><a href="#__codelineno-0-5161">5161</a></span>
<span class="normal"><a href="#__codelineno-0-5162">5162</a></span>
<span class="normal"><a href="#__codelineno-0-5163">5163</a></span>
<span class="normal"><a href="#__codelineno-0-5164">5164</a></span>
<span class="normal"><a href="#__codelineno-0-5165">5165</a></span>
<span class="normal"><a href="#__codelineno-0-5166">5166</a></span>
<span class="normal"><a href="#__codelineno-0-5167">5167</a></span>
<span class="normal"><a href="#__codelineno-0-5168">5168</a></span>
<span class="normal"><a href="#__codelineno-0-5169">5169</a></span>
<span class="normal"><a href="#__codelineno-0-5170">5170</a></span>
<span class="normal"><a href="#__codelineno-0-5171">5171</a></span>
<span class="normal"><a href="#__codelineno-0-5172">5172</a></span>
<span class="normal"><a href="#__codelineno-0-5173">5173</a></span>
<span class="normal"><a href="#__codelineno-0-5174">5174</a></span>
<span class="normal"><a href="#__codelineno-0-5175">5175</a></span>
<span class="normal"><a href="#__codelineno-0-5176">5176</a></span>
<span class="normal"><a href="#__codelineno-0-5177">5177</a></span>
<span class="normal"><a href="#__codelineno-0-5178">5178</a></span>
<span class="normal"><a href="#__codelineno-0-5179">5179</a></span>
<span class="normal"><a href="#__codelineno-0-5180">5180</a></span>
<span class="normal"><a href="#__codelineno-0-5181">5181</a></span>
<span class="normal"><a href="#__codelineno-0-5182">5182</a></span>
<span class="normal"><a href="#__codelineno-0-5183">5183</a></span>
<span class="normal"><a href="#__codelineno-0-5184">5184</a></span>
<span class="normal"><a href="#__codelineno-0-5185">5185</a></span>
<span class="normal"><a href="#__codelineno-0-5186">5186</a></span>
<span class="normal"><a href="#__codelineno-0-5187">5187</a></span>
<span class="normal"><a href="#__codelineno-0-5188">5188</a></span>
<span class="normal"><a href="#__codelineno-0-5189">5189</a></span>
<span class="normal"><a href="#__codelineno-0-5190">5190</a></span>
<span class="normal"><a href="#__codelineno-0-5191">5191</a></span>
<span class="normal"><a href="#__codelineno-0-5192">5192</a></span>
<span class="normal"><a href="#__codelineno-0-5193">5193</a></span>
<span class="normal"><a href="#__codelineno-0-5194">5194</a></span>
<span class="normal"><a href="#__codelineno-0-5195">5195</a></span>
<span class="normal"><a href="#__codelineno-0-5196">5196</a></span>
<span class="normal"><a href="#__codelineno-0-5197">5197</a></span>
<span class="normal"><a href="#__codelineno-0-5198">5198</a></span>
<span class="normal"><a href="#__codelineno-0-5199">5199</a></span>
<span class="normal"><a href="#__codelineno-0-5200">5200</a></span>
<span class="normal"><a href="#__codelineno-0-5201">5201</a></span>
<span class="normal"><a href="#__codelineno-0-5202">5202</a></span>
<span class="normal"><a href="#__codelineno-0-5203">5203</a></span>
<span class="normal"><a href="#__codelineno-0-5204">5204</a></span>
<span class="normal"><a href="#__codelineno-0-5205">5205</a></span>
<span class="normal"><a href="#__codelineno-0-5206">5206</a></span>
<span class="normal"><a href="#__codelineno-0-5207">5207</a></span>
<span class="normal"><a href="#__codelineno-0-5208">5208</a></span>
<span class="normal"><a href="#__codelineno-0-5209">5209</a></span>
<span class="normal"><a href="#__codelineno-0-5210">5210</a></span>
<span class="normal"><a href="#__codelineno-0-5211">5211</a></span>
<span class="normal"><a href="#__codelineno-0-5212">5212</a></span>
<span class="normal"><a href="#__codelineno-0-5213">5213</a></span>
<span class="normal"><a href="#__codelineno-0-5214">5214</a></span>
<span class="normal"><a href="#__codelineno-0-5215">5215</a></span>
<span class="normal"><a href="#__codelineno-0-5216">5216</a></span>
<span class="normal"><a href="#__codelineno-0-5217">5217</a></span>
<span class="normal"><a href="#__codelineno-0-5218">5218</a></span>
<span class="normal"><a href="#__codelineno-0-5219">5219</a></span>
<span class="normal"><a href="#__codelineno-0-5220">5220</a></span>
<span class="normal"><a href="#__codelineno-0-5221">5221</a></span>
<span class="normal"><a href="#__codelineno-0-5222">5222</a></span>
<span class="normal"><a href="#__codelineno-0-5223">5223</a></span>
<span class="normal"><a href="#__codelineno-0-5224">5224</a></span>
<span class="normal"><a href="#__codelineno-0-5225">5225</a></span>
<span class="normal"><a href="#__codelineno-0-5226">5226</a></span>
<span class="normal"><a href="#__codelineno-0-5227">5227</a></span>
<span class="normal"><a href="#__codelineno-0-5228">5228</a></span>
<span class="normal"><a href="#__codelineno-0-5229">5229</a></span>
<span class="normal"><a href="#__codelineno-0-5230">5230</a></span>
<span class="normal"><a href="#__codelineno-0-5231">5231</a></span>
<span class="normal"><a href="#__codelineno-0-5232">5232</a></span>
<span class="normal"><a href="#__codelineno-0-5233">5233</a></span>
<span class="normal"><a href="#__codelineno-0-5234">5234</a></span>
<span class="normal"><a href="#__codelineno-0-5235">5235</a></span>
<span class="normal"><a href="#__codelineno-0-5236">5236</a></span>
<span class="normal"><a href="#__codelineno-0-5237">5237</a></span>
<span class="normal"><a href="#__codelineno-0-5238">5238</a></span>
<span class="normal"><a href="#__codelineno-0-5239">5239</a></span>
<span class="normal"><a href="#__codelineno-0-5240">5240</a></span>
<span class="normal"><a href="#__codelineno-0-5241">5241</a></span>
<span class="normal"><a href="#__codelineno-0-5242">5242</a></span>
<span class="normal"><a href="#__codelineno-0-5243">5243</a></span>
<span class="normal"><a href="#__codelineno-0-5244">5244</a></span>
<span class="normal"><a href="#__codelineno-0-5245">5245</a></span>
<span class="normal"><a href="#__codelineno-0-5246">5246</a></span>
<span class="normal"><a href="#__codelineno-0-5247">5247</a></span>
<span class="normal"><a href="#__codelineno-0-5248">5248</a></span>
<span class="normal"><a href="#__codelineno-0-5249">5249</a></span>
<span class="normal"><a href="#__codelineno-0-5250">5250</a></span>
<span class="normal"><a href="#__codelineno-0-5251">5251</a></span>
<span class="normal"><a href="#__codelineno-0-5252">5252</a></span>
<span class="normal"><a href="#__codelineno-0-5253">5253</a></span>
<span class="normal"><a href="#__codelineno-0-5254">5254</a></span>
<span class="normal"><a href="#__codelineno-0-5255">5255</a></span>
<span class="normal"><a href="#__codelineno-0-5256">5256</a></span>
<span class="normal"><a href="#__codelineno-0-5257">5257</a></span>
<span class="normal"><a href="#__codelineno-0-5258">5258</a></span>
<span class="normal"><a href="#__codelineno-0-5259">5259</a></span>
<span class="normal"><a href="#__codelineno-0-5260">5260</a></span>
<span class="normal"><a href="#__codelineno-0-5261">5261</a></span>
<span class="normal"><a href="#__codelineno-0-5262">5262</a></span>
<span class="normal"><a href="#__codelineno-0-5263">5263</a></span>
<span class="normal"><a href="#__codelineno-0-5264">5264</a></span>
<span class="normal"><a href="#__codelineno-0-5265">5265</a></span>
<span class="normal"><a href="#__codelineno-0-5266">5266</a></span>
<span class="normal"><a href="#__codelineno-0-5267">5267</a></span>
<span class="normal"><a href="#__codelineno-0-5268">5268</a></span>
<span class="normal"><a href="#__codelineno-0-5269">5269</a></span>
<span class="normal"><a href="#__codelineno-0-5270">5270</a></span>
<span class="normal"><a href="#__codelineno-0-5271">5271</a></span>
<span class="normal"><a href="#__codelineno-0-5272">5272</a></span>
<span class="normal"><a href="#__codelineno-0-5273">5273</a></span>
<span class="normal"><a href="#__codelineno-0-5274">5274</a></span>
<span class="normal"><a href="#__codelineno-0-5275">5275</a></span>
<span class="normal"><a href="#__codelineno-0-5276">5276</a></span>
<span class="normal"><a href="#__codelineno-0-5277">5277</a></span>
<span class="normal"><a href="#__codelineno-0-5278">5278</a></span>
<span class="normal"><a href="#__codelineno-0-5279">5279</a></span>
<span class="normal"><a href="#__codelineno-0-5280">5280</a></span>
<span class="normal"><a href="#__codelineno-0-5281">5281</a></span>
<span class="normal"><a href="#__codelineno-0-5282">5282</a></span>
<span class="normal"><a href="#__codelineno-0-5283">5283</a></span>
<span class="normal"><a href="#__codelineno-0-5284">5284</a></span>
<span class="normal"><a href="#__codelineno-0-5285">5285</a></span>
<span class="normal"><a href="#__codelineno-0-5286">5286</a></span>
<span class="normal"><a href="#__codelineno-0-5287">5287</a></span>
<span class="normal"><a href="#__codelineno-0-5288">5288</a></span>
<span class="normal"><a href="#__codelineno-0-5289">5289</a></span>
<span class="normal"><a href="#__codelineno-0-5290">5290</a></span>
<span class="normal"><a href="#__codelineno-0-5291">5291</a></span>
<span class="normal"><a href="#__codelineno-0-5292">5292</a></span>
<span class="normal"><a href="#__codelineno-0-5293">5293</a></span>
<span class="normal"><a href="#__codelineno-0-5294">5294</a></span>
<span class="normal"><a href="#__codelineno-0-5295">5295</a></span>
<span class="normal"><a href="#__codelineno-0-5296">5296</a></span>
<span class="normal"><a href="#__codelineno-0-5297">5297</a></span>
<span class="normal"><a href="#__codelineno-0-5298">5298</a></span>
<span class="normal"><a href="#__codelineno-0-5299">5299</a></span>
<span class="normal"><a href="#__codelineno-0-5300">5300</a></span>
<span class="normal"><a href="#__codelineno-0-5301">5301</a></span>
<span class="normal"><a href="#__codelineno-0-5302">5302</a></span>
<span class="normal"><a href="#__codelineno-0-5303">5303</a></span>
<span class="normal"><a href="#__codelineno-0-5304">5304</a></span>
<span class="normal"><a href="#__codelineno-0-5305">5305</a></span>
<span class="normal"><a href="#__codelineno-0-5306">5306</a></span>
<span class="normal"><a href="#__codelineno-0-5307">5307</a></span>
<span class="normal"><a href="#__codelineno-0-5308">5308</a></span>
<span class="normal"><a href="#__codelineno-0-5309">5309</a></span>
<span class="normal"><a href="#__codelineno-0-5310">5310</a></span>
<span class="normal"><a href="#__codelineno-0-5311">5311</a></span>
<span class="normal"><a href="#__codelineno-0-5312">5312</a></span>
<span class="normal"><a href="#__codelineno-0-5313">5313</a></span>
<span class="normal"><a href="#__codelineno-0-5314">5314</a></span>
<span class="normal"><a href="#__codelineno-0-5315">5315</a></span>
<span class="normal"><a href="#__codelineno-0-5316">5316</a></span>
<span class="normal"><a href="#__codelineno-0-5317">5317</a></span>
<span class="normal"><a href="#__codelineno-0-5318">5318</a></span>
<span class="normal"><a href="#__codelineno-0-5319">5319</a></span>
<span class="normal"><a href="#__codelineno-0-5320">5320</a></span>
<span class="normal"><a href="#__codelineno-0-5321">5321</a></span>
<span class="normal"><a href="#__codelineno-0-5322">5322</a></span>
<span class="normal"><a href="#__codelineno-0-5323">5323</a></span>
<span class="normal"><a href="#__codelineno-0-5324">5324</a></span>
<span class="normal"><a href="#__codelineno-0-5325">5325</a></span>
<span class="normal"><a href="#__codelineno-0-5326">5326</a></span>
<span class="normal"><a href="#__codelineno-0-5327">5327</a></span>
<span class="normal"><a href="#__codelineno-0-5328">5328</a></span>
<span class="normal"><a href="#__codelineno-0-5329">5329</a></span>
<span class="normal"><a href="#__codelineno-0-5330">5330</a></span>
<span class="normal"><a href="#__codelineno-0-5331">5331</a></span>
<span class="normal"><a href="#__codelineno-0-5332">5332</a></span>
<span class="normal"><a href="#__codelineno-0-5333">5333</a></span>
<span class="normal"><a href="#__codelineno-0-5334">5334</a></span>
<span class="normal"><a href="#__codelineno-0-5335">5335</a></span>
<span class="normal"><a href="#__codelineno-0-5336">5336</a></span>
<span class="normal"><a href="#__codelineno-0-5337">5337</a></span>
<span class="normal"><a href="#__codelineno-0-5338">5338</a></span>
<span class="normal"><a href="#__codelineno-0-5339">5339</a></span>
<span class="normal"><a href="#__codelineno-0-5340">5340</a></span>
<span class="normal"><a href="#__codelineno-0-5341">5341</a></span>
<span class="normal"><a href="#__codelineno-0-5342">5342</a></span>
<span class="normal"><a href="#__codelineno-0-5343">5343</a></span>
<span class="normal"><a href="#__codelineno-0-5344">5344</a></span>
<span class="normal"><a href="#__codelineno-0-5345">5345</a></span>
<span class="normal"><a href="#__codelineno-0-5346">5346</a></span>
<span class="normal"><a href="#__codelineno-0-5347">5347</a></span>
<span class="normal"><a href="#__codelineno-0-5348">5348</a></span>
<span class="normal"><a href="#__codelineno-0-5349">5349</a></span>
<span class="normal"><a href="#__codelineno-0-5350">5350</a></span>
<span class="normal"><a href="#__codelineno-0-5351">5351</a></span>
<span class="normal"><a href="#__codelineno-0-5352">5352</a></span>
<span class="normal"><a href="#__codelineno-0-5353">5353</a></span>
<span class="normal"><a href="#__codelineno-0-5354">5354</a></span>
<span class="normal"><a href="#__codelineno-0-5355">5355</a></span>
<span class="normal"><a href="#__codelineno-0-5356">5356</a></span>
<span class="normal"><a href="#__codelineno-0-5357">5357</a></span>
<span class="normal"><a href="#__codelineno-0-5358">5358</a></span>
<span class="normal"><a href="#__codelineno-0-5359">5359</a></span>
<span class="normal"><a href="#__codelineno-0-5360">5360</a></span>
<span class="normal"><a href="#__codelineno-0-5361">5361</a></span>
<span class="normal"><a href="#__codelineno-0-5362">5362</a></span>
<span class="normal"><a href="#__codelineno-0-5363">5363</a></span>
<span class="normal"><a href="#__codelineno-0-5364">5364</a></span>
<span class="normal"><a href="#__codelineno-0-5365">5365</a></span>
<span class="normal"><a href="#__codelineno-0-5366">5366</a></span>
<span class="normal"><a href="#__codelineno-0-5367">5367</a></span>
<span class="normal"><a href="#__codelineno-0-5368">5368</a></span>
<span class="normal"><a href="#__codelineno-0-5369">5369</a></span>
<span class="normal"><a href="#__codelineno-0-5370">5370</a></span>
<span class="normal"><a href="#__codelineno-0-5371">5371</a></span>
<span class="normal"><a href="#__codelineno-0-5372">5372</a></span>
<span class="normal"><a href="#__codelineno-0-5373">5373</a></span>
<span class="normal"><a href="#__codelineno-0-5374">5374</a></span>
<span class="normal"><a href="#__codelineno-0-5375">5375</a></span>
<span class="normal"><a href="#__codelineno-0-5376">5376</a></span>
<span class="normal"><a href="#__codelineno-0-5377">5377</a></span>
<span class="normal"><a href="#__codelineno-0-5378">5378</a></span>
<span class="normal"><a href="#__codelineno-0-5379">5379</a></span>
<span class="normal"><a href="#__codelineno-0-5380">5380</a></span>
<span class="normal"><a href="#__codelineno-0-5381">5381</a></span>
<span class="normal"><a href="#__codelineno-0-5382">5382</a></span>
<span class="normal"><a href="#__codelineno-0-5383">5383</a></span>
<span class="normal"><a href="#__codelineno-0-5384">5384</a></span>
<span class="normal"><a href="#__codelineno-0-5385">5385</a></span>
<span class="normal"><a href="#__codelineno-0-5386">5386</a></span>
<span class="normal"><a href="#__codelineno-0-5387">5387</a></span>
<span class="normal"><a href="#__codelineno-0-5388">5388</a></span>
<span class="normal"><a href="#__codelineno-0-5389">5389</a></span>
<span class="normal"><a href="#__codelineno-0-5390">5390</a></span>
<span class="normal"><a href="#__codelineno-0-5391">5391</a></span>
<span class="normal"><a href="#__codelineno-0-5392">5392</a></span>
<span class="normal"><a href="#__codelineno-0-5393">5393</a></span>
<span class="normal"><a href="#__codelineno-0-5394">5394</a></span>
<span class="normal"><a href="#__codelineno-0-5395">5395</a></span>
<span class="normal"><a href="#__codelineno-0-5396">5396</a></span>
<span class="normal"><a href="#__codelineno-0-5397">5397</a></span>
<span class="normal"><a href="#__codelineno-0-5398">5398</a></span>
<span class="normal"><a href="#__codelineno-0-5399">5399</a></span>
<span class="normal"><a href="#__codelineno-0-5400">5400</a></span>
<span class="normal"><a href="#__codelineno-0-5401">5401</a></span>
<span class="normal"><a href="#__codelineno-0-5402">5402</a></span>
<span class="normal"><a href="#__codelineno-0-5403">5403</a></span>
<span class="normal"><a href="#__codelineno-0-5404">5404</a></span>
<span class="normal"><a href="#__codelineno-0-5405">5405</a></span>
<span class="normal"><a href="#__codelineno-0-5406">5406</a></span>
<span class="normal"><a href="#__codelineno-0-5407">5407</a></span>
<span class="normal"><a href="#__codelineno-0-5408">5408</a></span>
<span class="normal"><a href="#__codelineno-0-5409">5409</a></span>
<span class="normal"><a href="#__codelineno-0-5410">5410</a></span>
<span class="normal"><a href="#__codelineno-0-5411">5411</a></span>
<span class="normal"><a href="#__codelineno-0-5412">5412</a></span>
<span class="normal"><a href="#__codelineno-0-5413">5413</a></span>
<span class="normal"><a href="#__codelineno-0-5414">5414</a></span>
<span class="normal"><a href="#__codelineno-0-5415">5415</a></span>
<span class="normal"><a href="#__codelineno-0-5416">5416</a></span>
<span class="normal"><a href="#__codelineno-0-5417">5417</a></span>
<span class="normal"><a href="#__codelineno-0-5418">5418</a></span>
<span class="normal"><a href="#__codelineno-0-5419">5419</a></span>
<span class="normal"><a href="#__codelineno-0-5420">5420</a></span>
<span class="normal"><a href="#__codelineno-0-5421">5421</a></span>
<span class="normal"><a href="#__codelineno-0-5422">5422</a></span>
<span class="normal"><a href="#__codelineno-0-5423">5423</a></span>
<span class="normal"><a href="#__codelineno-0-5424">5424</a></span>
<span class="normal"><a href="#__codelineno-0-5425">5425</a></span>
<span class="normal"><a href="#__codelineno-0-5426">5426</a></span>
<span class="normal"><a href="#__codelineno-0-5427">5427</a></span>
<span class="normal"><a href="#__codelineno-0-5428">5428</a></span>
<span class="normal"><a href="#__codelineno-0-5429">5429</a></span>
<span class="normal"><a href="#__codelineno-0-5430">5430</a></span>
<span class="normal"><a href="#__codelineno-0-5431">5431</a></span>
<span class="normal"><a href="#__codelineno-0-5432">5432</a></span>
<span class="normal"><a href="#__codelineno-0-5433">5433</a></span>
<span class="normal"><a href="#__codelineno-0-5434">5434</a></span>
<span class="normal"><a href="#__codelineno-0-5435">5435</a></span>
<span class="normal"><a href="#__codelineno-0-5436">5436</a></span>
<span class="normal"><a href="#__codelineno-0-5437">5437</a></span>
<span class="normal"><a href="#__codelineno-0-5438">5438</a></span>
<span class="normal"><a href="#__codelineno-0-5439">5439</a></span>
<span class="normal"><a href="#__codelineno-0-5440">5440</a></span>
<span class="normal"><a href="#__codelineno-0-5441">5441</a></span>
<span class="normal"><a href="#__codelineno-0-5442">5442</a></span>
<span class="normal"><a href="#__codelineno-0-5443">5443</a></span>
<span class="normal"><a href="#__codelineno-0-5444">5444</a></span>
<span class="normal"><a href="#__codelineno-0-5445">5445</a></span>
<span class="normal"><a href="#__codelineno-0-5446">5446</a></span>
<span class="normal"><a href="#__codelineno-0-5447">5447</a></span>
<span class="normal"><a href="#__codelineno-0-5448">5448</a></span>
<span class="normal"><a href="#__codelineno-0-5449">5449</a></span>
<span class="normal"><a href="#__codelineno-0-5450">5450</a></span>
<span class="normal"><a href="#__codelineno-0-5451">5451</a></span>
<span class="normal"><a href="#__codelineno-0-5452">5452</a></span>
<span class="normal"><a href="#__codelineno-0-5453">5453</a></span>
<span class="normal"><a href="#__codelineno-0-5454">5454</a></span>
<span class="normal"><a href="#__codelineno-0-5455">5455</a></span>
<span class="normal"><a href="#__codelineno-0-5456">5456</a></span>
<span class="normal"><a href="#__codelineno-0-5457">5457</a></span>
<span class="normal"><a href="#__codelineno-0-5458">5458</a></span>
<span class="normal"><a href="#__codelineno-0-5459">5459</a></span>
<span class="normal"><a href="#__codelineno-0-5460">5460</a></span>
<span class="normal"><a href="#__codelineno-0-5461">5461</a></span>
<span class="normal"><a href="#__codelineno-0-5462">5462</a></span>
<span class="normal"><a href="#__codelineno-0-5463">5463</a></span>
<span class="normal"><a href="#__codelineno-0-5464">5464</a></span>
<span class="normal"><a href="#__codelineno-0-5465">5465</a></span>
<span class="normal"><a href="#__codelineno-0-5466">5466</a></span>
<span class="normal"><a href="#__codelineno-0-5467">5467</a></span>
<span class="normal"><a href="#__codelineno-0-5468">5468</a></span>
<span class="normal"><a href="#__codelineno-0-5469">5469</a></span>
<span class="normal"><a href="#__codelineno-0-5470">5470</a></span>
<span class="normal"><a href="#__codelineno-0-5471">5471</a></span>
<span class="normal"><a href="#__codelineno-0-5472">5472</a></span>
<span class="normal"><a href="#__codelineno-0-5473">5473</a></span>
<span class="normal"><a href="#__codelineno-0-5474">5474</a></span>
<span class="normal"><a href="#__codelineno-0-5475">5475</a></span>
<span class="normal"><a href="#__codelineno-0-5476">5476</a></span>
<span class="normal"><a href="#__codelineno-0-5477">5477</a></span>
<span class="normal"><a href="#__codelineno-0-5478">5478</a></span>
<span class="normal"><a href="#__codelineno-0-5479">5479</a></span>
<span class="normal"><a href="#__codelineno-0-5480">5480</a></span>
<span class="normal"><a href="#__codelineno-0-5481">5481</a></span>
<span class="normal"><a href="#__codelineno-0-5482">5482</a></span>
<span class="normal"><a href="#__codelineno-0-5483">5483</a></span>
<span class="normal"><a href="#__codelineno-0-5484">5484</a></span>
<span class="normal"><a href="#__codelineno-0-5485">5485</a></span>
<span class="normal"><a href="#__codelineno-0-5486">5486</a></span>
<span class="normal"><a href="#__codelineno-0-5487">5487</a></span>
<span class="normal"><a href="#__codelineno-0-5488">5488</a></span>
<span class="normal"><a href="#__codelineno-0-5489">5489</a></span>
<span class="normal"><a href="#__codelineno-0-5490">5490</a></span>
<span class="normal"><a href="#__codelineno-0-5491">5491</a></span>
<span class="normal"><a href="#__codelineno-0-5492">5492</a></span>
<span class="normal"><a href="#__codelineno-0-5493">5493</a></span>
<span class="normal"><a href="#__codelineno-0-5494">5494</a></span>
<span class="normal"><a href="#__codelineno-0-5495">5495</a></span>
<span class="normal"><a href="#__codelineno-0-5496">5496</a></span>
<span class="normal"><a href="#__codelineno-0-5497">5497</a></span>
<span class="normal"><a href="#__codelineno-0-5498">5498</a></span>
<span class="normal"><a href="#__codelineno-0-5499">5499</a></span>
<span class="normal"><a href="#__codelineno-0-5500">5500</a></span>
<span class="normal"><a href="#__codelineno-0-5501">5501</a></span>
<span class="normal"><a href="#__codelineno-0-5502">5502</a></span>
<span class="normal"><a href="#__codelineno-0-5503">5503</a></span>
<span class="normal"><a href="#__codelineno-0-5504">5504</a></span>
<span class="normal"><a href="#__codelineno-0-5505">5505</a></span>
<span class="normal"><a href="#__codelineno-0-5506">5506</a></span>
<span class="normal"><a href="#__codelineno-0-5507">5507</a></span>
<span class="normal"><a href="#__codelineno-0-5508">5508</a></span>
<span class="normal"><a href="#__codelineno-0-5509">5509</a></span>
<span class="normal"><a href="#__codelineno-0-5510">5510</a></span>
<span class="normal"><a href="#__codelineno-0-5511">5511</a></span>
<span class="normal"><a href="#__codelineno-0-5512">5512</a></span>
<span class="normal"><a href="#__codelineno-0-5513">5513</a></span>
<span class="normal"><a href="#__codelineno-0-5514">5514</a></span>
<span class="normal"><a href="#__codelineno-0-5515">5515</a></span>
<span class="normal"><a href="#__codelineno-0-5516">5516</a></span>
<span class="normal"><a href="#__codelineno-0-5517">5517</a></span>
<span class="normal"><a href="#__codelineno-0-5518">5518</a></span>
<span class="normal"><a href="#__codelineno-0-5519">5519</a></span>
<span class="normal"><a href="#__codelineno-0-5520">5520</a></span>
<span class="normal"><a href="#__codelineno-0-5521">5521</a></span>
<span class="normal"><a href="#__codelineno-0-5522">5522</a></span>
<span class="normal"><a href="#__codelineno-0-5523">5523</a></span>
<span class="normal"><a href="#__codelineno-0-5524">5524</a></span>
<span class="normal"><a href="#__codelineno-0-5525">5525</a></span>
<span class="normal"><a href="#__codelineno-0-5526">5526</a></span>
<span class="normal"><a href="#__codelineno-0-5527">5527</a></span>
<span class="normal"><a href="#__codelineno-0-5528">5528</a></span>
<span class="normal"><a href="#__codelineno-0-5529">5529</a></span>
<span class="normal"><a href="#__codelineno-0-5530">5530</a></span>
<span class="normal"><a href="#__codelineno-0-5531">5531</a></span>
<span class="normal"><a href="#__codelineno-0-5532">5532</a></span>
<span class="normal"><a href="#__codelineno-0-5533">5533</a></span>
<span class="normal"><a href="#__codelineno-0-5534">5534</a></span>
<span class="normal"><a href="#__codelineno-0-5535">5535</a></span>
<span class="normal"><a href="#__codelineno-0-5536">5536</a></span>
<span class="normal"><a href="#__codelineno-0-5537">5537</a></span>
<span class="normal"><a href="#__codelineno-0-5538">5538</a></span>
<span class="normal"><a href="#__codelineno-0-5539">5539</a></span>
<span class="normal"><a href="#__codelineno-0-5540">5540</a></span>
<span class="normal"><a href="#__codelineno-0-5541">5541</a></span>
<span class="normal"><a href="#__codelineno-0-5542">5542</a></span>
<span class="normal"><a href="#__codelineno-0-5543">5543</a></span>
<span class="normal"><a href="#__codelineno-0-5544">5544</a></span>
<span class="normal"><a href="#__codelineno-0-5545">5545</a></span>
<span class="normal"><a href="#__codelineno-0-5546">5546</a></span>
<span class="normal"><a href="#__codelineno-0-5547">5547</a></span>
<span class="normal"><a href="#__codelineno-0-5548">5548</a></span>
<span class="normal"><a href="#__codelineno-0-5549">5549</a></span>
<span class="normal"><a href="#__codelineno-0-5550">5550</a></span>
<span class="normal"><a href="#__codelineno-0-5551">5551</a></span>
<span class="normal"><a href="#__codelineno-0-5552">5552</a></span>
<span class="normal"><a href="#__codelineno-0-5553">5553</a></span>
<span class="normal"><a href="#__codelineno-0-5554">5554</a></span>
<span class="normal"><a href="#__codelineno-0-5555">5555</a></span>
<span class="normal"><a href="#__codelineno-0-5556">5556</a></span>
<span class="normal"><a href="#__codelineno-0-5557">5557</a></span>
<span class="normal"><a href="#__codelineno-0-5558">5558</a></span>
<span class="normal"><a href="#__codelineno-0-5559">5559</a></span>
<span class="normal"><a href="#__codelineno-0-5560">5560</a></span>
<span class="normal"><a href="#__codelineno-0-5561">5561</a></span>
<span class="normal"><a href="#__codelineno-0-5562">5562</a></span>
<span class="normal"><a href="#__codelineno-0-5563">5563</a></span>
<span class="normal"><a href="#__codelineno-0-5564">5564</a></span>
<span class="normal"><a href="#__codelineno-0-5565">5565</a></span>
<span class="normal"><a href="#__codelineno-0-5566">5566</a></span>
<span class="normal"><a href="#__codelineno-0-5567">5567</a></span>
<span class="normal"><a href="#__codelineno-0-5568">5568</a></span>
<span class="normal"><a href="#__codelineno-0-5569">5569</a></span>
<span class="normal"><a href="#__codelineno-0-5570">5570</a></span>
<span class="normal"><a href="#__codelineno-0-5571">5571</a></span>
<span class="normal"><a href="#__codelineno-0-5572">5572</a></span>
<span class="normal"><a href="#__codelineno-0-5573">5573</a></span>
<span class="normal"><a href="#__codelineno-0-5574">5574</a></span>
<span class="normal"><a href="#__codelineno-0-5575">5575</a></span>
<span class="normal"><a href="#__codelineno-0-5576">5576</a></span>
<span class="normal"><a href="#__codelineno-0-5577">5577</a></span>
<span class="normal"><a href="#__codelineno-0-5578">5578</a></span>
<span class="normal"><a href="#__codelineno-0-5579">5579</a></span>
<span class="normal"><a href="#__codelineno-0-5580">5580</a></span>
<span class="normal"><a href="#__codelineno-0-5581">5581</a></span>
<span class="normal"><a href="#__codelineno-0-5582">5582</a></span>
<span class="normal"><a href="#__codelineno-0-5583">5583</a></span>
<span class="normal"><a href="#__codelineno-0-5584">5584</a></span>
<span class="normal"><a href="#__codelineno-0-5585">5585</a></span>
<span class="normal"><a href="#__codelineno-0-5586">5586</a></span>
<span class="normal"><a href="#__codelineno-0-5587">5587</a></span>
<span class="normal"><a href="#__codelineno-0-5588">5588</a></span>
<span class="normal"><a href="#__codelineno-0-5589">5589</a></span>
<span class="normal"><a href="#__codelineno-0-5590">5590</a></span>
<span class="normal"><a href="#__codelineno-0-5591">5591</a></span>
<span class="normal"><a href="#__codelineno-0-5592">5592</a></span>
<span class="normal"><a href="#__codelineno-0-5593">5593</a></span>
<span class="normal"><a href="#__codelineno-0-5594">5594</a></span>
<span class="normal"><a href="#__codelineno-0-5595">5595</a></span>
<span class="normal"><a href="#__codelineno-0-5596">5596</a></span>
<span class="normal"><a href="#__codelineno-0-5597">5597</a></span>
<span class="normal"><a href="#__codelineno-0-5598">5598</a></span>
<span class="normal"><a href="#__codelineno-0-5599">5599</a></span>
<span class="normal"><a href="#__codelineno-0-5600">5600</a></span>
<span class="normal"><a href="#__codelineno-0-5601">5601</a></span>
<span class="normal"><a href="#__codelineno-0-5602">5602</a></span>
<span class="normal"><a href="#__codelineno-0-5603">5603</a></span>
<span class="normal"><a href="#__codelineno-0-5604">5604</a></span>
<span class="normal"><a href="#__codelineno-0-5605">5605</a></span>
<span class="normal"><a href="#__codelineno-0-5606">5606</a></span>
<span class="normal"><a href="#__codelineno-0-5607">5607</a></span>
<span class="normal"><a href="#__codelineno-0-5608">5608</a></span>
<span class="normal"><a href="#__codelineno-0-5609">5609</a></span>
<span class="normal"><a href="#__codelineno-0-5610">5610</a></span>
<span class="normal"><a href="#__codelineno-0-5611">5611</a></span>
<span class="normal"><a href="#__codelineno-0-5612">5612</a></span>
<span class="normal"><a href="#__codelineno-0-5613">5613</a></span>
<span class="normal"><a href="#__codelineno-0-5614">5614</a></span>
<span class="normal"><a href="#__codelineno-0-5615">5615</a></span>
<span class="normal"><a href="#__codelineno-0-5616">5616</a></span>
<span class="normal"><a href="#__codelineno-0-5617">5617</a></span>
<span class="normal"><a href="#__codelineno-0-5618">5618</a></span>
<span class="normal"><a href="#__codelineno-0-5619">5619</a></span>
<span class="normal"><a href="#__codelineno-0-5620">5620</a></span>
<span class="normal"><a href="#__codelineno-0-5621">5621</a></span>
<span class="normal"><a href="#__codelineno-0-5622">5622</a></span>
<span class="normal"><a href="#__codelineno-0-5623">5623</a></span>
<span class="normal"><a href="#__codelineno-0-5624">5624</a></span>
<span class="normal"><a href="#__codelineno-0-5625">5625</a></span>
<span class="normal"><a href="#__codelineno-0-5626">5626</a></span>
<span class="normal"><a href="#__codelineno-0-5627">5627</a></span>
<span class="normal"><a href="#__codelineno-0-5628">5628</a></span>
<span class="normal"><a href="#__codelineno-0-5629">5629</a></span>
<span class="normal"><a href="#__codelineno-0-5630">5630</a></span>
<span class="normal"><a href="#__codelineno-0-5631">5631</a></span>
<span class="normal"><a href="#__codelineno-0-5632">5632</a></span>
<span class="normal"><a href="#__codelineno-0-5633">5633</a></span>
<span class="normal"><a href="#__codelineno-0-5634">5634</a></span>
<span class="normal"><a href="#__codelineno-0-5635">5635</a></span>
<span class="normal"><a href="#__codelineno-0-5636">5636</a></span>
<span class="normal"><a href="#__codelineno-0-5637">5637</a></span>
<span class="normal"><a href="#__codelineno-0-5638">5638</a></span>
<span class="normal"><a href="#__codelineno-0-5639">5639</a></span>
<span class="normal"><a href="#__codelineno-0-5640">5640</a></span>
<span class="normal"><a href="#__codelineno-0-5641">5641</a></span>
<span class="normal"><a href="#__codelineno-0-5642">5642</a></span>
<span class="normal"><a href="#__codelineno-0-5643">5643</a></span>
<span class="normal"><a href="#__codelineno-0-5644">5644</a></span>
<span class="normal"><a href="#__codelineno-0-5645">5645</a></span>
<span class="normal"><a href="#__codelineno-0-5646">5646</a></span>
<span class="normal"><a href="#__codelineno-0-5647">5647</a></span>
<span class="normal"><a href="#__codelineno-0-5648">5648</a></span>
<span class="normal"><a href="#__codelineno-0-5649">5649</a></span>
<span class="normal"><a href="#__codelineno-0-5650">5650</a></span>
<span class="normal"><a href="#__codelineno-0-5651">5651</a></span>
<span class="normal"><a href="#__codelineno-0-5652">5652</a></span>
<span class="normal"><a href="#__codelineno-0-5653">5653</a></span>
<span class="normal"><a href="#__codelineno-0-5654">5654</a></span>
<span class="normal"><a href="#__codelineno-0-5655">5655</a></span>
<span class="normal"><a href="#__codelineno-0-5656">5656</a></span>
<span class="normal"><a href="#__codelineno-0-5657">5657</a></span>
<span class="normal"><a href="#__codelineno-0-5658">5658</a></span>
<span class="normal"><a href="#__codelineno-0-5659">5659</a></span>
<span class="normal"><a href="#__codelineno-0-5660">5660</a></span>
<span class="normal"><a href="#__codelineno-0-5661">5661</a></span>
<span class="normal"><a href="#__codelineno-0-5662">5662</a></span>
<span class="normal"><a href="#__codelineno-0-5663">5663</a></span>
<span class="normal"><a href="#__codelineno-0-5664">5664</a></span>
<span class="normal"><a href="#__codelineno-0-5665">5665</a></span>
<span class="normal"><a href="#__codelineno-0-5666">5666</a></span>
<span class="normal"><a href="#__codelineno-0-5667">5667</a></span>
<span class="normal"><a href="#__codelineno-0-5668">5668</a></span>
<span class="normal"><a href="#__codelineno-0-5669">5669</a></span>
<span class="normal"><a href="#__codelineno-0-5670">5670</a></span>
<span class="normal"><a href="#__codelineno-0-5671">5671</a></span>
<span class="normal"><a href="#__codelineno-0-5672">5672</a></span>
<span class="normal"><a href="#__codelineno-0-5673">5673</a></span>
<span class="normal"><a href="#__codelineno-0-5674">5674</a></span>
<span class="normal"><a href="#__codelineno-0-5675">5675</a></span>
<span class="normal"><a href="#__codelineno-0-5676">5676</a></span>
<span class="normal"><a href="#__codelineno-0-5677">5677</a></span>
<span class="normal"><a href="#__codelineno-0-5678">5678</a></span>
<span class="normal"><a href="#__codelineno-0-5679">5679</a></span>
<span class="normal"><a href="#__codelineno-0-5680">5680</a></span>
<span class="normal"><a href="#__codelineno-0-5681">5681</a></span>
<span class="normal"><a href="#__codelineno-0-5682">5682</a></span>
<span class="normal"><a href="#__codelineno-0-5683">5683</a></span>
<span class="normal"><a href="#__codelineno-0-5684">5684</a></span>
<span class="normal"><a href="#__codelineno-0-5685">5685</a></span>
<span class="normal"><a href="#__codelineno-0-5686">5686</a></span>
<span class="normal"><a href="#__codelineno-0-5687">5687</a></span>
<span class="normal"><a href="#__codelineno-0-5688">5688</a></span>
<span class="normal"><a href="#__codelineno-0-5689">5689</a></span>
<span class="normal"><a href="#__codelineno-0-5690">5690</a></span>
<span class="normal"><a href="#__codelineno-0-5691">5691</a></span>
<span class="normal"><a href="#__codelineno-0-5692">5692</a></span>
<span class="normal"><a href="#__codelineno-0-5693">5693</a></span>
<span class="normal"><a href="#__codelineno-0-5694">5694</a></span>
<span class="normal"><a href="#__codelineno-0-5695">5695</a></span>
<span class="normal"><a href="#__codelineno-0-5696">5696</a></span>
<span class="normal"><a href="#__codelineno-0-5697">5697</a></span>
<span class="normal"><a href="#__codelineno-0-5698">5698</a></span>
<span class="normal"><a href="#__codelineno-0-5699">5699</a></span>
<span class="normal"><a href="#__codelineno-0-5700">5700</a></span>
<span class="normal"><a href="#__codelineno-0-5701">5701</a></span>
<span class="normal"><a href="#__codelineno-0-5702">5702</a></span>
<span class="normal"><a href="#__codelineno-0-5703">5703</a></span>
<span class="normal"><a href="#__codelineno-0-5704">5704</a></span>
<span class="normal"><a href="#__codelineno-0-5705">5705</a></span>
<span class="normal"><a href="#__codelineno-0-5706">5706</a></span>
<span class="normal"><a href="#__codelineno-0-5707">5707</a></span>
<span class="normal"><a href="#__codelineno-0-5708">5708</a></span>
<span class="normal"><a href="#__codelineno-0-5709">5709</a></span>
<span class="normal"><a href="#__codelineno-0-5710">5710</a></span>
<span class="normal"><a href="#__codelineno-0-5711">5711</a></span>
<span class="normal"><a href="#__codelineno-0-5712">5712</a></span>
<span class="normal"><a href="#__codelineno-0-5713">5713</a></span>
<span class="normal"><a href="#__codelineno-0-5714">5714</a></span>
<span class="normal"><a href="#__codelineno-0-5715">5715</a></span>
<span class="normal"><a href="#__codelineno-0-5716">5716</a></span>
<span class="normal"><a href="#__codelineno-0-5717">5717</a></span>
<span class="normal"><a href="#__codelineno-0-5718">5718</a></span>
<span class="normal"><a href="#__codelineno-0-5719">5719</a></span>
<span class="normal"><a href="#__codelineno-0-5720">5720</a></span>
<span class="normal"><a href="#__codelineno-0-5721">5721</a></span>
<span class="normal"><a href="#__codelineno-0-5722">5722</a></span>
<span class="normal"><a href="#__codelineno-0-5723">5723</a></span>
<span class="normal"><a href="#__codelineno-0-5724">5724</a></span>
<span class="normal"><a href="#__codelineno-0-5725">5725</a></span>
<span class="normal"><a href="#__codelineno-0-5726">5726</a></span>
<span class="normal"><a href="#__codelineno-0-5727">5727</a></span>
<span class="normal"><a href="#__codelineno-0-5728">5728</a></span>
<span class="normal"><a href="#__codelineno-0-5729">5729</a></span>
<span class="normal"><a href="#__codelineno-0-5730">5730</a></span>
<span class="normal"><a href="#__codelineno-0-5731">5731</a></span>
<span class="normal"><a href="#__codelineno-0-5732">5732</a></span>
<span class="normal"><a href="#__codelineno-0-5733">5733</a></span>
<span class="normal"><a href="#__codelineno-0-5734">5734</a></span>
<span class="normal"><a href="#__codelineno-0-5735">5735</a></span>
<span class="normal"><a href="#__codelineno-0-5736">5736</a></span>
<span class="normal"><a href="#__codelineno-0-5737">5737</a></span>
<span class="normal"><a href="#__codelineno-0-5738">5738</a></span>
<span class="normal"><a href="#__codelineno-0-5739">5739</a></span>
<span class="normal"><a href="#__codelineno-0-5740">5740</a></span>
<span class="normal"><a href="#__codelineno-0-5741">5741</a></span>
<span class="normal"><a href="#__codelineno-0-5742">5742</a></span>
<span class="normal"><a href="#__codelineno-0-5743">5743</a></span>
<span class="normal"><a href="#__codelineno-0-5744">5744</a></span>
<span class="normal"><a href="#__codelineno-0-5745">5745</a></span>
<span class="normal"><a href="#__codelineno-0-5746">5746</a></span>
<span class="normal"><a href="#__codelineno-0-5747">5747</a></span>
<span class="normal"><a href="#__codelineno-0-5748">5748</a></span>
<span class="normal"><a href="#__codelineno-0-5749">5749</a></span>
<span class="normal"><a href="#__codelineno-0-5750">5750</a></span>
<span class="normal"><a href="#__codelineno-0-5751">5751</a></span>
<span class="normal"><a href="#__codelineno-0-5752">5752</a></span>
<span class="normal"><a href="#__codelineno-0-5753">5753</a></span>
<span class="normal"><a href="#__codelineno-0-5754">5754</a></span>
<span class="normal"><a href="#__codelineno-0-5755">5755</a></span>
<span class="normal"><a href="#__codelineno-0-5756">5756</a></span>
<span class="normal"><a href="#__codelineno-0-5757">5757</a></span>
<span class="normal"><a href="#__codelineno-0-5758">5758</a></span>
<span class="normal"><a href="#__codelineno-0-5759">5759</a></span>
<span class="normal"><a href="#__codelineno-0-5760">5760</a></span>
<span class="normal"><a href="#__codelineno-0-5761">5761</a></span>
<span class="normal"><a href="#__codelineno-0-5762">5762</a></span>
<span class="normal"><a href="#__codelineno-0-5763">5763</a></span>
<span class="normal"><a href="#__codelineno-0-5764">5764</a></span>
<span class="normal"><a href="#__codelineno-0-5765">5765</a></span>
<span class="normal"><a href="#__codelineno-0-5766">5766</a></span>
<span class="normal"><a href="#__codelineno-0-5767">5767</a></span>
<span class="normal"><a href="#__codelineno-0-5768">5768</a></span>
<span class="normal"><a href="#__codelineno-0-5769">5769</a></span>
<span class="normal"><a href="#__codelineno-0-5770">5770</a></span>
<span class="normal"><a href="#__codelineno-0-5771">5771</a></span>
<span class="normal"><a href="#__codelineno-0-5772">5772</a></span>
<span class="normal"><a href="#__codelineno-0-5773">5773</a></span>
<span class="normal"><a href="#__codelineno-0-5774">5774</a></span>
<span class="normal"><a href="#__codelineno-0-5775">5775</a></span>
<span class="normal"><a href="#__codelineno-0-5776">5776</a></span>
<span class="normal"><a href="#__codelineno-0-5777">5777</a></span>
<span class="normal"><a href="#__codelineno-0-5778">5778</a></span>
<span class="normal"><a href="#__codelineno-0-5779">5779</a></span>
<span class="normal"><a href="#__codelineno-0-5780">5780</a></span>
<span class="normal"><a href="#__codelineno-0-5781">5781</a></span>
<span class="normal"><a href="#__codelineno-0-5782">5782</a></span>
<span class="normal"><a href="#__codelineno-0-5783">5783</a></span>
<span class="normal"><a href="#__codelineno-0-5784">5784</a></span>
<span class="normal"><a href="#__codelineno-0-5785">5785</a></span>
<span class="normal"><a href="#__codelineno-0-5786">5786</a></span>
<span class="normal"><a href="#__codelineno-0-5787">5787</a></span>
<span class="normal"><a href="#__codelineno-0-5788">5788</a></span>
<span class="normal"><a href="#__codelineno-0-5789">5789</a></span>
<span class="normal"><a href="#__codelineno-0-5790">5790</a></span>
<span class="normal"><a href="#__codelineno-0-5791">5791</a></span>
<span class="normal"><a href="#__codelineno-0-5792">5792</a></span>
<span class="normal"><a href="#__codelineno-0-5793">5793</a></span>
<span class="normal"><a href="#__codelineno-0-5794">5794</a></span>
<span class="normal"><a href="#__codelineno-0-5795">5795</a></span>
<span class="normal"><a href="#__codelineno-0-5796">5796</a></span>
<span class="normal"><a href="#__codelineno-0-5797">5797</a></span>
<span class="normal"><a href="#__codelineno-0-5798">5798</a></span>
<span class="normal"><a href="#__codelineno-0-5799">5799</a></span>
<span class="normal"><a href="#__codelineno-0-5800">5800</a></span>
<span class="normal"><a href="#__codelineno-0-5801">5801</a></span>
<span class="normal"><a href="#__codelineno-0-5802">5802</a></span>
<span class="normal"><a href="#__codelineno-0-5803">5803</a></span>
<span class="normal"><a href="#__codelineno-0-5804">5804</a></span>
<span class="normal"><a href="#__codelineno-0-5805">5805</a></span>
<span class="normal"><a href="#__codelineno-0-5806">5806</a></span>
<span class="normal"><a href="#__codelineno-0-5807">5807</a></span>
<span class="normal"><a href="#__codelineno-0-5808">5808</a></span>
<span class="normal"><a href="#__codelineno-0-5809">5809</a></span>
<span class="normal"><a href="#__codelineno-0-5810">5810</a></span>
<span class="normal"><a href="#__codelineno-0-5811">5811</a></span>
<span class="normal"><a href="#__codelineno-0-5812">5812</a></span>
<span class="normal"><a href="#__codelineno-0-5813">5813</a></span>
<span class="normal"><a href="#__codelineno-0-5814">5814</a></span>
<span class="normal"><a href="#__codelineno-0-5815">5815</a></span>
<span class="normal"><a href="#__codelineno-0-5816">5816</a></span>
<span class="normal"><a href="#__codelineno-0-5817">5817</a></span>
<span class="normal"><a href="#__codelineno-0-5818">5818</a></span>
<span class="normal"><a href="#__codelineno-0-5819">5819</a></span>
<span class="normal"><a href="#__codelineno-0-5820">5820</a></span>
<span class="normal"><a href="#__codelineno-0-5821">5821</a></span>
<span class="normal"><a href="#__codelineno-0-5822">5822</a></span>
<span class="normal"><a href="#__codelineno-0-5823">5823</a></span>
<span class="normal"><a href="#__codelineno-0-5824">5824</a></span>
<span class="normal"><a href="#__codelineno-0-5825">5825</a></span>
<span class="normal"><a href="#__codelineno-0-5826">5826</a></span>
<span class="normal"><a href="#__codelineno-0-5827">5827</a></span>
<span class="normal"><a href="#__codelineno-0-5828">5828</a></span>
<span class="normal"><a href="#__codelineno-0-5829">5829</a></span>
<span class="normal"><a href="#__codelineno-0-5830">5830</a></span>
<span class="normal"><a href="#__codelineno-0-5831">5831</a></span>
<span class="normal"><a href="#__codelineno-0-5832">5832</a></span>
<span class="normal"><a href="#__codelineno-0-5833">5833</a></span>
<span class="normal"><a href="#__codelineno-0-5834">5834</a></span>
<span class="normal"><a href="#__codelineno-0-5835">5835</a></span>
<span class="normal"><a href="#__codelineno-0-5836">5836</a></span>
<span class="normal"><a href="#__codelineno-0-5837">5837</a></span>
<span class="normal"><a href="#__codelineno-0-5838">5838</a></span>
<span class="normal"><a href="#__codelineno-0-5839">5839</a></span>
<span class="normal"><a href="#__codelineno-0-5840">5840</a></span>
<span class="normal"><a href="#__codelineno-0-5841">5841</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">M365</span><span class="p">:</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to automate stettings in Microsoft 365 via the Graph API.&quot;&quot;&quot;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">default_logger</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">_config</span><span class="p">:</span> <span class="nb">dict</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">_access_token</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">_user_access_token</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">_http_object</span><span class="p">:</span> <span class="n">HTTP</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="n">tenant_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">client_secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">sku_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">teams_app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">teams_app_external_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">sharepoint_app_root_site</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">sharepoint_app_client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">sharepoint_app_client_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">default_logger</span><span class="p">,</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the M365 object.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        Args:</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            tenant_id (str):</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">                The M365 Tenant ID.</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            client_id (str):</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">                The M365 Client ID.</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            client_secret (str):</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">                The M365 Client Secret.</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            domain (str):</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">                The M365 domain.</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            sku_id (str):</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">                License SKU for M365 users.</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            teams_app_name (str):</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">                The name of the Extended ECM app for MS Teams.</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            teams_app_external_id (str):</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                The external ID of the Extended ECM app for MS Teams</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            sharepoint_app_root_site (str):</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                The URL to the SharePoint root site.</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            sharepoint_app_client_id (str):</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                The SharePoint App client ID.</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            sharepoint_app_client_secret (str):</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">                The SharePoint App client secret.</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            logger (logging.Logger, optional):</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">                The logging object to use for all log messages. Defaults to default_logger.</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">if</span> <span class="n">logger</span> <span class="o">!=</span> <span class="n">default_logger</span><span class="p">:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="s2">&quot;m365&quot;</span><span class="p">)</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="k">for</span> <span class="n">logfilter</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">logfilter</span><span class="p">)</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">m365_config</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="c1"># Set the authentication endpoints and credentials</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;tenantId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tenant_id</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;clientId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_id</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;clientSecret&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_secret</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">domain</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;skuId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sku_id</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teams_app_name</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppExternalId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teams_app_external_id</span>  <span class="c1"># this is the external App ID</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppInternalId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># will be set later...</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sharepointAppRootSite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharepoint_app_root_site</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sharepointAppClientId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharepoint_app_client_id</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sharepointAppClientSecret&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharepoint_app_client_secret</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://login.microsoftonline.com/</span><span class="si">{}</span><span class="s2">/oauth2/v2.0/token&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tenant_id</span><span class="p">)</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://graph.microsoft.com/v1.0/&quot;</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;betaUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://graph.microsoft.com/beta/&quot;</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;directoryObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;directoryObjects&quot;</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="c1"># Set the data for the token request</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;tokenData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">client_secret</span><span class="p">,</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;client_credentials&quot;</span><span class="p">,</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;https://graph.microsoft.com/.default&quot;</span><span class="p">,</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="p">}</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;meUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;me&quot;</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;groups&quot;</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;users&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;teams&quot;</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsTemplatesUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;teamsTemplates&quot;</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;appCatalogs/teamsApps&quot;</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;directory&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;securityUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;betaUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;security&quot;</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;applications&quot;</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;betaUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;sites&quot;</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">m365_config</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_http_object</span> <span class="o">=</span> <span class="n">HTTP</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the configuration dictionary.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            dict: Configuration dictionary</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the login credentials.</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            dict:</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">                A dictionary with (admin) login credentials for M365.</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;tokenData&quot;</span><span class="p">]</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">credentials_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Files.ReadWrite&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get user credentials.</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        In some cases MS Graph APIs cannot be called via</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        application permissions (client_id, client_secret)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        but requires a token of a user authenticated</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        with username + password. This is e.g. the case</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        to upload a MS teams app to the catalog.</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        See https://learn.microsoft.com/en-us/graph/api/teamsapp-publish</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        Args:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            username (str):</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                The M365 username.</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            password (str):</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                The password of the M365 user.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            scope (str):</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                The scope of the delegated permission.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                It is important to provide a scope for the intended operation</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">                like &quot;Files.ReadWrite&quot;.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            dict:</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                A dictionary with the (user) credentials for M365.</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="c1"># Use OAuth2 / ROPC (Resource Owner Password Credentials):</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;clientId&quot;</span><span class="p">],</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;clientSecret&quot;</span><span class="p">],</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="n">scope</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="p">}</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">return</span> <span class="n">credentials</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">request_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the request header used for Application calls.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Consists of Bearer access token and Content Type.</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Args:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            content_type (str, optional):</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">                The content type for the request. Default is &quot;application/json&quot;.</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            dict:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">                The request header values.</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span><span class="p">),</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="n">content_type</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="p">}</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">return</span> <span class="n">request_header</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">request_header_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the request header used for user specific calls.</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        Consists of Bearer access token and Content Type.</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        Args:</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            content_type (str, optional):</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">                The content type for the request.</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            dict:</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">                The request header values.</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="n">content_type</span><span class="p">,</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="p">}</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span><span class="p">:</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No M365 user is authenticated! Cannot include Bearer token in request header!&quot;</span><span class="p">)</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="n">request_header</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bearer </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span><span class="p">)</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">return</span> <span class="n">request_header</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_request</span><span class="p">(</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">json_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">show_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">warning_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">failure_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">success_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">REQUEST_MAX_RETRIES</span><span class="p">,</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">retry_forever</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">parse_request_response</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">stream</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Call an M365 Graph API in a safe way.</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        Args:</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            url (str):</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">                URL to send the request to.</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            method (str, optional):</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">                HTTP method (GET, POST, etc.). Defaults to &quot;GET&quot;.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            headers (dict | None, optional):</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">                Request Headers. Defaults to None.</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            data (dict | None, optional):</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">                Request payload. Defaults to None.</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            json_data (dict | None, optional):</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">                Request payload for the JSON parameter. Defaults to None.</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            files (dict | None, optional):</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">                Dictionary of {&quot;name&quot;: file-tuple} for multipart encoding upload.</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">                file-tuple can be a 2-tuple (&quot;filename&quot;, fileobj) or a 3-tuple (&quot;filename&quot;, fileobj, &quot;content_type&quot;)</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            params (dict | None, optional):</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">                Add key-value pairs to the query string of the URL.</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">                When you use the params parameter, requests automatically appends</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">                the key-value pairs to the URL as part of the query string</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            timeout (float | None, optional):</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">                Timeout for the request in seconds. Defaults to REQUEST_TIMEOUT.</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">                Whether or not an error should be logged in case of a failed REST call.</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">                If False, then only a warning is logged. Defaults to True.</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            show_warning (bool, optional):</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">                Whether or not an warning should be logged in case of a</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                failed REST call.</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                If False, then only a warning is logged. Defaults to True.</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            warning_message (str, optional):</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                Specific warning message. Defaults to &quot;&quot;. If not given the error_message will be used.</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            failure_message (str, optional):</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">                Specific error message. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            success_message (str, optional):</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">                Specific success message. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            max_retries (int, optional):</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                How many retries on Connection errors? Default is REQUEST_MAX_RETRIES.</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            retry_forever (bool, optional):</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">                Eventually wait forever - without timeout. Defaults to False.</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            parse_request_response (bool, optional):</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">                Defines whether the response.text should be interpreted as json and loaded into a dictionary.</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">                True is the default.</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            stream (bool, optional):</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">                This parameter is used to control whether the response content should be immediately</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">                downloaded or streamed incrementally.</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">                Response of M365 Graph REST API or None in case of an error.</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="k">if</span> <span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>                <span class="s2">&quot;Missing request header. Cannot send request to Microsoft M365 Graph API!&quot;</span><span class="p">,</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="p">)</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="c1"># In case of an expired session we reauthenticate and</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="c1"># try 1 more time. Session expiration should not happen</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="c1"># twice in a row:</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>                    <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>                    <span class="n">json</span><span class="o">=</span><span class="n">json_data</span><span class="p">,</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>                    <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>                    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>                    <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>                    <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="p">)</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>                    <span class="k">if</span> <span class="n">success_message</span><span class="p">:</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">success_message</span><span class="p">)</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>                    <span class="k">if</span> <span class="n">parse_request_response</span><span class="p">:</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>                        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="c1"># Check if Session has expired - then re-authenticate and try once more</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Session has expired - try to re-authenticate...&quot;</span><span class="p">)</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">revalidate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>                    <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>                    <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">]</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">REQUEST_MAX_RETRIES</span><span class="p">:</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>                        <span class="s2">&quot;M365 Graph API delivered server side error -&gt; </span><span class="si">%s</span><span class="s2">; retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>                        <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>                        <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>                    <span class="p">)</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">((</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>                    <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a>                <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">404</span><span class="p">,</span> <span class="mi">429</span><span class="p">]</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">REQUEST_MAX_RETRIES</span><span class="p">:</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>                        <span class="s2">&quot;M365 Graph API is too slow or throtteling calls -&gt; </span><span class="si">%s</span><span class="s2">; retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>                        <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a>                        <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>                    <span class="p">)</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">((</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>                    <span class="c1"># Handle plain HTML responses to not pollute the logs</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>                    <span class="n">content_type</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content-type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>                    <span class="n">response_text</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>                        <span class="s2">&quot;HTML content (only printed in debug log)&quot;</span> <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;text/html&quot;</span> <span class="k">else</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a>                    <span class="p">)</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>                    <span class="k">if</span> <span class="n">show_error</span><span class="p">:</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; status -&gt; </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">; error -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>                            <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>                            <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>                            <span class="n">HTTPStatus</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span><span class="o">.</span><span class="n">phrase</span><span class="p">,</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>                            <span class="n">response_text</span><span class="p">,</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>                        <span class="p">)</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>                    <span class="k">elif</span> <span class="n">show_warning</span><span class="p">:</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; status -&gt; </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">; warning -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>                            <span class="n">warning_message</span> <span class="k">if</span> <span class="n">warning_message</span> <span class="k">else</span> <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>                            <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>                            <span class="n">HTTPStatus</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span><span class="o">.</span><span class="n">phrase</span><span class="p">,</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>                            <span class="n">response_text</span><span class="p">,</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>                        <span class="p">)</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>                    <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;text/html&quot;</span><span class="p">:</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; status -&gt; </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">; warning -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>                            <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>                            <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>                            <span class="n">HTTPStatus</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span><span class="o">.</span><span class="n">phrase</span><span class="p">,</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>                            <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>                        <span class="p">)</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;=</span> <span class="n">max_retries</span><span class="p">:</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a>                        <span class="s2">&quot;Request timed out. Retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>                        <span class="nb">str</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">),</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>                    <span class="p">)</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a>                    <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">)</span>  <span class="c1"># Add a delay before retrying</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a>                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; timeout error!&quot;</span><span class="p">,</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a>                        <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a>                    <span class="p">)</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="k">if</span> <span class="n">retry_forever</span><span class="p">:</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>                        <span class="c1"># If it fails after REQUEST_MAX_RETRIES retries we let it wait forever</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Turn timeouts off and wait forever...&quot;</span><span class="p">)</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a>                        <span class="n">timeout</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a>                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a>                <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;=</span> <span class="n">max_retries</span><span class="p">:</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a>                        <span class="s2">&quot;Connection error. Retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>                        <span class="nb">str</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">),</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>                    <span class="p">)</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>                    <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">)</span>  <span class="c1"># Add a delay before retrying</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; connection error!&quot;</span><span class="p">,</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a>                        <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>                    <span class="p">)</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>                    <span class="k">if</span> <span class="n">retry_forever</span><span class="p">:</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a>                        <span class="c1"># If it fails after REQUEST_MAX_RETRIES retries we let it wait forever</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Turn timeouts off and wait forever...&quot;</span><span class="p">)</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>                        <span class="n">timeout</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a>                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">)</span>  <span class="c1"># Add a delay before retrying</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a>                        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="c1"># end try</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a>                <span class="s2">&quot;Retrying REST API </span><span class="si">%s</span><span class="s2"> call -&gt; </span><span class="si">%s</span><span class="s2">... (retry = </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a>                <span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a>                <span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">retries</span><span class="p">),</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="p">)</span>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="c1"># end while True</span>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_request_response</span><span class="p">(</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">response_object</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span><span class="p">,</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">additional_error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the request response (JSon) to a Python dict in a safe way.</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        It first tries to load the response.text via json.loads() that produces a</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        dict output. Only if response.text is not set or is empty it just converts the</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        response_object to a dict using the vars() built-in method.</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Args:</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            response_object (object):</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">                This is reponse object delivered by the request call.</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            additional_error_message (str, optional):</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">                Use a more specific error message in case of an error.</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">                True: write an error to the log file</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">                False: write a warning to the log file</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            dict:</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">                API response information or None in case of an error.</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response_object</span><span class="p">:</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">dict_object</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response_object</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="n">response_object</span><span class="o">.</span><span class="n">text</span> <span class="k">else</span> <span class="nb">vars</span><span class="p">(</span><span class="n">response_object</span><span class="p">)</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="k">if</span> <span class="n">additional_error_message</span><span class="p">:</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Cannot decode response as JSon. </span><span class="si">{}</span><span class="s2">; error -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>                    <span class="n">additional_error_message</span><span class="p">,</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>                    <span class="n">exception</span><span class="p">,</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>                <span class="p">)</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Cannot decode response as JSon; error -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="n">exception</span><span class="p">,</span>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="p">)</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="k">if</span> <span class="n">show_error</span><span class="p">:</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="k">return</span> <span class="n">dict_object</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512"></a>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exist_result_item</span><span class="p">(</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="n">response</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="n">sub_dict_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check existence of key / value pair in the response properties of an MS Graph API call.</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Args:</span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            response (dict | None):</span>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">                REST response from an MS Graph REST Call.</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            key (str):</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">                The property name (key).</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">            value (str):</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">                The value to find in the item with the matching key</span>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            sub_dict_name (str, optional):</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">                Some MS Graph API calls include nested dict structures that can be requested</span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">                with an &quot;expand&quot; query parameter. In such a case we use the sub_dict_name to</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">                access it.</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            bool:</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">                True if the value was found, False otherwise</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="k">if</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict_name</span><span class="p">:</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>                <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">][</span><span class="n">key</span><span class="p">]:</span>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561"></a>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563"></a>
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_result_value</span><span class="p">(</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="n">response</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="n">sub_dict_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get value of a result property with a given key of an MS Graph API call.</span>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        Args:</span>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">            response (dict | None):</span>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">                REST response from an MS Graph REST Call.</span>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">            key (str):</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">                The property name (key).</span>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">            index (int, optional):</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">                Index to use (1st element has index 0).</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">                Defaults to 0.</span>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            sub_dict_name (str):</span>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">                Some MS Graph API calls include nested dict structures that can</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">                be requested with an &quot;expand&quot; query parameter. In such</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">                a case we use the sub_dict_name to access it.</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">                The value for the key, None otherwise.</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="k">if</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>  <span class="c1"># If Graph APIs are called with specific IDs (and not name lookups)</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a>            <span class="c1"># they may not return a list of dicts calles &quot;values&quot; but a single dict directly</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">and</span> <span class="n">sub_dict_name</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>                <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>                <span class="c1"># also the substructure could be a list</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_structure</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>                    <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">sub_structure</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>                <span class="k">return</span> <span class="n">sub_structure</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">index</span><span class="p">:</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict_name</span><span class="p">:</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_structure</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>                <span class="c1"># here we assume it is the first element of the</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>                <span class="c1"># substructure. If really required for specific</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="c1"># use cases we may introduce a second index in</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="c1"># the future.</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">sub_structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="k">return</span> <span class="n">sub_structure</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lookup_result_value</span><span class="p">(</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="n">response</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="n">return_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">sub_dict_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Look up a property value for a provided key-value pair of a REST response.</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">        Args:</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            response (dict):</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">                The REST response from an OTCS REST call, containing property data.</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">            key (str):</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">                Property name (key) to match in the response.</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            value (str):</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">                Value to find in the item with the matching key.</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            return_key (str):</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">                Name of the dictionary key whose value should be returned.</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            sub_dict_name (str):</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">                Some MS Graph API calls include nested dict structures that can</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">                be requested with an &quot;expand&quot; query parameter. In such</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">                a case we use the sub_dict_name to access it.</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">                The value of the property specified by &quot;return_key&quot; if found,</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">                or None if the lookup fails.</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="c1"># check if results is a list or a dict (both is possible -</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="c1"># dependent on the actual REST API):</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="c1"># result is a dict - we don&#39;t need index value:</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">and</span> <span class="n">sub_dict_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a>                <span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">results</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">return_key</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a>                <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="n">return_key</span><span class="p">]</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="c1"># result is a list - we need index value</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>                <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">and</span> <span class="n">sub_dict_name</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">return_key</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>                    <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">return_key</span><span class="p">]</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="s2">&quot;Result needs to be a list or dictionary but it is of type -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">results</span><span class="p">)),</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="p">)</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685"></a>
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687"></a>
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">revalidate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Authenticate at M365 Graph API with client ID and client secret.</span>
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690"></a>
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">        Args:</span>
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">            revalidate (bool, optional):</span>
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">                Determins if a re-athentication is enforced.</span>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">                (e.g. if session has timed out with 401 error)</span>
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695"></a>
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">                The access token. Also stores access token in self._access_token.</span>
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">                None in case of an error.</span>
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="c1"># Already authenticated and session still valid?</span>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">revalidate</span><span class="p">:</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>                <span class="s2">&quot;Session still valid - return existing access token -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a>                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span><span class="p">),</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="p">)</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="n">request_login_headers</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Requesting M365 Access Token from -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="n">authenticate_post_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">()</span>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="n">authenticate_response</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="n">authenticate_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>                <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>                <span class="n">data</span><span class="o">=</span><span class="n">authenticate_post_body</span><span class="p">,</span>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a>                <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>                <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="p">)</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="s2">&quot;Unable to connect to -&gt; </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">],</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="p">)</span>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="k">if</span> <span class="n">authenticate_response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="n">authenticate_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">authenticate_response</span><span class="p">)</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">authenticate_dict</span><span class="p">:</span>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">access_token</span> <span class="o">=</span> <span class="n">authenticate_dict</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Access Token -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">access_token</span><span class="p">)</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="s2">&quot;Failed to request an M365 Access Token; error -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a>                <span class="n">authenticate_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a>            <span class="p">)</span>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="c1"># Store authentication access_token:</span>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span> <span class="o">=</span> <span class="n">access_token</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span>
</span><span id="__span-0-751"><a id="__codelineno-0-751" name="__codelineno-0-751"></a>
</span><span id="__span-0-752"><a id="__codelineno-0-752" name="__codelineno-0-752"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-753"><a id="__codelineno-0-753" name="__codelineno-0-753"></a>
</span><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Authenticate at M365 Graph API with username and password.</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">        Args:</span>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">            username (str):</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">                The name (email) of the M365 user.</span>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">            password (str):</span>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">                The password of the M365 user.</span>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">            scope (str):</span>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">                The scope of the delegated permission. E.g. &quot;Files.ReadWrite&quot;.</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">                Multiple delegated permissions should be separated by spaces.</span>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">                The access token for the user. Also stores access token in self._access_token.</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">                None in case of an error.</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="n">request_login_headers</span>
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775"></a>
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="p">:</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Missing user name - cannot authenticate at M365!&quot;</span><span class="p">)</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a>                <span class="s2">&quot;Missing password for user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; - cannot authenticate at M365!&quot;</span><span class="p">,</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a>                <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="p">)</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="s2">&quot;Requesting M365 Access Token for user -&gt; </span><span class="si">%s</span><span class="s2"> from -&gt; </span><span class="si">%s%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="s2">&quot; with scope -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span> <span class="k">if</span> <span class="n">scope</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="p">)</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">authenticate_post_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials_user</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">)</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>        <span class="n">authenticate_response</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a>            <span class="n">authenticate_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a>                <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a>                <span class="n">data</span><span class="o">=</span><span class="n">authenticate_post_body</span><span class="p">,</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a>                <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a>                <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a>            <span class="p">)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a>                <span class="s2">&quot;Unable to connect to -&gt; </span><span class="si">%s</span><span class="s2"> with username -&gt; </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">],</span>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a>                <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a>            <span class="p">)</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="k">if</span> <span class="n">authenticate_response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a>            <span class="n">authenticate_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">authenticate_response</span><span class="p">)</span>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">authenticate_dict</span><span class="p">:</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a>            <span class="n">access_token</span> <span class="o">=</span> <span class="n">authenticate_dict</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;User Access Token -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">access_token</span><span class="p">)</span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a>                <span class="s2">&quot;Failed to request an M365 Access Token for user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; error -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a>                <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a>                <span class="n">authenticate_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a>            <span class="p">)</span>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a>        <span class="c1"># Store authentication access_token:</span>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span> <span class="o">=</span> <span class="n">access_token</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="n">next_page_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get list all all users in M365 tenant.</span>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a>
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        Args:</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">            max_number (int, optional):</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">                The maximum result values (limit).</span>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">            next_page_url (str, optional):</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">                The MS Graph URL to retrieve the next page of M365 users (pagination).</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">                This is used for the iterator get_users_iterator() below.</span>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">                Dictionary of all M365 users.</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="n">next_page_url</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="s2">&quot;Get list of all M365 users</span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>            <span class="s2">&quot; (paged)&quot;</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>        <span class="p">)</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;$top&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_number</span><span class="p">)}</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 users!&quot;</span><span class="p">,</span>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="p">)</span>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_users_iterator</span><span class="p">(</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">iter</span><span class="p">:</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an iterator object that can be used to traverse all M365 users.</span>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">        Returning a generator avoids loading a large number of nodes into memory at once. Instead you</span>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        can iterate over the potential large list of users.</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">        Example usage:</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">            users = m365_object.get_users_iterator()</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">            for user in users:</span>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">                logger.info(&quot;Traversing M365 user -&gt; &#39;%s&#39;...&quot;, user.get(&quot;displayName&quot;, &quot;&lt;undefined name&gt;&quot;))</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">            iter:</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">                A generator yielding one M365 user per iteration.</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">                If the REST API fails, returns no value.</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="n">next_page_url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_users</span><span class="p">(</span>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a>                <span class="n">next_page_url</span><span class="o">=</span><span class="n">next_page_url</span><span class="p">,</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a>            <span class="p">)</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>                <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>                <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a>                <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a>                <span class="k">return</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="c1"># Yield users one at a time:</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a>            <span class="k">yield from</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="c1"># See if we have an additional result page.</span>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="c1"># If not terminate the iterator and return</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a>            <span class="c1"># no value.</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="n">next_page_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.nextLink&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a>                <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a>                <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a>                <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a>                <span class="k">return</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a M365 User based on its email or ID.</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        Args:</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">            user_email (str):</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">                The M365 user email.</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            user_id (str | None, optional):</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">                The ID of the M365 user (alternatively to user_email). Optional.</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            show_error (bool):</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">                Whether or not an error should be displayed if the</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">                user is not found.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            dict:</span>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">                User information or None if the user couldn&#39;t be retrieved (e.g. because it doesn&#39;t exist</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">                or if there is a permission problem).</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        Example:</span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            {</span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#users/$entity&#39;,</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">                &#39;businessPhones&#39;: [],</span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">                &#39;displayName&#39;: &#39;Bob Davis&#39;,</span>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">                &#39;givenName&#39;: &#39;Bob&#39;,</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">                &#39;id&#39;: &#39;72c80809-094f-4e6e-98d4-25a736385d10&#39;,</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">                &#39;jobTitle&#39;: None,</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">                &#39;mail&#39;: &#39;bdavis@M365x61936377.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">                &#39;mobilePhone&#39;: None,</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">                &#39;officeLocation&#39;: None,</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">                &#39;preferredLanguage&#39;: None,</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">                &#39;surname&#39;: &#39;Davis&#39;,</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">                &#39;userPrincipalName&#39;: &#39;bdavis@M365x61936377.onmicrosoft.com&#39;</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            }</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="c1"># Some sanity checks:</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="k">if</span> <span class="n">user_email</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;@&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_email</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_email</span><span class="p">):</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a>                <span class="s2">&quot;User email -&gt; </span><span class="si">%s</span><span class="s2"> is not a valid email address!&quot;</span><span class="p">,</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>                <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>            <span class="p">)</span>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="c1"># if there&#39;s an alias in the E-Mail Adress we remove it as</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="c1"># MS Graph seems to not support an alias to lookup a user object.</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="k">if</span> <span class="n">user_email</span> <span class="ow">and</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">user_email</span><span class="p">:</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a>                <span class="s2">&quot;Removing Alias from email address -&gt; </span><span class="si">%s</span><span class="s2"> to determine M365 principal name...&quot;</span><span class="p">,</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a>                <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="p">)</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="c1"># Find the index of the &#39;+&#39; character</span>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>            <span class="n">alias_index</span> <span class="o">=</span> <span class="n">user_email</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="c1"># Find the index of the &#39;@&#39; character</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="n">domain_index</span> <span class="o">=</span> <span class="n">user_email</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="c1"># Construct the email address without the alias</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a>            <span class="n">user_email</span> <span class="o">=</span> <span class="n">user_email</span><span class="p">[:</span><span class="n">alias_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">user_email</span><span class="p">[</span><span class="n">domain_index</span><span class="p">:]</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a>                <span class="s2">&quot;M365 user principal name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a>                <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a>            <span class="p">)</span>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_email</span> <span class="k">if</span> <span class="n">user_email</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">)</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a>            <span class="s2">&quot;Get M365 user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">user_email</span> <span class="k">if</span> <span class="n">user_email</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="p">)</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_email</span> <span class="k">if</span> <span class="n">user_email</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="p">)</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_user</span><span class="p">(</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="n">department</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="n">company_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Innovate&quot;</span><span class="p">,</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a M365 user.</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            email (str):</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">                The email address of the user. This is also the unique identifier.</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">            password (str):</span>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">                The password of the user.</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">            first_name (str):</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">                The first name of the user.</span>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">            last_name (str):</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">                The last name of the user.</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">            location (str, optional):</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">                The country ISO 3166-1 alpha-2 code (e.g. US, CA, FR, DE, CN, ...)</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">            department (str, optional):</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">                The department of the user.</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            company_name (str):</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">                The name of the company the user works for.</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">                User information or None if the user couldn&#39;t be created (e.g. because it exisits already</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">                or if a permission problem occurs).</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">user_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>            <span class="s2">&quot;accountEnabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>            <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">last_name</span><span class="p">,</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>            <span class="s2">&quot;givenName&quot;</span><span class="p">:</span> <span class="n">first_name</span><span class="p">,</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>            <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">last_name</span><span class="p">,</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>            <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="n">email</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>            <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>            <span class="s2">&quot;passwordProfile&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>                <span class="s2">&quot;forceChangePasswordNextSignIn&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>                <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>            <span class="p">},</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>            <span class="s2">&quot;usageLocation&quot;</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="p">}</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>        <span class="k">if</span> <span class="n">department</span><span class="p">:</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>            <span class="n">user_post_body</span><span class="p">[</span><span class="s2">&quot;department&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">department</span>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>        <span class="k">if</span> <span class="n">company_name</span><span class="p">:</span>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>            <span class="n">user_post_body</span><span class="p">[</span><span class="s2">&quot;companyName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">company_name</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding M365 user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">user_post_body</span><span class="p">),</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email</span><span class="p">),</span>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>        <span class="p">)</span>
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updated_settings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update selected properties of an M365 user.</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        Documentation on user properties is here: https://learn.microsoft.com/en-us/graph/api/user-update</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">                The ID of the user (can also be email). This is also the unique identifier.</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">            updated_settings (dict):</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">                The new data to update the user with.</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">                Response of the M365 Graph API  or None if the call fails.</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>            <span class="s2">&quot;Updating M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2"> with -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">updated_settings</span><span class="p">),</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>        <span class="p">)</span>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">updated_settings</span><span class="p">,</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; with -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>                <span class="n">updated_settings</span><span class="p">,</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>            <span class="p">),</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>        <span class="p">)</span>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_user_licenses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assigned license SKUs of a user.</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            dict:</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">                A list of user licenses or None if request fails.</span>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            {</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">                &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#users(&#39;a5875311-f0a5-486d-a746-bd7372b91115&#39;)/licenseDetails&quot;,</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">                &#39;value&#39;: [</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">                    {</span>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">                        &#39;id&#39;: &#39;8DRPYHK6IUOra-Nq6L0A7GAn38eBLPdOtXhbU5K1cd8&#39;,</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">                        &#39;skuId&#39;: &#39;c7df2760-2c81-4ef7-b578-5b5392b571df&#39;,</span>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">                        &#39;skuPartNumber&#39;: &#39;ENTERPRISEPREMIUM&#39;,</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">                        &#39;servicePlans&#39;: [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, ...]</span>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">                    }</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">                ]</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            }</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/licenseDetails&quot;</span>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 licenses of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>        <span class="p">)</span>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assign_license_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sku_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an M365 license to a user (e.g. to use Office 365).</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user)</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">            sku_id (str):</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">                M365 GUID of the SKU.</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">                (e.g. c7df2760-2c81-4ef7-b578-5b5392b571df for E5 and</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                6fd2c87f-b296-42f0-b197-1e91e994b900 for E3)</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">            dict:</span>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">                The API response or None if request fails.</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/assignLicense&quot;</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>        <span class="c1"># Construct the request body for assigning the E5 license</span>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>        <span class="n">license_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>            <span class="s2">&quot;addLicenses&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>                <span class="p">{</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>                    <span class="s2">&quot;disabledPlans&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>                    <span class="s2">&quot;skuId&quot;</span><span class="p">:</span> <span class="n">sku_id</span><span class="p">,</span>  <span class="c1"># &quot;c42b9cae-ea4f-4a69-9ca5-c53bd8779c42&quot;</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>                <span class="p">},</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>            <span class="p">],</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>            <span class="s2">&quot;removeLicenses&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="p">}</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>            <span class="s2">&quot;Assign M365 license -&gt; </span><span class="si">%s</span><span class="s2"> to M365 user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>            <span class="n">sku_id</span><span class="p">,</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="p">)</span>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">license_post_body</span><span class="p">,</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 license -&gt; </span><span class="si">{}</span><span class="s2"> to M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>                <span class="n">sku_id</span><span class="p">,</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>            <span class="p">),</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>        <span class="p">)</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_user_photo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the photo of a M365 user.</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">                Whether or not an error should be logged if the user</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">                does not have a photo in M365.</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">            bytes:</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">                Image of the user photo or None if the user photo couldn&#39;t be retrieved.</span>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/photo/$value&quot;</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="c1"># Set image as content type:</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">(</span><span class="s2">&quot;image/*&quot;</span><span class="p">)</span>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>            <span class="s2">&quot;Get photo of user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="p">)</span>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get photo of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;M365 User -&gt; </span><span class="si">{}</span><span class="s2"> does not yet have a photo.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>            <span class="p">),</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>            <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># the response is NOT JSON!</span>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>        <span class="p">)</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>  <span class="c1"># this is the actual image - not json!</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">download_user_photo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Download the M365 user photo and save it to the local file system.</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">            photo_path (str):</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">                The directory where the photo should be saved.</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">            str:</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">                The name of the photo file in the file system (with full path) or None if</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">                the call of the REST API fails.</span>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/photo/$value&quot;</span>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">(</span><span class="s2">&quot;application/json&quot;</span><span class="p">)</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>            <span class="s2">&quot;Downloading photo for M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>        <span class="p">)</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to download photo for M365 user with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>            <span class="p">),</span>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>            <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>        <span class="p">)</span>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>            <span class="n">content_type</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;image/png&quot;</span><span class="p">)</span>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>            <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;image/jpeg&quot;</span><span class="p">:</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>                <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;jpg&quot;</span>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>            <span class="k">elif</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;image/png&quot;</span><span class="p">:</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>                <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>                <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;img&quot;</span>  <span class="c1"># Default extension if type is unknown</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>                <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>                <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">file_extension</span><span class="p">),</span>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>            <span class="p">)</span>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>                    <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">))</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>                    <span class="s2">&quot;Error saving photo for user with ID -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>                    <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>                <span class="p">)</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>                    <span class="s2">&quot;Photo for M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2"> saved to -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>                    <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>                    <span class="n">file_path</span><span class="p">,</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>                <span class="p">)</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>                <span class="k">return</span> <span class="n">file_path</span>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1315"><a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>
</span><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_user_photo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the M365 user photo.</span>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">            photo_path (str):</span>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">                The file system path with the location of the photo file.</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">                Response of Graph REST API or None if the user photo couldn&#39;t be updated.</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/photo/$value&quot;</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>        <span class="c1"># Set image as content type:</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">(</span><span class="s2">&quot;image/*&quot;</span><span class="p">)</span>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>        <span class="c1"># Check if the photo file exists</span>
</span><span id="__span-0-1338"><a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">photo_path</span><span class="p">):</span>
</span><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Photo file -&gt; </span><span class="si">%s</span><span class="s2"> not found!&quot;</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">)</span>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>            <span class="c1"># Read the photo file as binary data</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">photo_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image_file</span><span class="p">:</span>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>                <span class="n">photo_data</span> <span class="o">=</span> <span class="n">image_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>            <span class="c1"># Handle any errors that occurred while reading the photo file</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>                <span class="s2">&quot;Error reading photo file -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>                <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>            <span class="p">)</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">photo_data</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>            <span class="s2">&quot;Update M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2"> with photo -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>            <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>        <span class="p">)</span>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update M365 user with ID -&gt; </span><span class="si">{}</span><span class="s2"> with photo -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>                <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>            <span class="p">),</span>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>        <span class="p">)</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_user_drive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">me</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mysite (OneDrive) of the user.</span>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">        It may be required to do this before certain other operations</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">        are possible. These operations may require that the mydrive</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><span class="sd">        is initialized for that user. If you get errors like</span>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">        &quot;User&#39;s mysite not found.&quot; this may be the case.</span>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">            me (bool, optional):</span>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">                Should be True if the user itself is accessing the drive.</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">            dict:</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">                A list of user licenses or None if request fails.</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">        {</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#drives/$entity&#39;,</span>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2025-04-10T23:43:26Z&#39;,</span>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">            &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="sd">            &#39;id&#39;: &#39;b!VsxYN1IbrEqbiwMiba_M7FCkNAhL5LRFnQEZpEYbxDAxvvcvUMAhSqfgWW_4eAUP&#39;,</span>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">            &#39;lastModifiedDateTime&#39;: &#39;2025-04-12T15:50:20Z&#39;,</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">            &#39;name&#39;: &#39;OneDrive&#39;,</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">            &#39;webUrl&#39;: &#39;https://ideateqa-my.sharepoint.com/personal/jbenham_qa_idea-te_eimdemo_com/Documents&#39;,</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">            &#39;driveType&#39;: &#39;business&#39;,</span>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">            &#39;createdBy&#39;: {</span>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">                &#39;user&#39;: {</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">                    &#39;displayName&#39;: &#39;System Account&#39;</span>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">                }</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a><span class="sd">            },</span>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a><span class="sd">            &#39;lastModifiedBy&#39;: {</span>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">                &#39;user&#39;: {</span>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">                    &#39;email&#39;: &#39;jbenham@qa.idea-te.eimdemo.com&#39;,</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">                    &#39;id&#39;: &#39;470060cc-4d9f-439e-8a6e-8d567c5bda80&#39;,</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a><span class="sd">                    &#39;displayName&#39;: &#39;Jeff Benham&#39;</span>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a><span class="sd">                }</span>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a><span class="sd">            },</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a><span class="sd">            &#39;owner&#39;: {</span>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><span class="sd">                &#39;user&#39;: {...}</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><span class="sd">            },</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="sd">            &#39;quota&#39;: {</span>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><span class="sd">                &#39;deleted&#39;: 0,</span>
</span><span id="__span-0-1422"><a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="sd">                &#39;remaining&#39;: 1099511518137,</span>
</span><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">                &#39;state&#39;: &#39;normal&#39;,</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">                &#39;total&#39;: 1099511627776,</span>
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">                &#39;used&#39;: 109639</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">            }</span>
</span><span id="__span-0-1427"><a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><span class="sd">        }</span>
</span><span id="__span-0-1428"><a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>
</span><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;meUrl&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">me</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/drive&quot;</span>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header_user</span><span class="p">()</span> <span class="k">if</span> <span class="n">me</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get mySite (drive) of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>        <span class="p">)</span>
</span><span id="__span-0-1442"><a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>
</span><span id="__span-0-1443"><a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1444"><a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>
</span><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_groups</span><span class="p">(</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1447"><a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>        <span class="n">max_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
</span><span id="__span-0-1448"><a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>        <span class="n">next_page_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1449"><a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1450"><a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get list all all groups in M365 tenant.</span>
</span><span id="__span-0-1451"><a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>
</span><span id="__span-0-1452"><a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1453"><a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">            max_number (int, optional):</span>
</span><span id="__span-0-1454"><a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">                The maximum result values (limit).</span>
</span><span id="__span-0-1455"><a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">            next_page_url (str, optional):</span>
</span><span id="__span-0-1456"><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="sd">                The MS Graph URL to retrieve the next page of M365 groups (pagination).</span>
</span><span id="__span-0-1457"><a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">                This is used for the iterator get_groups_iterator() below.</span>
</span><span id="__span-0-1458"><a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>
</span><span id="__span-0-1459"><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="sd">            dict:</span>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">                A dictionary of all groups or None in case of an error.</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="n">next_page_url</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1467"><a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
</span><span id="__span-0-1468"><a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1469"><a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>            <span class="s2">&quot;Get list of all M365 groups</span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1470"><a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>            <span class="s2">&quot; (paged)&quot;</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-1471"><a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1472"><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>        <span class="p">)</span>
</span><span id="__span-0-1473"><a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>
</span><span id="__span-0-1474"><a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1475"><a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1476"><a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1477"><a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1478"><a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;$top&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_number</span><span class="p">)}</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1479"><a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1480"><a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 groups&quot;</span><span class="p">,</span>
</span><span id="__span-0-1481"><a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>        <span class="p">)</span>
</span><span id="__span-0-1482"><a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>
</span><span id="__span-0-1483"><a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-1484"><a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>
</span><span id="__span-0-1485"><a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1486"><a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>
</span><span id="__span-0-1487"><a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_groups_iterator</span><span class="p">(</span>
</span><span id="__span-0-1488"><a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1489"><a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">iter</span><span class="p">:</span>
</span><span id="__span-0-1490"><a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an iterator object that can be used to traverse all M365 groups.</span>
</span><span id="__span-0-1491"><a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>
</span><span id="__span-0-1492"><a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">        Returning a generator avoids loading a large number of nodes into memory at once. Instead you</span>
</span><span id="__span-0-1493"><a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">        can iterate over the potential large list of groups.</span>
</span><span id="__span-0-1494"><a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>
</span><span id="__span-0-1495"><a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">        Example usage:</span>
</span><span id="__span-0-1496"><a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">            groups = m365_object.get_groups_iterator()</span>
</span><span id="__span-0-1497"><a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">            for group in groups:</span>
</span><span id="__span-0-1498"><a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><span class="sd">                logger.info(&quot;Traversing M365 group -&gt; &#39;%s&#39;...&quot;, group.get(&quot;displayName&quot;, &quot;&lt;undefined name&gt;&quot;))</span>
</span><span id="__span-0-1499"><a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>
</span><span id="__span-0-1500"><a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1501"><a id="__codelineno-0-1501" name="__codelineno-0-1501"></a><span class="sd">            iter:</span>
</span><span id="__span-0-1502"><a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><span class="sd">                A generator yielding one M365 group per iteration.</span>
</span><span id="__span-0-1503"><a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><span class="sd">                If the REST API fails, returns no value.</span>
</span><span id="__span-0-1504"><a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>
</span><span id="__span-0-1505"><a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1506"><a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>
</span><span id="__span-0-1507"><a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>        <span class="n">next_page_url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-1508"><a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>
</span><span id="__span-0-1509"><a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-1510"><a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_groups</span><span class="p">(</span>
</span><span id="__span-0-1511"><a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>                <span class="n">next_page_url</span><span class="o">=</span><span class="n">next_page_url</span><span class="p">,</span>
</span><span id="__span-0-1512"><a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>            <span class="p">)</span>
</span><span id="__span-0-1513"><a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-1514"><a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>                <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-1515"><a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>                <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-1516"><a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>                <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-1517"><a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>                <span class="k">return</span>
</span><span id="__span-0-1518"><a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>
</span><span id="__span-0-1519"><a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>            <span class="c1"># Yield users one at a time:</span>
</span><span id="__span-0-1520"><a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>            <span class="k">yield from</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-1521"><a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>
</span><span id="__span-0-1522"><a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>            <span class="c1"># See if we have an additional result page.</span>
</span><span id="__span-0-1523"><a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>            <span class="c1"># If not terminate the iterator and return</span>
</span><span id="__span-0-1524"><a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>            <span class="c1"># no value.</span>
</span><span id="__span-0-1525"><a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>            <span class="n">next_page_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.nextLink&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-1526"><a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-1527"><a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>                <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-1528"><a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>                <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-1529"><a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>                <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-1530"><a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>                <span class="k">return</span>
</span><span id="__span-0-1531"><a id="__codelineno-0-1531" name="__codelineno-0-1531"></a>
</span><span id="__span-0-1532"><a id="__codelineno-0-1532" name="__codelineno-0-1532"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1533"><a id="__codelineno-0-1533" name="__codelineno-0-1533"></a>
</span><span id="__span-0-1534"><a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1535"><a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a M365 Group based on its name.</span>
</span><span id="__span-0-1536"><a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>
</span><span id="__span-0-1537"><a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1538"><a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">            group_name (str):</span>
</span><span id="__span-0-1539"><a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">                The M365 Group name.</span>
</span><span id="__span-0-1540"><a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">            show_error (bool):</span>
</span><span id="__span-0-1541"><a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><span class="sd">                Should an error be logged if group is not found.</span>
</span><span id="__span-0-1542"><a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>
</span><span id="__span-0-1543"><a id="__codelineno-0-1543" name="__codelineno-0-1543"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1544"><a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">            dict:</span>
</span><span id="__span-0-1545"><a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">                Group information or None if the group doesn&#39;t exist.</span>
</span><span id="__span-0-1546"><a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>
</span><span id="__span-0-1547"><a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1548"><a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">            {</span>
</span><span id="__span-0-1549"><a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#groups&#39;,</span>
</span><span id="__span-0-1550"><a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">                &#39;value&#39;: [</span>
</span><span id="__span-0-1551"><a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">                    {</span>
</span><span id="__span-0-1552"><a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">                        &#39;id&#39;: &#39;b65f7dba-3ed1-49df-91bf-2bf99affcc8d&#39;,</span>
</span><span id="__span-0-1553"><a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">                        &#39;deletedDateTime&#39;: None,</span>
</span><span id="__span-0-1554"><a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">                        &#39;classification&#39;: None,</span>
</span><span id="__span-0-1555"><a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">                        &#39;createdDateTime&#39;: &#39;2023-04-01T13:46:26Z&#39;,</span>
</span><span id="__span-0-1556"><a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">                        &#39;creationOptions&#39;: [],</span>
</span><span id="__span-0-1557"><a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">                        &#39;description&#39;: &#39;Engineering &amp; Construction&#39;,</span>
</span><span id="__span-0-1558"><a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">                        &#39;displayName&#39;: &#39;Engineering &amp; Construction&#39;,</span>
</span><span id="__span-0-1559"><a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">                        &#39;expirationDateTime&#39;: None,</span>
</span><span id="__span-0-1560"><a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">                        &#39;groupTypes&#39;: [&#39;Unified&#39;],</span>
</span><span id="__span-0-1561"><a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">                        &#39;isAssignableToRole&#39;: None,</span>
</span><span id="__span-0-1562"><a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">                        &#39;mail&#39;: &#39;Engineering&amp;Construction@M365x61936377.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-1563"><a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">                        &#39;mailEnabled&#39;: True,</span>
</span><span id="__span-0-1564"><a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">                        &#39;mailNickname&#39;: &#39;Engineering&amp;Construction&#39;,</span>
</span><span id="__span-0-1565"><a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">                        &#39;membershipRule&#39;: None,</span>
</span><span id="__span-0-1566"><a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">                        &#39;membershipRuleProcessingState&#39;: None,</span>
</span><span id="__span-0-1567"><a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">                        &#39;onPremisesDomainName&#39;: None,</span>
</span><span id="__span-0-1568"><a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">                        &#39;onPremisesLastSyncDateTime&#39;: None,</span>
</span><span id="__span-0-1569"><a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">                        &#39;onPremisesNetBiosName&#39;: None,</span>
</span><span id="__span-0-1570"><a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">                        &#39;onPremisesSamAccountName&#39;: None,</span>
</span><span id="__span-0-1571"><a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">                        &#39;onPremisesSecurityIdentifier&#39;: None,</span>
</span><span id="__span-0-1572"><a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">                        &#39;onPremisesSyncEnabled&#39;: None,</span>
</span><span id="__span-0-1573"><a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">                        &#39;preferredDataLocation&#39;: None,</span>
</span><span id="__span-0-1574"><a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">                        &#39;preferredLanguage&#39;: None,</span>
</span><span id="__span-0-1575"><a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">                        &#39;proxyAddresses&#39;: [&#39;SPO:SPO_d9deb3e7-c72f-4e8d-80fb-5d9411ca1458@SPO_604f34f0-ba72-4321-ab6b-e36ae8bd00ec&#39;, ...],</span>
</span><span id="__span-0-1576"><a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">                        &#39;renewedDateTime&#39;: &#39;2023-04-01T13:46:26Z&#39;,</span>
</span><span id="__span-0-1577"><a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">                        &#39;resourceBehaviorOptions&#39;: [],</span>
</span><span id="__span-0-1578"><a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">                        &#39;resourceProvisioningOptions&#39;: [],</span>
</span><span id="__span-0-1579"><a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">                        &#39;securityEnabled&#39;: False,</span>
</span><span id="__span-0-1580"><a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">                        &#39;securityIdentifier&#39;: &#39;S-1-12-1-3059711418-1239367377-4180393873-2379022234&#39;,</span>
</span><span id="__span-0-1581"><a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><span class="sd">                        &#39;theme&#39;: None,</span>
</span><span id="__span-0-1582"><a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">                        &#39;visibility&#39;: &#39;Public&#39;,</span>
</span><span id="__span-0-1583"><a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">                        &#39;onPremisesProvisioningErrors&#39;: []</span>
</span><span id="__span-0-1584"><a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">                    },</span>
</span><span id="__span-0-1585"><a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">                    {</span>
</span><span id="__span-0-1586"><a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">                        &#39;id&#39;: &#39;61359860-302e-4016-b5cc-abff2293dff1&#39;,</span>
</span><span id="__span-0-1587"><a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">                        ...</span>
</span><span id="__span-0-1588"><a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="sd">                    }</span>
</span><span id="__span-0-1589"><a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">                ]</span>
</span><span id="__span-0-1590"><a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><span class="sd">            }</span>
</span><span id="__span-0-1591"><a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>
</span><span id="__span-0-1592"><a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1593"><a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>
</span><span id="__span-0-1594"><a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$filter&quot;</span><span class="p">:</span> <span class="s2">&quot;displayName eq &#39;&quot;</span> <span class="o">+</span> <span class="n">group_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
</span><span id="__span-0-1595"><a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1596"><a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
</span><span id="__span-0-1597"><a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-1598"><a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1599"><a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>
</span><span id="__span-0-1600"><a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1601"><a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>            <span class="s2">&quot;Get M365 group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1602"><a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1603"><a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1604"><a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>        <span class="p">)</span>
</span><span id="__span-0-1605"><a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>
</span><span id="__span-0-1606"><a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1607"><a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1608"><a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1609"><a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1610"><a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1611"><a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group_name</span><span class="p">),</span>
</span><span id="__span-0-1612"><a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-1613"><a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>        <span class="p">)</span>
</span><span id="__span-0-1614"><a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>
</span><span id="__span-0-1615"><a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1616"><a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
</span><span id="__span-0-1617"><a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_group</span><span class="p">(</span>
</span><span id="__span-0-1618"><a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1619"><a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1620"><a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>        <span class="n">security_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1621"><a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>        <span class="n">mail_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-1622"><a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1623"><a id="__codelineno-0-1623" name="__codelineno-0-1623"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a M365 Group.</span>
</span><span id="__span-0-1624"><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>
</span><span id="__span-0-1625"><a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1626"><a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">            name (str):</span>
</span><span id="__span-0-1627"><a id="__codelineno-0-1627" name="__codelineno-0-1627"></a><span class="sd">                The name of the group.</span>
</span><span id="__span-0-1628"><a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><span class="sd">            security_enabled (bool, optional):</span>
</span><span id="__span-0-1629"><a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">                Whether or not this group is used for permission management.</span>
</span><span id="__span-0-1630"><a id="__codelineno-0-1630" name="__codelineno-0-1630"></a><span class="sd">            mail_enabled (bool, optional):</span>
</span><span id="__span-0-1631"><a id="__codelineno-0-1631" name="__codelineno-0-1631"></a><span class="sd">                Whether or not this group is email enabled.</span>
</span><span id="__span-0-1632"><a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>
</span><span id="__span-0-1633"><a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1634"><a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1635"><a id="__codelineno-0-1635" name="__codelineno-0-1635"></a><span class="sd">                Group information or None if the group couldn&#39;t be created (e.g. because it exisits already).</span>
</span><span id="__span-0-1636"><a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>
</span><span id="__span-0-1637"><a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="sd">        Example:</span>
</span><span id="__span-0-1638"><a id="__codelineno-0-1638" name="__codelineno-0-1638"></a><span class="sd">            {</span>
</span><span id="__span-0-1639"><a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#groups/$entity&#39;,</span>
</span><span id="__span-0-1640"><a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">                &#39;id&#39;: &#39;28906460-a69c-439e-84ca-c70becf37655&#39;,</span>
</span><span id="__span-0-1641"><a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><span class="sd">                &#39;deletedDateTime&#39;: None,</span>
</span><span id="__span-0-1642"><a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="sd">                &#39;classification&#39;: None,</span>
</span><span id="__span-0-1643"><a id="__codelineno-0-1643" name="__codelineno-0-1643"></a><span class="sd">                &#39;createdDateTime&#39;: &#39;2023-04-01T11:40:13Z&#39;,</span>
</span><span id="__span-0-1644"><a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="sd">                &#39;creationOptions&#39;: [],</span>
</span><span id="__span-0-1645"><a id="__codelineno-0-1645" name="__codelineno-0-1645"></a><span class="sd">                &#39;description&#39;: None,</span>
</span><span id="__span-0-1646"><a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">                &#39;displayName&#39;: &#39;Test&#39;,</span>
</span><span id="__span-0-1647"><a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><span class="sd">                &#39;expirationDateTime&#39;: None,</span>
</span><span id="__span-0-1648"><a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">                &#39;groupTypes&#39;: [&#39;Unified&#39;],</span>
</span><span id="__span-0-1649"><a id="__codelineno-0-1649" name="__codelineno-0-1649"></a><span class="sd">                &#39;isAssignableToRole&#39;: None,</span>
</span><span id="__span-0-1650"><a id="__codelineno-0-1650" name="__codelineno-0-1650"></a><span class="sd">                &#39;mail&#39;: &#39;Diefenbruch@M365x61936377.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-1651"><a id="__codelineno-0-1651" name="__codelineno-0-1651"></a><span class="sd">                &#39;mailEnabled&#39;: True,</span>
</span><span id="__span-0-1652"><a id="__codelineno-0-1652" name="__codelineno-0-1652"></a><span class="sd">                &#39;mailNickname&#39;: &#39;Test&#39;,</span>
</span><span id="__span-0-1653"><a id="__codelineno-0-1653" name="__codelineno-0-1653"></a><span class="sd">                &#39;membershipRule&#39;: None,</span>
</span><span id="__span-0-1654"><a id="__codelineno-0-1654" name="__codelineno-0-1654"></a><span class="sd">                &#39;membershipRuleProcessingState&#39;: None,</span>
</span><span id="__span-0-1655"><a id="__codelineno-0-1655" name="__codelineno-0-1655"></a><span class="sd">                &#39;onPremisesDomainName&#39;: None,</span>
</span><span id="__span-0-1656"><a id="__codelineno-0-1656" name="__codelineno-0-1656"></a><span class="sd">                &#39;onPremisesLastSyncDateTime&#39;: None,</span>
</span><span id="__span-0-1657"><a id="__codelineno-0-1657" name="__codelineno-0-1657"></a><span class="sd">                &#39;onPremisesNetBiosName&#39;: None,</span>
</span><span id="__span-0-1658"><a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><span class="sd">                &#39;onPremisesSamAccountName&#39;: None,</span>
</span><span id="__span-0-1659"><a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><span class="sd">                &#39;onPremisesSecurityIdentifier&#39;: None,</span>
</span><span id="__span-0-1660"><a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><span class="sd">                &#39;onPremisesSyncEnabled&#39;: None,</span>
</span><span id="__span-0-1661"><a id="__codelineno-0-1661" name="__codelineno-0-1661"></a><span class="sd">                &#39;onPremisesProvisioningErrors&#39;: [],</span>
</span><span id="__span-0-1662"><a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="sd">                &#39;preferredDataLocation&#39;: None,</span>
</span><span id="__span-0-1663"><a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">                &#39;preferredLanguage&#39;: None,</span>
</span><span id="__span-0-1664"><a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><span class="sd">                &#39;proxyAddresses&#39;: [&#39;SMTP:Test@M365x61936377.onmicrosoft.com&#39;],</span>
</span><span id="__span-0-1665"><a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><span class="sd">                &#39;renewedDateTime&#39;: &#39;2023-04-01T11:40:13Z&#39;,</span>
</span><span id="__span-0-1666"><a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><span class="sd">                &#39;resourceBehaviorOptions&#39;: [],</span>
</span><span id="__span-0-1667"><a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">                &#39;resourceProvisioningOptions&#39;: [],</span>
</span><span id="__span-0-1668"><a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">                &#39;securityEnabled&#39;: True,</span>
</span><span id="__span-0-1669"><a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">                &#39;securityIdentifier&#39;: &#39;S-1-12-1-680551520-1134470812-197642884-1433859052&#39;,</span>
</span><span id="__span-0-1670"><a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">                &#39;theme&#39;: None,</span>
</span><span id="__span-0-1671"><a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">                &#39;visibility&#39;: &#39;Public&#39;</span>
</span><span id="__span-0-1672"><a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">            }</span>
</span><span id="__span-0-1673"><a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>
</span><span id="__span-0-1674"><a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1675"><a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>
</span><span id="__span-0-1676"><a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>        <span class="n">group_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1677"><a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>            <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-1678"><a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>            <span class="s2">&quot;mailEnabled&quot;</span><span class="p">:</span> <span class="n">mail_enabled</span><span class="p">,</span>
</span><span id="__span-0-1679"><a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>            <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-0-1680"><a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>            <span class="s2">&quot;securityEnabled&quot;</span><span class="p">:</span> <span class="n">security_enabled</span><span class="p">,</span>
</span><span id="__span-0-1681"><a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>            <span class="s2">&quot;groupTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Unified&quot;</span><span class="p">],</span>
</span><span id="__span-0-1682"><a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>        <span class="p">}</span>
</span><span id="__span-0-1683"><a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>
</span><span id="__span-0-1684"><a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-1685"><a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1686"><a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>
</span><span id="__span-0-1687"><a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding M365 group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-1688"><a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;M365 group attributes -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">group_post_body</span><span class="p">))</span>
</span><span id="__span-0-1689"><a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>
</span><span id="__span-0-1690"><a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1691"><a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1692"><a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1693"><a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1694"><a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">group_post_body</span><span class="p">),</span>
</span><span id="__span-0-1695"><a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1696"><a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
</span><span id="__span-0-1697"><a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>        <span class="p">)</span>
</span><span id="__span-0-1698"><a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>
</span><span id="__span-0-1699"><a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1700"><a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>
</span><span id="__span-0-1701"><a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_group_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1702"><a id="__codelineno-0-1702" name="__codelineno-0-1702"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get members (users and groups) of the specified group.</span>
</span><span id="__span-0-1703"><a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>
</span><span id="__span-0-1704"><a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1705"><a id="__codelineno-0-1705" name="__codelineno-0-1705"></a><span class="sd">            group_name (str):</span>
</span><span id="__span-0-1706"><a id="__codelineno-0-1706" name="__codelineno-0-1706"></a><span class="sd">                The name of the group.</span>
</span><span id="__span-0-1707"><a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>
</span><span id="__span-0-1708"><a id="__codelineno-0-1708" name="__codelineno-0-1708"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1709"><a id="__codelineno-0-1709" name="__codelineno-0-1709"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1710"><a id="__codelineno-0-1710" name="__codelineno-0-1710"></a><span class="sd">                Response of Graph REST API or None if the REST call fails.</span>
</span><span id="__span-0-1711"><a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>
</span><span id="__span-0-1712"><a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1713"><a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>
</span><span id="__span-0-1714"><a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-1715"><a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>        <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1716"><a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-1717"><a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1718"><a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>                <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; does not exist! Cannot retrieve group members.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1719"><a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1720"><a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>            <span class="p">)</span>
</span><span id="__span-0-1721"><a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1722"><a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>
</span><span id="__span-0-1723"><a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$select&quot;</span><span class="p">:</span> <span class="s2">&quot;id,displayName,mail,userPrincipalName&quot;</span><span class="p">}</span>
</span><span id="__span-0-1724"><a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1725"><a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>
</span><span id="__span-0-1726"><a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/members?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-1727"><a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1728"><a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>
</span><span id="__span-0-1729"><a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1730"><a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>            <span class="s2">&quot;Get members of M365 group -&gt; </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1731"><a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1732"><a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1733"><a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1734"><a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>        <span class="p">)</span>
</span><span id="__span-0-1735"><a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>
</span><span id="__span-0-1736"><a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1737"><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1738"><a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1739"><a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1740"><a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1741"><a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get members of M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1742"><a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1743"><a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>                <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1744"><a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>            <span class="p">),</span>
</span><span id="__span-0-1745"><a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>        <span class="p">)</span>
</span><span id="__span-0-1746"><a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>
</span><span id="__span-0-1747"><a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1748"><a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
</span><span id="__span-0-1749"><a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_group_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">member_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1750"><a id="__codelineno-0-1750" name="__codelineno-0-1750"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a member (user or group) to a (parent) group.</span>
</span><span id="__span-0-1751"><a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>
</span><span id="__span-0-1752"><a id="__codelineno-0-1752" name="__codelineno-0-1752"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1753"><a id="__codelineno-0-1753" name="__codelineno-0-1753"></a><span class="sd">            group_id (str):</span>
</span><span id="__span-0-1754"><a id="__codelineno-0-1754" name="__codelineno-0-1754"></a><span class="sd">                The M365 GUID of the group.</span>
</span><span id="__span-0-1755"><a id="__codelineno-0-1755" name="__codelineno-0-1755"></a><span class="sd">            member_id (str):</span>
</span><span id="__span-0-1756"><a id="__codelineno-0-1756" name="__codelineno-0-1756"></a><span class="sd">                The M365 GUID of the new member.</span>
</span><span id="__span-0-1757"><a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
</span><span id="__span-0-1758"><a id="__codelineno-0-1758" name="__codelineno-0-1758"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1759"><a id="__codelineno-0-1759" name="__codelineno-0-1759"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1760"><a id="__codelineno-0-1760" name="__codelineno-0-1760"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-1761"><a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>
</span><span id="__span-0-1762"><a id="__codelineno-0-1762" name="__codelineno-0-1762"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1763"><a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
</span><span id="__span-0-1764"><a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/members/$ref&quot;</span>
</span><span id="__span-0-1765"><a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1766"><a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>
</span><span id="__span-0-1767"><a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>        <span class="n">group_member_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1768"><a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>            <span class="s2">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryObjects&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1769"><a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>        <span class="p">}</span>
</span><span id="__span-0-1770"><a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
</span><span id="__span-0-1771"><a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1772"><a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>            <span class="s2">&quot;Adding member -&gt; </span><span class="si">%s</span><span class="s2"> to group -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1773"><a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>            <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1774"><a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1775"><a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1776"><a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>        <span class="p">)</span>
</span><span id="__span-0-1777"><a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>
</span><span id="__span-0-1778"><a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1779"><a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1780"><a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1781"><a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1782"><a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">group_member_post_body</span><span class="p">),</span>
</span><span id="__span-0-1783"><a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1784"><a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add member -&gt; </span><span class="si">{}</span><span class="s2"> to M365 group -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1785"><a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>                <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1786"><a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>                <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1787"><a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>            <span class="p">),</span>
</span><span id="__span-0-1788"><a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>        <span class="p">)</span>
</span><span id="__span-0-1789"><a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>
</span><span id="__span-0-1790"><a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1791"><a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>
</span><span id="__span-0-1792"><a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">member_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1793"><a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether a M365 user is already in a M365 group.</span>
</span><span id="__span-0-1794"><a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>
</span><span id="__span-0-1795"><a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1796"><a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">            group_id (str):</span>
</span><span id="__span-0-1797"><a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">                The M365 GUID of the group.</span>
</span><span id="__span-0-1798"><a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><span class="sd">            member_id (str):</span>
</span><span id="__span-0-1799"><a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">                The M365 GUID of the user (member).</span>
</span><span id="__span-0-1800"><a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">            show_error (bool):</span>
</span><span id="__span-0-1801"><a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">                Whether or not an error should be logged if the user</span>
</span><span id="__span-0-1802"><a id="__codelineno-0-1802" name="__codelineno-0-1802"></a><span class="sd">                is not a member of the group.</span>
</span><span id="__span-0-1803"><a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>
</span><span id="__span-0-1804"><a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1805"><a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">            bool:</span>
</span><span id="__span-0-1806"><a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">                True if the user is in the group. False otherwise.</span>
</span><span id="__span-0-1807"><a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>
</span><span id="__span-0-1808"><a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1809"><a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>
</span><span id="__span-0-1810"><a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>        <span class="c1"># don&#39;t encode this URL - this has not been working!!</span>
</span><span id="__span-0-1811"><a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">group_id</span><span class="si">}</span><span class="s2">/members?$filter=id eq &#39;</span><span class="si">{</span><span class="n">member_id</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-1812"><a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1813"><a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>
</span><span id="__span-0-1814"><a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1815"><a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>            <span class="s2">&quot;Check if user -&gt; </span><span class="si">%s</span><span class="s2"> is in group -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1816"><a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>            <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1817"><a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1818"><a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1819"><a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>        <span class="p">)</span>
</span><span id="__span-0-1820"><a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>
</span><span id="__span-0-1821"><a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1822"><a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1823"><a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1824"><a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1825"><a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1826"><a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to check if M365 user -&gt; </span><span class="si">{}</span><span class="s2"> is in M365 group -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1827"><a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>                <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1828"><a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>                <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1829"><a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>            <span class="p">),</span>
</span><span id="__span-0-1830"><a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-1831"><a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>        <span class="p">)</span>
</span><span id="__span-0-1832"><a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
</span><span id="__span-0-1833"><a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
</span><span id="__span-0-1834"><a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
</span><span id="__span-0-1835"><a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1836"><a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>
</span><span id="__span-0-1837"><a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_group_owners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1838"><a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get owners (users) of the specified group.</span>
</span><span id="__span-0-1839"><a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>
</span><span id="__span-0-1840"><a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1841"><a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><span class="sd">            group_name (str):</span>
</span><span id="__span-0-1842"><a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><span class="sd">                The name of the group.</span>
</span><span id="__span-0-1843"><a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>
</span><span id="__span-0-1844"><a id="__codelineno-0-1844" name="__codelineno-0-1844"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1845"><a id="__codelineno-0-1845" name="__codelineno-0-1845"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1846"><a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><span class="sd">                Response of Graph REST API or None if the REST call fails.</span>
</span><span id="__span-0-1847"><a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>
</span><span id="__span-0-1848"><a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1849"><a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>
</span><span id="__span-0-1850"><a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-1851"><a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>        <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1852"><a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-1853"><a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1854"><a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>                <span class="s2">&quot;M365 Group -&gt; </span><span class="si">%s</span><span class="s2"> does not exist! Cannot retrieve group owners.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1855"><a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1856"><a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>            <span class="p">)</span>
</span><span id="__span-0-1857"><a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1858"><a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>
</span><span id="__span-0-1859"><a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$select&quot;</span><span class="p">:</span> <span class="s2">&quot;id,displayName,mail,userPrincipalName&quot;</span><span class="p">}</span>
</span><span id="__span-0-1860"><a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1861"><a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>
</span><span id="__span-0-1862"><a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/owners?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-1863"><a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1864"><a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>
</span><span id="__span-0-1865"><a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1866"><a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>            <span class="s2">&quot;Get owners of M365 group -&gt; </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1867"><a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1868"><a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1869"><a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1870"><a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>        <span class="p">)</span>
</span><span id="__span-0-1871"><a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>
</span><span id="__span-0-1872"><a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1873"><a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1874"><a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1875"><a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1876"><a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1877"><a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get owners of M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1878"><a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1879"><a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>                <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1880"><a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>            <span class="p">),</span>
</span><span id="__span-0-1881"><a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>        <span class="p">)</span>
</span><span id="__span-0-1882"><a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>
</span><span id="__span-0-1883"><a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1884"><a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>
</span><span id="__span-0-1885"><a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_group_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">owner_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1886"><a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an owner (user) to a group.</span>
</span><span id="__span-0-1887"><a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>
</span><span id="__span-0-1888"><a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1889"><a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">            group_id (str):</span>
</span><span id="__span-0-1890"><a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">                The M365 GUID of the group.</span>
</span><span id="__span-0-1891"><a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">            owner_id (str):</span>
</span><span id="__span-0-1892"><a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">                The M365 GUID of the new member.</span>
</span><span id="__span-0-1893"><a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>
</span><span id="__span-0-1894"><a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1895"><a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1896"><a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">                The response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-1897"><a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>
</span><span id="__span-0-1898"><a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1899"><a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>
</span><span id="__span-0-1900"><a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/owners/$ref&quot;</span>
</span><span id="__span-0-1901"><a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1902"><a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
</span><span id="__span-0-1903"><a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>        <span class="n">group_member_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1904"><a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>            <span class="s2">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryObjects&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">owner_id</span><span class="p">,</span>
</span><span id="__span-0-1905"><a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>        <span class="p">}</span>
</span><span id="__span-0-1906"><a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>
</span><span id="__span-0-1907"><a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1908"><a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>            <span class="s2">&quot;Adding owner -&gt; </span><span class="si">%s</span><span class="s2"> to M365 group -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1909"><a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>            <span class="n">owner_id</span><span class="p">,</span>
</span><span id="__span-0-1910"><a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1911"><a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1912"><a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>        <span class="p">)</span>
</span><span id="__span-0-1913"><a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>
</span><span id="__span-0-1914"><a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1915"><a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1916"><a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1917"><a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1918"><a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">group_member_post_body</span><span class="p">),</span>
</span><span id="__span-0-1919"><a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1920"><a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add owner -&gt; </span><span class="si">{}</span><span class="s2"> to M365 group -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1921"><a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>                <span class="n">owner_id</span><span class="p">,</span>
</span><span id="__span-0-1922"><a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>                <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1923"><a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>            <span class="p">),</span>
</span><span id="__span-0-1924"><a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>        <span class="p">)</span>
</span><span id="__span-0-1925"><a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>
</span><span id="__span-0-1926"><a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1927"><a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>
</span><span id="__span-0-1928"><a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">purge_deleted_items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1929"><a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Purge all deleted users and groups.</span>
</span><span id="__span-0-1930"><a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>
</span><span id="__span-0-1931"><a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">        Purging users and groups requires administrative rights that typically</span>
</span><span id="__span-0-1932"><a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">        are not provided in Contoso example org.</span>
</span><span id="__span-0-1933"><a id="__codelineno-0-1933" name="__codelineno-0-1933"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1934"><a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>
</span><span id="__span-0-1935"><a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1936"><a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>
</span><span id="__span-0-1937"><a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/deletedItems/microsoft.graph.group&quot;</span>
</span><span id="__span-0-1938"><a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-0-1939"><a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1940"><a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1941"><a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1942"><a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>        <span class="p">)</span>
</span><span id="__span-0-1943"><a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>        <span class="n">deleted_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-0-1944"><a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>
</span><span id="__span-0-1945"><a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">deleted_groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-0-1946"><a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>            <span class="n">group_id</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-1947"><a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge_deleted_item</span><span class="p">(</span><span class="n">group_id</span><span class="p">)</span>
</span><span id="__span-0-1948"><a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>
</span><span id="__span-0-1949"><a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/deletedItems/microsoft.graph.user&quot;</span>
</span><span id="__span-0-1950"><a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-0-1951"><a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1952"><a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1953"><a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1954"><a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>        <span class="p">)</span>
</span><span id="__span-0-1955"><a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>        <span class="n">deleted_users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-0-1956"><a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>
</span><span id="__span-0-1957"><a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">deleted_users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-0-1958"><a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>            <span class="n">user_id</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-1959"><a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge_deleted_item</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
</span><span id="__span-0-1960"><a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>
</span><span id="__span-0-1961"><a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1962"><a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>
</span><span id="__span-0-1963"><a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">purge_deleted_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1964"><a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Purge a single deleted user or group.</span>
</span><span id="__span-0-1965"><a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>
</span><span id="__span-0-1966"><a id="__codelineno-0-1966" name="__codelineno-0-1966"></a><span class="sd">        This requires elevated permissions that are typically</span>
</span><span id="__span-0-1967"><a id="__codelineno-0-1967" name="__codelineno-0-1967"></a><span class="sd">        not available via Graph API.</span>
</span><span id="__span-0-1968"><a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>
</span><span id="__span-0-1969"><a id="__codelineno-0-1969" name="__codelineno-0-1969"></a><span class="sd">        Args:</span>
</span><span id="__span-0-1970"><a id="__codelineno-0-1970" name="__codelineno-0-1970"></a><span class="sd">            item_id (str):</span>
</span><span id="__span-0-1971"><a id="__codelineno-0-1971" name="__codelineno-0-1971"></a><span class="sd">                The M365 GUID of the item to purge.</span>
</span><span id="__span-0-1972"><a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>
</span><span id="__span-0-1973"><a id="__codelineno-0-1973" name="__codelineno-0-1973"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-1974"><a id="__codelineno-0-1974" name="__codelineno-0-1974"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-1975"><a id="__codelineno-0-1975" name="__codelineno-0-1975"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-1976"><a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>
</span><span id="__span-0-1977"><a id="__codelineno-0-1977" name="__codelineno-0-1977"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-1978"><a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>
</span><span id="__span-0-1979"><a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/deletedItems/&quot;</span> <span class="o">+</span> <span class="n">item_id</span>
</span><span id="__span-0-1980"><a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1981"><a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>
</span><span id="__span-0-1982"><a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1983"><a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>            <span class="s2">&quot;Purging deleted item -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1984"><a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>            <span class="n">item_id</span><span class="p">,</span>
</span><span id="__span-0-1985"><a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1986"><a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>        <span class="p">)</span>
</span><span id="__span-0-1987"><a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>
</span><span id="__span-0-1988"><a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1989"><a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1990"><a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-1991"><a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1992"><a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1993"><a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to purge deleted item -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item_id</span><span class="p">),</span>
</span><span id="__span-0-1994"><a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>        <span class="p">)</span>
</span><span id="__span-0-1995"><a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>
</span><span id="__span-0-1996"><a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-1997"><a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>
</span><span id="__span-0-1998"><a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1999"><a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a M365 Group has a M365 Team connected or not.</span>
</span><span id="__span-0-2000"><a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
</span><span id="__span-0-2001"><a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2002"><a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><span class="sd">            group_name (str):</span>
</span><span id="__span-0-2003"><a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">                The name of the M365 group.</span>
</span><span id="__span-0-2004"><a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>
</span><span id="__span-0-2005"><a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2006"><a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><span class="sd">            bool:</span>
</span><span id="__span-0-2007"><a id="__codelineno-0-2007" name="__codelineno-0-2007"></a><span class="sd">                Returns True if a Team is assigned and False otherwise.</span>
</span><span id="__span-0-2008"><a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
</span><span id="__span-0-2009"><a id="__codelineno-0-2009" name="__codelineno-0-2009"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2010"><a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>
</span><span id="__span-0-2011"><a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2012"><a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>        <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2013"><a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-2014"><a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2015"><a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>                <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found! Cannot check if it has a M365 Team.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2016"><a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2017"><a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>            <span class="p">)</span>
</span><span id="__span-0-2018"><a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2019"><a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>
</span><span id="__span-0-2020"><a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/team&quot;</span>
</span><span id="__span-0-2021"><a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2022"><a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>
</span><span id="__span-0-2023"><a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2024"><a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>            <span class="s2">&quot;Check if M365 Group -&gt; </span><span class="si">%s</span><span class="s2"> has a M365 Team connected; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2025"><a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2026"><a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2027"><a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>        <span class="p">)</span>
</span><span id="__span-0-2028"><a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>
</span><span id="__span-0-2029"><a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2030"><a id="__codelineno-0-2030" name="__codelineno-0-2030"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2031"><a id="__codelineno-0-2031" name="__codelineno-0-2031"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2032"><a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2033"><a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2034"><a id="__codelineno-0-2034" name="__codelineno-0-2034"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to check if M365 Group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; has a M365 Team connected&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2035"><a id="__codelineno-0-2035" name="__codelineno-0-2035"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2036"><a id="__codelineno-0-2036" name="__codelineno-0-2036"></a>            <span class="p">),</span>
</span><span id="__span-0-2037"><a id="__codelineno-0-2037" name="__codelineno-0-2037"></a>            <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2038"><a id="__codelineno-0-2038" name="__codelineno-0-2038"></a>            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2039"><a id="__codelineno-0-2039" name="__codelineno-0-2039"></a>        <span class="p">)</span>
</span><span id="__span-0-2040"><a id="__codelineno-0-2040" name="__codelineno-0-2040"></a>
</span><span id="__span-0-2041"><a id="__codelineno-0-2041" name="__codelineno-0-2041"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>  <span class="c1"># Group has a Team assigned!</span>
</span><span id="__span-0-2042"><a id="__codelineno-0-2042" name="__codelineno-0-2042"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has a M365 Team connected.&quot;</span><span class="p">,</span> <span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2043"><a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-2044"><a id="__codelineno-0-2044" name="__codelineno-0-2044"></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>  <span class="c1"># Group does not have a Team assigned!</span>
</span><span id="__span-0-2045"><a id="__codelineno-0-2045" name="__codelineno-0-2045"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has no M365 Team connected.&quot;</span><span class="p">,</span> <span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2046"><a id="__codelineno-0-2046" name="__codelineno-0-2046"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2047"><a id="__codelineno-0-2047" name="__codelineno-0-2047"></a>
</span><span id="__span-0-2048"><a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2049"><a id="__codelineno-0-2049" name="__codelineno-0-2049"></a>
</span><span id="__span-0-2050"><a id="__codelineno-0-2050" name="__codelineno-0-2050"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2051"><a id="__codelineno-0-2051" name="__codelineno-0-2051"></a>
</span><span id="__span-0-2052"><a id="__codelineno-0-2052" name="__codelineno-0-2052"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2053"><a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a M365 Team based on its name.</span>
</span><span id="__span-0-2054"><a id="__codelineno-0-2054" name="__codelineno-0-2054"></a>
</span><span id="__span-0-2055"><a id="__codelineno-0-2055" name="__codelineno-0-2055"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2056"><a id="__codelineno-0-2056" name="__codelineno-0-2056"></a><span class="sd">            name (str):</span>
</span><span id="__span-0-2057"><a id="__codelineno-0-2057" name="__codelineno-0-2057"></a><span class="sd">                The name of the M365 Team.</span>
</span><span id="__span-0-2058"><a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>
</span><span id="__span-0-2059"><a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2060"><a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2061"><a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><span class="sd">                Teams data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-2062"><a id="__codelineno-0-2062" name="__codelineno-0-2062"></a>
</span><span id="__span-0-2063"><a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">        Example:</span>
</span><span id="__span-0-2064"><a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">            {</span>
</span><span id="__span-0-2065"><a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#teams&#39;,</span>
</span><span id="__span-0-2066"><a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">                &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2067"><a id="__codelineno-0-2067" name="__codelineno-0-2067"></a><span class="sd">                &#39;value&#39;: [</span>
</span><span id="__span-0-2068"><a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">                    {</span>
</span><span id="__span-0-2069"><a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">                        &#39;id&#39;: &#39;951bd036-c6fc-4da4-bb80-1860f5472a2f&#39;,</span>
</span><span id="__span-0-2070"><a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><span class="sd">                        &#39;createdDateTime&#39;: None,</span>
</span><span id="__span-0-2071"><a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">                        &#39;displayName&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2072"><a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">                        &#39;description&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2073"><a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">                        &#39;internalId&#39;: None,</span>
</span><span id="__span-0-2074"><a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">                        &#39;classification&#39;: None,</span>
</span><span id="__span-0-2075"><a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">                        &#39;specialization&#39;: None,</span>
</span><span id="__span-0-2076"><a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">                        &#39;visibility&#39;: &#39;public&#39;,</span>
</span><span id="__span-0-2077"><a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">                        &#39;webUrl&#39;: None, ...}]}</span>
</span><span id="__span-0-2078"><a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">                        &#39;isArchived&#39;: None,</span>
</span><span id="__span-0-2079"><a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="sd">                        &#39;isMembershipLimitedToOwners&#39;: None,</span>
</span><span id="__span-0-2080"><a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">                        &#39;memberSettings&#39;: None,</span>
</span><span id="__span-0-2081"><a id="__codelineno-0-2081" name="__codelineno-0-2081"></a><span class="sd">                        &#39;guestSettings&#39;: None,</span>
</span><span id="__span-0-2082"><a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">                        &#39;messagingSettings&#39;: None,</span>
</span><span id="__span-0-2083"><a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">                        ...</span>
</span><span id="__span-0-2084"><a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">                    }</span>
</span><span id="__span-0-2085"><a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">                ]</span>
</span><span id="__span-0-2086"><a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">            }</span>
</span><span id="__span-0-2087"><a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>
</span><span id="__span-0-2088"><a id="__codelineno-0-2088" name="__codelineno-0-2088"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2089"><a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>
</span><span id="__span-0-2090"><a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>        <span class="c1"># The M365 Teams API has an issues with ampersand characters in team names (like &quot;Engineering &amp; Construction&quot;)</span>
</span><span id="__span-0-2091"><a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>        <span class="c1"># So we do a work-around here to first get the Team ID via the Group endpoint of the Graph API and</span>
</span><span id="__span-0-2092"><a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>        <span class="c1"># then fetch the M365 Team via its ID (which is identical to the underlying M365 Group ID)</span>
</span><span id="__span-0-2093"><a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2094"><a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>        <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2095"><a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-2096"><a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2097"><a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>                <span class="s2">&quot;Failed to get the ID of the M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; via the M365 Group API!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2098"><a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2099"><a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>            <span class="p">)</span>
</span><span id="__span-0-2100"><a id="__codelineno-0-2100" name="__codelineno-0-2100"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2101"><a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>
</span><span id="__span-0-2102"><a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span>
</span><span id="__span-0-2103"><a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>
</span><span id="__span-0-2104"><a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2105"><a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>
</span><span id="__span-0-2106"><a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2107"><a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>            <span class="s2">&quot;Lookup Microsoft 365 Teams with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2108"><a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2109"><a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2110"><a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>        <span class="p">)</span>
</span><span id="__span-0-2111"><a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>
</span><span id="__span-0-2112"><a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2113"><a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2114"><a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2115"><a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2116"><a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2117"><a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
</span><span id="__span-0-2118"><a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>        <span class="p">)</span>
</span><span id="__span-0-2119"><a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>
</span><span id="__span-0-2120"><a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2121"><a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>
</span><span id="__span-0-2122"><a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2123"><a id="__codelineno-0-2123" name="__codelineno-0-2123"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add M365 Team based on an existing M365 Group.</span>
</span><span id="__span-0-2124"><a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>
</span><span id="__span-0-2125"><a id="__codelineno-0-2125" name="__codelineno-0-2125"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2126"><a id="__codelineno-0-2126" name="__codelineno-0-2126"></a><span class="sd">            name (str):</span>
</span><span id="__span-0-2127"><a id="__codelineno-0-2127" name="__codelineno-0-2127"></a><span class="sd">                The name of the team. It is assumed that a group with the same name does already exist!</span>
</span><span id="__span-0-2128"><a id="__codelineno-0-2128" name="__codelineno-0-2128"></a><span class="sd">            template_name (str, optional):</span>
</span><span id="__span-0-2129"><a id="__codelineno-0-2129" name="__codelineno-0-2129"></a><span class="sd">                The name of the team template. &quot;standard&quot; is the default value.</span>
</span><span id="__span-0-2130"><a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>
</span><span id="__span-0-2131"><a id="__codelineno-0-2131" name="__codelineno-0-2131"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2132"><a id="__codelineno-0-2132" name="__codelineno-0-2132"></a><span class="sd">            dict:</span>
</span><span id="__span-0-2133"><a id="__codelineno-0-2133" name="__codelineno-0-2133"></a><span class="sd">                Team information (json - empty text!) or None if the team couldn&#39;t be created</span>
</span><span id="__span-0-2134"><a id="__codelineno-0-2134" name="__codelineno-0-2134"></a><span class="sd">                (e.g. because it exisits already).</span>
</span><span id="__span-0-2135"><a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>
</span><span id="__span-0-2136"><a id="__codelineno-0-2136" name="__codelineno-0-2136"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2137"><a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>
</span><span id="__span-0-2138"><a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2139"><a id="__codelineno-0-2139" name="__codelineno-0-2139"></a>        <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2140"><a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-2141"><a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2142"><a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>                <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found! It is required for creating a corresponding M365 Team.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2143"><a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2144"><a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>            <span class="p">)</span>
</span><span id="__span-0-2145"><a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2146"><a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>
</span><span id="__span-0-2147"><a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group_owners</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2148"><a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]:</span>
</span><span id="__span-0-2149"><a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-2150"><a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>                <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has no owners. This is required for creating a corresponding M365 Team.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2151"><a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2152"><a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>            <span class="p">)</span>
</span><span id="__span-0-2153"><a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2154"><a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>
</span><span id="__span-0-2155"><a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>        <span class="n">team_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2156"><a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>            <span class="s2">&quot;template@odata.bind&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(&#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2157"><a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsTemplatesUrl&quot;</span><span class="p">],</span>
</span><span id="__span-0-2158"><a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>                <span class="n">template_name</span><span class="p">,</span>
</span><span id="__span-0-2159"><a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>            <span class="p">),</span>
</span><span id="__span-0-2160"><a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>            <span class="s2">&quot;group@odata.bind&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(&#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">],</span> <span class="n">group_id</span><span class="p">),</span>
</span><span id="__span-0-2161"><a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>        <span class="p">}</span>
</span><span id="__span-0-2162"><a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>
</span><span id="__span-0-2163"><a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-2164"><a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2165"><a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>
</span><span id="__span-0-2166"><a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-2167"><a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;M365 Team attributes -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_post_body</span><span class="p">))</span>
</span><span id="__span-0-2168"><a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>
</span><span id="__span-0-2169"><a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2170"><a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2171"><a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-2172"><a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">team_post_body</span><span class="p">),</span>
</span><span id="__span-0-2173"><a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2174"><a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2175"><a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
</span><span id="__span-0-2176"><a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>        <span class="p">)</span>
</span><span id="__span-0-2177"><a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>
</span><span id="__span-0-2178"><a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2179"><a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>
</span><span id="__span-0-2180"><a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2181"><a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete Microsoft 365 Team with a specific ID.</span>
</span><span id="__span-0-2182"><a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
</span><span id="__span-0-2183"><a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2184"><a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">            team_id (str):</span>
</span><span id="__span-0-2185"><a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">                The ID of the Microsoft 365 Team to delete.</span>
</span><span id="__span-0-2186"><a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>
</span><span id="__span-0-2187"><a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2188"><a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2189"><a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">                Response dictionary if the team has been deleted, False otherwise.</span>
</span><span id="__span-0-2190"><a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>
</span><span id="__span-0-2191"><a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2192"><a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>
</span><span id="__span-0-2193"><a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span>
</span><span id="__span-0-2194"><a id="__codelineno-0-2194" name="__codelineno-0-2194"></a>
</span><span id="__span-0-2195"><a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2196"><a id="__codelineno-0-2196" name="__codelineno-0-2196"></a>
</span><span id="__span-0-2197"><a id="__codelineno-0-2197" name="__codelineno-0-2197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2198"><a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>            <span class="s2">&quot;Delete Microsoft 365 Teams with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2199"><a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2200"><a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2201"><a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>        <span class="p">)</span>
</span><span id="__span-0-2202"><a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
</span><span id="__span-0-2203"><a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2204"><a id="__codelineno-0-2204" name="__codelineno-0-2204"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2205"><a id="__codelineno-0-2205" name="__codelineno-0-2205"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-2206"><a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2207"><a id="__codelineno-0-2207" name="__codelineno-0-2207"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2208"><a id="__codelineno-0-2208" name="__codelineno-0-2208"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to delete M365 Team with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
</span><span id="__span-0-2209"><a id="__codelineno-0-2209" name="__codelineno-0-2209"></a>        <span class="p">)</span>
</span><span id="__span-0-2210"><a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>
</span><span id="__span-0-2211"><a id="__codelineno-0-2211" name="__codelineno-0-2211"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2212"><a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>
</span><span id="__span-0-2213"><a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_teams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2214"><a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete Microsoft 365 Teams with a specific name.</span>
</span><span id="__span-0-2215"><a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>
</span><span id="__span-0-2216"><a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">        Microsoft 365 allows to have multiple teams with the same name. So this method may delete</span>
</span><span id="__span-0-2217"><a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">        multiple teams if the have the same name. The Graph API we use here</span>
</span><span id="__span-0-2218"><a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">        is the M365 Group API as deleting the group also deletes the associated team.</span>
</span><span id="__span-0-2219"><a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>
</span><span id="__span-0-2220"><a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2221"><a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">            name (str):</span>
</span><span id="__span-0-2222"><a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">                The name of the Microsoft 365 Team.</span>
</span><span id="__span-0-2223"><a id="__codelineno-0-2223" name="__codelineno-0-2223"></a>
</span><span id="__span-0-2224"><a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2225"><a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">            bool:</span>
</span><span id="__span-0-2226"><a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">                True if teams have been deleted, False otherwise.</span>
</span><span id="__span-0-2227"><a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>
</span><span id="__span-0-2228"><a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2229"><a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>
</span><span id="__span-0-2230"><a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>        <span class="c1"># We need a special handling of team names with single quotes:</span>
</span><span id="__span-0-2231"><a id="__codelineno-0-2231" name="__codelineno-0-2231"></a>        <span class="n">escaped_group_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
</span><span id="__span-0-2232"><a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>        <span class="n">encoded_group_name</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">escaped_group_name</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-2233"><a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?$filter=displayName eq &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">encoded_group_name</span><span class="p">)</span>
</span><span id="__span-0-2234"><a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
</span><span id="__span-0-2235"><a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2236"><a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
</span><span id="__span-0-2237"><a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2238"><a id="__codelineno-0-2238" name="__codelineno-0-2238"></a>            <span class="s2">&quot;Delete all Microsoft 365 Teams with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2239"><a id="__codelineno-0-2239" name="__codelineno-0-2239"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2240"><a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2241"><a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>        <span class="p">)</span>
</span><span id="__span-0-2242"><a id="__codelineno-0-2242" name="__codelineno-0-2242"></a>
</span><span id="__span-0-2243"><a id="__codelineno-0-2243" name="__codelineno-0-2243"></a>        <span class="n">existing_teams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2244"><a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2245"><a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2246"><a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2247"><a id="__codelineno-0-2247" name="__codelineno-0-2247"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2248"><a id="__codelineno-0-2248" name="__codelineno-0-2248"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 Teams to delete&quot;</span><span class="p">,</span>
</span><span id="__span-0-2249"><a id="__codelineno-0-2249" name="__codelineno-0-2249"></a>        <span class="p">)</span>
</span><span id="__span-0-2250"><a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>
</span><span id="__span-0-2251"><a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>        <span class="k">if</span> <span class="n">existing_teams</span><span class="p">:</span>
</span><span id="__span-0-2252"><a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">existing_teams</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-2253"><a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span><span id="__span-0-2254"><a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>                <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-2255"><a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>                <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="__span-0-2256"><a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>                    <span class="n">team_id</span> <span class="o">=</span> <span class="n">team</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-2257"><a id="__codelineno-0-2257" name="__codelineno-0-2257"></a>                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span>
</span><span id="__span-0-2258"><a id="__codelineno-0-2258" name="__codelineno-0-2258"></a>
</span><span id="__span-0-2259"><a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-2260"><a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2261"><a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>                            <span class="s2">&quot;Failed to delete M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">)!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2262"><a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>                            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2263"><a id="__codelineno-0-2263" name="__codelineno-0-2263"></a>                            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2264"><a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>                        <span class="p">)</span>
</span><span id="__span-0-2265"><a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>                        <span class="k">continue</span>
</span><span id="__span-0-2266"><a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-2267"><a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
</span><span id="__span-0-2268"><a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2269"><a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> M365 Team</span><span class="si">%s</span><span class="s2"> with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; </span><span class="si">%s</span><span class="s2"> been deleted.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2270"><a id="__codelineno-0-2270" name="__codelineno-0-2270"></a>                    <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">),</span>
</span><span id="__span-0-2271"><a id="__codelineno-0-2271" name="__codelineno-0-2271"></a>                    <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2272"><a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>                    <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2273"><a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>                    <span class="s2">&quot;have&quot;</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;has&quot;</span><span class="p">,</span>
</span><span id="__span-0-2274"><a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>                <span class="p">)</span>
</span><span id="__span-0-2275"><a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-2276"><a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2277"><a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No M365 Team with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; found.&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2278"><a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2279"><a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2280"><a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to retrieve M365 Teams with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2281"><a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2282"><a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>
</span><span id="__span-0-2283"><a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2284"><a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>
</span><span id="__span-0-2285"><a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_all_teams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pattern_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2286"><a id="__codelineno-0-2286" name="__codelineno-0-2286"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete all teams (groups) based on patterns and exceptions.</span>
</span><span id="__span-0-2287"><a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>
</span><span id="__span-0-2288"><a id="__codelineno-0-2288" name="__codelineno-0-2288"></a><span class="sd">        Only delete MS Teams that are NOT on the exception list AND</span>
</span><span id="__span-0-2289"><a id="__codelineno-0-2289" name="__codelineno-0-2289"></a><span class="sd">        that are matching at least one of the patterns in the provided pattern list.</span>
</span><span id="__span-0-2290"><a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>
</span><span id="__span-0-2291"><a id="__codelineno-0-2291" name="__codelineno-0-2291"></a><span class="sd">        This method is used for general cleanup of teams. Be aware that deleted teams</span>
</span><span id="__span-0-2292"><a id="__codelineno-0-2292" name="__codelineno-0-2292"></a><span class="sd">        are still listed under https://admin.microsoft.com/#/deletedgroups and it</span>
</span><span id="__span-0-2293"><a id="__codelineno-0-2293" name="__codelineno-0-2293"></a><span class="sd">        may take some days until M365 finally deletes them.</span>
</span><span id="__span-0-2294"><a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>
</span><span id="__span-0-2295"><a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2296"><a id="__codelineno-0-2296" name="__codelineno-0-2296"></a><span class="sd">            exception_list (list):</span>
</span><span id="__span-0-2297"><a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><span class="sd">                A list of group names that should not be deleted.</span>
</span><span id="__span-0-2298"><a id="__codelineno-0-2298" name="__codelineno-0-2298"></a><span class="sd">            pattern_list (list):</span>
</span><span id="__span-0-2299"><a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="sd">                A list of patterns for group names to be deleted</span>
</span><span id="__span-0-2300"><a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><span class="sd">                (regular expression).</span>
</span><span id="__span-0-2301"><a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>
</span><span id="__span-0-2302"><a id="__codelineno-0-2302" name="__codelineno-0-2302"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2303"><a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="sd">            bool:</span>
</span><span id="__span-0-2304"><a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="sd">                True if teams have been deleted, False otherwise.</span>
</span><span id="__span-0-2305"><a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
</span><span id="__span-0-2306"><a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2307"><a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>
</span><span id="__span-0-2308"><a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2309"><a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>            <span class="s2">&quot;Delete existing M365 groups/teams matching delete pattern and not on exception list...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2310"><a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>        <span class="p">)</span>
</span><span id="__span-0-2311"><a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>
</span><span id="__span-0-2312"><a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>        <span class="c1"># Get list of all existing M365 groups/teams:</span>
</span><span id="__span-0-2313"><a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_groups_iterator</span><span class="p">()</span>
</span><span id="__span-0-2314"><a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>
</span><span id="__span-0-2315"><a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>        <span class="c1"># Process all groups and check if they should be deleted:</span>
</span><span id="__span-0-2316"><a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="__span-0-2317"><a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>            <span class="n">group_name</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-2318"><a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">group_name</span><span class="p">:</span>
</span><span id="__span-0-2319"><a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>                <span class="k">continue</span>
</span><span id="__span-0-2320"><a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>            <span class="c1"># Check if group is in exception list:</span>
</span><span id="__span-0-2321"><a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>            <span class="k">if</span> <span class="n">group_name</span> <span class="ow">in</span> <span class="n">exception_list</span><span class="p">:</span>
</span><span id="__span-0-2322"><a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2323"><a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>                    <span class="s2">&quot;M365 Group name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; is on the exception list. Skipping...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2324"><a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>                    <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2325"><a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>                <span class="p">)</span>
</span><span id="__span-0-2326"><a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>                <span class="k">continue</span>
</span><span id="__span-0-2327"><a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>            <span class="c1"># Check that at least one pattern is found that matches the group:</span>
</span><span id="__span-0-2328"><a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>            <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">pattern_list</span><span class="p">:</span>
</span><span id="__span-0-2329"><a id="__codelineno-0-2329" name="__codelineno-0-2329"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2330"><a id="__codelineno-0-2330" name="__codelineno-0-2330"></a>                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-2331"><a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2332"><a id="__codelineno-0-2332" name="__codelineno-0-2332"></a>                        <span class="s2">&quot;M365 Group name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; is matching pattern -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;. Deleting...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2333"><a id="__codelineno-0-2333" name="__codelineno-0-2333"></a>                        <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2334"><a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>                        <span class="n">pattern</span><span class="p">,</span>
</span><span id="__span-0-2335"><a id="__codelineno-0-2335" name="__codelineno-0-2335"></a>                    <span class="p">)</span>
</span><span id="__span-0-2336"><a id="__codelineno-0-2336" name="__codelineno-0-2336"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">delete_teams</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2337"><a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>                    <span class="k">break</span>
</span><span id="__span-0-2338"><a id="__codelineno-0-2338" name="__codelineno-0-2338"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2339"><a id="__codelineno-0-2339" name="__codelineno-0-2339"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2340"><a id="__codelineno-0-2340" name="__codelineno-0-2340"></a>                    <span class="s2">&quot;M365 Group name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; is not matching any delete pattern. Skipping...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2341"><a id="__codelineno-0-2341" name="__codelineno-0-2341"></a>                    <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2342"><a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>                <span class="p">)</span>
</span><span id="__span-0-2343"><a id="__codelineno-0-2343" name="__codelineno-0-2343"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-2344"><a id="__codelineno-0-2344" name="__codelineno-0-2344"></a>
</span><span id="__span-0-2345"><a id="__codelineno-0-2345" name="__codelineno-0-2345"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2346"><a id="__codelineno-0-2346" name="__codelineno-0-2346"></a>
</span><span id="__span-0-2347"><a id="__codelineno-0-2347" name="__codelineno-0-2347"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_team_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2348"><a id="__codelineno-0-2348" name="__codelineno-0-2348"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get channels of a M365 Team based on the team name.</span>
</span><span id="__span-0-2349"><a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>
</span><span id="__span-0-2350"><a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2351"><a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="sd">            name (str):</span>
</span><span id="__span-0-2352"><a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="sd">                The name of the M365 team.</span>
</span><span id="__span-0-2353"><a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>
</span><span id="__span-0-2354"><a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2355"><a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="sd">            dict:</span>
</span><span id="__span-0-2356"><a id="__codelineno-0-2356" name="__codelineno-0-2356"></a><span class="sd">                The channel data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-2357"><a id="__codelineno-0-2357" name="__codelineno-0-2357"></a>
</span><span id="__span-0-2358"><a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="sd">        Example:</span>
</span><span id="__span-0-2359"><a id="__codelineno-0-2359" name="__codelineno-0-2359"></a><span class="sd">            {</span>
</span><span id="__span-0-2360"><a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">                &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#teams(&#39;951bd036-c6fc-4da4-bb80-1860f5472a2f&#39;)/channels&quot;,</span>
</span><span id="__span-0-2361"><a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><span class="sd">                &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2362"><a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">                &#39;value&#39;: [</span>
</span><span id="__span-0-2363"><a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">                    {</span>
</span><span id="__span-0-2364"><a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">                        &#39;id&#39;: &#39;19:yPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1@thread.tacv2&#39;,</span>
</span><span id="__span-0-2365"><a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><span class="sd">                        &#39;createdDateTime&#39;: &#39;2023-08-11T14:11:35.986Z&#39;,</span>
</span><span id="__span-0-2366"><a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><span class="sd">                        &#39;displayName&#39;: &#39;General&#39;,</span>
</span><span id="__span-0-2367"><a id="__codelineno-0-2367" name="__codelineno-0-2367"></a><span class="sd">                        &#39;description&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2368"><a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><span class="sd">                        &#39;isFavoriteByDefault&#39;: None,</span>
</span><span id="__span-0-2369"><a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><span class="sd">                        &#39;email&#39;: None,</span>
</span><span id="__span-0-2370"><a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><span class="sd">                        &#39;tenantId&#39;: &#39;417e6e3a-82e6-4aa0-9d47-a7734ca3daea&#39;,</span>
</span><span id="__span-0-2371"><a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><span class="sd">                        &#39;webUrl&#39;: &#39;https://teams.microsoft.com/l/channel/19%3AyPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2/Procurement?groupId=951bd036-c6fc-4da4-bb80-1860f5472a2f&amp;tenantId=417e6e3a-82e6-4aa0-9d47-a7734ca3daea&amp;allowXTenantAccess=False&#39;,</span>
</span><span id="__span-0-2372"><a id="__codelineno-0-2372" name="__codelineno-0-2372"></a><span class="sd">                        &#39;membershipType&#39;: &#39;standard&#39;</span>
</span><span id="__span-0-2373"><a id="__codelineno-0-2373" name="__codelineno-0-2373"></a><span class="sd">                    }</span>
</span><span id="__span-0-2374"><a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><span class="sd">                ]</span>
</span><span id="__span-0-2375"><a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><span class="sd">            }</span>
</span><span id="__span-0-2376"><a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>
</span><span id="__span-0-2377"><a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2378"><a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>
</span><span id="__span-0-2379"><a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2380"><a id="__codelineno-0-2380" name="__codelineno-0-2380"></a>        <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2381"><a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-2382"><a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2383"><a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>
</span><span id="__span-0-2384"><a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels&quot;</span>
</span><span id="__span-0-2385"><a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>
</span><span id="__span-0-2386"><a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2387"><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>
</span><span id="__span-0-2388"><a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2389"><a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>            <span class="s2">&quot;Retrieve channels of Microsoft 365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2390"><a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2391"><a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2392"><a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>        <span class="p">)</span>
</span><span id="__span-0-2393"><a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>
</span><span id="__span-0-2394"><a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2395"><a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2396"><a id="__codelineno-0-2396" name="__codelineno-0-2396"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2397"><a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2398"><a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2399"><a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get Channels for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2400"><a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2401"><a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2402"><a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>            <span class="p">),</span>
</span><span id="__span-0-2403"><a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>        <span class="p">)</span>
</span><span id="__span-0-2404"><a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>
</span><span id="__span-0-2405"><a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2406"><a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>
</span><span id="__span-0-2407"><a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_team_channel_tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2408"><a id="__codelineno-0-2408" name="__codelineno-0-2408"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get tabs of an M365 Team channel based on the team and channel names.</span>
</span><span id="__span-0-2409"><a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>
</span><span id="__span-0-2410"><a id="__codelineno-0-2410" name="__codelineno-0-2410"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2411"><a id="__codelineno-0-2411" name="__codelineno-0-2411"></a><span class="sd">            team_name (str):</span>
</span><span id="__span-0-2412"><a id="__codelineno-0-2412" name="__codelineno-0-2412"></a><span class="sd">                The name of the M365 Team.</span>
</span><span id="__span-0-2413"><a id="__codelineno-0-2413" name="__codelineno-0-2413"></a><span class="sd">            channel_name (str):</span>
</span><span id="__span-0-2414"><a id="__codelineno-0-2414" name="__codelineno-0-2414"></a><span class="sd">                The name of the M365 Team channel.</span>
</span><span id="__span-0-2415"><a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>
</span><span id="__span-0-2416"><a id="__codelineno-0-2416" name="__codelineno-0-2416"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2417"><a id="__codelineno-0-2417" name="__codelineno-0-2417"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2418"><a id="__codelineno-0-2418" name="__codelineno-0-2418"></a><span class="sd">                Tabs data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-2419"><a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>
</span><span id="__span-0-2420"><a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><span class="sd">        Example:</span>
</span><span id="__span-0-2421"><a id="__codelineno-0-2421" name="__codelineno-0-2421"></a><span class="sd">            {</span>
</span><span id="__span-0-2422"><a id="__codelineno-0-2422" name="__codelineno-0-2422"></a><span class="sd">                &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#teams(&#39;951bd036-c6fc-4da4-bb80-1860f5472a2f&#39;)/channels(&#39;19%3AyPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2&#39;)/tabs&quot;,</span>
</span><span id="__span-0-2423"><a id="__codelineno-0-2423" name="__codelineno-0-2423"></a><span class="sd">                &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2424"><a id="__codelineno-0-2424" name="__codelineno-0-2424"></a><span class="sd">                &#39;value&#39;: [</span>
</span><span id="__span-0-2425"><a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><span class="sd">                    {</span>
</span><span id="__span-0-2426"><a id="__codelineno-0-2426" name="__codelineno-0-2426"></a><span class="sd">                        &#39;id&#39;: &#39;66f44e9a-0741-49a4-9500-ec82cc120115&#39;,</span>
</span><span id="__span-0-2427"><a id="__codelineno-0-2427" name="__codelineno-0-2427"></a><span class="sd">                        &#39;displayName&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2428"><a id="__codelineno-0-2428" name="__codelineno-0-2428"></a><span class="sd">                        &#39;webUrl&#39;: &#39;https://teams.microsoft.com/l/entity/2851980b-95dc-4118-a1f5-5ae1894eaaaf/_djb2_msteams_prefix_66f44e9a-0741-49a4-9500-ec82cc120115?webUrl=https%3a%2f%2fotcs.fqdn.tld.com%2fcssupport%2fxecmoffice%2fteamsapp.html%3fnodeId%3d13178%26type%3dcontainer%26parentId%3d2000%26target%3dcontent%26csurl%3dhttps%3a%2f%2fotcs.fqdn.tld.com%2fcs%2fcs%26appId%3da168b00d-3ad9-46ac-8798-578c1961e1ed%26showBW%3dtrue%26title%3dProcurement&amp;label=Procurement&amp;context=%7b%0d%0a++%22canvasUrl%22%3a+%22https%3a%2f%2fotcs.fqdn.tld.com%2fcssupport%2fxecmoffice%2fteamsapp.html%3fnodeId%3d13178%26type%3dcontainer%26parentId%3d2000%26target%3dcontent%26csurl%3dhttps%3a%2f%2fotcs.fqdn.tld.com%2fcs%2fcs%26appId%3da168b00d-3ad9-46ac-8798-578c1961e1ed%22%2c%0d%0a++%22channelId%22%3a+%2219%3ayPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2%22%2c%0d%0a++%22subEntityId%22%3a+null%0d%0a%7d&amp;groupId=951bd036-c6fc-4da4-bb80-1860f5472a2f&amp;tenantId=417e6e3a-82e6-4aa0-9d47-a7734ca3daea&#39;,</span>
</span><span id="__span-0-2429"><a id="__codelineno-0-2429" name="__codelineno-0-2429"></a><span class="sd">                        &#39;configuration&#39;:</span>
</span><span id="__span-0-2430"><a id="__codelineno-0-2430" name="__codelineno-0-2430"></a><span class="sd">                        {</span>
</span><span id="__span-0-2431"><a id="__codelineno-0-2431" name="__codelineno-0-2431"></a><span class="sd">                            &#39;entityId&#39;: &#39;13178&#39;,</span>
</span><span id="__span-0-2432"><a id="__codelineno-0-2432" name="__codelineno-0-2432"></a><span class="sd">                            &#39;contentUrl&#39;: &#39;https://otcs.fqdn.tld.com/cssupport/xecmoffice/teamsapp.html?nodeId=13178&amp;type=container&amp;parentId=2000&amp;target=content&amp;csurl=https://otcs.fqdn.tld.com/cs/cs&amp;appId=a168b00d-3ad9-46ac-8798-578c1961e1ed&#39;,</span>
</span><span id="__span-0-2433"><a id="__codelineno-0-2433" name="__codelineno-0-2433"></a><span class="sd">                            &#39;removeUrl&#39;: None,</span>
</span><span id="__span-0-2434"><a id="__codelineno-0-2434" name="__codelineno-0-2434"></a><span class="sd">                            &#39;websiteUrl&#39;: &#39;https://otcs.fqdn.tld.com/cssupport/xecmoffice/teamsapp.html?nodeId=13178&amp;type=container&amp;parentId=2000&amp;target=content&amp;csurl=https://otcs.fqdn.tld.com/cs/cs&amp;appId=a168b00d-3ad9-46ac-8798-578c1961e1ed&amp;showBW=true&amp;title=Procurement&#39;,</span>
</span><span id="__span-0-2435"><a id="__codelineno-0-2435" name="__codelineno-0-2435"></a><span class="sd">                            &#39;dateAdded&#39;: &#39;2023-08-12T08:57:35.895Z&#39;</span>
</span><span id="__span-0-2436"><a id="__codelineno-0-2436" name="__codelineno-0-2436"></a><span class="sd">                        }</span>
</span><span id="__span-0-2437"><a id="__codelineno-0-2437" name="__codelineno-0-2437"></a><span class="sd">                    }</span>
</span><span id="__span-0-2438"><a id="__codelineno-0-2438" name="__codelineno-0-2438"></a><span class="sd">                ]</span>
</span><span id="__span-0-2439"><a id="__codelineno-0-2439" name="__codelineno-0-2439"></a><span class="sd">            }</span>
</span><span id="__span-0-2440"><a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>
</span><span id="__span-0-2441"><a id="__codelineno-0-2441" name="__codelineno-0-2441"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2442"><a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>
</span><span id="__span-0-2443"><a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-2444"><a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>        <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2445"><a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-2446"><a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2447"><a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>
</span><span id="__span-0-2448"><a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>        <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-2449"><a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-2450"><a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-2451"><a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2452"><a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>
</span><span id="__span-0-2453"><a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>        <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-2454"><a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-2455"><a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>            <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-2456"><a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-2457"><a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>        <span class="p">)</span>
</span><span id="__span-0-2458"><a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-2459"><a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2460"><a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>                <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2461"><a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-2462"><a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-2463"><a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>            <span class="p">)</span>
</span><span id="__span-0-2464"><a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2465"><a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>        <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-2466"><a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>
</span><span id="__span-0-2467"><a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs&quot;</span>
</span><span id="__span-0-2468"><a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>
</span><span id="__span-0-2469"><a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2470"><a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>
</span><span id="__span-0-2471"><a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2472"><a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>            <span class="s2">&quot;Retrieve Tabs of Microsoft 365 Teams -&gt; </span><span class="si">%s</span><span class="s2"> and Channel -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2473"><a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-2474"><a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-2475"><a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2476"><a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>        <span class="p">)</span>
</span><span id="__span-0-2477"><a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
</span><span id="__span-0-2478"><a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2479"><a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2480"><a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2481"><a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2482"><a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2483"><a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get Tabs for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2484"><a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-2485"><a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2486"><a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-2487"><a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-2488"><a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>            <span class="p">),</span>
</span><span id="__span-0-2489"><a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>        <span class="p">)</span>
</span><span id="__span-0-2490"><a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>
</span><span id="__span-0-2491"><a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2492"><a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>
</span><span id="__span-0-2493"><a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_teams_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2494"><a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of MS Teams apps in catalog that match a given filter criterium.</span>
</span><span id="__span-0-2495"><a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>
</span><span id="__span-0-2496"><a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2497"><a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="sd">            filter_expression (str, optional):</span>
</span><span id="__span-0-2498"><a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><span class="sd">                Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</span>
</span><span id="__span-0-2499"><a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>
</span><span id="__span-0-2500"><a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2501"><a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2502"><a id="__codelineno-0-2502" name="__codelineno-0-2502"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2503"><a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>
</span><span id="__span-0-2504"><a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="sd">        Example:</span>
</span><span id="__span-0-2505"><a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">            {</span>
</span><span id="__span-0-2506"><a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(appDefinitions())&#39;,</span>
</span><span id="__span-0-2507"><a id="__codelineno-0-2507" name="__codelineno-0-2507"></a><span class="sd">                &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2508"><a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">                &#39;value&#39;: [</span>
</span><span id="__span-0-2509"><a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="sd">                    {</span>
</span><span id="__span-0-2510"><a id="__codelineno-0-2510" name="__codelineno-0-2510"></a><span class="sd">                        &#39;id&#39;: &#39;2851980b-95dc-4118-a1f5-5ae1894eaaaf&#39;,</span>
</span><span id="__span-0-2511"><a id="__codelineno-0-2511" name="__codelineno-0-2511"></a><span class="sd">                        &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,</span>
</span><span id="__span-0-2512"><a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="sd">                        &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,</span>
</span><span id="__span-0-2513"><a id="__codelineno-0-2513" name="__codelineno-0-2513"></a><span class="sd">                        &#39;distributionMethod&#39;: &#39;organization&#39;,</span>
</span><span id="__span-0-2514"><a id="__codelineno-0-2514" name="__codelineno-0-2514"></a><span class="sd">                        &#39;appDefinitions@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(&#39;2851980b-95dc-4118-a1f5-5ae1894eaaaf&#39;)/appDefinitions&quot;,</span>
</span><span id="__span-0-2515"><a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><span class="sd">                        &#39;appDefinitions&#39;: [</span>
</span><span id="__span-0-2516"><a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="sd">                            {</span>
</span><span id="__span-0-2517"><a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="sd">                                &#39;id&#39;: &#39;Mjg1MTk4MGItOTVkYy00MTE4LWExZjUtNWFlMTg5NGVhYWFmIyMyMi40IyNQdWJsaXNoZWQ=&#39;,</span>
</span><span id="__span-0-2518"><a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><span class="sd">                                &#39;teamsAppId&#39;: &#39;2851980b-95dc-4118-a1f5-5ae1894eaaaf&#39;,</span>
</span><span id="__span-0-2519"><a id="__codelineno-0-2519" name="__codelineno-0-2519"></a><span class="sd">                                &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,</span>
</span><span id="__span-0-2520"><a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><span class="sd">                                &#39;version&#39;: &#39;22.4&#39;,</span>
</span><span id="__span-0-2521"><a id="__codelineno-0-2521" name="__codelineno-0-2521"></a><span class="sd">                                &#39;publishingState&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-2522"><a id="__codelineno-0-2522" name="__codelineno-0-2522"></a><span class="sd">                                &#39;shortDescription&#39;: &#39;Add a tab for an Extended ECM business workspace.&#39;,</span>
</span><span id="__span-0-2523"><a id="__codelineno-0-2523" name="__codelineno-0-2523"></a><span class="sd">                                &#39;description&#39;: &#39;View and interact with OpenText Extended ECM business workspaces&#39;,</span>
</span><span id="__span-0-2524"><a id="__codelineno-0-2524" name="__codelineno-0-2524"></a><span class="sd">                                &#39;lastModifiedDateTime&#39;: None,</span>
</span><span id="__span-0-2525"><a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><span class="sd">                                &#39;createdBy&#39;: None,</span>
</span><span id="__span-0-2526"><a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><span class="sd">                                &#39;authorization&#39;: {</span>
</span><span id="__span-0-2527"><a id="__codelineno-0-2527" name="__codelineno-0-2527"></a><span class="sd">                                    &#39;requiredPermissionSet&#39;: {...}</span>
</span><span id="__span-0-2528"><a id="__codelineno-0-2528" name="__codelineno-0-2528"></a><span class="sd">                                }</span>
</span><span id="__span-0-2529"><a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><span class="sd">                            }</span>
</span><span id="__span-0-2530"><a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><span class="sd">                        ]</span>
</span><span id="__span-0-2531"><a id="__codelineno-0-2531" name="__codelineno-0-2531"></a><span class="sd">                    }</span>
</span><span id="__span-0-2532"><a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><span class="sd">                ]</span>
</span><span id="__span-0-2533"><a id="__codelineno-0-2533" name="__codelineno-0-2533"></a><span class="sd">            }</span>
</span><span id="__span-0-2534"><a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>
</span><span id="__span-0-2535"><a id="__codelineno-0-2535" name="__codelineno-0-2535"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2536"><a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>
</span><span id="__span-0-2537"><a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;AppDefinitions&quot;</span><span class="p">}</span>
</span><span id="__span-0-2538"><a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>
</span><span id="__span-0-2539"><a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>        <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2540"><a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-2541"><a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>
</span><span id="__span-0-2542"><a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2543"><a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2544"><a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>
</span><span id="__span-0-2545"><a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>        <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2546"><a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2547"><a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>                <span class="s2">&quot;Get list of MS Teams Apps using filter -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2548"><a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>                <span class="n">filter_expression</span><span class="p">,</span>
</span><span id="__span-0-2549"><a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>                <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2550"><a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>            <span class="p">)</span>
</span><span id="__span-0-2551"><a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>            <span class="n">failure_message</span> <span class="o">=</span> <span class="s2">&quot;Failed to get list of M365 Teams apps using filter -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2552"><a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>                <span class="n">filter_expression</span><span class="p">,</span>
</span><span id="__span-0-2553"><a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>            <span class="p">)</span>
</span><span id="__span-0-2554"><a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2555"><a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2556"><a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>                <span class="s2">&quot;Get list of all MS Teams Apps; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2557"><a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>                <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2558"><a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>            <span class="p">)</span>
</span><span id="__span-0-2559"><a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>            <span class="n">failure_message</span> <span class="o">=</span> <span class="s2">&quot;Failed to get list of M365 Teams apps&quot;</span>
</span><span id="__span-0-2560"><a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>
</span><span id="__span-0-2561"><a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2562"><a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>
</span><span id="__span-0-2563"><a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2564"><a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2565"><a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2566"><a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2567"><a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2568"><a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-2569"><a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>        <span class="p">)</span>
</span><span id="__span-0-2570"><a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>
</span><span id="__span-0-2571"><a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2572"><a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>
</span><span id="__span-0-2573"><a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_teams_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2574"><a id="__codelineno-0-2574" name="__codelineno-0-2574"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a specific MS Teams app in catalog based on the known (internal) app ID.</span>
</span><span id="__span-0-2575"><a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>
</span><span id="__span-0-2576"><a id="__codelineno-0-2576" name="__codelineno-0-2576"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2577"><a id="__codelineno-0-2577" name="__codelineno-0-2577"></a><span class="sd">            app_id (str):</span>
</span><span id="__span-0-2578"><a id="__codelineno-0-2578" name="__codelineno-0-2578"></a><span class="sd">                ID of the app (this is NOT the external ID but the internal ID).</span>
</span><span id="__span-0-2579"><a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>
</span><span id="__span-0-2580"><a id="__codelineno-0-2580" name="__codelineno-0-2580"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2581"><a id="__codelineno-0-2581" name="__codelineno-0-2581"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2582"><a id="__codelineno-0-2582" name="__codelineno-0-2582"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2583"><a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>
</span><span id="__span-0-2584"><a id="__codelineno-0-2584" name="__codelineno-0-2584"></a><span class="sd">        Examle:</span>
</span><span id="__span-0-2585"><a id="__codelineno-0-2585" name="__codelineno-0-2585"></a><span class="sd">            {</span>
</span><span id="__span-0-2586"><a id="__codelineno-0-2586" name="__codelineno-0-2586"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(appDefinitions())/$entity&#39;,</span>
</span><span id="__span-0-2587"><a id="__codelineno-0-2587" name="__codelineno-0-2587"></a><span class="sd">                &#39;id&#39;: &#39;ccabe3fb-316f-40e0-a486-1659682cb8cd&#39;,</span>
</span><span id="__span-0-2588"><a id="__codelineno-0-2588" name="__codelineno-0-2588"></a><span class="sd">                &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,</span>
</span><span id="__span-0-2589"><a id="__codelineno-0-2589" name="__codelineno-0-2589"></a><span class="sd">                &#39;displayName&#39;: &#39;Extended ECM&#39;,</span>
</span><span id="__span-0-2590"><a id="__codelineno-0-2590" name="__codelineno-0-2590"></a><span class="sd">                &#39;distributionMethod&#39;: &#39;organization&#39;,</span>
</span><span id="__span-0-2591"><a id="__codelineno-0-2591" name="__codelineno-0-2591"></a><span class="sd">                &#39;appDefinitions@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(&#39;ccabe3fb-316f-40e0-a486-1659682cb8cd&#39;)/appDefinitions&quot;,</span>
</span><span id="__span-0-2592"><a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><span class="sd">                &#39;appDefinitions&#39;: [</span>
</span><span id="__span-0-2593"><a id="__codelineno-0-2593" name="__codelineno-0-2593"></a><span class="sd">                    {</span>
</span><span id="__span-0-2594"><a id="__codelineno-0-2594" name="__codelineno-0-2594"></a><span class="sd">                        &#39;id&#39;: &#39;Y2NhYmUzZmItMzE2Zi00MGUwLWE0ODYtMTY1OTY4MmNiOGNkIyMyNC4yLjAjI1B1Ymxpc2hlZA==&#39;,</span>
</span><span id="__span-0-2595"><a id="__codelineno-0-2595" name="__codelineno-0-2595"></a><span class="sd">                        &#39;teamsAppId&#39;: &#39;ccabe3fb-316f-40e0-a486-1659682cb8cd&#39;,</span>
</span><span id="__span-0-2596"><a id="__codelineno-0-2596" name="__codelineno-0-2596"></a><span class="sd">                        &#39;displayName&#39;: &#39;Extended ECM&#39;,</span>
</span><span id="__span-0-2597"><a id="__codelineno-0-2597" name="__codelineno-0-2597"></a><span class="sd">                        &#39;version&#39;: &#39;24.2.0&#39;,</span>
</span><span id="__span-0-2598"><a id="__codelineno-0-2598" name="__codelineno-0-2598"></a><span class="sd">                        &#39;publishingState&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-2599"><a id="__codelineno-0-2599" name="__codelineno-0-2599"></a><span class="sd">                        &#39;shortDescription&#39;: &#39;Add a tab for an Extended ECM business workspace.&#39;,</span>
</span><span id="__span-0-2600"><a id="__codelineno-0-2600" name="__codelineno-0-2600"></a><span class="sd">                        &#39;description&#39;: &#39;View and interact with OpenText Extended ECM business workspaces&#39;,</span>
</span><span id="__span-0-2601"><a id="__codelineno-0-2601" name="__codelineno-0-2601"></a><span class="sd">                        &#39;lastModifiedDateTime&#39;: None,</span>
</span><span id="__span-0-2602"><a id="__codelineno-0-2602" name="__codelineno-0-2602"></a><span class="sd">                        &#39;createdBy&#39;: None,</span>
</span><span id="__span-0-2603"><a id="__codelineno-0-2603" name="__codelineno-0-2603"></a><span class="sd">                        &#39;authorization&#39;: {...}</span>
</span><span id="__span-0-2604"><a id="__codelineno-0-2604" name="__codelineno-0-2604"></a><span class="sd">                    }</span>
</span><span id="__span-0-2605"><a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="sd">                ]</span>
</span><span id="__span-0-2606"><a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">            }</span>
</span><span id="__span-0-2607"><a id="__codelineno-0-2607" name="__codelineno-0-2607"></a>
</span><span id="__span-0-2608"><a id="__codelineno-0-2608" name="__codelineno-0-2608"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2609"><a id="__codelineno-0-2609" name="__codelineno-0-2609"></a>
</span><span id="__span-0-2610"><a id="__codelineno-0-2610" name="__codelineno-0-2610"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;AppDefinitions&quot;</span><span class="p">}</span>
</span><span id="__span-0-2611"><a id="__codelineno-0-2611" name="__codelineno-0-2611"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2612"><a id="__codelineno-0-2612" name="__codelineno-0-2612"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_id</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2613"><a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>
</span><span id="__span-0-2614"><a id="__codelineno-0-2614" name="__codelineno-0-2614"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2615"><a id="__codelineno-0-2615" name="__codelineno-0-2615"></a>            <span class="s2">&quot;Get M365 Teams App with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2616"><a id="__codelineno-0-2616" name="__codelineno-0-2616"></a>            <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-2617"><a id="__codelineno-0-2617" name="__codelineno-0-2617"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2618"><a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>        <span class="p">)</span>
</span><span id="__span-0-2619"><a id="__codelineno-0-2619" name="__codelineno-0-2619"></a>
</span><span id="__span-0-2620"><a id="__codelineno-0-2620" name="__codelineno-0-2620"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2621"><a id="__codelineno-0-2621" name="__codelineno-0-2621"></a>
</span><span id="__span-0-2622"><a id="__codelineno-0-2622" name="__codelineno-0-2622"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2623"><a id="__codelineno-0-2623" name="__codelineno-0-2623"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2624"><a id="__codelineno-0-2624" name="__codelineno-0-2624"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2625"><a id="__codelineno-0-2625" name="__codelineno-0-2625"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2626"><a id="__codelineno-0-2626" name="__codelineno-0-2626"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2627"><a id="__codelineno-0-2627" name="__codelineno-0-2627"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 Teams app with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_id</span><span class="p">),</span>
</span><span id="__span-0-2628"><a id="__codelineno-0-2628" name="__codelineno-0-2628"></a>        <span class="p">)</span>
</span><span id="__span-0-2629"><a id="__codelineno-0-2629" name="__codelineno-0-2629"></a>
</span><span id="__span-0-2630"><a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-2631"><a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>
</span><span id="__span-0-2632"><a id="__codelineno-0-2632" name="__codelineno-0-2632"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2633"><a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>
</span><span id="__span-0-2634"><a id="__codelineno-0-2634" name="__codelineno-0-2634"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_teams_apps_of_user</span><span class="p">(</span>
</span><span id="__span-0-2635"><a id="__codelineno-0-2635" name="__codelineno-0-2635"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2636"><a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2637"><a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>        <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2638"><a id="__codelineno-0-2638" name="__codelineno-0-2638"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2639"><a id="__codelineno-0-2639" name="__codelineno-0-2639"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of MS Teams apps of a user that match a given filter criterium.</span>
</span><span id="__span-0-2640"><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>
</span><span id="__span-0-2641"><a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2642"><a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-2643"><a id="__codelineno-0-2643" name="__codelineno-0-2643"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user)</span>
</span><span id="__span-0-2644"><a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">            filter_expression (str, optional):</span>
</span><span id="__span-0-2645"><a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">                Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</span>
</span><span id="__span-0-2646"><a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>
</span><span id="__span-0-2647"><a id="__codelineno-0-2647" name="__codelineno-0-2647"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2648"><a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2649"><a id="__codelineno-0-2649" name="__codelineno-0-2649"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2650"><a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>
</span><span id="__span-0-2651"><a id="__codelineno-0-2651" name="__codelineno-0-2651"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2652"><a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>
</span><span id="__span-0-2653"><a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;teamsAppDefinition&quot;</span><span class="p">}</span>
</span><span id="__span-0-2654"><a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>        <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2655"><a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-2656"><a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>
</span><span id="__span-0-2657"><a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2658"><a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2659"><a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>
</span><span id="__span-0-2660"><a id="__codelineno-0-2660" name="__codelineno-0-2660"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2661"><a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>            <span class="s2">&quot;Get list of M365 Teams Apps for user -&gt; </span><span class="si">%s</span><span class="s2"> using query -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2662"><a id="__codelineno-0-2662" name="__codelineno-0-2662"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2663"><a id="__codelineno-0-2663" name="__codelineno-0-2663"></a>            <span class="n">query</span><span class="p">,</span>
</span><span id="__span-0-2664"><a id="__codelineno-0-2664" name="__codelineno-0-2664"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2665"><a id="__codelineno-0-2665" name="__codelineno-0-2665"></a>        <span class="p">)</span>
</span><span id="__span-0-2666"><a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>
</span><span id="__span-0-2667"><a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2668"><a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>
</span><span id="__span-0-2669"><a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2670"><a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2671"><a id="__codelineno-0-2671" name="__codelineno-0-2671"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2672"><a id="__codelineno-0-2672" name="__codelineno-0-2672"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2673"><a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2674"><a id="__codelineno-0-2674" name="__codelineno-0-2674"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 Teams apps for user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2675"><a id="__codelineno-0-2675" name="__codelineno-0-2675"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2676"><a id="__codelineno-0-2676" name="__codelineno-0-2676"></a>            <span class="p">),</span>
</span><span id="__span-0-2677"><a id="__codelineno-0-2677" name="__codelineno-0-2677"></a>        <span class="p">)</span>
</span><span id="__span-0-2678"><a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>
</span><span id="__span-0-2679"><a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-2680"><a id="__codelineno-0-2680" name="__codelineno-0-2680"></a>
</span><span id="__span-0-2681"><a id="__codelineno-0-2681" name="__codelineno-0-2681"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2682"><a id="__codelineno-0-2682" name="__codelineno-0-2682"></a>
</span><span id="__span-0-2683"><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_teams_apps_of_team</span><span class="p">(</span>
</span><span id="__span-0-2684"><a id="__codelineno-0-2684" name="__codelineno-0-2684"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2685"><a id="__codelineno-0-2685" name="__codelineno-0-2685"></a>        <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2686"><a id="__codelineno-0-2686" name="__codelineno-0-2686"></a>        <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2687"><a id="__codelineno-0-2687" name="__codelineno-0-2687"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2688"><a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of MS Teams apps of a M365 team that match a given filter criterium.</span>
</span><span id="__span-0-2689"><a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>
</span><span id="__span-0-2690"><a id="__codelineno-0-2690" name="__codelineno-0-2690"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2691"><a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">            team_id (str):</span>
</span><span id="__span-0-2692"><a id="__codelineno-0-2692" name="__codelineno-0-2692"></a><span class="sd">                The M365 ID of the team.</span>
</span><span id="__span-0-2693"><a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">            filter_expression (str, optional):</span>
</span><span id="__span-0-2694"><a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">                Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</span>
</span><span id="__span-0-2695"><a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>
</span><span id="__span-0-2696"><a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2697"><a id="__codelineno-0-2697" name="__codelineno-0-2697"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2698"><a id="__codelineno-0-2698" name="__codelineno-0-2698"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2699"><a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>
</span><span id="__span-0-2700"><a id="__codelineno-0-2700" name="__codelineno-0-2700"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2701"><a id="__codelineno-0-2701" name="__codelineno-0-2701"></a>
</span><span id="__span-0-2702"><a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;teamsAppDefinition&quot;</span><span class="p">}</span>
</span><span id="__span-0-2703"><a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>        <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2704"><a id="__codelineno-0-2704" name="__codelineno-0-2704"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-2705"><a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>
</span><span id="__span-0-2706"><a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2707"><a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span> <span class="o">+</span> <span class="s2">&quot;/installedApps?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2708"><a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>
</span><span id="__span-0-2709"><a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2710"><a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>            <span class="s2">&quot;Get list of M365 Teams Apps for M365 Team -&gt; </span><span class="si">%s</span><span class="s2"> using query -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2711"><a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2712"><a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>            <span class="n">query</span><span class="p">,</span>
</span><span id="__span-0-2713"><a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2714"><a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>        <span class="p">)</span>
</span><span id="__span-0-2715"><a id="__codelineno-0-2715" name="__codelineno-0-2715"></a>
</span><span id="__span-0-2716"><a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2717"><a id="__codelineno-0-2717" name="__codelineno-0-2717"></a>
</span><span id="__span-0-2718"><a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2719"><a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2720"><a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2721"><a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2722"><a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2723"><a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 Teams apps for M365 Team -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2724"><a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2725"><a id="__codelineno-0-2725" name="__codelineno-0-2725"></a>            <span class="p">),</span>
</span><span id="__span-0-2726"><a id="__codelineno-0-2726" name="__codelineno-0-2726"></a>        <span class="p">)</span>
</span><span id="__span-0-2727"><a id="__codelineno-0-2727" name="__codelineno-0-2727"></a>
</span><span id="__span-0-2728"><a id="__codelineno-0-2728" name="__codelineno-0-2728"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2729"><a id="__codelineno-0-2729" name="__codelineno-0-2729"></a>
</span><span id="__span-0-2730"><a id="__codelineno-0-2730" name="__codelineno-0-2730"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_version_from_app_manifest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2731"><a id="__codelineno-0-2731" name="__codelineno-0-2731"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract the version number from the MS Teams app manifest file.</span>
</span><span id="__span-0-2732"><a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>
</span><span id="__span-0-2733"><a id="__codelineno-0-2733" name="__codelineno-0-2733"></a><span class="sd">        This can be used to check if the app package includes a newer</span>
</span><span id="__span-0-2734"><a id="__codelineno-0-2734" name="__codelineno-0-2734"></a><span class="sd">        app version then the already installed one.</span>
</span><span id="__span-0-2735"><a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>
</span><span id="__span-0-2736"><a id="__codelineno-0-2736" name="__codelineno-0-2736"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2737"><a id="__codelineno-0-2737" name="__codelineno-0-2737"></a><span class="sd">            app_path (str):</span>
</span><span id="__span-0-2738"><a id="__codelineno-0-2738" name="__codelineno-0-2738"></a><span class="sd">                The file path (with directory) to the app package to extract</span>
</span><span id="__span-0-2739"><a id="__codelineno-0-2739" name="__codelineno-0-2739"></a><span class="sd">                the version from.</span>
</span><span id="__span-0-2740"><a id="__codelineno-0-2740" name="__codelineno-0-2740"></a>
</span><span id="__span-0-2741"><a id="__codelineno-0-2741" name="__codelineno-0-2741"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2742"><a id="__codelineno-0-2742" name="__codelineno-0-2742"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-2743"><a id="__codelineno-0-2743" name="__codelineno-0-2743"></a><span class="sd">                The version number or None in case of an error.</span>
</span><span id="__span-0-2744"><a id="__codelineno-0-2744" name="__codelineno-0-2744"></a>
</span><span id="__span-0-2745"><a id="__codelineno-0-2745" name="__codelineno-0-2745"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2746"><a id="__codelineno-0-2746" name="__codelineno-0-2746"></a>
</span><span id="__span-0-2747"><a id="__codelineno-0-2747" name="__codelineno-0-2747"></a>        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
</span><span id="__span-0-2748"><a id="__codelineno-0-2748" name="__codelineno-0-2748"></a>            <span class="n">manifest_data</span> <span class="o">=</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;manifest.json&quot;</span><span class="p">)</span>
</span><span id="__span-0-2749"><a id="__codelineno-0-2749" name="__codelineno-0-2749"></a>            <span class="n">manifest_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">manifest_data</span><span class="p">)</span>
</span><span id="__span-0-2750"><a id="__codelineno-0-2750" name="__codelineno-0-2750"></a>            <span class="n">version</span> <span class="o">=</span> <span class="n">manifest_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
</span><span id="__span-0-2751"><a id="__codelineno-0-2751" name="__codelineno-0-2751"></a>
</span><span id="__span-0-2752"><a id="__codelineno-0-2752" name="__codelineno-0-2752"></a>            <span class="k">return</span> <span class="n">version</span>
</span><span id="__span-0-2753"><a id="__codelineno-0-2753" name="__codelineno-0-2753"></a>
</span><span id="__span-0-2754"><a id="__codelineno-0-2754" name="__codelineno-0-2754"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2755"><a id="__codelineno-0-2755" name="__codelineno-0-2755"></a>
</span><span id="__span-0-2756"><a id="__codelineno-0-2756" name="__codelineno-0-2756"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">upload_teams_app</span><span class="p">(</span>
</span><span id="__span-0-2757"><a id="__codelineno-0-2757" name="__codelineno-0-2757"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2758"><a id="__codelineno-0-2758" name="__codelineno-0-2758"></a>        <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2759"><a id="__codelineno-0-2759" name="__codelineno-0-2759"></a>        <span class="n">update_existing_app</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2760"><a id="__codelineno-0-2760" name="__codelineno-0-2760"></a>        <span class="n">app_catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2761"><a id="__codelineno-0-2761" name="__codelineno-0-2761"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2762"><a id="__codelineno-0-2762" name="__codelineno-0-2762"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload a new app package to the catalog of MS Teams apps.</span>
</span><span id="__span-0-2763"><a id="__codelineno-0-2763" name="__codelineno-0-2763"></a>
</span><span id="__span-0-2764"><a id="__codelineno-0-2764" name="__codelineno-0-2764"></a><span class="sd">        This is not possible with client secret credentials</span>
</span><span id="__span-0-2765"><a id="__codelineno-0-2765" name="__codelineno-0-2765"></a><span class="sd">        but requires a token of a user authenticated with username + password.</span>
</span><span id="__span-0-2766"><a id="__codelineno-0-2766" name="__codelineno-0-2766"></a><span class="sd">        See https://learn.microsoft.com/en-us/graph/api/teamsapp-publish</span>
</span><span id="__span-0-2767"><a id="__codelineno-0-2767" name="__codelineno-0-2767"></a><span class="sd">        (permissions table on that page).</span>
</span><span id="__span-0-2768"><a id="__codelineno-0-2768" name="__codelineno-0-2768"></a>
</span><span id="__span-0-2769"><a id="__codelineno-0-2769" name="__codelineno-0-2769"></a><span class="sd">        For updates see: https://learn.microsoft.com/en-us/graph/api/teamsapp-update?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-2770"><a id="__codelineno-0-2770" name="__codelineno-0-2770"></a>
</span><span id="__span-0-2771"><a id="__codelineno-0-2771" name="__codelineno-0-2771"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2772"><a id="__codelineno-0-2772" name="__codelineno-0-2772"></a><span class="sd">            app_path (str):</span>
</span><span id="__span-0-2773"><a id="__codelineno-0-2773" name="__codelineno-0-2773"></a><span class="sd">                The file path (with directory) to the app package to upload.</span>
</span><span id="__span-0-2774"><a id="__codelineno-0-2774" name="__codelineno-0-2774"></a><span class="sd">            update_existing_app (bool, optional):</span>
</span><span id="__span-0-2775"><a id="__codelineno-0-2775" name="__codelineno-0-2775"></a><span class="sd">                Whether or not to update an existing app with the same name.</span>
</span><span id="__span-0-2776"><a id="__codelineno-0-2776" name="__codelineno-0-2776"></a><span class="sd">            app_catalog_id (str, optional):</span>
</span><span id="__span-0-2777"><a id="__codelineno-0-2777" name="__codelineno-0-2777"></a><span class="sd">                The unique ID of the app. It is the ID the app has in</span>
</span><span id="__span-0-2778"><a id="__codelineno-0-2778" name="__codelineno-0-2778"></a><span class="sd">                the catalog - which is different from ID an app gets</span>
</span><span id="__span-0-2779"><a id="__codelineno-0-2779" name="__codelineno-0-2779"></a><span class="sd">                after installation (which is tenant specific).</span>
</span><span id="__span-0-2780"><a id="__codelineno-0-2780" name="__codelineno-0-2780"></a>
</span><span id="__span-0-2781"><a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2782"><a id="__codelineno-0-2782" name="__codelineno-0-2782"></a><span class="sd">            dict:</span>
</span><span id="__span-0-2783"><a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">                Response of the MS GRAPH API REST call or None if the request fails</span>
</span><span id="__span-0-2784"><a id="__codelineno-0-2784" name="__codelineno-0-2784"></a><span class="sd">                The responses are different depending if it is an install or upgrade!!</span>
</span><span id="__span-0-2785"><a id="__codelineno-0-2785" name="__codelineno-0-2785"></a>
</span><span id="__span-0-2786"><a id="__codelineno-0-2786" name="__codelineno-0-2786"></a><span class="sd">        Example return for upgrades (&quot;teamsAppId&quot; is the &quot;internal&quot; ID of the app):</span>
</span><span id="__span-0-2787"><a id="__codelineno-0-2787" name="__codelineno-0-2787"></a><span class="sd">            {</span>
</span><span id="__span-0-2788"><a id="__codelineno-0-2788" name="__codelineno-0-2788"></a><span class="sd">                &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(&#39;3f749cca-8cb0-4925-9fa0-ba7aca2014af&#39;)/appDefinitions/$entity&quot;,</span>
</span><span id="__span-0-2789"><a id="__codelineno-0-2789" name="__codelineno-0-2789"></a><span class="sd">                &#39;id&#39;: &#39;M2Y3NDljY2EtOGNiMC00OTI1LTlmYTAtYmE3YWNhMjAxNGFmIyMyNC4yLjAjI1B1Ymxpc2hlZA==&#39;,</span>
</span><span id="__span-0-2790"><a id="__codelineno-0-2790" name="__codelineno-0-2790"></a><span class="sd">                &#39;teamsAppId&#39;: &#39;3f749cca-8cb0-4925-9fa0-ba7aca2014af&#39;,</span>
</span><span id="__span-0-2791"><a id="__codelineno-0-2791" name="__codelineno-0-2791"></a><span class="sd">                &#39;displayName&#39;: &#39;IDEA-TE - Extended ECM 24.2.0&#39;,</span>
</span><span id="__span-0-2792"><a id="__codelineno-0-2792" name="__codelineno-0-2792"></a><span class="sd">                &#39;version&#39;: &#39;24.2.0&#39;,</span>
</span><span id="__span-0-2793"><a id="__codelineno-0-2793" name="__codelineno-0-2793"></a><span class="sd">                &#39;publishingState&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-2794"><a id="__codelineno-0-2794" name="__codelineno-0-2794"></a><span class="sd">                &#39;shortDescription&#39;: &#39;Add a tab for an Extended ECM business workspace.&#39;,</span>
</span><span id="__span-0-2795"><a id="__codelineno-0-2795" name="__codelineno-0-2795"></a><span class="sd">                &#39;description&#39;: &#39;View and interact with OpenText Extended ECM business workspaces&#39;,</span>
</span><span id="__span-0-2796"><a id="__codelineno-0-2796" name="__codelineno-0-2796"></a><span class="sd">                &#39;lastModifiedDateTime&#39;: None,</span>
</span><span id="__span-0-2797"><a id="__codelineno-0-2797" name="__codelineno-0-2797"></a><span class="sd">                &#39;createdBy&#39;: None,</span>
</span><span id="__span-0-2798"><a id="__codelineno-0-2798" name="__codelineno-0-2798"></a><span class="sd">                &#39;authorization&#39;: {</span>
</span><span id="__span-0-2799"><a id="__codelineno-0-2799" name="__codelineno-0-2799"></a><span class="sd">                    &#39;requiredPermissionSet&#39;: {...}</span>
</span><span id="__span-0-2800"><a id="__codelineno-0-2800" name="__codelineno-0-2800"></a><span class="sd">                }</span>
</span><span id="__span-0-2801"><a id="__codelineno-0-2801" name="__codelineno-0-2801"></a><span class="sd">            }</span>
</span><span id="__span-0-2802"><a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>
</span><span id="__span-0-2803"><a id="__codelineno-0-2803" name="__codelineno-0-2803"></a><span class="sd">            Example return for new installations (&quot;id&quot; is the &quot;internal&quot; ID of the app):</span>
</span><span id="__span-0-2804"><a id="__codelineno-0-2804" name="__codelineno-0-2804"></a><span class="sd">            {</span>
</span><span id="__span-0-2805"><a id="__codelineno-0-2805" name="__codelineno-0-2805"></a><span class="sd">                &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps/$entity&#39;,</span>
</span><span id="__span-0-2806"><a id="__codelineno-0-2806" name="__codelineno-0-2806"></a><span class="sd">                &#39;id&#39;: &#39;6c672afd-37fc-46c6-8365-d499aba3808b&#39;,</span>
</span><span id="__span-0-2807"><a id="__codelineno-0-2807" name="__codelineno-0-2807"></a><span class="sd">                &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,</span>
</span><span id="__span-0-2808"><a id="__codelineno-0-2808" name="__codelineno-0-2808"></a><span class="sd">                &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,</span>
</span><span id="__span-0-2809"><a id="__codelineno-0-2809" name="__codelineno-0-2809"></a><span class="sd">                &#39;distributionMethod&#39;: &#39;organization&#39;</span>
</span><span id="__span-0-2810"><a id="__codelineno-0-2810" name="__codelineno-0-2810"></a><span class="sd">            }</span>
</span><span id="__span-0-2811"><a id="__codelineno-0-2811" name="__codelineno-0-2811"></a>
</span><span id="__span-0-2812"><a id="__codelineno-0-2812" name="__codelineno-0-2812"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2813"><a id="__codelineno-0-2813" name="__codelineno-0-2813"></a>
</span><span id="__span-0-2814"><a id="__codelineno-0-2814" name="__codelineno-0-2814"></a>        <span class="k">if</span> <span class="n">update_existing_app</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">app_catalog_id</span><span class="p">:</span>
</span><span id="__span-0-2815"><a id="__codelineno-0-2815" name="__codelineno-0-2815"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2816"><a id="__codelineno-0-2816" name="__codelineno-0-2816"></a>                <span class="s2">&quot;To update an existing M365 Teams app in the app catalog you need to provide the existing App catalog ID!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2817"><a id="__codelineno-0-2817" name="__codelineno-0-2817"></a>            <span class="p">)</span>
</span><span id="__span-0-2818"><a id="__codelineno-0-2818" name="__codelineno-0-2818"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2819"><a id="__codelineno-0-2819" name="__codelineno-0-2819"></a>
</span><span id="__span-0-2820"><a id="__codelineno-0-2820" name="__codelineno-0-2820"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">app_path</span><span class="p">):</span>
</span><span id="__span-0-2821"><a id="__codelineno-0-2821" name="__codelineno-0-2821"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;M365 Teams app file -&gt; </span><span class="si">%s</span><span class="s2"> does not exist!&quot;</span><span class="p">,</span> <span class="n">app_path</span><span class="p">)</span>
</span><span id="__span-0-2822"><a id="__codelineno-0-2822" name="__codelineno-0-2822"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2823"><a id="__codelineno-0-2823" name="__codelineno-0-2823"></a>
</span><span id="__span-0-2824"><a id="__codelineno-0-2824" name="__codelineno-0-2824"></a>        <span class="c1"># Ensure that the app file is a zip file</span>
</span><span id="__span-0-2825"><a id="__codelineno-0-2825" name="__codelineno-0-2825"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
</span><span id="__span-0-2826"><a id="__codelineno-0-2826" name="__codelineno-0-2826"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;M365 Teams app file -&gt; </span><span class="si">%s</span><span class="s2"> must be a zip file!&quot;</span><span class="p">,</span> <span class="n">app_path</span><span class="p">)</span>
</span><span id="__span-0-2827"><a id="__codelineno-0-2827" name="__codelineno-0-2827"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2828"><a id="__codelineno-0-2828" name="__codelineno-0-2828"></a>
</span><span id="__span-0-2829"><a id="__codelineno-0-2829" name="__codelineno-0-2829"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-2830"><a id="__codelineno-0-2830" name="__codelineno-0-2830"></a>        <span class="c1"># If we want to upgrade an existing app we add the app ID and</span>
</span><span id="__span-0-2831"><a id="__codelineno-0-2831" name="__codelineno-0-2831"></a>        <span class="c1"># the specific endpoint:</span>
</span><span id="__span-0-2832"><a id="__codelineno-0-2832" name="__codelineno-0-2832"></a>        <span class="k">if</span> <span class="n">update_existing_app</span><span class="p">:</span>
</span><span id="__span-0-2833"><a id="__codelineno-0-2833" name="__codelineno-0-2833"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_catalog_id</span> <span class="o">+</span> <span class="s2">&quot;/appDefinitions&quot;</span>
</span><span id="__span-0-2834"><a id="__codelineno-0-2834" name="__codelineno-0-2834"></a>
</span><span id="__span-0-2835"><a id="__codelineno-0-2835" name="__codelineno-0-2835"></a>        <span class="c1"># Here we need the credentials of an authenticated user!</span>
</span><span id="__span-0-2836"><a id="__codelineno-0-2836" name="__codelineno-0-2836"></a>        <span class="c1"># (not the application credentials (client_id, client_secret))</span>
</span><span id="__span-0-2837"><a id="__codelineno-0-2837" name="__codelineno-0-2837"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header_user</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;application/zip&quot;</span><span class="p">)</span>
</span><span id="__span-0-2838"><a id="__codelineno-0-2838" name="__codelineno-0-2838"></a>
</span><span id="__span-0-2839"><a id="__codelineno-0-2839" name="__codelineno-0-2839"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-2840"><a id="__codelineno-0-2840" name="__codelineno-0-2840"></a>            <span class="n">app_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-0-2841"><a id="__codelineno-0-2841" name="__codelineno-0-2841"></a>
</span><span id="__span-0-2842"><a id="__codelineno-0-2842" name="__codelineno-0-2842"></a>        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">app_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
</span><span id="__span-0-2843"><a id="__codelineno-0-2843" name="__codelineno-0-2843"></a>            <span class="c1"># Ensure that the app file contains a manifest.json file</span>
</span><span id="__span-0-2844"><a id="__codelineno-0-2844" name="__codelineno-0-2844"></a>            <span class="k">if</span> <span class="s2">&quot;manifest.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">z</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
</span><span id="__span-0-2845"><a id="__codelineno-0-2845" name="__codelineno-0-2845"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2846"><a id="__codelineno-0-2846" name="__codelineno-0-2846"></a>                    <span class="s2">&quot;M365 Teams app file -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; does not contain a manifest.json file!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2847"><a id="__codelineno-0-2847" name="__codelineno-0-2847"></a>                    <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-2848"><a id="__codelineno-0-2848" name="__codelineno-0-2848"></a>                <span class="p">)</span>
</span><span id="__span-0-2849"><a id="__codelineno-0-2849" name="__codelineno-0-2849"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2850"><a id="__codelineno-0-2850" name="__codelineno-0-2850"></a>
</span><span id="__span-0-2851"><a id="__codelineno-0-2851" name="__codelineno-0-2851"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2852"><a id="__codelineno-0-2852" name="__codelineno-0-2852"></a>            <span class="s2">&quot;Upload M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; to the MS Teams catalog; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2853"><a id="__codelineno-0-2853" name="__codelineno-0-2853"></a>            <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-2854"><a id="__codelineno-0-2854" name="__codelineno-0-2854"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2855"><a id="__codelineno-0-2855" name="__codelineno-0-2855"></a>        <span class="p">)</span>
</span><span id="__span-0-2856"><a id="__codelineno-0-2856" name="__codelineno-0-2856"></a>
</span><span id="__span-0-2857"><a id="__codelineno-0-2857" name="__codelineno-0-2857"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2858"><a id="__codelineno-0-2858" name="__codelineno-0-2858"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2859"><a id="__codelineno-0-2859" name="__codelineno-0-2859"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-2860"><a id="__codelineno-0-2860" name="__codelineno-0-2860"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2861"><a id="__codelineno-0-2861" name="__codelineno-0-2861"></a>            <span class="n">data</span><span class="o">=</span><span class="n">app_data</span><span class="p">,</span>
</span><span id="__span-0-2862"><a id="__codelineno-0-2862" name="__codelineno-0-2862"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2863"><a id="__codelineno-0-2863" name="__codelineno-0-2863"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update existing M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (may be because it is not a new version)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2864"><a id="__codelineno-0-2864" name="__codelineno-0-2864"></a>                <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-2865"><a id="__codelineno-0-2865" name="__codelineno-0-2865"></a>            <span class="p">),</span>
</span><span id="__span-0-2866"><a id="__codelineno-0-2866" name="__codelineno-0-2866"></a>        <span class="p">)</span>
</span><span id="__span-0-2867"><a id="__codelineno-0-2867" name="__codelineno-0-2867"></a>
</span><span id="__span-0-2868"><a id="__codelineno-0-2868" name="__codelineno-0-2868"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2869"><a id="__codelineno-0-2869" name="__codelineno-0-2869"></a>
</span><span id="__span-0-2870"><a id="__codelineno-0-2870" name="__codelineno-0-2870"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_teams_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2871"><a id="__codelineno-0-2871" name="__codelineno-0-2871"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove MS Teams App from the app catalog.</span>
</span><span id="__span-0-2872"><a id="__codelineno-0-2872" name="__codelineno-0-2872"></a>
</span><span id="__span-0-2873"><a id="__codelineno-0-2873" name="__codelineno-0-2873"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2874"><a id="__codelineno-0-2874" name="__codelineno-0-2874"></a><span class="sd">            app_id (str):</span>
</span><span id="__span-0-2875"><a id="__codelineno-0-2875" name="__codelineno-0-2875"></a><span class="sd">                The Microsoft 365 GUID of the MS Teams app.</span>
</span><span id="__span-0-2876"><a id="__codelineno-0-2876" name="__codelineno-0-2876"></a>
</span><span id="__span-0-2877"><a id="__codelineno-0-2877" name="__codelineno-0-2877"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2878"><a id="__codelineno-0-2878" name="__codelineno-0-2878"></a>
</span><span id="__span-0-2879"><a id="__codelineno-0-2879" name="__codelineno-0-2879"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_id</span>
</span><span id="__span-0-2880"><a id="__codelineno-0-2880" name="__codelineno-0-2880"></a>        <span class="c1"># Here we need the credentials of an authenticated user!</span>
</span><span id="__span-0-2881"><a id="__codelineno-0-2881" name="__codelineno-0-2881"></a>        <span class="c1"># (not the application credentials (client_id, client_secret))</span>
</span><span id="__span-0-2882"><a id="__codelineno-0-2882" name="__codelineno-0-2882"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header_user</span><span class="p">()</span>
</span><span id="__span-0-2883"><a id="__codelineno-0-2883" name="__codelineno-0-2883"></a>
</span><span id="__span-0-2884"><a id="__codelineno-0-2884" name="__codelineno-0-2884"></a>        <span class="c1"># Make the DELETE request to remove the app from the app catalog</span>
</span><span id="__span-0-2885"><a id="__codelineno-0-2885" name="__codelineno-0-2885"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="__span-0-2886"><a id="__codelineno-0-2886" name="__codelineno-0-2886"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2887"><a id="__codelineno-0-2887" name="__codelineno-0-2887"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2888"><a id="__codelineno-0-2888" name="__codelineno-0-2888"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2889"><a id="__codelineno-0-2889" name="__codelineno-0-2889"></a>        <span class="p">)</span>
</span><span id="__span-0-2890"><a id="__codelineno-0-2890" name="__codelineno-0-2890"></a>
</span><span id="__span-0-2891"><a id="__codelineno-0-2891" name="__codelineno-0-2891"></a>        <span class="c1"># Check the status code of the response</span>
</span><span id="__span-0-2892"><a id="__codelineno-0-2892" name="__codelineno-0-2892"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
</span><span id="__span-0-2893"><a id="__codelineno-0-2893" name="__codelineno-0-2893"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2894"><a id="__codelineno-0-2894" name="__codelineno-0-2894"></a>                <span class="s2">&quot;The M365 Teams app with ID -&gt; </span><span class="si">%s</span><span class="s2"> has been successfully removed from the app catalog.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2895"><a id="__codelineno-0-2895" name="__codelineno-0-2895"></a>                <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-2896"><a id="__codelineno-0-2896" name="__codelineno-0-2896"></a>            <span class="p">)</span>
</span><span id="__span-0-2897"><a id="__codelineno-0-2897" name="__codelineno-0-2897"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2898"><a id="__codelineno-0-2898" name="__codelineno-0-2898"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2899"><a id="__codelineno-0-2899" name="__codelineno-0-2899"></a>                <span class="s2">&quot;An error occurred while removing the M365 Teams app from the M365 app catalog. Status code -&gt; </span><span class="si">%s</span><span class="s2">. Error message -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2900"><a id="__codelineno-0-2900" name="__codelineno-0-2900"></a>                <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-2901"><a id="__codelineno-0-2901" name="__codelineno-0-2901"></a>                <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-2902"><a id="__codelineno-0-2902" name="__codelineno-0-2902"></a>            <span class="p">)</span>
</span><span id="__span-0-2903"><a id="__codelineno-0-2903" name="__codelineno-0-2903"></a>
</span><span id="__span-0-2904"><a id="__codelineno-0-2904" name="__codelineno-0-2904"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2905"><a id="__codelineno-0-2905" name="__codelineno-0-2905"></a>
</span><span id="__span-0-2906"><a id="__codelineno-0-2906" name="__codelineno-0-2906"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assign_teams_app_to_user</span><span class="p">(</span>
</span><span id="__span-0-2907"><a id="__codelineno-0-2907" name="__codelineno-0-2907"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2908"><a id="__codelineno-0-2908" name="__codelineno-0-2908"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2909"><a id="__codelineno-0-2909" name="__codelineno-0-2909"></a>        <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2910"><a id="__codelineno-0-2910" name="__codelineno-0-2910"></a>        <span class="n">app_internal_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2911"><a id="__codelineno-0-2911" name="__codelineno-0-2911"></a>        <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2912"><a id="__codelineno-0-2912" name="__codelineno-0-2912"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2913"><a id="__codelineno-0-2913" name="__codelineno-0-2913"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign (add) a M365 Teams app to a M365 user.</span>
</span><span id="__span-0-2914"><a id="__codelineno-0-2914" name="__codelineno-0-2914"></a>
</span><span id="__span-0-2915"><a id="__codelineno-0-2915" name="__codelineno-0-2915"></a><span class="sd">        See: https://learn.microsoft.com/en-us/graph/api/userteamwork-post-installedapps?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-2916"><a id="__codelineno-0-2916" name="__codelineno-0-2916"></a>
</span><span id="__span-0-2917"><a id="__codelineno-0-2917" name="__codelineno-0-2917"></a><span class="sd">        Args:</span>
</span><span id="__span-0-2918"><a id="__codelineno-0-2918" name="__codelineno-0-2918"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-2919"><a id="__codelineno-0-2919" name="__codelineno-0-2919"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-2920"><a id="__codelineno-0-2920" name="__codelineno-0-2920"></a><span class="sd">            app_name (str, optional):</span>
</span><span id="__span-0-2921"><a id="__codelineno-0-2921" name="__codelineno-0-2921"></a><span class="sd">                The exact name of the app. Not needed if app_internal_id is provided.</span>
</span><span id="__span-0-2922"><a id="__codelineno-0-2922" name="__codelineno-0-2922"></a><span class="sd">            app_internal_id (str, optional):</span>
</span><span id="__span-0-2923"><a id="__codelineno-0-2923" name="__codelineno-0-2923"></a><span class="sd">                The internal ID of the app. If not provided it will be derived from app_name.</span>
</span><span id="__span-0-2924"><a id="__codelineno-0-2924" name="__codelineno-0-2924"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-2925"><a id="__codelineno-0-2925" name="__codelineno-0-2925"></a><span class="sd">                Whether or not an error should be displayed if the user is not found.</span>
</span><span id="__span-0-2926"><a id="__codelineno-0-2926" name="__codelineno-0-2926"></a>
</span><span id="__span-0-2927"><a id="__codelineno-0-2927" name="__codelineno-0-2927"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-2928"><a id="__codelineno-0-2928" name="__codelineno-0-2928"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-2929"><a id="__codelineno-0-2929" name="__codelineno-0-2929"></a><span class="sd">                The response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2930"><a id="__codelineno-0-2930" name="__codelineno-0-2930"></a>
</span><span id="__span-0-2931"><a id="__codelineno-0-2931" name="__codelineno-0-2931"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2932"><a id="__codelineno-0-2932" name="__codelineno-0-2932"></a>
</span><span id="__span-0-2933"><a id="__codelineno-0-2933" name="__codelineno-0-2933"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_internal_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">app_name</span><span class="p">:</span>
</span><span id="__span-0-2934"><a id="__codelineno-0-2934" name="__codelineno-0-2934"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2935"><a id="__codelineno-0-2935" name="__codelineno-0-2935"></a>                <span class="s2">&quot;Either the internal App ID or the App name need to be provided!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2936"><a id="__codelineno-0-2936" name="__codelineno-0-2936"></a>            <span class="p">)</span>
</span><span id="__span-0-2937"><a id="__codelineno-0-2937" name="__codelineno-0-2937"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2938"><a id="__codelineno-0-2938" name="__codelineno-0-2938"></a>
</span><span id="__span-0-2939"><a id="__codelineno-0-2939" name="__codelineno-0-2939"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_internal_id</span><span class="p">:</span>
</span><span id="__span-0-2940"><a id="__codelineno-0-2940" name="__codelineno-0-2940"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps</span><span class="p">(</span>
</span><span id="__span-0-2941"><a id="__codelineno-0-2941" name="__codelineno-0-2941"></a>                <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_name</span><span class="p">),</span>
</span><span id="__span-0-2942"><a id="__codelineno-0-2942" name="__codelineno-0-2942"></a>            <span class="p">)</span>
</span><span id="__span-0-2943"><a id="__codelineno-0-2943" name="__codelineno-0-2943"></a>            <span class="n">app_internal_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span>
</span><span id="__span-0-2944"><a id="__codelineno-0-2944" name="__codelineno-0-2944"></a>                <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
</span><span id="__span-0-2945"><a id="__codelineno-0-2945" name="__codelineno-0-2945"></a>                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span>
</span><span id="__span-0-2946"><a id="__codelineno-0-2946" name="__codelineno-0-2946"></a>                <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-2947"><a id="__codelineno-0-2947" name="__codelineno-0-2947"></a>            <span class="p">)</span>
</span><span id="__span-0-2948"><a id="__codelineno-0-2948" name="__codelineno-0-2948"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">app_internal_id</span><span class="p">:</span>
</span><span id="__span-0-2949"><a id="__codelineno-0-2949" name="__codelineno-0-2949"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2950"><a id="__codelineno-0-2950" name="__codelineno-0-2950"></a>                    <span class="s2">&quot;M365 Teams App -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found! Cannot assign App to user -&gt; </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2951"><a id="__codelineno-0-2951" name="__codelineno-0-2951"></a>                    <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2952"><a id="__codelineno-0-2952" name="__codelineno-0-2952"></a>                    <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2953"><a id="__codelineno-0-2953" name="__codelineno-0-2953"></a>                <span class="p">)</span>
</span><span id="__span-0-2954"><a id="__codelineno-0-2954" name="__codelineno-0-2954"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2955"><a id="__codelineno-0-2955" name="__codelineno-0-2955"></a>
</span><span id="__span-0-2956"><a id="__codelineno-0-2956" name="__codelineno-0-2956"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps&quot;</span>
</span><span id="__span-0-2957"><a id="__codelineno-0-2957" name="__codelineno-0-2957"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2958"><a id="__codelineno-0-2958" name="__codelineno-0-2958"></a>
</span><span id="__span-0-2959"><a id="__codelineno-0-2959" name="__codelineno-0-2959"></a>        <span class="n">post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2960"><a id="__codelineno-0-2960" name="__codelineno-0-2960"></a>            <span class="s2">&quot;teamsApp@odata.bind&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2961"><a id="__codelineno-0-2961" name="__codelineno-0-2961"></a>        <span class="p">}</span>
</span><span id="__span-0-2962"><a id="__codelineno-0-2962" name="__codelineno-0-2962"></a>
</span><span id="__span-0-2963"><a id="__codelineno-0-2963" name="__codelineno-0-2963"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2964"><a id="__codelineno-0-2964" name="__codelineno-0-2964"></a>            <span class="s2">&quot;Assign M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) to M365 user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2965"><a id="__codelineno-0-2965" name="__codelineno-0-2965"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2966"><a id="__codelineno-0-2966" name="__codelineno-0-2966"></a>            <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2967"><a id="__codelineno-0-2967" name="__codelineno-0-2967"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2968"><a id="__codelineno-0-2968" name="__codelineno-0-2968"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2969"><a id="__codelineno-0-2969" name="__codelineno-0-2969"></a>        <span class="p">)</span>
</span><span id="__span-0-2970"><a id="__codelineno-0-2970" name="__codelineno-0-2970"></a>
</span><span id="__span-0-2971"><a id="__codelineno-0-2971" name="__codelineno-0-2971"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2972"><a id="__codelineno-0-2972" name="__codelineno-0-2972"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2973"><a id="__codelineno-0-2973" name="__codelineno-0-2973"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-2974"><a id="__codelineno-0-2974" name="__codelineno-0-2974"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2975"><a id="__codelineno-0-2975" name="__codelineno-0-2975"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">post_body</span><span class="p">,</span>
</span><span id="__span-0-2976"><a id="__codelineno-0-2976" name="__codelineno-0-2976"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2977"><a id="__codelineno-0-2977" name="__codelineno-0-2977"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) to M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2978"><a id="__codelineno-0-2978" name="__codelineno-0-2978"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2979"><a id="__codelineno-0-2979" name="__codelineno-0-2979"></a>                <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2980"><a id="__codelineno-0-2980" name="__codelineno-0-2980"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2981"><a id="__codelineno-0-2981" name="__codelineno-0-2981"></a>            <span class="p">),</span>
</span><span id="__span-0-2982"><a id="__codelineno-0-2982" name="__codelineno-0-2982"></a>            <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) to M365 user -&gt; </span><span class="si">{}</span><span class="s2"> (could be the app is assigned organization-wide)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2983"><a id="__codelineno-0-2983" name="__codelineno-0-2983"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2984"><a id="__codelineno-0-2984" name="__codelineno-0-2984"></a>                <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2985"><a id="__codelineno-0-2985" name="__codelineno-0-2985"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2986"><a id="__codelineno-0-2986" name="__codelineno-0-2986"></a>            <span class="p">),</span>
</span><span id="__span-0-2987"><a id="__codelineno-0-2987" name="__codelineno-0-2987"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-2988"><a id="__codelineno-0-2988" name="__codelineno-0-2988"></a>        <span class="p">)</span>
</span><span id="__span-0-2989"><a id="__codelineno-0-2989" name="__codelineno-0-2989"></a>
</span><span id="__span-0-2990"><a id="__codelineno-0-2990" name="__codelineno-0-2990"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-2991"><a id="__codelineno-0-2991" name="__codelineno-0-2991"></a>
</span><span id="__span-0-2992"><a id="__codelineno-0-2992" name="__codelineno-0-2992"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">upgrade_teams_app_of_user</span><span class="p">(</span>
</span><span id="__span-0-2993"><a id="__codelineno-0-2993" name="__codelineno-0-2993"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2994"><a id="__codelineno-0-2994" name="__codelineno-0-2994"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2995"><a id="__codelineno-0-2995" name="__codelineno-0-2995"></a>        <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2996"><a id="__codelineno-0-2996" name="__codelineno-0-2996"></a>        <span class="n">app_installation_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-2997"><a id="__codelineno-0-2997" name="__codelineno-0-2997"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2998"><a id="__codelineno-0-2998" name="__codelineno-0-2998"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upgrade a MS teams app for a user.</span>
</span><span id="__span-0-2999"><a id="__codelineno-0-2999" name="__codelineno-0-2999"></a>
</span><span id="__span-0-3000"><a id="__codelineno-0-3000" name="__codelineno-0-3000"></a><span class="sd">        The call will fail if the user does not already have the app assigned.</span>
</span><span id="__span-0-3001"><a id="__codelineno-0-3001" name="__codelineno-0-3001"></a><span class="sd">        So this needs to be checked before calling this method.</span>
</span><span id="__span-0-3002"><a id="__codelineno-0-3002" name="__codelineno-0-3002"></a>
</span><span id="__span-0-3003"><a id="__codelineno-0-3003" name="__codelineno-0-3003"></a><span class="sd">        See: https://learn.microsoft.com/en-us/graph/api/userteamwork-teamsappinstallation-upgrade?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-3004"><a id="__codelineno-0-3004" name="__codelineno-0-3004"></a>
</span><span id="__span-0-3005"><a id="__codelineno-0-3005" name="__codelineno-0-3005"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3006"><a id="__codelineno-0-3006" name="__codelineno-0-3006"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-3007"><a id="__codelineno-0-3007" name="__codelineno-0-3007"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-3008"><a id="__codelineno-0-3008" name="__codelineno-0-3008"></a><span class="sd">            app_name (str):</span>
</span><span id="__span-0-3009"><a id="__codelineno-0-3009" name="__codelineno-0-3009"></a><span class="sd">                The exact name of the app.</span>
</span><span id="__span-0-3010"><a id="__codelineno-0-3010" name="__codelineno-0-3010"></a><span class="sd">            app_installation_id (str | None, optional):</span>
</span><span id="__span-0-3011"><a id="__codelineno-0-3011" name="__codelineno-0-3011"></a><span class="sd">                The ID of the app installation for the user. This is neither the internal nor</span>
</span><span id="__span-0-3012"><a id="__codelineno-0-3012" name="__codelineno-0-3012"></a><span class="sd">                external app ID. It is specific for each user and app.</span>
</span><span id="__span-0-3013"><a id="__codelineno-0-3013" name="__codelineno-0-3013"></a>
</span><span id="__span-0-3014"><a id="__codelineno-0-3014" name="__codelineno-0-3014"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3015"><a id="__codelineno-0-3015" name="__codelineno-0-3015"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-3016"><a id="__codelineno-0-3016" name="__codelineno-0-3016"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-3017"><a id="__codelineno-0-3017" name="__codelineno-0-3017"></a>
</span><span id="__span-0-3018"><a id="__codelineno-0-3018" name="__codelineno-0-3018"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3019"><a id="__codelineno-0-3019" name="__codelineno-0-3019"></a>
</span><span id="__span-0-3020"><a id="__codelineno-0-3020" name="__codelineno-0-3020"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3021"><a id="__codelineno-0-3021" name="__codelineno-0-3021"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps_of_user</span><span class="p">(</span>
</span><span id="__span-0-3022"><a id="__codelineno-0-3022" name="__codelineno-0-3022"></a>                <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3023"><a id="__codelineno-0-3023" name="__codelineno-0-3023"></a>                <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(teamsAppDefinition/displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3024"><a id="__codelineno-0-3024" name="__codelineno-0-3024"></a>                    <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3025"><a id="__codelineno-0-3025" name="__codelineno-0-3025"></a>                <span class="p">),</span>
</span><span id="__span-0-3026"><a id="__codelineno-0-3026" name="__codelineno-0-3026"></a>            <span class="p">)</span>
</span><span id="__span-0-3027"><a id="__codelineno-0-3027" name="__codelineno-0-3027"></a>            <span class="c1"># Retrieve the installation specific App ID - this is different from thew App catalalog ID!!</span>
</span><span id="__span-0-3028"><a id="__codelineno-0-3028" name="__codelineno-0-3028"></a>            <span class="n">app_installation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3029"><a id="__codelineno-0-3029" name="__codelineno-0-3029"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3030"><a id="__codelineno-0-3030" name="__codelineno-0-3030"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3031"><a id="__codelineno-0-3031" name="__codelineno-0-3031"></a>                <span class="s2">&quot;M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found for user with ID -&gt; </span><span class="si">%s</span><span class="s2">. Cannot upgrade app for this user!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3032"><a id="__codelineno-0-3032" name="__codelineno-0-3032"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3033"><a id="__codelineno-0-3033" name="__codelineno-0-3033"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3034"><a id="__codelineno-0-3034" name="__codelineno-0-3034"></a>            <span class="p">)</span>
</span><span id="__span-0-3035"><a id="__codelineno-0-3035" name="__codelineno-0-3035"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3036"><a id="__codelineno-0-3036" name="__codelineno-0-3036"></a>
</span><span id="__span-0-3037"><a id="__codelineno-0-3037" name="__codelineno-0-3037"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3038"><a id="__codelineno-0-3038" name="__codelineno-0-3038"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps/&quot;</span> <span class="o">+</span> <span class="n">app_installation_id</span> <span class="o">+</span> <span class="s2">&quot;/upgrade&quot;</span>
</span><span id="__span-0-3039"><a id="__codelineno-0-3039" name="__codelineno-0-3039"></a>        <span class="p">)</span>
</span><span id="__span-0-3040"><a id="__codelineno-0-3040" name="__codelineno-0-3040"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3041"><a id="__codelineno-0-3041" name="__codelineno-0-3041"></a>
</span><span id="__span-0-3042"><a id="__codelineno-0-3042" name="__codelineno-0-3042"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3043"><a id="__codelineno-0-3043" name="__codelineno-0-3043"></a>            <span class="s2">&quot;Upgrade M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3044"><a id="__codelineno-0-3044" name="__codelineno-0-3044"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3045"><a id="__codelineno-0-3045" name="__codelineno-0-3045"></a>            <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3046"><a id="__codelineno-0-3046" name="__codelineno-0-3046"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3047"><a id="__codelineno-0-3047" name="__codelineno-0-3047"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3048"><a id="__codelineno-0-3048" name="__codelineno-0-3048"></a>        <span class="p">)</span>
</span><span id="__span-0-3049"><a id="__codelineno-0-3049" name="__codelineno-0-3049"></a>
</span><span id="__span-0-3050"><a id="__codelineno-0-3050" name="__codelineno-0-3050"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3051"><a id="__codelineno-0-3051" name="__codelineno-0-3051"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3052"><a id="__codelineno-0-3052" name="__codelineno-0-3052"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3053"><a id="__codelineno-0-3053" name="__codelineno-0-3053"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3054"><a id="__codelineno-0-3054" name="__codelineno-0-3054"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3055"><a id="__codelineno-0-3055" name="__codelineno-0-3055"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to upgrade M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3056"><a id="__codelineno-0-3056" name="__codelineno-0-3056"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3057"><a id="__codelineno-0-3057" name="__codelineno-0-3057"></a>                <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3058"><a id="__codelineno-0-3058" name="__codelineno-0-3058"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3059"><a id="__codelineno-0-3059" name="__codelineno-0-3059"></a>            <span class="p">),</span>
</span><span id="__span-0-3060"><a id="__codelineno-0-3060" name="__codelineno-0-3060"></a>        <span class="p">)</span>
</span><span id="__span-0-3061"><a id="__codelineno-0-3061" name="__codelineno-0-3061"></a>
</span><span id="__span-0-3062"><a id="__codelineno-0-3062" name="__codelineno-0-3062"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3063"><a id="__codelineno-0-3063" name="__codelineno-0-3063"></a>
</span><span id="__span-0-3064"><a id="__codelineno-0-3064" name="__codelineno-0-3064"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_teams_app_from_user</span><span class="p">(</span>
</span><span id="__span-0-3065"><a id="__codelineno-0-3065" name="__codelineno-0-3065"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3066"><a id="__codelineno-0-3066" name="__codelineno-0-3066"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3067"><a id="__codelineno-0-3067" name="__codelineno-0-3067"></a>        <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3068"><a id="__codelineno-0-3068" name="__codelineno-0-3068"></a>        <span class="n">app_installation_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3069"><a id="__codelineno-0-3069" name="__codelineno-0-3069"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3070"><a id="__codelineno-0-3070" name="__codelineno-0-3070"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a M365 Teams app from a M365 user.</span>
</span><span id="__span-0-3071"><a id="__codelineno-0-3071" name="__codelineno-0-3071"></a>
</span><span id="__span-0-3072"><a id="__codelineno-0-3072" name="__codelineno-0-3072"></a><span class="sd">           See: https://learn.microsoft.com/en-us/graph/api/userteamwork-delete-installedapps?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-3073"><a id="__codelineno-0-3073" name="__codelineno-0-3073"></a>
</span><span id="__span-0-3074"><a id="__codelineno-0-3074" name="__codelineno-0-3074"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3075"><a id="__codelineno-0-3075" name="__codelineno-0-3075"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-3076"><a id="__codelineno-0-3076" name="__codelineno-0-3076"></a><span class="sd">                The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-3077"><a id="__codelineno-0-3077" name="__codelineno-0-3077"></a><span class="sd">            app_name (str):</span>
</span><span id="__span-0-3078"><a id="__codelineno-0-3078" name="__codelineno-0-3078"></a><span class="sd">                The exact name of the app.</span>
</span><span id="__span-0-3079"><a id="__codelineno-0-3079" name="__codelineno-0-3079"></a><span class="sd">            app_installation_id (str | None):</span>
</span><span id="__span-0-3080"><a id="__codelineno-0-3080" name="__codelineno-0-3080"></a><span class="sd">                The installation ID of the app. Default is None.</span>
</span><span id="__span-0-3081"><a id="__codelineno-0-3081" name="__codelineno-0-3081"></a>
</span><span id="__span-0-3082"><a id="__codelineno-0-3082" name="__codelineno-0-3082"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3083"><a id="__codelineno-0-3083" name="__codelineno-0-3083"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3084"><a id="__codelineno-0-3084" name="__codelineno-0-3084"></a><span class="sd">                Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-3085"><a id="__codelineno-0-3085" name="__codelineno-0-3085"></a>
</span><span id="__span-0-3086"><a id="__codelineno-0-3086" name="__codelineno-0-3086"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3087"><a id="__codelineno-0-3087" name="__codelineno-0-3087"></a>
</span><span id="__span-0-3088"><a id="__codelineno-0-3088" name="__codelineno-0-3088"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3089"><a id="__codelineno-0-3089" name="__codelineno-0-3089"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps_of_user</span><span class="p">(</span>
</span><span id="__span-0-3090"><a id="__codelineno-0-3090" name="__codelineno-0-3090"></a>                <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3091"><a id="__codelineno-0-3091" name="__codelineno-0-3091"></a>                <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(teamsAppDefinition/displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3092"><a id="__codelineno-0-3092" name="__codelineno-0-3092"></a>                    <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3093"><a id="__codelineno-0-3093" name="__codelineno-0-3093"></a>                <span class="p">),</span>
</span><span id="__span-0-3094"><a id="__codelineno-0-3094" name="__codelineno-0-3094"></a>            <span class="p">)</span>
</span><span id="__span-0-3095"><a id="__codelineno-0-3095" name="__codelineno-0-3095"></a>            <span class="c1"># Retrieve the installation specific App ID - this is different from thew App catalalog ID!!</span>
</span><span id="__span-0-3096"><a id="__codelineno-0-3096" name="__codelineno-0-3096"></a>            <span class="n">app_installation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3097"><a id="__codelineno-0-3097" name="__codelineno-0-3097"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3098"><a id="__codelineno-0-3098" name="__codelineno-0-3098"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3099"><a id="__codelineno-0-3099" name="__codelineno-0-3099"></a>                <span class="s2">&quot;M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found for user with ID -&gt; </span><span class="si">%s</span><span class="s2">. Cannot remove app from this user!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3100"><a id="__codelineno-0-3100" name="__codelineno-0-3100"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3101"><a id="__codelineno-0-3101" name="__codelineno-0-3101"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3102"><a id="__codelineno-0-3102" name="__codelineno-0-3102"></a>            <span class="p">)</span>
</span><span id="__span-0-3103"><a id="__codelineno-0-3103" name="__codelineno-0-3103"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3104"><a id="__codelineno-0-3104" name="__codelineno-0-3104"></a>
</span><span id="__span-0-3105"><a id="__codelineno-0-3105" name="__codelineno-0-3105"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps/&quot;</span> <span class="o">+</span> <span class="n">app_installation_id</span>
</span><span id="__span-0-3106"><a id="__codelineno-0-3106" name="__codelineno-0-3106"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3107"><a id="__codelineno-0-3107" name="__codelineno-0-3107"></a>
</span><span id="__span-0-3108"><a id="__codelineno-0-3108" name="__codelineno-0-3108"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3109"><a id="__codelineno-0-3109" name="__codelineno-0-3109"></a>            <span class="s2">&quot;Remove M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) from M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3110"><a id="__codelineno-0-3110" name="__codelineno-0-3110"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3111"><a id="__codelineno-0-3111" name="__codelineno-0-3111"></a>            <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3112"><a id="__codelineno-0-3112" name="__codelineno-0-3112"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3113"><a id="__codelineno-0-3113" name="__codelineno-0-3113"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3114"><a id="__codelineno-0-3114" name="__codelineno-0-3114"></a>        <span class="p">)</span>
</span><span id="__span-0-3115"><a id="__codelineno-0-3115" name="__codelineno-0-3115"></a>
</span><span id="__span-0-3116"><a id="__codelineno-0-3116" name="__codelineno-0-3116"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3117"><a id="__codelineno-0-3117" name="__codelineno-0-3117"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3118"><a id="__codelineno-0-3118" name="__codelineno-0-3118"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-3119"><a id="__codelineno-0-3119" name="__codelineno-0-3119"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3120"><a id="__codelineno-0-3120" name="__codelineno-0-3120"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3121"><a id="__codelineno-0-3121" name="__codelineno-0-3121"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to remove M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) from M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3122"><a id="__codelineno-0-3122" name="__codelineno-0-3122"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3123"><a id="__codelineno-0-3123" name="__codelineno-0-3123"></a>                <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3124"><a id="__codelineno-0-3124" name="__codelineno-0-3124"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3125"><a id="__codelineno-0-3125" name="__codelineno-0-3125"></a>            <span class="p">),</span>
</span><span id="__span-0-3126"><a id="__codelineno-0-3126" name="__codelineno-0-3126"></a>        <span class="p">)</span>
</span><span id="__span-0-3127"><a id="__codelineno-0-3127" name="__codelineno-0-3127"></a>
</span><span id="__span-0-3128"><a id="__codelineno-0-3128" name="__codelineno-0-3128"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3129"><a id="__codelineno-0-3129" name="__codelineno-0-3129"></a>
</span><span id="__span-0-3130"><a id="__codelineno-0-3130" name="__codelineno-0-3130"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assign_teams_app_to_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3131"><a id="__codelineno-0-3131" name="__codelineno-0-3131"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign (add) a MS Teams app to a M365 team.</span>
</span><span id="__span-0-3132"><a id="__codelineno-0-3132" name="__codelineno-0-3132"></a>
</span><span id="__span-0-3133"><a id="__codelineno-0-3133" name="__codelineno-0-3133"></a><span class="sd">        Afterwards the app can be added as a Tab in a M365 Teams Channel).</span>
</span><span id="__span-0-3134"><a id="__codelineno-0-3134" name="__codelineno-0-3134"></a>
</span><span id="__span-0-3135"><a id="__codelineno-0-3135" name="__codelineno-0-3135"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3136"><a id="__codelineno-0-3136" name="__codelineno-0-3136"></a><span class="sd">            team_id (str):</span>
</span><span id="__span-0-3137"><a id="__codelineno-0-3137" name="__codelineno-0-3137"></a><span class="sd">                The ID of the Microsoft 365 Team.</span>
</span><span id="__span-0-3138"><a id="__codelineno-0-3138" name="__codelineno-0-3138"></a><span class="sd">            app_id (str):</span>
</span><span id="__span-0-3139"><a id="__codelineno-0-3139" name="__codelineno-0-3139"></a><span class="sd">                The ID of the M365 Team App.</span>
</span><span id="__span-0-3140"><a id="__codelineno-0-3140" name="__codelineno-0-3140"></a>
</span><span id="__span-0-3141"><a id="__codelineno-0-3141" name="__codelineno-0-3141"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3142"><a id="__codelineno-0-3142" name="__codelineno-0-3142"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-3143"><a id="__codelineno-0-3143" name="__codelineno-0-3143"></a><span class="sd">                API response or None if the Graph API call fails.</span>
</span><span id="__span-0-3144"><a id="__codelineno-0-3144" name="__codelineno-0-3144"></a>
</span><span id="__span-0-3145"><a id="__codelineno-0-3145" name="__codelineno-0-3145"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3146"><a id="__codelineno-0-3146" name="__codelineno-0-3146"></a>
</span><span id="__span-0-3147"><a id="__codelineno-0-3147" name="__codelineno-0-3147"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span> <span class="o">+</span> <span class="s2">&quot;/installedApps&quot;</span>
</span><span id="__span-0-3148"><a id="__codelineno-0-3148" name="__codelineno-0-3148"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3149"><a id="__codelineno-0-3149" name="__codelineno-0-3149"></a>
</span><span id="__span-0-3150"><a id="__codelineno-0-3150" name="__codelineno-0-3150"></a>        <span class="n">post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3151"><a id="__codelineno-0-3151" name="__codelineno-0-3151"></a>            <span class="s2">&quot;teamsApp@odata.bind&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3152"><a id="__codelineno-0-3152" name="__codelineno-0-3152"></a>        <span class="p">}</span>
</span><span id="__span-0-3153"><a id="__codelineno-0-3153" name="__codelineno-0-3153"></a>
</span><span id="__span-0-3154"><a id="__codelineno-0-3154" name="__codelineno-0-3154"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3155"><a id="__codelineno-0-3155" name="__codelineno-0-3155"></a>            <span class="s2">&quot;Assign M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) to M365 Team -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3156"><a id="__codelineno-0-3156" name="__codelineno-0-3156"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppName&quot;</span><span class="p">],</span>
</span><span id="__span-0-3157"><a id="__codelineno-0-3157" name="__codelineno-0-3157"></a>            <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3158"><a id="__codelineno-0-3158" name="__codelineno-0-3158"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3159"><a id="__codelineno-0-3159" name="__codelineno-0-3159"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3160"><a id="__codelineno-0-3160" name="__codelineno-0-3160"></a>        <span class="p">)</span>
</span><span id="__span-0-3161"><a id="__codelineno-0-3161" name="__codelineno-0-3161"></a>
</span><span id="__span-0-3162"><a id="__codelineno-0-3162" name="__codelineno-0-3162"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3163"><a id="__codelineno-0-3163" name="__codelineno-0-3163"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3164"><a id="__codelineno-0-3164" name="__codelineno-0-3164"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3165"><a id="__codelineno-0-3165" name="__codelineno-0-3165"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3166"><a id="__codelineno-0-3166" name="__codelineno-0-3166"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">post_body</span><span class="p">,</span>
</span><span id="__span-0-3167"><a id="__codelineno-0-3167" name="__codelineno-0-3167"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3168"><a id="__codelineno-0-3168" name="__codelineno-0-3168"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) to M365 Team -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3169"><a id="__codelineno-0-3169" name="__codelineno-0-3169"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppName&quot;</span><span class="p">],</span>
</span><span id="__span-0-3170"><a id="__codelineno-0-3170" name="__codelineno-0-3170"></a>                <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3171"><a id="__codelineno-0-3171" name="__codelineno-0-3171"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3172"><a id="__codelineno-0-3172" name="__codelineno-0-3172"></a>            <span class="p">),</span>
</span><span id="__span-0-3173"><a id="__codelineno-0-3173" name="__codelineno-0-3173"></a>        <span class="p">)</span>
</span><span id="__span-0-3174"><a id="__codelineno-0-3174" name="__codelineno-0-3174"></a>
</span><span id="__span-0-3175"><a id="__codelineno-0-3175" name="__codelineno-0-3175"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3176"><a id="__codelineno-0-3176" name="__codelineno-0-3176"></a>
</span><span id="__span-0-3177"><a id="__codelineno-0-3177" name="__codelineno-0-3177"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">upgrade_teams_app_of_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3178"><a id="__codelineno-0-3178" name="__codelineno-0-3178"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upgrade a MS teams app for a specific team.</span>
</span><span id="__span-0-3179"><a id="__codelineno-0-3179" name="__codelineno-0-3179"></a>
</span><span id="__span-0-3180"><a id="__codelineno-0-3180" name="__codelineno-0-3180"></a><span class="sd">        The call will fail if the team does not already have the app assigned.</span>
</span><span id="__span-0-3181"><a id="__codelineno-0-3181" name="__codelineno-0-3181"></a><span class="sd">        So this needs to be checked before calling this method.</span>
</span><span id="__span-0-3182"><a id="__codelineno-0-3182" name="__codelineno-0-3182"></a>
</span><span id="__span-0-3183"><a id="__codelineno-0-3183" name="__codelineno-0-3183"></a><span class="sd">        THIS IS CURRENTLY NOT WORKING AS EXPECTED.</span>
</span><span id="__span-0-3184"><a id="__codelineno-0-3184" name="__codelineno-0-3184"></a>
</span><span id="__span-0-3185"><a id="__codelineno-0-3185" name="__codelineno-0-3185"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3186"><a id="__codelineno-0-3186" name="__codelineno-0-3186"></a><span class="sd">            team_id (str):</span>
</span><span id="__span-0-3187"><a id="__codelineno-0-3187" name="__codelineno-0-3187"></a><span class="sd">                M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-3188"><a id="__codelineno-0-3188" name="__codelineno-0-3188"></a><span class="sd">            app_name (str):</span>
</span><span id="__span-0-3189"><a id="__codelineno-0-3189" name="__codelineno-0-3189"></a><span class="sd">                The exact name of the app.</span>
</span><span id="__span-0-3190"><a id="__codelineno-0-3190" name="__codelineno-0-3190"></a>
</span><span id="__span-0-3191"><a id="__codelineno-0-3191" name="__codelineno-0-3191"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3192"><a id="__codelineno-0-3192" name="__codelineno-0-3192"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3193"><a id="__codelineno-0-3193" name="__codelineno-0-3193"></a><span class="sd">                The response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-3194"><a id="__codelineno-0-3194" name="__codelineno-0-3194"></a>
</span><span id="__span-0-3195"><a id="__codelineno-0-3195" name="__codelineno-0-3195"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3196"><a id="__codelineno-0-3196" name="__codelineno-0-3196"></a>
</span><span id="__span-0-3197"><a id="__codelineno-0-3197" name="__codelineno-0-3197"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps_of_team</span><span class="p">(</span>
</span><span id="__span-0-3198"><a id="__codelineno-0-3198" name="__codelineno-0-3198"></a>            <span class="n">team_id</span><span class="o">=</span><span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3199"><a id="__codelineno-0-3199" name="__codelineno-0-3199"></a>            <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(teamsAppDefinition/displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_name</span><span class="p">),</span>
</span><span id="__span-0-3200"><a id="__codelineno-0-3200" name="__codelineno-0-3200"></a>        <span class="p">)</span>
</span><span id="__span-0-3201"><a id="__codelineno-0-3201" name="__codelineno-0-3201"></a>        <span class="c1"># Retrieve the installation specific App ID - this is different from thew App catalalog ID!!</span>
</span><span id="__span-0-3202"><a id="__codelineno-0-3202" name="__codelineno-0-3202"></a>        <span class="n">app_installation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3203"><a id="__codelineno-0-3203" name="__codelineno-0-3203"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3204"><a id="__codelineno-0-3204" name="__codelineno-0-3204"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3205"><a id="__codelineno-0-3205" name="__codelineno-0-3205"></a>                <span class="s2">&quot;M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found for M365 Team with ID -&gt; </span><span class="si">%s</span><span class="s2">. Cannot upgrade app for this team!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3206"><a id="__codelineno-0-3206" name="__codelineno-0-3206"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3207"><a id="__codelineno-0-3207" name="__codelineno-0-3207"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3208"><a id="__codelineno-0-3208" name="__codelineno-0-3208"></a>            <span class="p">)</span>
</span><span id="__span-0-3209"><a id="__codelineno-0-3209" name="__codelineno-0-3209"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3210"><a id="__codelineno-0-3210" name="__codelineno-0-3210"></a>
</span><span id="__span-0-3211"><a id="__codelineno-0-3211" name="__codelineno-0-3211"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span> <span class="o">+</span> <span class="s2">&quot;/installedApps/&quot;</span> <span class="o">+</span> <span class="n">app_installation_id</span> <span class="o">+</span> <span class="s2">&quot;/upgrade&quot;</span>
</span><span id="__span-0-3212"><a id="__codelineno-0-3212" name="__codelineno-0-3212"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3213"><a id="__codelineno-0-3213" name="__codelineno-0-3213"></a>
</span><span id="__span-0-3214"><a id="__codelineno-0-3214" name="__codelineno-0-3214"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3215"><a id="__codelineno-0-3215" name="__codelineno-0-3215"></a>            <span class="s2">&quot;Upgrade app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of M365 team with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3216"><a id="__codelineno-0-3216" name="__codelineno-0-3216"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3217"><a id="__codelineno-0-3217" name="__codelineno-0-3217"></a>            <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3218"><a id="__codelineno-0-3218" name="__codelineno-0-3218"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3219"><a id="__codelineno-0-3219" name="__codelineno-0-3219"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3220"><a id="__codelineno-0-3220" name="__codelineno-0-3220"></a>        <span class="p">)</span>
</span><span id="__span-0-3221"><a id="__codelineno-0-3221" name="__codelineno-0-3221"></a>
</span><span id="__span-0-3222"><a id="__codelineno-0-3222" name="__codelineno-0-3222"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3223"><a id="__codelineno-0-3223" name="__codelineno-0-3223"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3224"><a id="__codelineno-0-3224" name="__codelineno-0-3224"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3225"><a id="__codelineno-0-3225" name="__codelineno-0-3225"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3226"><a id="__codelineno-0-3226" name="__codelineno-0-3226"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3227"><a id="__codelineno-0-3227" name="__codelineno-0-3227"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to upgrade M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) of M365 team with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3228"><a id="__codelineno-0-3228" name="__codelineno-0-3228"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3229"><a id="__codelineno-0-3229" name="__codelineno-0-3229"></a>                <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3230"><a id="__codelineno-0-3230" name="__codelineno-0-3230"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3231"><a id="__codelineno-0-3231" name="__codelineno-0-3231"></a>            <span class="p">),</span>
</span><span id="__span-0-3232"><a id="__codelineno-0-3232" name="__codelineno-0-3232"></a>        <span class="p">)</span>
</span><span id="__span-0-3233"><a id="__codelineno-0-3233" name="__codelineno-0-3233"></a>
</span><span id="__span-0-3234"><a id="__codelineno-0-3234" name="__codelineno-0-3234"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3235"><a id="__codelineno-0-3235" name="__codelineno-0-3235"></a>
</span><span id="__span-0-3236"><a id="__codelineno-0-3236" name="__codelineno-0-3236"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_teams_app_to_channel</span><span class="p">(</span>
</span><span id="__span-0-3237"><a id="__codelineno-0-3237" name="__codelineno-0-3237"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3238"><a id="__codelineno-0-3238" name="__codelineno-0-3238"></a>        <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3239"><a id="__codelineno-0-3239" name="__codelineno-0-3239"></a>        <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3240"><a id="__codelineno-0-3240" name="__codelineno-0-3240"></a>        <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3241"><a id="__codelineno-0-3241" name="__codelineno-0-3241"></a>        <span class="n">tab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3242"><a id="__codelineno-0-3242" name="__codelineno-0-3242"></a>        <span class="n">app_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3243"><a id="__codelineno-0-3243" name="__codelineno-0-3243"></a>        <span class="n">cs_node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3244"><a id="__codelineno-0-3244" name="__codelineno-0-3244"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3245"><a id="__codelineno-0-3245" name="__codelineno-0-3245"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add tab for Extended ECM app to an M365 Team channel.</span>
</span><span id="__span-0-3246"><a id="__codelineno-0-3246" name="__codelineno-0-3246"></a>
</span><span id="__span-0-3247"><a id="__codelineno-0-3247" name="__codelineno-0-3247"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3248"><a id="__codelineno-0-3248" name="__codelineno-0-3248"></a><span class="sd">            team_name (str):</span>
</span><span id="__span-0-3249"><a id="__codelineno-0-3249" name="__codelineno-0-3249"></a><span class="sd">                The name of the M365 Team</span>
</span><span id="__span-0-3250"><a id="__codelineno-0-3250" name="__codelineno-0-3250"></a><span class="sd">            channel_name (str):</span>
</span><span id="__span-0-3251"><a id="__codelineno-0-3251" name="__codelineno-0-3251"></a><span class="sd">                The name of the channel.</span>
</span><span id="__span-0-3252"><a id="__codelineno-0-3252" name="__codelineno-0-3252"></a><span class="sd">            app_id (str):</span>
</span><span id="__span-0-3253"><a id="__codelineno-0-3253" name="__codelineno-0-3253"></a><span class="sd">                ID of the MS Teams Application (e.g. the Extended ECM Teams App).</span>
</span><span id="__span-0-3254"><a id="__codelineno-0-3254" name="__codelineno-0-3254"></a><span class="sd">            tab_name (str):</span>
</span><span id="__span-0-3255"><a id="__codelineno-0-3255" name="__codelineno-0-3255"></a><span class="sd">                The name of the tab.</span>
</span><span id="__span-0-3256"><a id="__codelineno-0-3256" name="__codelineno-0-3256"></a><span class="sd">            app_url (str):</span>
</span><span id="__span-0-3257"><a id="__codelineno-0-3257" name="__codelineno-0-3257"></a><span class="sd">                The web URL of the app.</span>
</span><span id="__span-0-3258"><a id="__codelineno-0-3258" name="__codelineno-0-3258"></a><span class="sd">            cs_node_id (int):</span>
</span><span id="__span-0-3259"><a id="__codelineno-0-3259" name="__codelineno-0-3259"></a><span class="sd">                The node ID of the target workspace or container in Extended ECM.</span>
</span><span id="__span-0-3260"><a id="__codelineno-0-3260" name="__codelineno-0-3260"></a>
</span><span id="__span-0-3261"><a id="__codelineno-0-3261" name="__codelineno-0-3261"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3262"><a id="__codelineno-0-3262" name="__codelineno-0-3262"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3263"><a id="__codelineno-0-3263" name="__codelineno-0-3263"></a><span class="sd">                Return data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-3264"><a id="__codelineno-0-3264" name="__codelineno-0-3264"></a>
</span><span id="__span-0-3265"><a id="__codelineno-0-3265" name="__codelineno-0-3265"></a><span class="sd">            Example return data:</span>
</span><span id="__span-0-3266"><a id="__codelineno-0-3266" name="__codelineno-0-3266"></a>
</span><span id="__span-0-3267"><a id="__codelineno-0-3267" name="__codelineno-0-3267"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3268"><a id="__codelineno-0-3268" name="__codelineno-0-3268"></a>
</span><span id="__span-0-3269"><a id="__codelineno-0-3269" name="__codelineno-0-3269"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3270"><a id="__codelineno-0-3270" name="__codelineno-0-3270"></a>        <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3271"><a id="__codelineno-0-3271" name="__codelineno-0-3271"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-3272"><a id="__codelineno-0-3272" name="__codelineno-0-3272"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3273"><a id="__codelineno-0-3273" name="__codelineno-0-3273"></a>
</span><span id="__span-0-3274"><a id="__codelineno-0-3274" name="__codelineno-0-3274"></a>        <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-3275"><a id="__codelineno-0-3275" name="__codelineno-0-3275"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3276"><a id="__codelineno-0-3276" name="__codelineno-0-3276"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3277"><a id="__codelineno-0-3277" name="__codelineno-0-3277"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3278"><a id="__codelineno-0-3278" name="__codelineno-0-3278"></a>
</span><span id="__span-0-3279"><a id="__codelineno-0-3279" name="__codelineno-0-3279"></a>        <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-3280"><a id="__codelineno-0-3280" name="__codelineno-0-3280"></a>        <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3281"><a id="__codelineno-0-3281" name="__codelineno-0-3281"></a>            <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-3282"><a id="__codelineno-0-3282" name="__codelineno-0-3282"></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3283"><a id="__codelineno-0-3283" name="__codelineno-0-3283"></a>        <span class="p">)</span>
</span><span id="__span-0-3284"><a id="__codelineno-0-3284" name="__codelineno-0-3284"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-3285"><a id="__codelineno-0-3285" name="__codelineno-0-3285"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3286"><a id="__codelineno-0-3286" name="__codelineno-0-3286"></a>                <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3287"><a id="__codelineno-0-3287" name="__codelineno-0-3287"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3288"><a id="__codelineno-0-3288" name="__codelineno-0-3288"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3289"><a id="__codelineno-0-3289" name="__codelineno-0-3289"></a>            <span class="p">)</span>
</span><span id="__span-0-3290"><a id="__codelineno-0-3290" name="__codelineno-0-3290"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3291"><a id="__codelineno-0-3291" name="__codelineno-0-3291"></a>        <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3292"><a id="__codelineno-0-3292" name="__codelineno-0-3292"></a>
</span><span id="__span-0-3293"><a id="__codelineno-0-3293" name="__codelineno-0-3293"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs&quot;</span>
</span><span id="__span-0-3294"><a id="__codelineno-0-3294" name="__codelineno-0-3294"></a>
</span><span id="__span-0-3295"><a id="__codelineno-0-3295" name="__codelineno-0-3295"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3296"><a id="__codelineno-0-3296" name="__codelineno-0-3296"></a>
</span><span id="__span-0-3297"><a id="__codelineno-0-3297" name="__codelineno-0-3297"></a>        <span class="c1"># Create tab configuration payload:</span>
</span><span id="__span-0-3298"><a id="__codelineno-0-3298" name="__codelineno-0-3298"></a>        <span class="n">tab_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3299"><a id="__codelineno-0-3299" name="__codelineno-0-3299"></a>            <span class="s2">&quot;teamsApp@odata.bind&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/</span><span class="si">{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3300"><a id="__codelineno-0-3300" name="__codelineno-0-3300"></a>            <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3301"><a id="__codelineno-0-3301" name="__codelineno-0-3301"></a>            <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-3302"><a id="__codelineno-0-3302" name="__codelineno-0-3302"></a>                <span class="s2">&quot;entityId&quot;</span><span class="p">:</span> <span class="n">cs_node_id</span><span class="p">,</span>  <span class="c1"># Unique identifier for the tab</span>
</span><span id="__span-0-3303"><a id="__codelineno-0-3303" name="__codelineno-0-3303"></a>                <span class="s2">&quot;contentUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span><span class="p">,</span>
</span><span id="__span-0-3304"><a id="__codelineno-0-3304" name="__codelineno-0-3304"></a>                <span class="s2">&quot;removeUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3305"><a id="__codelineno-0-3305" name="__codelineno-0-3305"></a>                <span class="s2">&quot;websiteUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span> <span class="o">+</span> <span class="s2">&quot;&amp;showBW=true&amp;title=&quot;</span> <span class="o">+</span> <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3306"><a id="__codelineno-0-3306" name="__codelineno-0-3306"></a>            <span class="p">},</span>
</span><span id="__span-0-3307"><a id="__codelineno-0-3307" name="__codelineno-0-3307"></a>        <span class="p">}</span>
</span><span id="__span-0-3308"><a id="__codelineno-0-3308" name="__codelineno-0-3308"></a>
</span><span id="__span-0-3309"><a id="__codelineno-0-3309" name="__codelineno-0-3309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3310"><a id="__codelineno-0-3310" name="__codelineno-0-3310"></a>            <span class="s2">&quot;Add Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; with App ID -&gt; </span><span class="si">%s</span><span class="s2"> to Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; of Microsoft 365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3311"><a id="__codelineno-0-3311" name="__codelineno-0-3311"></a>            <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3312"><a id="__codelineno-0-3312" name="__codelineno-0-3312"></a>            <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3313"><a id="__codelineno-0-3313" name="__codelineno-0-3313"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3314"><a id="__codelineno-0-3314" name="__codelineno-0-3314"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3315"><a id="__codelineno-0-3315" name="__codelineno-0-3315"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3316"><a id="__codelineno-0-3316" name="__codelineno-0-3316"></a>        <span class="p">)</span>
</span><span id="__span-0-3317"><a id="__codelineno-0-3317" name="__codelineno-0-3317"></a>
</span><span id="__span-0-3318"><a id="__codelineno-0-3318" name="__codelineno-0-3318"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3319"><a id="__codelineno-0-3319" name="__codelineno-0-3319"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3320"><a id="__codelineno-0-3320" name="__codelineno-0-3320"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3321"><a id="__codelineno-0-3321" name="__codelineno-0-3321"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3322"><a id="__codelineno-0-3322" name="__codelineno-0-3322"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">tab_config</span><span class="p">,</span>
</span><span id="__span-0-3323"><a id="__codelineno-0-3323" name="__codelineno-0-3323"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3324"><a id="__codelineno-0-3324" name="__codelineno-0-3324"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add Tab for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3325"><a id="__codelineno-0-3325" name="__codelineno-0-3325"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3326"><a id="__codelineno-0-3326" name="__codelineno-0-3326"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3327"><a id="__codelineno-0-3327" name="__codelineno-0-3327"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3328"><a id="__codelineno-0-3328" name="__codelineno-0-3328"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3329"><a id="__codelineno-0-3329" name="__codelineno-0-3329"></a>            <span class="p">),</span>
</span><span id="__span-0-3330"><a id="__codelineno-0-3330" name="__codelineno-0-3330"></a>        <span class="p">)</span>
</span><span id="__span-0-3331"><a id="__codelineno-0-3331" name="__codelineno-0-3331"></a>
</span><span id="__span-0-3332"><a id="__codelineno-0-3332" name="__codelineno-0-3332"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3333"><a id="__codelineno-0-3333" name="__codelineno-0-3333"></a>
</span><span id="__span-0-3334"><a id="__codelineno-0-3334" name="__codelineno-0-3334"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_teams_app_of_channel</span><span class="p">(</span>
</span><span id="__span-0-3335"><a id="__codelineno-0-3335" name="__codelineno-0-3335"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3336"><a id="__codelineno-0-3336" name="__codelineno-0-3336"></a>        <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3337"><a id="__codelineno-0-3337" name="__codelineno-0-3337"></a>        <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3338"><a id="__codelineno-0-3338" name="__codelineno-0-3338"></a>        <span class="n">tab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3339"><a id="__codelineno-0-3339" name="__codelineno-0-3339"></a>        <span class="n">app_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3340"><a id="__codelineno-0-3340" name="__codelineno-0-3340"></a>        <span class="n">cs_node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3341"><a id="__codelineno-0-3341" name="__codelineno-0-3341"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3342"><a id="__codelineno-0-3342" name="__codelineno-0-3342"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update an existing tab for Extended ECM app in an M365 Team channel.</span>
</span><span id="__span-0-3343"><a id="__codelineno-0-3343" name="__codelineno-0-3343"></a>
</span><span id="__span-0-3344"><a id="__codelineno-0-3344" name="__codelineno-0-3344"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3345"><a id="__codelineno-0-3345" name="__codelineno-0-3345"></a><span class="sd">            team_name (str):</span>
</span><span id="__span-0-3346"><a id="__codelineno-0-3346" name="__codelineno-0-3346"></a><span class="sd">                The name of the M365 Team.</span>
</span><span id="__span-0-3347"><a id="__codelineno-0-3347" name="__codelineno-0-3347"></a><span class="sd">            channel_name (str):</span>
</span><span id="__span-0-3348"><a id="__codelineno-0-3348" name="__codelineno-0-3348"></a><span class="sd">                The name of the channel.</span>
</span><span id="__span-0-3349"><a id="__codelineno-0-3349" name="__codelineno-0-3349"></a><span class="sd">            tab_name (str):</span>
</span><span id="__span-0-3350"><a id="__codelineno-0-3350" name="__codelineno-0-3350"></a><span class="sd">                The name of the tab.</span>
</span><span id="__span-0-3351"><a id="__codelineno-0-3351" name="__codelineno-0-3351"></a><span class="sd">            app_url (str):</span>
</span><span id="__span-0-3352"><a id="__codelineno-0-3352" name="__codelineno-0-3352"></a><span class="sd">                The web URL of the app.</span>
</span><span id="__span-0-3353"><a id="__codelineno-0-3353" name="__codelineno-0-3353"></a><span class="sd">            cs_node_id (int):</span>
</span><span id="__span-0-3354"><a id="__codelineno-0-3354" name="__codelineno-0-3354"></a><span class="sd">                The node ID of the target workspace or container in Content Server.</span>
</span><span id="__span-0-3355"><a id="__codelineno-0-3355" name="__codelineno-0-3355"></a>
</span><span id="__span-0-3356"><a id="__codelineno-0-3356" name="__codelineno-0-3356"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3357"><a id="__codelineno-0-3357" name="__codelineno-0-3357"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3358"><a id="__codelineno-0-3358" name="__codelineno-0-3358"></a><span class="sd">                Return data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-3359"><a id="__codelineno-0-3359" name="__codelineno-0-3359"></a>
</span><span id="__span-0-3360"><a id="__codelineno-0-3360" name="__codelineno-0-3360"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3361"><a id="__codelineno-0-3361" name="__codelineno-0-3361"></a>
</span><span id="__span-0-3362"><a id="__codelineno-0-3362" name="__codelineno-0-3362"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3363"><a id="__codelineno-0-3363" name="__codelineno-0-3363"></a>        <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3364"><a id="__codelineno-0-3364" name="__codelineno-0-3364"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-3365"><a id="__codelineno-0-3365" name="__codelineno-0-3365"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3366"><a id="__codelineno-0-3366" name="__codelineno-0-3366"></a>
</span><span id="__span-0-3367"><a id="__codelineno-0-3367" name="__codelineno-0-3367"></a>        <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-3368"><a id="__codelineno-0-3368" name="__codelineno-0-3368"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3369"><a id="__codelineno-0-3369" name="__codelineno-0-3369"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3370"><a id="__codelineno-0-3370" name="__codelineno-0-3370"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3371"><a id="__codelineno-0-3371" name="__codelineno-0-3371"></a>
</span><span id="__span-0-3372"><a id="__codelineno-0-3372" name="__codelineno-0-3372"></a>        <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-3373"><a id="__codelineno-0-3373" name="__codelineno-0-3373"></a>        <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3374"><a id="__codelineno-0-3374" name="__codelineno-0-3374"></a>            <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-3375"><a id="__codelineno-0-3375" name="__codelineno-0-3375"></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3376"><a id="__codelineno-0-3376" name="__codelineno-0-3376"></a>        <span class="p">)</span>
</span><span id="__span-0-3377"><a id="__codelineno-0-3377" name="__codelineno-0-3377"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-3378"><a id="__codelineno-0-3378" name="__codelineno-0-3378"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3379"><a id="__codelineno-0-3379" name="__codelineno-0-3379"></a>                <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; for M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3380"><a id="__codelineno-0-3380" name="__codelineno-0-3380"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3381"><a id="__codelineno-0-3381" name="__codelineno-0-3381"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3382"><a id="__codelineno-0-3382" name="__codelineno-0-3382"></a>            <span class="p">)</span>
</span><span id="__span-0-3383"><a id="__codelineno-0-3383" name="__codelineno-0-3383"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3384"><a id="__codelineno-0-3384" name="__codelineno-0-3384"></a>        <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3385"><a id="__codelineno-0-3385" name="__codelineno-0-3385"></a>
</span><span id="__span-0-3386"><a id="__codelineno-0-3386" name="__codelineno-0-3386"></a>        <span class="c1"># Get the tabs of the M365 Team channel:</span>
</span><span id="__span-0-3387"><a id="__codelineno-0-3387" name="__codelineno-0-3387"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channel_tabs</span><span class="p">(</span><span class="n">team_name</span><span class="o">=</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="o">=</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="__span-0-3388"><a id="__codelineno-0-3388" name="__codelineno-0-3388"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3389"><a id="__codelineno-0-3389" name="__codelineno-0-3389"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3390"><a id="__codelineno-0-3390" name="__codelineno-0-3390"></a>
</span><span id="__span-0-3391"><a id="__codelineno-0-3391" name="__codelineno-0-3391"></a>        <span class="c1"># Look the tab by name and then retrieve its ID:</span>
</span><span id="__span-0-3392"><a id="__codelineno-0-3392" name="__codelineno-0-3392"></a>        <span class="n">tab</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3393"><a id="__codelineno-0-3393" name="__codelineno-0-3393"></a>            <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab_name</span><span class="p">),</span>
</span><span id="__span-0-3394"><a id="__codelineno-0-3394" name="__codelineno-0-3394"></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3395"><a id="__codelineno-0-3395" name="__codelineno-0-3395"></a>        <span class="p">)</span>
</span><span id="__span-0-3396"><a id="__codelineno-0-3396" name="__codelineno-0-3396"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">tab</span><span class="p">:</span>
</span><span id="__span-0-3397"><a id="__codelineno-0-3397" name="__codelineno-0-3397"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3398"><a id="__codelineno-0-3398" name="__codelineno-0-3398"></a>                <span class="s2">&quot;Cannot find Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">)!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3399"><a id="__codelineno-0-3399" name="__codelineno-0-3399"></a>                <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3400"><a id="__codelineno-0-3400" name="__codelineno-0-3400"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3401"><a id="__codelineno-0-3401" name="__codelineno-0-3401"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3402"><a id="__codelineno-0-3402" name="__codelineno-0-3402"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3403"><a id="__codelineno-0-3403" name="__codelineno-0-3403"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3404"><a id="__codelineno-0-3404" name="__codelineno-0-3404"></a>            <span class="p">)</span>
</span><span id="__span-0-3405"><a id="__codelineno-0-3405" name="__codelineno-0-3405"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3406"><a id="__codelineno-0-3406" name="__codelineno-0-3406"></a>        <span class="n">tab_id</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3407"><a id="__codelineno-0-3407" name="__codelineno-0-3407"></a>
</span><span id="__span-0-3408"><a id="__codelineno-0-3408" name="__codelineno-0-3408"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3409"><a id="__codelineno-0-3409" name="__codelineno-0-3409"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tab_id</span><span class="p">)</span>
</span><span id="__span-0-3410"><a id="__codelineno-0-3410" name="__codelineno-0-3410"></a>        <span class="p">)</span>
</span><span id="__span-0-3411"><a id="__codelineno-0-3411" name="__codelineno-0-3411"></a>
</span><span id="__span-0-3412"><a id="__codelineno-0-3412" name="__codelineno-0-3412"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3413"><a id="__codelineno-0-3413" name="__codelineno-0-3413"></a>
</span><span id="__span-0-3414"><a id="__codelineno-0-3414" name="__codelineno-0-3414"></a>        <span class="c1"># Create tab configuration payload:</span>
</span><span id="__span-0-3415"><a id="__codelineno-0-3415" name="__codelineno-0-3415"></a>        <span class="n">tab_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3416"><a id="__codelineno-0-3416" name="__codelineno-0-3416"></a>            <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-3417"><a id="__codelineno-0-3417" name="__codelineno-0-3417"></a>                <span class="s2">&quot;entityId&quot;</span><span class="p">:</span> <span class="n">cs_node_id</span><span class="p">,</span>  <span class="c1"># Unique identifier for the tab</span>
</span><span id="__span-0-3418"><a id="__codelineno-0-3418" name="__codelineno-0-3418"></a>                <span class="s2">&quot;contentUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span><span class="p">,</span>
</span><span id="__span-0-3419"><a id="__codelineno-0-3419" name="__codelineno-0-3419"></a>                <span class="s2">&quot;removeUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3420"><a id="__codelineno-0-3420" name="__codelineno-0-3420"></a>                <span class="s2">&quot;websiteUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span> <span class="o">+</span> <span class="s2">&quot;&amp;showBW=true&amp;title=&quot;</span> <span class="o">+</span> <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3421"><a id="__codelineno-0-3421" name="__codelineno-0-3421"></a>            <span class="p">},</span>
</span><span id="__span-0-3422"><a id="__codelineno-0-3422" name="__codelineno-0-3422"></a>        <span class="p">}</span>
</span><span id="__span-0-3423"><a id="__codelineno-0-3423" name="__codelineno-0-3423"></a>
</span><span id="__span-0-3424"><a id="__codelineno-0-3424" name="__codelineno-0-3424"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3425"><a id="__codelineno-0-3425" name="__codelineno-0-3425"></a>            <span class="s2">&quot;Update Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) for Microsoft 365 Teams -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) with configuration -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3426"><a id="__codelineno-0-3426" name="__codelineno-0-3426"></a>            <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3427"><a id="__codelineno-0-3427" name="__codelineno-0-3427"></a>            <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3428"><a id="__codelineno-0-3428" name="__codelineno-0-3428"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3429"><a id="__codelineno-0-3429" name="__codelineno-0-3429"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3430"><a id="__codelineno-0-3430" name="__codelineno-0-3430"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3431"><a id="__codelineno-0-3431" name="__codelineno-0-3431"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3432"><a id="__codelineno-0-3432" name="__codelineno-0-3432"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">tab_config</span><span class="p">),</span>
</span><span id="__span-0-3433"><a id="__codelineno-0-3433" name="__codelineno-0-3433"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3434"><a id="__codelineno-0-3434" name="__codelineno-0-3434"></a>        <span class="p">)</span>
</span><span id="__span-0-3435"><a id="__codelineno-0-3435" name="__codelineno-0-3435"></a>
</span><span id="__span-0-3436"><a id="__codelineno-0-3436" name="__codelineno-0-3436"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3437"><a id="__codelineno-0-3437" name="__codelineno-0-3437"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3438"><a id="__codelineno-0-3438" name="__codelineno-0-3438"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-3439"><a id="__codelineno-0-3439" name="__codelineno-0-3439"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3440"><a id="__codelineno-0-3440" name="__codelineno-0-3440"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">tab_config</span><span class="p">,</span>
</span><span id="__span-0-3441"><a id="__codelineno-0-3441" name="__codelineno-0-3441"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3442"><a id="__codelineno-0-3442" name="__codelineno-0-3442"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update Tab -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3443"><a id="__codelineno-0-3443" name="__codelineno-0-3443"></a>                <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3444"><a id="__codelineno-0-3444" name="__codelineno-0-3444"></a>                <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3445"><a id="__codelineno-0-3445" name="__codelineno-0-3445"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3446"><a id="__codelineno-0-3446" name="__codelineno-0-3446"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3447"><a id="__codelineno-0-3447" name="__codelineno-0-3447"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3448"><a id="__codelineno-0-3448" name="__codelineno-0-3448"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3449"><a id="__codelineno-0-3449" name="__codelineno-0-3449"></a>            <span class="p">),</span>
</span><span id="__span-0-3450"><a id="__codelineno-0-3450" name="__codelineno-0-3450"></a>        <span class="p">)</span>
</span><span id="__span-0-3451"><a id="__codelineno-0-3451" name="__codelineno-0-3451"></a>
</span><span id="__span-0-3452"><a id="__codelineno-0-3452" name="__codelineno-0-3452"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3453"><a id="__codelineno-0-3453" name="__codelineno-0-3453"></a>
</span><span id="__span-0-3454"><a id="__codelineno-0-3454" name="__codelineno-0-3454"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_teams_app_from_channel</span><span class="p">(</span>
</span><span id="__span-0-3455"><a id="__codelineno-0-3455" name="__codelineno-0-3455"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3456"><a id="__codelineno-0-3456" name="__codelineno-0-3456"></a>        <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3457"><a id="__codelineno-0-3457" name="__codelineno-0-3457"></a>        <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3458"><a id="__codelineno-0-3458" name="__codelineno-0-3458"></a>        <span class="n">tab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3459"><a id="__codelineno-0-3459" name="__codelineno-0-3459"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-3460"><a id="__codelineno-0-3460" name="__codelineno-0-3460"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete an existing tab for Extended ECM app from an M365 Team channel.</span>
</span><span id="__span-0-3461"><a id="__codelineno-0-3461" name="__codelineno-0-3461"></a>
</span><span id="__span-0-3462"><a id="__codelineno-0-3462" name="__codelineno-0-3462"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3463"><a id="__codelineno-0-3463" name="__codelineno-0-3463"></a><span class="sd">            team_name (str):</span>
</span><span id="__span-0-3464"><a id="__codelineno-0-3464" name="__codelineno-0-3464"></a><span class="sd">                The name of the M365 Team.</span>
</span><span id="__span-0-3465"><a id="__codelineno-0-3465" name="__codelineno-0-3465"></a><span class="sd">            channel_name (str):</span>
</span><span id="__span-0-3466"><a id="__codelineno-0-3466" name="__codelineno-0-3466"></a><span class="sd">                The name of the channel.</span>
</span><span id="__span-0-3467"><a id="__codelineno-0-3467" name="__codelineno-0-3467"></a><span class="sd">            tab_name (str):</span>
</span><span id="__span-0-3468"><a id="__codelineno-0-3468" name="__codelineno-0-3468"></a><span class="sd">                The name of the tab.</span>
</span><span id="__span-0-3469"><a id="__codelineno-0-3469" name="__codelineno-0-3469"></a>
</span><span id="__span-0-3470"><a id="__codelineno-0-3470" name="__codelineno-0-3470"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3471"><a id="__codelineno-0-3471" name="__codelineno-0-3471"></a><span class="sd">            bool:</span>
</span><span id="__span-0-3472"><a id="__codelineno-0-3472" name="__codelineno-0-3472"></a><span class="sd">                True = success, False = Error.</span>
</span><span id="__span-0-3473"><a id="__codelineno-0-3473" name="__codelineno-0-3473"></a>
</span><span id="__span-0-3474"><a id="__codelineno-0-3474" name="__codelineno-0-3474"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3475"><a id="__codelineno-0-3475" name="__codelineno-0-3475"></a>
</span><span id="__span-0-3476"><a id="__codelineno-0-3476" name="__codelineno-0-3476"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3477"><a id="__codelineno-0-3477" name="__codelineno-0-3477"></a>        <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3478"><a id="__codelineno-0-3478" name="__codelineno-0-3478"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-3479"><a id="__codelineno-0-3479" name="__codelineno-0-3479"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3480"><a id="__codelineno-0-3480" name="__codelineno-0-3480"></a>
</span><span id="__span-0-3481"><a id="__codelineno-0-3481" name="__codelineno-0-3481"></a>        <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-3482"><a id="__codelineno-0-3482" name="__codelineno-0-3482"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3483"><a id="__codelineno-0-3483" name="__codelineno-0-3483"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3484"><a id="__codelineno-0-3484" name="__codelineno-0-3484"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3485"><a id="__codelineno-0-3485" name="__codelineno-0-3485"></a>
</span><span id="__span-0-3486"><a id="__codelineno-0-3486" name="__codelineno-0-3486"></a>        <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-3487"><a id="__codelineno-0-3487" name="__codelineno-0-3487"></a>        <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3488"><a id="__codelineno-0-3488" name="__codelineno-0-3488"></a>            <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-3489"><a id="__codelineno-0-3489" name="__codelineno-0-3489"></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3490"><a id="__codelineno-0-3490" name="__codelineno-0-3490"></a>        <span class="p">)</span>
</span><span id="__span-0-3491"><a id="__codelineno-0-3491" name="__codelineno-0-3491"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-3492"><a id="__codelineno-0-3492" name="__codelineno-0-3492"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3493"><a id="__codelineno-0-3493" name="__codelineno-0-3493"></a>                <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; for M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3494"><a id="__codelineno-0-3494" name="__codelineno-0-3494"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3495"><a id="__codelineno-0-3495" name="__codelineno-0-3495"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3496"><a id="__codelineno-0-3496" name="__codelineno-0-3496"></a>            <span class="p">)</span>
</span><span id="__span-0-3497"><a id="__codelineno-0-3497" name="__codelineno-0-3497"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3498"><a id="__codelineno-0-3498" name="__codelineno-0-3498"></a>        <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3499"><a id="__codelineno-0-3499" name="__codelineno-0-3499"></a>
</span><span id="__span-0-3500"><a id="__codelineno-0-3500" name="__codelineno-0-3500"></a>        <span class="c1"># Get the tabs of the M365 Team channel:</span>
</span><span id="__span-0-3501"><a id="__codelineno-0-3501" name="__codelineno-0-3501"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channel_tabs</span><span class="p">(</span><span class="n">team_name</span><span class="o">=</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="o">=</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="__span-0-3502"><a id="__codelineno-0-3502" name="__codelineno-0-3502"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3503"><a id="__codelineno-0-3503" name="__codelineno-0-3503"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3504"><a id="__codelineno-0-3504" name="__codelineno-0-3504"></a>
</span><span id="__span-0-3505"><a id="__codelineno-0-3505" name="__codelineno-0-3505"></a>        <span class="c1"># Lookup the tabs by name and then retrieve their IDs (in worst case it can</span>
</span><span id="__span-0-3506"><a id="__codelineno-0-3506" name="__codelineno-0-3506"></a>        <span class="c1"># be multiple tabs / apps with same name if former cleanups did not work):</span>
</span><span id="__span-0-3507"><a id="__codelineno-0-3507" name="__codelineno-0-3507"></a>        <span class="n">tab_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab_name</span><span class="p">]</span>
</span><span id="__span-0-3508"><a id="__codelineno-0-3508" name="__codelineno-0-3508"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">tab_list</span><span class="p">:</span>
</span><span id="__span-0-3509"><a id="__codelineno-0-3509" name="__codelineno-0-3509"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3510"><a id="__codelineno-0-3510" name="__codelineno-0-3510"></a>                <span class="s2">&quot;Cannot find Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">)!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3511"><a id="__codelineno-0-3511" name="__codelineno-0-3511"></a>                <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3512"><a id="__codelineno-0-3512" name="__codelineno-0-3512"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3513"><a id="__codelineno-0-3513" name="__codelineno-0-3513"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3514"><a id="__codelineno-0-3514" name="__codelineno-0-3514"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3515"><a id="__codelineno-0-3515" name="__codelineno-0-3515"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3516"><a id="__codelineno-0-3516" name="__codelineno-0-3516"></a>            <span class="p">)</span>
</span><span id="__span-0-3517"><a id="__codelineno-0-3517" name="__codelineno-0-3517"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3518"><a id="__codelineno-0-3518" name="__codelineno-0-3518"></a>
</span><span id="__span-0-3519"><a id="__codelineno-0-3519" name="__codelineno-0-3519"></a>        <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">tab_list</span><span class="p">:</span>
</span><span id="__span-0-3520"><a id="__codelineno-0-3520" name="__codelineno-0-3520"></a>            <span class="n">tab_id</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3521"><a id="__codelineno-0-3521" name="__codelineno-0-3521"></a>
</span><span id="__span-0-3522"><a id="__codelineno-0-3522" name="__codelineno-0-3522"></a>            <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3523"><a id="__codelineno-0-3523" name="__codelineno-0-3523"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tab_id</span><span class="p">)</span>
</span><span id="__span-0-3524"><a id="__codelineno-0-3524" name="__codelineno-0-3524"></a>            <span class="p">)</span>
</span><span id="__span-0-3525"><a id="__codelineno-0-3525" name="__codelineno-0-3525"></a>
</span><span id="__span-0-3526"><a id="__codelineno-0-3526" name="__codelineno-0-3526"></a>            <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3527"><a id="__codelineno-0-3527" name="__codelineno-0-3527"></a>
</span><span id="__span-0-3528"><a id="__codelineno-0-3528" name="__codelineno-0-3528"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3529"><a id="__codelineno-0-3529" name="__codelineno-0-3529"></a>                <span class="s2">&quot;Delete Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) from Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of Microsoft 365 Teams -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3530"><a id="__codelineno-0-3530" name="__codelineno-0-3530"></a>                <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3531"><a id="__codelineno-0-3531" name="__codelineno-0-3531"></a>                <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3532"><a id="__codelineno-0-3532" name="__codelineno-0-3532"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3533"><a id="__codelineno-0-3533" name="__codelineno-0-3533"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3534"><a id="__codelineno-0-3534" name="__codelineno-0-3534"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3535"><a id="__codelineno-0-3535" name="__codelineno-0-3535"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3536"><a id="__codelineno-0-3536" name="__codelineno-0-3536"></a>                <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3537"><a id="__codelineno-0-3537" name="__codelineno-0-3537"></a>            <span class="p">)</span>
</span><span id="__span-0-3538"><a id="__codelineno-0-3538" name="__codelineno-0-3538"></a>
</span><span id="__span-0-3539"><a id="__codelineno-0-3539" name="__codelineno-0-3539"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3540"><a id="__codelineno-0-3540" name="__codelineno-0-3540"></a>                <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3541"><a id="__codelineno-0-3541" name="__codelineno-0-3541"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-3542"><a id="__codelineno-0-3542" name="__codelineno-0-3542"></a>                <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3543"><a id="__codelineno-0-3543" name="__codelineno-0-3543"></a>                <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3544"><a id="__codelineno-0-3544" name="__codelineno-0-3544"></a>                <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to delete Tab -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3545"><a id="__codelineno-0-3545" name="__codelineno-0-3545"></a>                    <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3546"><a id="__codelineno-0-3546" name="__codelineno-0-3546"></a>                    <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3547"><a id="__codelineno-0-3547" name="__codelineno-0-3547"></a>                    <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3548"><a id="__codelineno-0-3548" name="__codelineno-0-3548"></a>                    <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3549"><a id="__codelineno-0-3549" name="__codelineno-0-3549"></a>                    <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3550"><a id="__codelineno-0-3550" name="__codelineno-0-3550"></a>                    <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3551"><a id="__codelineno-0-3551" name="__codelineno-0-3551"></a>                <span class="p">),</span>
</span><span id="__span-0-3552"><a id="__codelineno-0-3552" name="__codelineno-0-3552"></a>                <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3553"><a id="__codelineno-0-3553" name="__codelineno-0-3553"></a>            <span class="p">)</span>
</span><span id="__span-0-3554"><a id="__codelineno-0-3554" name="__codelineno-0-3554"></a>
</span><span id="__span-0-3555"><a id="__codelineno-0-3555" name="__codelineno-0-3555"></a>            <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-3556"><a id="__codelineno-0-3556" name="__codelineno-0-3556"></a>                <span class="k">break</span>
</span><span id="__span-0-3557"><a id="__codelineno-0-3557" name="__codelineno-0-3557"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3558"><a id="__codelineno-0-3558" name="__codelineno-0-3558"></a>        <span class="c1"># end for tab in tab_list</span>
</span><span id="__span-0-3559"><a id="__codelineno-0-3559" name="__codelineno-0-3559"></a>
</span><span id="__span-0-3560"><a id="__codelineno-0-3560" name="__codelineno-0-3560"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-3561"><a id="__codelineno-0-3561" name="__codelineno-0-3561"></a>
</span><span id="__span-0-3562"><a id="__codelineno-0-3562" name="__codelineno-0-3562"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3563"><a id="__codelineno-0-3563" name="__codelineno-0-3563"></a>
</span><span id="__span-0-3564"><a id="__codelineno-0-3564" name="__codelineno-0-3564"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_sensitivity_label</span><span class="p">(</span>
</span><span id="__span-0-3565"><a id="__codelineno-0-3565" name="__codelineno-0-3565"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3566"><a id="__codelineno-0-3566" name="__codelineno-0-3566"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3567"><a id="__codelineno-0-3567" name="__codelineno-0-3567"></a>        <span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3568"><a id="__codelineno-0-3568" name="__codelineno-0-3568"></a>        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3569"><a id="__codelineno-0-3569" name="__codelineno-0-3569"></a>        <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
</span><span id="__span-0-3570"><a id="__codelineno-0-3570" name="__codelineno-0-3570"></a>        <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-3571"><a id="__codelineno-0-3571" name="__codelineno-0-3571"></a>        <span class="n">admin_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3572"><a id="__codelineno-0-3572" name="__codelineno-0-3572"></a>        <span class="n">user_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3573"><a id="__codelineno-0-3573" name="__codelineno-0-3573"></a>        <span class="n">enable_encryption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3574"><a id="__codelineno-0-3574" name="__codelineno-0-3574"></a>        <span class="n">enable_marking</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3575"><a id="__codelineno-0-3575" name="__codelineno-0-3575"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3576"><a id="__codelineno-0-3576" name="__codelineno-0-3576"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new sensitivity label in M365.</span>
</span><span id="__span-0-3577"><a id="__codelineno-0-3577" name="__codelineno-0-3577"></a>
</span><span id="__span-0-3578"><a id="__codelineno-0-3578" name="__codelineno-0-3578"></a><span class="sd">        TODO: THIS IS CURRENTLY NOT WORKING!</span>
</span><span id="__span-0-3579"><a id="__codelineno-0-3579" name="__codelineno-0-3579"></a>
</span><span id="__span-0-3580"><a id="__codelineno-0-3580" name="__codelineno-0-3580"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3581"><a id="__codelineno-0-3581" name="__codelineno-0-3581"></a><span class="sd">            name (str):</span>
</span><span id="__span-0-3582"><a id="__codelineno-0-3582" name="__codelineno-0-3582"></a><span class="sd">                The name of the label.</span>
</span><span id="__span-0-3583"><a id="__codelineno-0-3583" name="__codelineno-0-3583"></a><span class="sd">            display_name (str):</span>
</span><span id="__span-0-3584"><a id="__codelineno-0-3584" name="__codelineno-0-3584"></a><span class="sd">                The display name of the label.</span>
</span><span id="__span-0-3585"><a id="__codelineno-0-3585" name="__codelineno-0-3585"></a><span class="sd">            description (str, optional):</span>
</span><span id="__span-0-3586"><a id="__codelineno-0-3586" name="__codelineno-0-3586"></a><span class="sd">                Description of the label. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-3587"><a id="__codelineno-0-3587" name="__codelineno-0-3587"></a><span class="sd">            color (str, optional):</span>
</span><span id="__span-0-3588"><a id="__codelineno-0-3588" name="__codelineno-0-3588"></a><span class="sd">                Color of the label. Defaults to &quot;red&quot;.</span>
</span><span id="__span-0-3589"><a id="__codelineno-0-3589" name="__codelineno-0-3589"></a><span class="sd">            enabled (bool, optional):</span>
</span><span id="__span-0-3590"><a id="__codelineno-0-3590" name="__codelineno-0-3590"></a><span class="sd">                Whether this label is enabled. Defaults to True.</span>
</span><span id="__span-0-3591"><a id="__codelineno-0-3591" name="__codelineno-0-3591"></a><span class="sd">            admin_description (str, optional):</span>
</span><span id="__span-0-3592"><a id="__codelineno-0-3592" name="__codelineno-0-3592"></a><span class="sd">                Description for administrators. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-3593"><a id="__codelineno-0-3593" name="__codelineno-0-3593"></a><span class="sd">            user_description (str, optional):</span>
</span><span id="__span-0-3594"><a id="__codelineno-0-3594" name="__codelineno-0-3594"></a><span class="sd">                Description for users. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-3595"><a id="__codelineno-0-3595" name="__codelineno-0-3595"></a><span class="sd">            enable_encryption (bool, optional):</span>
</span><span id="__span-0-3596"><a id="__codelineno-0-3596" name="__codelineno-0-3596"></a><span class="sd">                Enable encryption. Defaults to False.</span>
</span><span id="__span-0-3597"><a id="__codelineno-0-3597" name="__codelineno-0-3597"></a><span class="sd">            enable_marking (bool, optional):</span>
</span><span id="__span-0-3598"><a id="__codelineno-0-3598" name="__codelineno-0-3598"></a><span class="sd">                Enable marking. Defaults to False.</span>
</span><span id="__span-0-3599"><a id="__codelineno-0-3599" name="__codelineno-0-3599"></a>
</span><span id="__span-0-3600"><a id="__codelineno-0-3600" name="__codelineno-0-3600"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3601"><a id="__codelineno-0-3601" name="__codelineno-0-3601"></a><span class="sd">            Request reponse or None if the request fails.</span>
</span><span id="__span-0-3602"><a id="__codelineno-0-3602" name="__codelineno-0-3602"></a>
</span><span id="__span-0-3603"><a id="__codelineno-0-3603" name="__codelineno-0-3603"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3604"><a id="__codelineno-0-3604" name="__codelineno-0-3604"></a>
</span><span id="__span-0-3605"><a id="__codelineno-0-3605" name="__codelineno-0-3605"></a>        <span class="c1"># Prepare the request body</span>
</span><span id="__span-0-3606"><a id="__codelineno-0-3606" name="__codelineno-0-3606"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3607"><a id="__codelineno-0-3607" name="__codelineno-0-3607"></a>            <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">display_name</span><span class="p">,</span>
</span><span id="__span-0-3608"><a id="__codelineno-0-3608" name="__codelineno-0-3608"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
</span><span id="__span-0-3609"><a id="__codelineno-0-3609" name="__codelineno-0-3609"></a>            <span class="s2">&quot;isEnabled&quot;</span><span class="p">:</span> <span class="n">enabled</span><span class="p">,</span>
</span><span id="__span-0-3610"><a id="__codelineno-0-3610" name="__codelineno-0-3610"></a>            <span class="s2">&quot;labelColor&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
</span><span id="__span-0-3611"><a id="__codelineno-0-3611" name="__codelineno-0-3611"></a>            <span class="s2">&quot;adminDescription&quot;</span><span class="p">:</span> <span class="n">admin_description</span><span class="p">,</span>
</span><span id="__span-0-3612"><a id="__codelineno-0-3612" name="__codelineno-0-3612"></a>            <span class="s2">&quot;userDescription&quot;</span><span class="p">:</span> <span class="n">user_description</span><span class="p">,</span>
</span><span id="__span-0-3613"><a id="__codelineno-0-3613" name="__codelineno-0-3613"></a>            <span class="s2">&quot;encryptContent&quot;</span><span class="p">:</span> <span class="n">enable_encryption</span><span class="p">,</span>
</span><span id="__span-0-3614"><a id="__codelineno-0-3614" name="__codelineno-0-3614"></a>            <span class="s2">&quot;contentMarking&quot;</span><span class="p">:</span> <span class="n">enable_marking</span><span class="p">,</span>
</span><span id="__span-0-3615"><a id="__codelineno-0-3615" name="__codelineno-0-3615"></a>        <span class="p">}</span>
</span><span id="__span-0-3616"><a id="__codelineno-0-3616" name="__codelineno-0-3616"></a>
</span><span id="__span-0-3617"><a id="__codelineno-0-3617" name="__codelineno-0-3617"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;securityUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/sensitivityLabels&quot;</span>
</span><span id="__span-0-3618"><a id="__codelineno-0-3618" name="__codelineno-0-3618"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3619"><a id="__codelineno-0-3619" name="__codelineno-0-3619"></a>
</span><span id="__span-0-3620"><a id="__codelineno-0-3620" name="__codelineno-0-3620"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3621"><a id="__codelineno-0-3621" name="__codelineno-0-3621"></a>            <span class="s2">&quot;Create M365 sensitivity label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3622"><a id="__codelineno-0-3622" name="__codelineno-0-3622"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-3623"><a id="__codelineno-0-3623" name="__codelineno-0-3623"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3624"><a id="__codelineno-0-3624" name="__codelineno-0-3624"></a>        <span class="p">)</span>
</span><span id="__span-0-3625"><a id="__codelineno-0-3625" name="__codelineno-0-3625"></a>
</span><span id="__span-0-3626"><a id="__codelineno-0-3626" name="__codelineno-0-3626"></a>        <span class="c1"># Send the POST request to create the label</span>
</span><span id="__span-0-3627"><a id="__codelineno-0-3627" name="__codelineno-0-3627"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-3628"><a id="__codelineno-0-3628" name="__codelineno-0-3628"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3629"><a id="__codelineno-0-3629" name="__codelineno-0-3629"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3630"><a id="__codelineno-0-3630" name="__codelineno-0-3630"></a>            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span>
</span><span id="__span-0-3631"><a id="__codelineno-0-3631" name="__codelineno-0-3631"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3632"><a id="__codelineno-0-3632" name="__codelineno-0-3632"></a>        <span class="p">)</span>
</span><span id="__span-0-3633"><a id="__codelineno-0-3633" name="__codelineno-0-3633"></a>
</span><span id="__span-0-3634"><a id="__codelineno-0-3634" name="__codelineno-0-3634"></a>        <span class="c1"># Check the response status code</span>
</span><span id="__span-0-3635"><a id="__codelineno-0-3635" name="__codelineno-0-3635"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
</span><span id="__span-0-3636"><a id="__codelineno-0-3636" name="__codelineno-0-3636"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has been created successfully!&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-3637"><a id="__codelineno-0-3637" name="__codelineno-0-3637"></a>            <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-3638"><a id="__codelineno-0-3638" name="__codelineno-0-3638"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3639"><a id="__codelineno-0-3639" name="__codelineno-0-3639"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3640"><a id="__codelineno-0-3640" name="__codelineno-0-3640"></a>                <span class="s2">&quot;Failed to create the M365 label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;! Response status code -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3641"><a id="__codelineno-0-3641" name="__codelineno-0-3641"></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-3642"><a id="__codelineno-0-3642" name="__codelineno-0-3642"></a>                <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-3643"><a id="__codelineno-0-3643" name="__codelineno-0-3643"></a>            <span class="p">)</span>
</span><span id="__span-0-3644"><a id="__codelineno-0-3644" name="__codelineno-0-3644"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3645"><a id="__codelineno-0-3645" name="__codelineno-0-3645"></a>
</span><span id="__span-0-3646"><a id="__codelineno-0-3646" name="__codelineno-0-3646"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3647"><a id="__codelineno-0-3647" name="__codelineno-0-3647"></a>
</span><span id="__span-0-3648"><a id="__codelineno-0-3648" name="__codelineno-0-3648"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assign_sensitivity_label_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3649"><a id="__codelineno-0-3649" name="__codelineno-0-3649"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign a existing sensitivity label to a user.</span>
</span><span id="__span-0-3650"><a id="__codelineno-0-3650" name="__codelineno-0-3650"></a>
</span><span id="__span-0-3651"><a id="__codelineno-0-3651" name="__codelineno-0-3651"></a><span class="sd">        TODO: THIS IS CURRENTLY NOT WORKING!</span>
</span><span id="__span-0-3652"><a id="__codelineno-0-3652" name="__codelineno-0-3652"></a>
</span><span id="__span-0-3653"><a id="__codelineno-0-3653" name="__codelineno-0-3653"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3654"><a id="__codelineno-0-3654" name="__codelineno-0-3654"></a><span class="sd">            user_email (str):</span>
</span><span id="__span-0-3655"><a id="__codelineno-0-3655" name="__codelineno-0-3655"></a><span class="sd">                The email address of the user (as unique identifier).</span>
</span><span id="__span-0-3656"><a id="__codelineno-0-3656" name="__codelineno-0-3656"></a><span class="sd">            label_name (str):</span>
</span><span id="__span-0-3657"><a id="__codelineno-0-3657" name="__codelineno-0-3657"></a><span class="sd">                The name of the label (need to exist).</span>
</span><span id="__span-0-3658"><a id="__codelineno-0-3658" name="__codelineno-0-3658"></a>
</span><span id="__span-0-3659"><a id="__codelineno-0-3659" name="__codelineno-0-3659"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3660"><a id="__codelineno-0-3660" name="__codelineno-0-3660"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-3661"><a id="__codelineno-0-3661" name="__codelineno-0-3661"></a><span class="sd">                Return the request response or None if the request fails.</span>
</span><span id="__span-0-3662"><a id="__codelineno-0-3662" name="__codelineno-0-3662"></a>
</span><span id="__span-0-3663"><a id="__codelineno-0-3663" name="__codelineno-0-3663"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3664"><a id="__codelineno-0-3664" name="__codelineno-0-3664"></a>
</span><span id="__span-0-3665"><a id="__codelineno-0-3665" name="__codelineno-0-3665"></a>        <span class="c1"># Set up the request body with the label name</span>
</span><span id="__span-0-3666"><a id="__codelineno-0-3666" name="__codelineno-0-3666"></a>        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;labelName&quot;</span><span class="p">:</span> <span class="n">label_name</span><span class="p">}</span>
</span><span id="__span-0-3667"><a id="__codelineno-0-3667" name="__codelineno-0-3667"></a>
</span><span id="__span-0-3668"><a id="__codelineno-0-3668" name="__codelineno-0-3668"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_email</span> <span class="o">+</span> <span class="s2">&quot;/assignSensitivityLabels&quot;</span>
</span><span id="__span-0-3669"><a id="__codelineno-0-3669" name="__codelineno-0-3669"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3670"><a id="__codelineno-0-3670" name="__codelineno-0-3670"></a>
</span><span id="__span-0-3671"><a id="__codelineno-0-3671" name="__codelineno-0-3671"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3672"><a id="__codelineno-0-3672" name="__codelineno-0-3672"></a>            <span class="s2">&quot;Assign label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; to user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3673"><a id="__codelineno-0-3673" name="__codelineno-0-3673"></a>            <span class="n">label_name</span><span class="p">,</span>
</span><span id="__span-0-3674"><a id="__codelineno-0-3674" name="__codelineno-0-3674"></a>            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-3675"><a id="__codelineno-0-3675" name="__codelineno-0-3675"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3676"><a id="__codelineno-0-3676" name="__codelineno-0-3676"></a>        <span class="p">)</span>
</span><span id="__span-0-3677"><a id="__codelineno-0-3677" name="__codelineno-0-3677"></a>
</span><span id="__span-0-3678"><a id="__codelineno-0-3678" name="__codelineno-0-3678"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3679"><a id="__codelineno-0-3679" name="__codelineno-0-3679"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3680"><a id="__codelineno-0-3680" name="__codelineno-0-3680"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3681"><a id="__codelineno-0-3681" name="__codelineno-0-3681"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3682"><a id="__codelineno-0-3682" name="__codelineno-0-3682"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
</span><span id="__span-0-3683"><a id="__codelineno-0-3683" name="__codelineno-0-3683"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3684"><a id="__codelineno-0-3684" name="__codelineno-0-3684"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign label -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; to M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3685"><a id="__codelineno-0-3685" name="__codelineno-0-3685"></a>                <span class="n">label_name</span><span class="p">,</span>
</span><span id="__span-0-3686"><a id="__codelineno-0-3686" name="__codelineno-0-3686"></a>                <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-3687"><a id="__codelineno-0-3687" name="__codelineno-0-3687"></a>            <span class="p">),</span>
</span><span id="__span-0-3688"><a id="__codelineno-0-3688" name="__codelineno-0-3688"></a>        <span class="p">)</span>
</span><span id="__span-0-3689"><a id="__codelineno-0-3689" name="__codelineno-0-3689"></a>
</span><span id="__span-0-3690"><a id="__codelineno-0-3690" name="__codelineno-0-3690"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3691"><a id="__codelineno-0-3691" name="__codelineno-0-3691"></a>
</span><span id="__span-0-3692"><a id="__codelineno-0-3692" name="__codelineno-0-3692"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">upload_outlook_app</span><span class="p">(</span>
</span><span id="__span-0-3693"><a id="__codelineno-0-3693" name="__codelineno-0-3693"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3694"><a id="__codelineno-0-3694" name="__codelineno-0-3694"></a>        <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3695"><a id="__codelineno-0-3695" name="__codelineno-0-3695"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3696"><a id="__codelineno-0-3696" name="__codelineno-0-3696"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload the M365 Outlook Add-In as &quot;Integrated&quot; App to M365 Admin Center.</span>
</span><span id="__span-0-3697"><a id="__codelineno-0-3697" name="__codelineno-0-3697"></a>
</span><span id="__span-0-3698"><a id="__codelineno-0-3698" name="__codelineno-0-3698"></a><span class="sd">        TODO: THIS IS CURRENTLY NOT IMPLEMENTED DUE TO MISSING MS GRAPH API SUPPORT!</span>
</span><span id="__span-0-3699"><a id="__codelineno-0-3699" name="__codelineno-0-3699"></a>
</span><span id="__span-0-3700"><a id="__codelineno-0-3700" name="__codelineno-0-3700"></a><span class="sd">        https://admin.microsoft.com/#/Settings/IntegratedApps</span>
</span><span id="__span-0-3701"><a id="__codelineno-0-3701" name="__codelineno-0-3701"></a>
</span><span id="__span-0-3702"><a id="__codelineno-0-3702" name="__codelineno-0-3702"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3703"><a id="__codelineno-0-3703" name="__codelineno-0-3703"></a><span class="sd">            app_path (str):</span>
</span><span id="__span-0-3704"><a id="__codelineno-0-3704" name="__codelineno-0-3704"></a><span class="sd">                Path to manifest file in local file system. Needs to be</span>
</span><span id="__span-0-3705"><a id="__codelineno-0-3705" name="__codelineno-0-3705"></a><span class="sd">                downloaded before.</span>
</span><span id="__span-0-3706"><a id="__codelineno-0-3706" name="__codelineno-0-3706"></a>
</span><span id="__span-0-3707"><a id="__codelineno-0-3707" name="__codelineno-0-3707"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3708"><a id="__codelineno-0-3708" name="__codelineno-0-3708"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-3709"><a id="__codelineno-0-3709" name="__codelineno-0-3709"></a><span class="sd">                Response of the MS Graph API or None if the request fails.</span>
</span><span id="__span-0-3710"><a id="__codelineno-0-3710" name="__codelineno-0-3710"></a>
</span><span id="__span-0-3711"><a id="__codelineno-0-3711" name="__codelineno-0-3711"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3712"><a id="__codelineno-0-3712" name="__codelineno-0-3712"></a>
</span><span id="__span-0-3713"><a id="__codelineno-0-3713" name="__codelineno-0-3713"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3714"><a id="__codelineno-0-3714" name="__codelineno-0-3714"></a>            <span class="s2">&quot;Install Outlook Add-in from -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (NOT IMPLEMENTED)&quot;</span><span class="p">,</span>
</span><span id="__span-0-3715"><a id="__codelineno-0-3715" name="__codelineno-0-3715"></a>            <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-3716"><a id="__codelineno-0-3716" name="__codelineno-0-3716"></a>        <span class="p">)</span>
</span><span id="__span-0-3717"><a id="__codelineno-0-3717" name="__codelineno-0-3717"></a>
</span><span id="__span-0-3718"><a id="__codelineno-0-3718" name="__codelineno-0-3718"></a>        <span class="n">response</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-3719"><a id="__codelineno-0-3719" name="__codelineno-0-3719"></a>
</span><span id="__span-0-3720"><a id="__codelineno-0-3720" name="__codelineno-0-3720"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-3721"><a id="__codelineno-0-3721" name="__codelineno-0-3721"></a>
</span><span id="__span-0-3722"><a id="__codelineno-0-3722" name="__codelineno-0-3722"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3723"><a id="__codelineno-0-3723" name="__codelineno-0-3723"></a>
</span><span id="__span-0-3724"><a id="__codelineno-0-3724" name="__codelineno-0-3724"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_registration</span><span class="p">(</span>
</span><span id="__span-0-3725"><a id="__codelineno-0-3725" name="__codelineno-0-3725"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3726"><a id="__codelineno-0-3726" name="__codelineno-0-3726"></a>        <span class="n">app_registration_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3727"><a id="__codelineno-0-3727" name="__codelineno-0-3727"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3728"><a id="__codelineno-0-3728" name="__codelineno-0-3728"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find an Azure App Registration based on its name.</span>
</span><span id="__span-0-3729"><a id="__codelineno-0-3729" name="__codelineno-0-3729"></a>
</span><span id="__span-0-3730"><a id="__codelineno-0-3730" name="__codelineno-0-3730"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3731"><a id="__codelineno-0-3731" name="__codelineno-0-3731"></a><span class="sd">            app_registration_name (str):</span>
</span><span id="__span-0-3732"><a id="__codelineno-0-3732" name="__codelineno-0-3732"></a><span class="sd">                Name of the App Registration.</span>
</span><span id="__span-0-3733"><a id="__codelineno-0-3733" name="__codelineno-0-3733"></a>
</span><span id="__span-0-3734"><a id="__codelineno-0-3734" name="__codelineno-0-3734"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3735"><a id="__codelineno-0-3735" name="__codelineno-0-3735"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-3736"><a id="__codelineno-0-3736" name="__codelineno-0-3736"></a><span class="sd">                App Registration data or None of the request fails.</span>
</span><span id="__span-0-3737"><a id="__codelineno-0-3737" name="__codelineno-0-3737"></a>
</span><span id="__span-0-3738"><a id="__codelineno-0-3738" name="__codelineno-0-3738"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3739"><a id="__codelineno-0-3739" name="__codelineno-0-3739"></a>
</span><span id="__span-0-3740"><a id="__codelineno-0-3740" name="__codelineno-0-3740"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?$filter=displayName eq &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_registration_name</span><span class="p">)</span>
</span><span id="__span-0-3741"><a id="__codelineno-0-3741" name="__codelineno-0-3741"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3742"><a id="__codelineno-0-3742" name="__codelineno-0-3742"></a>
</span><span id="__span-0-3743"><a id="__codelineno-0-3743" name="__codelineno-0-3743"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3744"><a id="__codelineno-0-3744" name="__codelineno-0-3744"></a>            <span class="s2">&quot;Get Azure App Registration -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3745"><a id="__codelineno-0-3745" name="__codelineno-0-3745"></a>            <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3746"><a id="__codelineno-0-3746" name="__codelineno-0-3746"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3747"><a id="__codelineno-0-3747" name="__codelineno-0-3747"></a>        <span class="p">)</span>
</span><span id="__span-0-3748"><a id="__codelineno-0-3748" name="__codelineno-0-3748"></a>
</span><span id="__span-0-3749"><a id="__codelineno-0-3749" name="__codelineno-0-3749"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3750"><a id="__codelineno-0-3750" name="__codelineno-0-3750"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3751"><a id="__codelineno-0-3751" name="__codelineno-0-3751"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-3752"><a id="__codelineno-0-3752" name="__codelineno-0-3752"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3753"><a id="__codelineno-0-3753" name="__codelineno-0-3753"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3754"><a id="__codelineno-0-3754" name="__codelineno-0-3754"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot find Azure App Registration -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3755"><a id="__codelineno-0-3755" name="__codelineno-0-3755"></a>                <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3756"><a id="__codelineno-0-3756" name="__codelineno-0-3756"></a>            <span class="p">),</span>
</span><span id="__span-0-3757"><a id="__codelineno-0-3757" name="__codelineno-0-3757"></a>        <span class="p">)</span>
</span><span id="__span-0-3758"><a id="__codelineno-0-3758" name="__codelineno-0-3758"></a>
</span><span id="__span-0-3759"><a id="__codelineno-0-3759" name="__codelineno-0-3759"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3760"><a id="__codelineno-0-3760" name="__codelineno-0-3760"></a>
</span><span id="__span-0-3761"><a id="__codelineno-0-3761" name="__codelineno-0-3761"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_app_registration</span><span class="p">(</span>
</span><span id="__span-0-3762"><a id="__codelineno-0-3762" name="__codelineno-0-3762"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3763"><a id="__codelineno-0-3763" name="__codelineno-0-3763"></a>        <span class="n">app_registration_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3764"><a id="__codelineno-0-3764" name="__codelineno-0-3764"></a>        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3765"><a id="__codelineno-0-3765" name="__codelineno-0-3765"></a>        <span class="n">api_permissions</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3766"><a id="__codelineno-0-3766" name="__codelineno-0-3766"></a>        <span class="n">supported_account_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AzureADMyOrg&quot;</span><span class="p">,</span>
</span><span id="__span-0-3767"><a id="__codelineno-0-3767" name="__codelineno-0-3767"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-3768"><a id="__codelineno-0-3768" name="__codelineno-0-3768"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an Azure App Registration.</span>
</span><span id="__span-0-3769"><a id="__codelineno-0-3769" name="__codelineno-0-3769"></a>
</span><span id="__span-0-3770"><a id="__codelineno-0-3770" name="__codelineno-0-3770"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3771"><a id="__codelineno-0-3771" name="__codelineno-0-3771"></a><span class="sd">            app_registration_name (str):</span>
</span><span id="__span-0-3772"><a id="__codelineno-0-3772" name="__codelineno-0-3772"></a><span class="sd">                The name of the App Registration.</span>
</span><span id="__span-0-3773"><a id="__codelineno-0-3773" name="__codelineno-0-3773"></a><span class="sd">            description (str, optional):</span>
</span><span id="__span-0-3774"><a id="__codelineno-0-3774" name="__codelineno-0-3774"></a><span class="sd">                The description of the app.</span>
</span><span id="__span-0-3775"><a id="__codelineno-0-3775" name="__codelineno-0-3775"></a><span class="sd">            api_permissions (list | None, optional):</span>
</span><span id="__span-0-3776"><a id="__codelineno-0-3776" name="__codelineno-0-3776"></a><span class="sd">                The API permissions.</span>
</span><span id="__span-0-3777"><a id="__codelineno-0-3777" name="__codelineno-0-3777"></a><span class="sd">            supported_account_type (str, optional):</span>
</span><span id="__span-0-3778"><a id="__codelineno-0-3778" name="__codelineno-0-3778"></a><span class="sd">                The type of account that is supposed to use</span>
</span><span id="__span-0-3779"><a id="__codelineno-0-3779" name="__codelineno-0-3779"></a><span class="sd">                the App Registration.</span>
</span><span id="__span-0-3780"><a id="__codelineno-0-3780" name="__codelineno-0-3780"></a>
</span><span id="__span-0-3781"><a id="__codelineno-0-3781" name="__codelineno-0-3781"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3782"><a id="__codelineno-0-3782" name="__codelineno-0-3782"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3783"><a id="__codelineno-0-3783" name="__codelineno-0-3783"></a><span class="sd">                App Registration data or None of the request fails.</span>
</span><span id="__span-0-3784"><a id="__codelineno-0-3784" name="__codelineno-0-3784"></a>
</span><span id="__span-0-3785"><a id="__codelineno-0-3785" name="__codelineno-0-3785"></a><span class="sd">            Example data:</span>
</span><span id="__span-0-3786"><a id="__codelineno-0-3786" name="__codelineno-0-3786"></a><span class="sd">            {</span>
</span><span id="__span-0-3787"><a id="__codelineno-0-3787" name="__codelineno-0-3787"></a><span class="sd">                &#39;id&#39;: &#39;d70bee91-3689-4239-a626-30756968e99c&#39;,</span>
</span><span id="__span-0-3788"><a id="__codelineno-0-3788" name="__codelineno-0-3788"></a><span class="sd">                &#39;deletedDateTime&#39;: None,</span>
</span><span id="__span-0-3789"><a id="__codelineno-0-3789" name="__codelineno-0-3789"></a><span class="sd">                &#39;appId&#39;: &#39;d288ba5f-9313-4b38-b4a4-d7edcce089b0&#39;,</span>
</span><span id="__span-0-3790"><a id="__codelineno-0-3790" name="__codelineno-0-3790"></a><span class="sd">                &#39;applicationTemplateId&#39;: None,</span>
</span><span id="__span-0-3791"><a id="__codelineno-0-3791" name="__codelineno-0-3791"></a><span class="sd">                &#39;disabledByMicrosoftStatus&#39;: None,</span>
</span><span id="__span-0-3792"><a id="__codelineno-0-3792" name="__codelineno-0-3792"></a><span class="sd">                &#39;createdDateTime&#39;: &#39;2023-09-06T21:06:05Z&#39;,</span>
</span><span id="__span-0-3793"><a id="__codelineno-0-3793" name="__codelineno-0-3793"></a><span class="sd">                &#39;displayName&#39;: &#39;Test 1&#39;,</span>
</span><span id="__span-0-3794"><a id="__codelineno-0-3794" name="__codelineno-0-3794"></a><span class="sd">                &#39;description&#39;: None,</span>
</span><span id="__span-0-3795"><a id="__codelineno-0-3795" name="__codelineno-0-3795"></a><span class="sd">                &#39;groupMembershipClaims&#39;: None,</span>
</span><span id="__span-0-3796"><a id="__codelineno-0-3796" name="__codelineno-0-3796"></a><span class="sd">                &#39;identifierUris&#39;: [],</span>
</span><span id="__span-0-3797"><a id="__codelineno-0-3797" name="__codelineno-0-3797"></a><span class="sd">                &#39;isDeviceOnlyAuthSupported&#39;: None,</span>
</span><span id="__span-0-3798"><a id="__codelineno-0-3798" name="__codelineno-0-3798"></a><span class="sd">                &#39;isFallbackPublicClient&#39;: None,</span>
</span><span id="__span-0-3799"><a id="__codelineno-0-3799" name="__codelineno-0-3799"></a><span class="sd">                &#39;notes&#39;: None,</span>
</span><span id="__span-0-3800"><a id="__codelineno-0-3800" name="__codelineno-0-3800"></a><span class="sd">                &#39;publisherDomain&#39;: &#39;M365x41497014.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-3801"><a id="__codelineno-0-3801" name="__codelineno-0-3801"></a><span class="sd">                &#39;signInAudience&#39;: &#39;AzureADMyOrg&#39;,</span>
</span><span id="__span-0-3802"><a id="__codelineno-0-3802" name="__codelineno-0-3802"></a><span class="sd">                ...</span>
</span><span id="__span-0-3803"><a id="__codelineno-0-3803" name="__codelineno-0-3803"></a><span class="sd">                &#39;requiredResourceAccess&#39;: [</span>
</span><span id="__span-0-3804"><a id="__codelineno-0-3804" name="__codelineno-0-3804"></a><span class="sd">                    {</span>
</span><span id="__span-0-3805"><a id="__codelineno-0-3805" name="__codelineno-0-3805"></a><span class="sd">                        &#39;resourceAppId&#39;: &#39;00000003-0000-0ff1-ce00-000000000000&#39;,</span>
</span><span id="__span-0-3806"><a id="__codelineno-0-3806" name="__codelineno-0-3806"></a><span class="sd">                        &#39;resourceAccess&#39;: [</span>
</span><span id="__span-0-3807"><a id="__codelineno-0-3807" name="__codelineno-0-3807"></a><span class="sd">                            {</span>
</span><span id="__span-0-3808"><a id="__codelineno-0-3808" name="__codelineno-0-3808"></a><span class="sd">                                &#39;id&#39;: &#39;741f803b-c850-494e-b5df-cde7c675a1ca&#39;,</span>
</span><span id="__span-0-3809"><a id="__codelineno-0-3809" name="__codelineno-0-3809"></a><span class="sd">                                &#39;type&#39;: &#39;Role&#39;</span>
</span><span id="__span-0-3810"><a id="__codelineno-0-3810" name="__codelineno-0-3810"></a><span class="sd">                            },</span>
</span><span id="__span-0-3811"><a id="__codelineno-0-3811" name="__codelineno-0-3811"></a><span class="sd">                            {</span>
</span><span id="__span-0-3812"><a id="__codelineno-0-3812" name="__codelineno-0-3812"></a><span class="sd">                                &#39;id&#39;: &#39;c8e3537c-ec53-43b9-bed3-b2bd3617ae97&#39;,</span>
</span><span id="__span-0-3813"><a id="__codelineno-0-3813" name="__codelineno-0-3813"></a><span class="sd">                                &#39;type&#39;: &#39;Role&#39;</span>
</span><span id="__span-0-3814"><a id="__codelineno-0-3814" name="__codelineno-0-3814"></a><span class="sd">                            },</span>
</span><span id="__span-0-3815"><a id="__codelineno-0-3815" name="__codelineno-0-3815"></a><span class="sd">                        ]</span>
</span><span id="__span-0-3816"><a id="__codelineno-0-3816" name="__codelineno-0-3816"></a><span class="sd">                    },</span>
</span><span id="__span-0-3817"><a id="__codelineno-0-3817" name="__codelineno-0-3817"></a><span class="sd">                ]</span>
</span><span id="__span-0-3818"><a id="__codelineno-0-3818" name="__codelineno-0-3818"></a><span class="sd">            }</span>
</span><span id="__span-0-3819"><a id="__codelineno-0-3819" name="__codelineno-0-3819"></a>
</span><span id="__span-0-3820"><a id="__codelineno-0-3820" name="__codelineno-0-3820"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3821"><a id="__codelineno-0-3821" name="__codelineno-0-3821"></a>
</span><span id="__span-0-3822"><a id="__codelineno-0-3822" name="__codelineno-0-3822"></a>        <span class="c1"># Define the request body to create the App Registration</span>
</span><span id="__span-0-3823"><a id="__codelineno-0-3823" name="__codelineno-0-3823"></a>        <span class="n">app_registration_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3824"><a id="__codelineno-0-3824" name="__codelineno-0-3824"></a>            <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3825"><a id="__codelineno-0-3825" name="__codelineno-0-3825"></a>            <span class="s2">&quot;signInAudience&quot;</span><span class="p">:</span> <span class="n">supported_account_type</span><span class="p">,</span>
</span><span id="__span-0-3826"><a id="__codelineno-0-3826" name="__codelineno-0-3826"></a>        <span class="p">}</span>
</span><span id="__span-0-3827"><a id="__codelineno-0-3827" name="__codelineno-0-3827"></a>        <span class="k">if</span> <span class="n">api_permissions</span><span class="p">:</span>
</span><span id="__span-0-3828"><a id="__codelineno-0-3828" name="__codelineno-0-3828"></a>            <span class="n">app_registration_data</span><span class="p">[</span><span class="s2">&quot;requiredResourceAccess&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_permissions</span>
</span><span id="__span-0-3829"><a id="__codelineno-0-3829" name="__codelineno-0-3829"></a>        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
</span><span id="__span-0-3830"><a id="__codelineno-0-3830" name="__codelineno-0-3830"></a>            <span class="n">app_registration_data</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
</span><span id="__span-0-3831"><a id="__codelineno-0-3831" name="__codelineno-0-3831"></a>
</span><span id="__span-0-3832"><a id="__codelineno-0-3832" name="__codelineno-0-3832"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-3833"><a id="__codelineno-0-3833" name="__codelineno-0-3833"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3834"><a id="__codelineno-0-3834" name="__codelineno-0-3834"></a>
</span><span id="__span-0-3835"><a id="__codelineno-0-3835" name="__codelineno-0-3835"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3836"><a id="__codelineno-0-3836" name="__codelineno-0-3836"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3837"><a id="__codelineno-0-3837" name="__codelineno-0-3837"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3838"><a id="__codelineno-0-3838" name="__codelineno-0-3838"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3839"><a id="__codelineno-0-3839" name="__codelineno-0-3839"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">app_registration_data</span><span class="p">,</span>
</span><span id="__span-0-3840"><a id="__codelineno-0-3840" name="__codelineno-0-3840"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3841"><a id="__codelineno-0-3841" name="__codelineno-0-3841"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot add App Registration -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3842"><a id="__codelineno-0-3842" name="__codelineno-0-3842"></a>                <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3843"><a id="__codelineno-0-3843" name="__codelineno-0-3843"></a>            <span class="p">),</span>
</span><span id="__span-0-3844"><a id="__codelineno-0-3844" name="__codelineno-0-3844"></a>        <span class="p">)</span>
</span><span id="__span-0-3845"><a id="__codelineno-0-3845" name="__codelineno-0-3845"></a>
</span><span id="__span-0-3846"><a id="__codelineno-0-3846" name="__codelineno-0-3846"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3847"><a id="__codelineno-0-3847" name="__codelineno-0-3847"></a>
</span><span id="__span-0-3848"><a id="__codelineno-0-3848" name="__codelineno-0-3848"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_app_registration</span><span class="p">(</span>
</span><span id="__span-0-3849"><a id="__codelineno-0-3849" name="__codelineno-0-3849"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3850"><a id="__codelineno-0-3850" name="__codelineno-0-3850"></a>        <span class="n">app_registration_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3851"><a id="__codelineno-0-3851" name="__codelineno-0-3851"></a>        <span class="n">app_registration_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3852"><a id="__codelineno-0-3852" name="__codelineno-0-3852"></a>        <span class="n">api_permissions</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="__span-0-3853"><a id="__codelineno-0-3853" name="__codelineno-0-3853"></a>        <span class="n">supported_account_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AzureADMyOrg&quot;</span><span class="p">,</span>
</span><span id="__span-0-3854"><a id="__codelineno-0-3854" name="__codelineno-0-3854"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-3855"><a id="__codelineno-0-3855" name="__codelineno-0-3855"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update an Azure App Registration.</span>
</span><span id="__span-0-3856"><a id="__codelineno-0-3856" name="__codelineno-0-3856"></a>
</span><span id="__span-0-3857"><a id="__codelineno-0-3857" name="__codelineno-0-3857"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3858"><a id="__codelineno-0-3858" name="__codelineno-0-3858"></a><span class="sd">            app_registration_id (str):</span>
</span><span id="__span-0-3859"><a id="__codelineno-0-3859" name="__codelineno-0-3859"></a><span class="sd">                The ID of the existing App Registration.</span>
</span><span id="__span-0-3860"><a id="__codelineno-0-3860" name="__codelineno-0-3860"></a><span class="sd">            app_registration_name (str):</span>
</span><span id="__span-0-3861"><a id="__codelineno-0-3861" name="__codelineno-0-3861"></a><span class="sd">                The name of the App Registration.</span>
</span><span id="__span-0-3862"><a id="__codelineno-0-3862" name="__codelineno-0-3862"></a><span class="sd">            api_permissions (list):</span>
</span><span id="__span-0-3863"><a id="__codelineno-0-3863" name="__codelineno-0-3863"></a><span class="sd">                The API permissions.</span>
</span><span id="__span-0-3864"><a id="__codelineno-0-3864" name="__codelineno-0-3864"></a><span class="sd">            supported_account_type (str, optional):</span>
</span><span id="__span-0-3865"><a id="__codelineno-0-3865" name="__codelineno-0-3865"></a><span class="sd">                The type of account that is supposed to use</span>
</span><span id="__span-0-3866"><a id="__codelineno-0-3866" name="__codelineno-0-3866"></a><span class="sd">                the App Registration.</span>
</span><span id="__span-0-3867"><a id="__codelineno-0-3867" name="__codelineno-0-3867"></a>
</span><span id="__span-0-3868"><a id="__codelineno-0-3868" name="__codelineno-0-3868"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3869"><a id="__codelineno-0-3869" name="__codelineno-0-3869"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3870"><a id="__codelineno-0-3870" name="__codelineno-0-3870"></a><span class="sd">                App Registration data or None of the request fails.</span>
</span><span id="__span-0-3871"><a id="__codelineno-0-3871" name="__codelineno-0-3871"></a>
</span><span id="__span-0-3872"><a id="__codelineno-0-3872" name="__codelineno-0-3872"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3873"><a id="__codelineno-0-3873" name="__codelineno-0-3873"></a>
</span><span id="__span-0-3874"><a id="__codelineno-0-3874" name="__codelineno-0-3874"></a>        <span class="c1"># Define the request body to create the App Registration</span>
</span><span id="__span-0-3875"><a id="__codelineno-0-3875" name="__codelineno-0-3875"></a>        <span class="n">app_registration_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3876"><a id="__codelineno-0-3876" name="__codelineno-0-3876"></a>            <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3877"><a id="__codelineno-0-3877" name="__codelineno-0-3877"></a>            <span class="s2">&quot;requiredResourceAccess&quot;</span><span class="p">:</span> <span class="n">api_permissions</span><span class="p">,</span>
</span><span id="__span-0-3878"><a id="__codelineno-0-3878" name="__codelineno-0-3878"></a>            <span class="s2">&quot;signInAudience&quot;</span><span class="p">:</span> <span class="n">supported_account_type</span><span class="p">,</span>
</span><span id="__span-0-3879"><a id="__codelineno-0-3879" name="__codelineno-0-3879"></a>        <span class="p">}</span>
</span><span id="__span-0-3880"><a id="__codelineno-0-3880" name="__codelineno-0-3880"></a>
</span><span id="__span-0-3881"><a id="__codelineno-0-3881" name="__codelineno-0-3881"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_registration_id</span>
</span><span id="__span-0-3882"><a id="__codelineno-0-3882" name="__codelineno-0-3882"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3883"><a id="__codelineno-0-3883" name="__codelineno-0-3883"></a>
</span><span id="__span-0-3884"><a id="__codelineno-0-3884" name="__codelineno-0-3884"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3885"><a id="__codelineno-0-3885" name="__codelineno-0-3885"></a>            <span class="s2">&quot;Update App Registration -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3886"><a id="__codelineno-0-3886" name="__codelineno-0-3886"></a>            <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3887"><a id="__codelineno-0-3887" name="__codelineno-0-3887"></a>            <span class="n">app_registration_id</span><span class="p">,</span>
</span><span id="__span-0-3888"><a id="__codelineno-0-3888" name="__codelineno-0-3888"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3889"><a id="__codelineno-0-3889" name="__codelineno-0-3889"></a>        <span class="p">)</span>
</span><span id="__span-0-3890"><a id="__codelineno-0-3890" name="__codelineno-0-3890"></a>
</span><span id="__span-0-3891"><a id="__codelineno-0-3891" name="__codelineno-0-3891"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3892"><a id="__codelineno-0-3892" name="__codelineno-0-3892"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3893"><a id="__codelineno-0-3893" name="__codelineno-0-3893"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-3894"><a id="__codelineno-0-3894" name="__codelineno-0-3894"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3895"><a id="__codelineno-0-3895" name="__codelineno-0-3895"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">app_registration_data</span><span class="p">,</span>
</span><span id="__span-0-3896"><a id="__codelineno-0-3896" name="__codelineno-0-3896"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3897"><a id="__codelineno-0-3897" name="__codelineno-0-3897"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot update App Registration -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3898"><a id="__codelineno-0-3898" name="__codelineno-0-3898"></a>                <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3899"><a id="__codelineno-0-3899" name="__codelineno-0-3899"></a>                <span class="n">app_registration_id</span><span class="p">,</span>
</span><span id="__span-0-3900"><a id="__codelineno-0-3900" name="__codelineno-0-3900"></a>            <span class="p">),</span>
</span><span id="__span-0-3901"><a id="__codelineno-0-3901" name="__codelineno-0-3901"></a>        <span class="p">)</span>
</span><span id="__span-0-3902"><a id="__codelineno-0-3902" name="__codelineno-0-3902"></a>
</span><span id="__span-0-3903"><a id="__codelineno-0-3903" name="__codelineno-0-3903"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3904"><a id="__codelineno-0-3904" name="__codelineno-0-3904"></a>
</span><span id="__span-0-3905"><a id="__codelineno-0-3905" name="__codelineno-0-3905"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_mail</span><span class="p">(</span>
</span><span id="__span-0-3906"><a id="__codelineno-0-3906" name="__codelineno-0-3906"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3907"><a id="__codelineno-0-3907" name="__codelineno-0-3907"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3908"><a id="__codelineno-0-3908" name="__codelineno-0-3908"></a>        <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3909"><a id="__codelineno-0-3909" name="__codelineno-0-3909"></a>        <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3910"><a id="__codelineno-0-3910" name="__codelineno-0-3910"></a>        <span class="n">num_emails</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3911"><a id="__codelineno-0-3911" name="__codelineno-0-3911"></a>        <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3912"><a id="__codelineno-0-3912" name="__codelineno-0-3912"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3913"><a id="__codelineno-0-3913" name="__codelineno-0-3913"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get email from inbox of a given user and a given sender (from).</span>
</span><span id="__span-0-3914"><a id="__codelineno-0-3914" name="__codelineno-0-3914"></a>
</span><span id="__span-0-3915"><a id="__codelineno-0-3915" name="__codelineno-0-3915"></a><span class="sd">        This requires Mail.Read Application permissions for the Azure App being used.</span>
</span><span id="__span-0-3916"><a id="__codelineno-0-3916" name="__codelineno-0-3916"></a>
</span><span id="__span-0-3917"><a id="__codelineno-0-3917" name="__codelineno-0-3917"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3918"><a id="__codelineno-0-3918" name="__codelineno-0-3918"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-3919"><a id="__codelineno-0-3919" name="__codelineno-0-3919"></a><span class="sd">                The M365 ID of the user.</span>
</span><span id="__span-0-3920"><a id="__codelineno-0-3920" name="__codelineno-0-3920"></a><span class="sd">            sender (str):</span>
</span><span id="__span-0-3921"><a id="__codelineno-0-3921" name="__codelineno-0-3921"></a><span class="sd">                The sender email address to filter for.</span>
</span><span id="__span-0-3922"><a id="__codelineno-0-3922" name="__codelineno-0-3922"></a><span class="sd">            subject (str):</span>
</span><span id="__span-0-3923"><a id="__codelineno-0-3923" name="__codelineno-0-3923"></a><span class="sd">                The subject to filter for.</span>
</span><span id="__span-0-3924"><a id="__codelineno-0-3924" name="__codelineno-0-3924"></a><span class="sd">            num_emails (int, optional):</span>
</span><span id="__span-0-3925"><a id="__codelineno-0-3925" name="__codelineno-0-3925"></a><span class="sd">                The number of matching emails to retrieve.</span>
</span><span id="__span-0-3926"><a id="__codelineno-0-3926" name="__codelineno-0-3926"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-3927"><a id="__codelineno-0-3927" name="__codelineno-0-3927"></a><span class="sd">                Whether or not an error should be displayed if the</span>
</span><span id="__span-0-3928"><a id="__codelineno-0-3928" name="__codelineno-0-3928"></a><span class="sd">                user is not found.</span>
</span><span id="__span-0-3929"><a id="__codelineno-0-3929" name="__codelineno-0-3929"></a>
</span><span id="__span-0-3930"><a id="__codelineno-0-3930" name="__codelineno-0-3930"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3931"><a id="__codelineno-0-3931" name="__codelineno-0-3931"></a><span class="sd">            dict:</span>
</span><span id="__span-0-3932"><a id="__codelineno-0-3932" name="__codelineno-0-3932"></a><span class="sd">                Email or None of the request fails.</span>
</span><span id="__span-0-3933"><a id="__codelineno-0-3933" name="__codelineno-0-3933"></a>
</span><span id="__span-0-3934"><a id="__codelineno-0-3934" name="__codelineno-0-3934"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-3935"><a id="__codelineno-0-3935" name="__codelineno-0-3935"></a>
</span><span id="__span-0-3936"><a id="__codelineno-0-3936" name="__codelineno-0-3936"></a>        <span class="c1"># Attention: you  can easily run in limitation of the MS Graph API. If selection + filtering</span>
</span><span id="__span-0-3937"><a id="__codelineno-0-3937" name="__codelineno-0-3937"></a>        <span class="c1"># is too complex you can get this error: &quot;The restriction or sort order is too complex for this operation.&quot;</span>
</span><span id="__span-0-3938"><a id="__codelineno-0-3938" name="__codelineno-0-3938"></a>        <span class="c1"># that&#39;s why we first just do the ordering and then do the filtering on sender and subject</span>
</span><span id="__span-0-3939"><a id="__codelineno-0-3939" name="__codelineno-0-3939"></a>        <span class="c1"># separately</span>
</span><span id="__span-0-3940"><a id="__codelineno-0-3940" name="__codelineno-0-3940"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3941"><a id="__codelineno-0-3941" name="__codelineno-0-3941"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-3942"><a id="__codelineno-0-3942" name="__codelineno-0-3942"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-3943"><a id="__codelineno-0-3943" name="__codelineno-0-3943"></a>            <span class="o">+</span> <span class="n">user_id</span>
</span><span id="__span-0-3944"><a id="__codelineno-0-3944" name="__codelineno-0-3944"></a>            <span class="c1">#            + &quot;/messages?$filter=from/emailAddress/address eq &#39;{}&#39; and contains(subject, &#39;{}&#39;)&amp;$orderby=receivedDateTime desc&quot;.format(</span>
</span><span id="__span-0-3945"><a id="__codelineno-0-3945" name="__codelineno-0-3945"></a>            <span class="o">+</span> <span class="s2">&quot;/messages?$orderby=receivedDateTime desc&quot;</span>
</span><span id="__span-0-3946"><a id="__codelineno-0-3946" name="__codelineno-0-3946"></a>        <span class="p">)</span>
</span><span id="__span-0-3947"><a id="__codelineno-0-3947" name="__codelineno-0-3947"></a>        <span class="k">if</span> <span class="n">num_emails</span><span class="p">:</span>
</span><span id="__span-0-3948"><a id="__codelineno-0-3948" name="__codelineno-0-3948"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;&amp;$top=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_emails</span><span class="p">)</span>
</span><span id="__span-0-3949"><a id="__codelineno-0-3949" name="__codelineno-0-3949"></a>
</span><span id="__span-0-3950"><a id="__codelineno-0-3950" name="__codelineno-0-3950"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3951"><a id="__codelineno-0-3951" name="__codelineno-0-3951"></a>
</span><span id="__span-0-3952"><a id="__codelineno-0-3952" name="__codelineno-0-3952"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3953"><a id="__codelineno-0-3953" name="__codelineno-0-3953"></a>            <span class="s2">&quot;Get mails for user -&gt; </span><span class="si">%s</span><span class="s2"> from -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; with subject -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3954"><a id="__codelineno-0-3954" name="__codelineno-0-3954"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3955"><a id="__codelineno-0-3955" name="__codelineno-0-3955"></a>            <span class="n">sender</span><span class="p">,</span>
</span><span id="__span-0-3956"><a id="__codelineno-0-3956" name="__codelineno-0-3956"></a>            <span class="n">subject</span><span class="p">,</span>
</span><span id="__span-0-3957"><a id="__codelineno-0-3957" name="__codelineno-0-3957"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3958"><a id="__codelineno-0-3958" name="__codelineno-0-3958"></a>        <span class="p">)</span>
</span><span id="__span-0-3959"><a id="__codelineno-0-3959" name="__codelineno-0-3959"></a>
</span><span id="__span-0-3960"><a id="__codelineno-0-3960" name="__codelineno-0-3960"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3961"><a id="__codelineno-0-3961" name="__codelineno-0-3961"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3962"><a id="__codelineno-0-3962" name="__codelineno-0-3962"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-3963"><a id="__codelineno-0-3963" name="__codelineno-0-3963"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3964"><a id="__codelineno-0-3964" name="__codelineno-0-3964"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3965"><a id="__codelineno-0-3965" name="__codelineno-0-3965"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot retrieve emails for M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-3966"><a id="__codelineno-0-3966" name="__codelineno-0-3966"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-3967"><a id="__codelineno-0-3967" name="__codelineno-0-3967"></a>        <span class="p">)</span>
</span><span id="__span-0-3968"><a id="__codelineno-0-3968" name="__codelineno-0-3968"></a>
</span><span id="__span-0-3969"><a id="__codelineno-0-3969" name="__codelineno-0-3969"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="s2">&quot;value&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-3970"><a id="__codelineno-0-3970" name="__codelineno-0-3970"></a>            <span class="n">messages</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-3971"><a id="__codelineno-0-3971" name="__codelineno-0-3971"></a>
</span><span id="__span-0-3972"><a id="__codelineno-0-3972" name="__codelineno-0-3972"></a>            <span class="c1"># Filter the messages by sender and subject in code</span>
</span><span id="__span-0-3973"><a id="__codelineno-0-3973" name="__codelineno-0-3973"></a>            <span class="n">filtered_messages</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-3974"><a id="__codelineno-0-3974" name="__codelineno-0-3974"></a>                <span class="n">msg</span>
</span><span id="__span-0-3975"><a id="__codelineno-0-3975" name="__codelineno-0-3975"></a>                <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span>
</span><span id="__span-0-3976"><a id="__codelineno-0-3976" name="__codelineno-0-3976"></a>                <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;emailAddress&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">sender</span>
</span><span id="__span-0-3977"><a id="__codelineno-0-3977" name="__codelineno-0-3977"></a>                <span class="ow">and</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-3978"><a id="__codelineno-0-3978" name="__codelineno-0-3978"></a>            <span class="p">]</span>
</span><span id="__span-0-3979"><a id="__codelineno-0-3979" name="__codelineno-0-3979"></a>            <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_messages</span>
</span><span id="__span-0-3980"><a id="__codelineno-0-3980" name="__codelineno-0-3980"></a>            <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-3981"><a id="__codelineno-0-3981" name="__codelineno-0-3981"></a>
</span><span id="__span-0-3982"><a id="__codelineno-0-3982" name="__codelineno-0-3982"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3983"><a id="__codelineno-0-3983" name="__codelineno-0-3983"></a>
</span><span id="__span-0-3984"><a id="__codelineno-0-3984" name="__codelineno-0-3984"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-3985"><a id="__codelineno-0-3985" name="__codelineno-0-3985"></a>
</span><span id="__span-0-3986"><a id="__codelineno-0-3986" name="__codelineno-0-3986"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_mail_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3987"><a id="__codelineno-0-3987" name="__codelineno-0-3987"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get full email body for a given email ID.</span>
</span><span id="__span-0-3988"><a id="__codelineno-0-3988" name="__codelineno-0-3988"></a>
</span><span id="__span-0-3989"><a id="__codelineno-0-3989" name="__codelineno-0-3989"></a><span class="sd">        This requires Mail.Read Application permissions for the Azure App being used.</span>
</span><span id="__span-0-3990"><a id="__codelineno-0-3990" name="__codelineno-0-3990"></a>
</span><span id="__span-0-3991"><a id="__codelineno-0-3991" name="__codelineno-0-3991"></a><span class="sd">        Args:</span>
</span><span id="__span-0-3992"><a id="__codelineno-0-3992" name="__codelineno-0-3992"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-3993"><a id="__codelineno-0-3993" name="__codelineno-0-3993"></a><span class="sd">                The M365 ID of the user.</span>
</span><span id="__span-0-3994"><a id="__codelineno-0-3994" name="__codelineno-0-3994"></a><span class="sd">            email_id (str):</span>
</span><span id="__span-0-3995"><a id="__codelineno-0-3995" name="__codelineno-0-3995"></a><span class="sd">                The M365 ID of the email.</span>
</span><span id="__span-0-3996"><a id="__codelineno-0-3996" name="__codelineno-0-3996"></a>
</span><span id="__span-0-3997"><a id="__codelineno-0-3997" name="__codelineno-0-3997"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-3998"><a id="__codelineno-0-3998" name="__codelineno-0-3998"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-3999"><a id="__codelineno-0-3999" name="__codelineno-0-3999"></a><span class="sd">                Email body or None of the request fails.</span>
</span><span id="__span-0-4000"><a id="__codelineno-0-4000" name="__codelineno-0-4000"></a>
</span><span id="__span-0-4001"><a id="__codelineno-0-4001" name="__codelineno-0-4001"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4002"><a id="__codelineno-0-4002" name="__codelineno-0-4002"></a>
</span><span id="__span-0-4003"><a id="__codelineno-0-4003" name="__codelineno-0-4003"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/messages/&quot;</span> <span class="o">+</span> <span class="n">email_id</span> <span class="o">+</span> <span class="s2">&quot;/$value&quot;</span>
</span><span id="__span-0-4004"><a id="__codelineno-0-4004" name="__codelineno-0-4004"></a>
</span><span id="__span-0-4005"><a id="__codelineno-0-4005" name="__codelineno-0-4005"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4006"><a id="__codelineno-0-4006" name="__codelineno-0-4006"></a>
</span><span id="__span-0-4007"><a id="__codelineno-0-4007" name="__codelineno-0-4007"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4008"><a id="__codelineno-0-4008" name="__codelineno-0-4008"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4009"><a id="__codelineno-0-4009" name="__codelineno-0-4009"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4010"><a id="__codelineno-0-4010" name="__codelineno-0-4010"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4011"><a id="__codelineno-0-4011" name="__codelineno-0-4011"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4012"><a id="__codelineno-0-4012" name="__codelineno-0-4012"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get email body for M365 user -&gt; </span><span class="si">{}</span><span class="s2"> and email with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4013"><a id="__codelineno-0-4013" name="__codelineno-0-4013"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-4014"><a id="__codelineno-0-4014" name="__codelineno-0-4014"></a>                <span class="n">email_id</span><span class="p">,</span>
</span><span id="__span-0-4015"><a id="__codelineno-0-4015" name="__codelineno-0-4015"></a>            <span class="p">),</span>
</span><span id="__span-0-4016"><a id="__codelineno-0-4016" name="__codelineno-0-4016"></a>            <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4017"><a id="__codelineno-0-4017" name="__codelineno-0-4017"></a>        <span class="p">)</span>
</span><span id="__span-0-4018"><a id="__codelineno-0-4018" name="__codelineno-0-4018"></a>
</span><span id="__span-0-4019"><a id="__codelineno-0-4019" name="__codelineno-0-4019"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span><span id="__span-0-4020"><a id="__codelineno-0-4020" name="__codelineno-0-4020"></a>            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="__span-0-4021"><a id="__codelineno-0-4021" name="__codelineno-0-4021"></a>
</span><span id="__span-0-4022"><a id="__codelineno-0-4022" name="__codelineno-0-4022"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-4023"><a id="__codelineno-0-4023" name="__codelineno-0-4023"></a>
</span><span id="__span-0-4024"><a id="__codelineno-0-4024" name="__codelineno-0-4024"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4025"><a id="__codelineno-0-4025" name="__codelineno-0-4025"></a>
</span><span id="__span-0-4026"><a id="__codelineno-0-4026" name="__codelineno-0-4026"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_url_from_message_body</span><span class="p">(</span>
</span><span id="__span-0-4027"><a id="__codelineno-0-4027" name="__codelineno-0-4027"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4028"><a id="__codelineno-0-4028" name="__codelineno-0-4028"></a>        <span class="n">message_body</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4029"><a id="__codelineno-0-4029" name="__codelineno-0-4029"></a>        <span class="n">search_pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4030"><a id="__codelineno-0-4030" name="__codelineno-0-4030"></a>        <span class="n">multi_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4031"><a id="__codelineno-0-4031" name="__codelineno-0-4031"></a>        <span class="n">multi_line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;%3D&quot;</span><span class="p">,</span>
</span><span id="__span-0-4032"><a id="__codelineno-0-4032" name="__codelineno-0-4032"></a>        <span class="n">line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span>
</span><span id="__span-0-4033"><a id="__codelineno-0-4033" name="__codelineno-0-4033"></a>        <span class="n">replacements</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4034"><a id="__codelineno-0-4034" name="__codelineno-0-4034"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4035"><a id="__codelineno-0-4035" name="__codelineno-0-4035"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the email body to extract (a potentially multi-line) URL from the body.</span>
</span><span id="__span-0-4036"><a id="__codelineno-0-4036" name="__codelineno-0-4036"></a>
</span><span id="__span-0-4037"><a id="__codelineno-0-4037" name="__codelineno-0-4037"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4038"><a id="__codelineno-0-4038" name="__codelineno-0-4038"></a><span class="sd">            message_body (str):</span>
</span><span id="__span-0-4039"><a id="__codelineno-0-4039" name="__codelineno-0-4039"></a><span class="sd">                Text of the Email body.</span>
</span><span id="__span-0-4040"><a id="__codelineno-0-4040" name="__codelineno-0-4040"></a><span class="sd">            search_pattern (str):</span>
</span><span id="__span-0-4041"><a id="__codelineno-0-4041" name="__codelineno-0-4041"></a><span class="sd">                Pattern that needs to be in first line of the URL. This</span>
</span><span id="__span-0-4042"><a id="__codelineno-0-4042" name="__codelineno-0-4042"></a><span class="sd">                makes sure it is the right URL we are looking for.</span>
</span><span id="__span-0-4043"><a id="__codelineno-0-4043" name="__codelineno-0-4043"></a><span class="sd">            multi_line (bool, optional):</span>
</span><span id="__span-0-4044"><a id="__codelineno-0-4044" name="__codelineno-0-4044"></a><span class="sd">                Is the URL spread over multiple lines?. Defaults to False.</span>
</span><span id="__span-0-4045"><a id="__codelineno-0-4045" name="__codelineno-0-4045"></a><span class="sd">            multi_line_end_marker (str, optional):</span>
</span><span id="__span-0-4046"><a id="__codelineno-0-4046" name="__codelineno-0-4046"></a><span class="sd">                If it is a multi-line URL, what marks the end</span>
</span><span id="__span-0-4047"><a id="__codelineno-0-4047" name="__codelineno-0-4047"></a><span class="sd">                of the URL in the last line? Defaults to &quot;%3D&quot;.</span>
</span><span id="__span-0-4048"><a id="__codelineno-0-4048" name="__codelineno-0-4048"></a><span class="sd">            line_end_marker (str, optional):</span>
</span><span id="__span-0-4049"><a id="__codelineno-0-4049" name="__codelineno-0-4049"></a><span class="sd">                What marks the end of lines 1-(n-1)? Defaults to &quot;=&quot;.</span>
</span><span id="__span-0-4050"><a id="__codelineno-0-4050" name="__codelineno-0-4050"></a><span class="sd">            replacements (list, optional):</span>
</span><span id="__span-0-4051"><a id="__codelineno-0-4051" name="__codelineno-0-4051"></a><span class="sd">                A list of replacements.</span>
</span><span id="__span-0-4052"><a id="__codelineno-0-4052" name="__codelineno-0-4052"></a>
</span><span id="__span-0-4053"><a id="__codelineno-0-4053" name="__codelineno-0-4053"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4054"><a id="__codelineno-0-4054" name="__codelineno-0-4054"></a><span class="sd">            str | None:</span>
</span><span id="__span-0-4055"><a id="__codelineno-0-4055" name="__codelineno-0-4055"></a><span class="sd">                The URL text that has been extracted. None in case of an error.</span>
</span><span id="__span-0-4056"><a id="__codelineno-0-4056" name="__codelineno-0-4056"></a>
</span><span id="__span-0-4057"><a id="__codelineno-0-4057" name="__codelineno-0-4057"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4058"><a id="__codelineno-0-4058" name="__codelineno-0-4058"></a>
</span><span id="__span-0-4059"><a id="__codelineno-0-4059" name="__codelineno-0-4059"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">message_body</span><span class="p">:</span>
</span><span id="__span-0-4060"><a id="__codelineno-0-4060" name="__codelineno-0-4060"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-4061"><a id="__codelineno-0-4061" name="__codelineno-0-4061"></a>
</span><span id="__span-0-4062"><a id="__codelineno-0-4062" name="__codelineno-0-4062"></a>        <span class="c1"># Split all the lines after a CRLF:</span>
</span><span id="__span-0-4063"><a id="__codelineno-0-4063" name="__codelineno-0-4063"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">message_body</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-0-4064"><a id="__codelineno-0-4064" name="__codelineno-0-4064"></a>
</span><span id="__span-0-4065"><a id="__codelineno-0-4065" name="__codelineno-0-4065"></a>        <span class="c1"># Filter out the complete URL from the extracted URLs</span>
</span><span id="__span-0-4066"><a id="__codelineno-0-4066" name="__codelineno-0-4066"></a>        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4067"><a id="__codelineno-0-4067" name="__codelineno-0-4067"></a>
</span><span id="__span-0-4068"><a id="__codelineno-0-4068" name="__codelineno-0-4068"></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-4069"><a id="__codelineno-0-4069" name="__codelineno-0-4069"></a>
</span><span id="__span-0-4070"><a id="__codelineno-0-4070" name="__codelineno-0-4070"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="__span-0-4071"><a id="__codelineno-0-4071" name="__codelineno-0-4071"></a>            <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
</span><span id="__span-0-4072"><a id="__codelineno-0-4072" name="__codelineno-0-4072"></a>                <span class="c1"># Remove line end marker - many times a &quot;=&quot;</span>
</span><span id="__span-0-4073"><a id="__codelineno-0-4073" name="__codelineno-0-4073"></a>                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">line_end_marker</span><span class="p">):</span>
</span><span id="__span-0-4074"><a id="__codelineno-0-4074" name="__codelineno-0-4074"></a>                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-4075"><a id="__codelineno-0-4075" name="__codelineno-0-4075"></a>                <span class="k">for</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
</span><span id="__span-0-4076"><a id="__codelineno-0-4076" name="__codelineno-0-4076"></a>                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">],</span> <span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">])</span>
</span><span id="__span-0-4077"><a id="__codelineno-0-4077" name="__codelineno-0-4077"></a>                <span class="c1"># We consider an empty line after we found the URL to indicate the end of the URL:</span>
</span><span id="__span-0-4078"><a id="__codelineno-0-4078" name="__codelineno-0-4078"></a>                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="__span-0-4079"><a id="__codelineno-0-4079" name="__codelineno-0-4079"></a>                    <span class="k">break</span>
</span><span id="__span-0-4080"><a id="__codelineno-0-4080" name="__codelineno-0-4080"></a>                <span class="n">url</span> <span class="o">+=</span> <span class="n">line</span>
</span><span id="__span-0-4081"><a id="__codelineno-0-4081" name="__codelineno-0-4081"></a>            <span class="k">if</span> <span class="n">multi_line</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">multi_line_end_marker</span><span class="p">):</span>
</span><span id="__span-0-4082"><a id="__codelineno-0-4082" name="__codelineno-0-4082"></a>                <span class="k">break</span>
</span><span id="__span-0-4083"><a id="__codelineno-0-4083" name="__codelineno-0-4083"></a>            <span class="k">if</span> <span class="n">search_pattern</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="__span-0-4084"><a id="__codelineno-0-4084" name="__codelineno-0-4084"></a>                <span class="k">continue</span>
</span><span id="__span-0-4085"><a id="__codelineno-0-4085" name="__codelineno-0-4085"></a>            <span class="c1"># Fine https:// in the current line:</span>
</span><span id="__span-0-4086"><a id="__codelineno-0-4086" name="__codelineno-0-4086"></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">)</span>
</span><span id="__span-0-4087"><a id="__codelineno-0-4087" name="__codelineno-0-4087"></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-4088"><a id="__codelineno-0-4088" name="__codelineno-0-4088"></a>                <span class="k">continue</span>
</span><span id="__span-0-4089"><a id="__codelineno-0-4089" name="__codelineno-0-4089"></a>            <span class="c1"># If there&#39;s any text in front of https in that line cut it:</span>
</span><span id="__span-0-4090"><a id="__codelineno-0-4090" name="__codelineno-0-4090"></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">index</span><span class="p">:]</span>
</span><span id="__span-0-4091"><a id="__codelineno-0-4091" name="__codelineno-0-4091"></a>            <span class="c1"># Remove line end marker - many times a &quot;=&quot;</span>
</span><span id="__span-0-4092"><a id="__codelineno-0-4092" name="__codelineno-0-4092"></a>            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">line_end_marker</span><span class="p">):</span>
</span><span id="__span-0-4093"><a id="__codelineno-0-4093" name="__codelineno-0-4093"></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-4094"><a id="__codelineno-0-4094" name="__codelineno-0-4094"></a>            <span class="k">for</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
</span><span id="__span-0-4095"><a id="__codelineno-0-4095" name="__codelineno-0-4095"></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">],</span> <span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">])</span>
</span><span id="__span-0-4096"><a id="__codelineno-0-4096" name="__codelineno-0-4096"></a>            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-4097"><a id="__codelineno-0-4097" name="__codelineno-0-4097"></a>            <span class="n">url</span> <span class="o">+=</span> <span class="n">line</span>
</span><span id="__span-0-4098"><a id="__codelineno-0-4098" name="__codelineno-0-4098"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">multi_line</span><span class="p">:</span>
</span><span id="__span-0-4099"><a id="__codelineno-0-4099" name="__codelineno-0-4099"></a>                <span class="k">break</span>
</span><span id="__span-0-4100"><a id="__codelineno-0-4100" name="__codelineno-0-4100"></a>
</span><span id="__span-0-4101"><a id="__codelineno-0-4101" name="__codelineno-0-4101"></a>        <span class="k">return</span> <span class="n">url</span>
</span><span id="__span-0-4102"><a id="__codelineno-0-4102" name="__codelineno-0-4102"></a>
</span><span id="__span-0-4103"><a id="__codelineno-0-4103" name="__codelineno-0-4103"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4104"><a id="__codelineno-0-4104" name="__codelineno-0-4104"></a>
</span><span id="__span-0-4105"><a id="__codelineno-0-4105" name="__codelineno-0-4105"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_mail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4106"><a id="__codelineno-0-4106" name="__codelineno-0-4106"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete email from inbox of a given user and a given email ID.</span>
</span><span id="__span-0-4107"><a id="__codelineno-0-4107" name="__codelineno-0-4107"></a>
</span><span id="__span-0-4108"><a id="__codelineno-0-4108" name="__codelineno-0-4108"></a><span class="sd">        This requires Mail.ReadWrite Application permissions for the Azure App being used.</span>
</span><span id="__span-0-4109"><a id="__codelineno-0-4109" name="__codelineno-0-4109"></a>
</span><span id="__span-0-4110"><a id="__codelineno-0-4110" name="__codelineno-0-4110"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4111"><a id="__codelineno-0-4111" name="__codelineno-0-4111"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-4112"><a id="__codelineno-0-4112" name="__codelineno-0-4112"></a><span class="sd">                The M365 ID of the user.</span>
</span><span id="__span-0-4113"><a id="__codelineno-0-4113" name="__codelineno-0-4113"></a><span class="sd">            email_id (str):</span>
</span><span id="__span-0-4114"><a id="__codelineno-0-4114" name="__codelineno-0-4114"></a><span class="sd">                The M365 ID of the email.</span>
</span><span id="__span-0-4115"><a id="__codelineno-0-4115" name="__codelineno-0-4115"></a>
</span><span id="__span-0-4116"><a id="__codelineno-0-4116" name="__codelineno-0-4116"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4117"><a id="__codelineno-0-4117" name="__codelineno-0-4117"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-4118"><a id="__codelineno-0-4118" name="__codelineno-0-4118"></a><span class="sd">                Email or None of the request fails.</span>
</span><span id="__span-0-4119"><a id="__codelineno-0-4119" name="__codelineno-0-4119"></a>
</span><span id="__span-0-4120"><a id="__codelineno-0-4120" name="__codelineno-0-4120"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4121"><a id="__codelineno-0-4121" name="__codelineno-0-4121"></a>
</span><span id="__span-0-4122"><a id="__codelineno-0-4122" name="__codelineno-0-4122"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/messages/&quot;</span> <span class="o">+</span> <span class="n">email_id</span>
</span><span id="__span-0-4123"><a id="__codelineno-0-4123" name="__codelineno-0-4123"></a>
</span><span id="__span-0-4124"><a id="__codelineno-0-4124" name="__codelineno-0-4124"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4125"><a id="__codelineno-0-4125" name="__codelineno-0-4125"></a>
</span><span id="__span-0-4126"><a id="__codelineno-0-4126" name="__codelineno-0-4126"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4127"><a id="__codelineno-0-4127" name="__codelineno-0-4127"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4128"><a id="__codelineno-0-4128" name="__codelineno-0-4128"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-4129"><a id="__codelineno-0-4129" name="__codelineno-0-4129"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4130"><a id="__codelineno-0-4130" name="__codelineno-0-4130"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4131"><a id="__codelineno-0-4131" name="__codelineno-0-4131"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot delete email with ID -&gt; </span><span class="si">{}</span><span class="s2"> from inbox of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4132"><a id="__codelineno-0-4132" name="__codelineno-0-4132"></a>                <span class="n">email_id</span><span class="p">,</span>
</span><span id="__span-0-4133"><a id="__codelineno-0-4133" name="__codelineno-0-4133"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-4134"><a id="__codelineno-0-4134" name="__codelineno-0-4134"></a>            <span class="p">),</span>
</span><span id="__span-0-4135"><a id="__codelineno-0-4135" name="__codelineno-0-4135"></a>        <span class="p">)</span>
</span><span id="__span-0-4136"><a id="__codelineno-0-4136" name="__codelineno-0-4136"></a>
</span><span id="__span-0-4137"><a id="__codelineno-0-4137" name="__codelineno-0-4137"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4138"><a id="__codelineno-0-4138" name="__codelineno-0-4138"></a>
</span><span id="__span-0-4139"><a id="__codelineno-0-4139" name="__codelineno-0-4139"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">email_verification</span><span class="p">(</span>
</span><span id="__span-0-4140"><a id="__codelineno-0-4140" name="__codelineno-0-4140"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4141"><a id="__codelineno-0-4141" name="__codelineno-0-4141"></a>        <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4142"><a id="__codelineno-0-4142" name="__codelineno-0-4142"></a>        <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4143"><a id="__codelineno-0-4143" name="__codelineno-0-4143"></a>        <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4144"><a id="__codelineno-0-4144" name="__codelineno-0-4144"></a>        <span class="n">url_search_pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4145"><a id="__codelineno-0-4145" name="__codelineno-0-4145"></a>        <span class="n">line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span>
</span><span id="__span-0-4146"><a id="__codelineno-0-4146" name="__codelineno-0-4146"></a>        <span class="n">multi_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4147"><a id="__codelineno-0-4147" name="__codelineno-0-4147"></a>        <span class="n">multi_line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;%3D&quot;</span><span class="p">,</span>
</span><span id="__span-0-4148"><a id="__codelineno-0-4148" name="__codelineno-0-4148"></a>        <span class="n">replacements</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4149"><a id="__codelineno-0-4149" name="__codelineno-0-4149"></a>        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
</span><span id="__span-0-4150"><a id="__codelineno-0-4150" name="__codelineno-0-4150"></a>        <span class="n">use_browser_automation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4151"><a id="__codelineno-0-4151" name="__codelineno-0-4151"></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4152"><a id="__codelineno-0-4152" name="__codelineno-0-4152"></a>        <span class="n">password_field_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4153"><a id="__codelineno-0-4153" name="__codelineno-0-4153"></a>        <span class="n">password_confirmation_field_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4154"><a id="__codelineno-0-4154" name="__codelineno-0-4154"></a>        <span class="n">password_submit_xpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4155"><a id="__codelineno-0-4155" name="__codelineno-0-4155"></a>        <span class="n">terms_of_service_xpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4156"><a id="__codelineno-0-4156" name="__codelineno-0-4156"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-4157"><a id="__codelineno-0-4157" name="__codelineno-0-4157"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process email verification.</span>
</span><span id="__span-0-4158"><a id="__codelineno-0-4158" name="__codelineno-0-4158"></a>
</span><span id="__span-0-4159"><a id="__codelineno-0-4159" name="__codelineno-0-4159"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4160"><a id="__codelineno-0-4160" name="__codelineno-0-4160"></a><span class="sd">            user_email (str):</span>
</span><span id="__span-0-4161"><a id="__codelineno-0-4161" name="__codelineno-0-4161"></a><span class="sd">                Email address of user recieving the verification mail.</span>
</span><span id="__span-0-4162"><a id="__codelineno-0-4162" name="__codelineno-0-4162"></a><span class="sd">            sender (str):</span>
</span><span id="__span-0-4163"><a id="__codelineno-0-4163" name="__codelineno-0-4163"></a><span class="sd">                Email sender (address)</span>
</span><span id="__span-0-4164"><a id="__codelineno-0-4164" name="__codelineno-0-4164"></a><span class="sd">            subject (str):</span>
</span><span id="__span-0-4165"><a id="__codelineno-0-4165" name="__codelineno-0-4165"></a><span class="sd">                Email subject to look for (can be substring)</span>
</span><span id="__span-0-4166"><a id="__codelineno-0-4166" name="__codelineno-0-4166"></a><span class="sd">            url_search_pattern (str):</span>
</span><span id="__span-0-4167"><a id="__codelineno-0-4167" name="__codelineno-0-4167"></a><span class="sd">                String the URL needs to contain to identify it.</span>
</span><span id="__span-0-4168"><a id="__codelineno-0-4168" name="__codelineno-0-4168"></a><span class="sd">            line_end_marker (str, optional):</span>
</span><span id="__span-0-4169"><a id="__codelineno-0-4169" name="__codelineno-0-4169"></a><span class="sd">                The character that marks line ends in the mail.</span>
</span><span id="__span-0-4170"><a id="__codelineno-0-4170" name="__codelineno-0-4170"></a><span class="sd">            multi_line (bool, optional):</span>
</span><span id="__span-0-4171"><a id="__codelineno-0-4171" name="__codelineno-0-4171"></a><span class="sd">                Whether or not this is a multi-line mail.</span>
</span><span id="__span-0-4172"><a id="__codelineno-0-4172" name="__codelineno-0-4172"></a><span class="sd">            multi_line_end_marker (str, optional):</span>
</span><span id="__span-0-4173"><a id="__codelineno-0-4173" name="__codelineno-0-4173"></a><span class="sd">                If the URL spans multiple lines this is the &quot;end&quot; marker for the last line.</span>
</span><span id="__span-0-4174"><a id="__codelineno-0-4174" name="__codelineno-0-4174"></a><span class="sd">            replacements (list, optional):</span>
</span><span id="__span-0-4175"><a id="__codelineno-0-4175" name="__codelineno-0-4175"></a><span class="sd">                If the URL needs some treatment these replacements can be applied.</span>
</span><span id="__span-0-4176"><a id="__codelineno-0-4176" name="__codelineno-0-4176"></a><span class="sd">            max_retries (int, optional):</span>
</span><span id="__span-0-4177"><a id="__codelineno-0-4177" name="__codelineno-0-4177"></a><span class="sd">                The number of retries in case of an error.</span>
</span><span id="__span-0-4178"><a id="__codelineno-0-4178" name="__codelineno-0-4178"></a><span class="sd">            use_browser_automation (bool, optional):</span>
</span><span id="__span-0-4179"><a id="__codelineno-0-4179" name="__codelineno-0-4179"></a><span class="sd">                If Selenium-based browser automation should be used or not. Default = False.</span>
</span><span id="__span-0-4180"><a id="__codelineno-0-4180" name="__codelineno-0-4180"></a><span class="sd">            password (str, optional):</span>
</span><span id="__span-0-4181"><a id="__codelineno-0-4181" name="__codelineno-0-4181"></a><span class="sd">                In case a password is required for browser automation. Default = &quot;&quot;,</span>
</span><span id="__span-0-4182"><a id="__codelineno-0-4182" name="__codelineno-0-4182"></a><span class="sd">            password_field_id (str, optional):</span>
</span><span id="__span-0-4183"><a id="__codelineno-0-4183" name="__codelineno-0-4183"></a><span class="sd">                The password field name in the HTML page of a confirmation dialog. Default = &quot;&quot;,</span>
</span><span id="__span-0-4184"><a id="__codelineno-0-4184" name="__codelineno-0-4184"></a><span class="sd">            password_confirmation_field_id (str, optional):</span>
</span><span id="__span-0-4185"><a id="__codelineno-0-4185" name="__codelineno-0-4185"></a><span class="sd">                The password confirmation field name in the HTML page of a confirmation dialog.</span>
</span><span id="__span-0-4186"><a id="__codelineno-0-4186" name="__codelineno-0-4186"></a><span class="sd">                Default = &quot;&quot;.</span>
</span><span id="__span-0-4187"><a id="__codelineno-0-4187" name="__codelineno-0-4187"></a><span class="sd">            password_submit_xpath (str, optional):</span>
</span><span id="__span-0-4188"><a id="__codelineno-0-4188" name="__codelineno-0-4188"></a><span class="sd">                Default = &quot;&quot;.</span>
</span><span id="__span-0-4189"><a id="__codelineno-0-4189" name="__codelineno-0-4189"></a><span class="sd">            terms_of_service_xpath (str, optional):</span>
</span><span id="__span-0-4190"><a id="__codelineno-0-4190" name="__codelineno-0-4190"></a><span class="sd">                Default = &quot;&quot;.</span>
</span><span id="__span-0-4191"><a id="__codelineno-0-4191" name="__codelineno-0-4191"></a>
</span><span id="__span-0-4192"><a id="__codelineno-0-4192" name="__codelineno-0-4192"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4193"><a id="__codelineno-0-4193" name="__codelineno-0-4193"></a><span class="sd">            bool:</span>
</span><span id="__span-0-4194"><a id="__codelineno-0-4194" name="__codelineno-0-4194"></a><span class="sd">                True = Success, False = Failure.</span>
</span><span id="__span-0-4195"><a id="__codelineno-0-4195" name="__codelineno-0-4195"></a>
</span><span id="__span-0-4196"><a id="__codelineno-0-4196" name="__codelineno-0-4196"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4197"><a id="__codelineno-0-4197" name="__codelineno-0-4197"></a>
</span><span id="__span-0-4198"><a id="__codelineno-0-4198" name="__codelineno-0-4198"></a>        <span class="c1"># Determine the M365 user for the current user by</span>
</span><span id="__span-0-4199"><a id="__codelineno-0-4199" name="__codelineno-0-4199"></a>        <span class="c1"># the email address:</span>
</span><span id="__span-0-4200"><a id="__codelineno-0-4200" name="__codelineno-0-4200"></a>        <span class="n">m365_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_email</span><span class="o">=</span><span class="n">user_email</span><span class="p">)</span>
</span><span id="__span-0-4201"><a id="__codelineno-0-4201" name="__codelineno-0-4201"></a>        <span class="n">m365_user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">m365_user</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-4202"><a id="__codelineno-0-4202" name="__codelineno-0-4202"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">m365_user_id</span><span class="p">:</span>
</span><span id="__span-0-4203"><a id="__codelineno-0-4203" name="__codelineno-0-4203"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot find M365 user -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">user_email</span><span class="p">)</span>
</span><span id="__span-0-4204"><a id="__codelineno-0-4204" name="__codelineno-0-4204"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4205"><a id="__codelineno-0-4205" name="__codelineno-0-4205"></a>
</span><span id="__span-0-4206"><a id="__codelineno-0-4206" name="__codelineno-0-4206"></a>        <span class="k">if</span> <span class="n">replacements</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4207"><a id="__codelineno-0-4207" name="__codelineno-0-4207"></a>            <span class="n">replacements</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;=3D&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span><span class="p">}]</span>
</span><span id="__span-0-4208"><a id="__codelineno-0-4208" name="__codelineno-0-4208"></a>
</span><span id="__span-0-4209"><a id="__codelineno-0-4209" name="__codelineno-0-4209"></a>        <span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-4210"><a id="__codelineno-0-4210" name="__codelineno-0-4210"></a>        <span class="k">while</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">max_retries</span><span class="p">:</span>
</span><span id="__span-0-4211"><a id="__codelineno-0-4211" name="__codelineno-0-4211"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mail</span><span class="p">(</span>
</span><span id="__span-0-4212"><a id="__codelineno-0-4212" name="__codelineno-0-4212"></a>                <span class="n">user_id</span><span class="o">=</span><span class="n">m365_user_id</span><span class="p">,</span>
</span><span id="__span-0-4213"><a id="__codelineno-0-4213" name="__codelineno-0-4213"></a>                <span class="n">sender</span><span class="o">=</span><span class="n">sender</span><span class="p">,</span>
</span><span id="__span-0-4214"><a id="__codelineno-0-4214" name="__codelineno-0-4214"></a>                <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span>
</span><span id="__span-0-4215"><a id="__codelineno-0-4215" name="__codelineno-0-4215"></a>                <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4216"><a id="__codelineno-0-4216" name="__codelineno-0-4216"></a>            <span class="p">)</span>
</span><span id="__span-0-4217"><a id="__codelineno-0-4217" name="__codelineno-0-4217"></a>            <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]:</span>
</span><span id="__span-0-4218"><a id="__codelineno-0-4218" name="__codelineno-0-4218"></a>                <span class="n">emails</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-4219"><a id="__codelineno-0-4219" name="__codelineno-0-4219"></a>                <span class="c1"># potentially there may be multiple matching emails,</span>
</span><span id="__span-0-4220"><a id="__codelineno-0-4220" name="__codelineno-0-4220"></a>                <span class="c1"># we want the most recent one (from today):</span>
</span><span id="__span-0-4221"><a id="__codelineno-0-4221" name="__codelineno-0-4221"></a>                <span class="n">latest_email</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">emails</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;receivedDateTime&quot;</span><span class="p">])</span>
</span><span id="__span-0-4222"><a id="__codelineno-0-4222" name="__codelineno-0-4222"></a>                <span class="c1"># Extract just the date:</span>
</span><span id="__span-0-4223"><a id="__codelineno-0-4223" name="__codelineno-0-4223"></a>                <span class="n">latest_email_date</span> <span class="o">=</span> <span class="n">latest_email</span><span class="p">[</span><span class="s2">&quot;receivedDateTime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-4224"><a id="__codelineno-0-4224" name="__codelineno-0-4224"></a>                <span class="c1"># Get the current date (today):</span>
</span><span id="__span-0-4225"><a id="__codelineno-0-4225" name="__codelineno-0-4225"></a>                <span class="n">today_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-4226"><a id="__codelineno-0-4226" name="__codelineno-0-4226"></a>                <span class="c1"># We do a sanity check here: the verification mail should be from today,</span>
</span><span id="__span-0-4227"><a id="__codelineno-0-4227" name="__codelineno-0-4227"></a>                <span class="c1"># otherwise we assume it is an old mail and we need to wait for the</span>
</span><span id="__span-0-4228"><a id="__codelineno-0-4228" name="__codelineno-0-4228"></a>                <span class="c1"># new verification mail to yet arrive:</span>
</span><span id="__span-0-4229"><a id="__codelineno-0-4229" name="__codelineno-0-4229"></a>                <span class="k">if</span> <span class="n">latest_email_date</span> <span class="o">!=</span> <span class="n">today_date</span><span class="p">:</span>
</span><span id="__span-0-4230"><a id="__codelineno-0-4230" name="__codelineno-0-4230"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4231"><a id="__codelineno-0-4231" name="__codelineno-0-4231"></a>                        <span class="s2">&quot;Verification email not yet received (latest mail from -&gt; </span><span class="si">%s</span><span class="s2">). Waiting </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4232"><a id="__codelineno-0-4232" name="__codelineno-0-4232"></a>                        <span class="n">latest_email_date</span><span class="p">,</span>
</span><span id="__span-0-4233"><a id="__codelineno-0-4233" name="__codelineno-0-4233"></a>                        <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-0-4234"><a id="__codelineno-0-4234" name="__codelineno-0-4234"></a>                    <span class="p">)</span>
</span><span id="__span-0-4235"><a id="__codelineno-0-4235" name="__codelineno-0-4235"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-4236"><a id="__codelineno-0-4236" name="__codelineno-0-4236"></a>                    <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-4237"><a id="__codelineno-0-4237" name="__codelineno-0-4237"></a>                    <span class="k">continue</span>
</span><span id="__span-0-4238"><a id="__codelineno-0-4238" name="__codelineno-0-4238"></a>                <span class="n">email_id</span> <span class="o">=</span> <span class="n">latest_email</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-4239"><a id="__codelineno-0-4239" name="__codelineno-0-4239"></a>                <span class="c1"># The full email body needs to be loaded with a separate REST call:</span>
</span><span id="__span-0-4240"><a id="__codelineno-0-4240" name="__codelineno-0-4240"></a>                <span class="n">body_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mail_body</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">m365_user_id</span><span class="p">,</span> <span class="n">email_id</span><span class="o">=</span><span class="n">email_id</span><span class="p">)</span>
</span><span id="__span-0-4241"><a id="__codelineno-0-4241" name="__codelineno-0-4241"></a>                <span class="c1"># Extract the verification URL.</span>
</span><span id="__span-0-4242"><a id="__codelineno-0-4242" name="__codelineno-0-4242"></a>                <span class="k">if</span> <span class="n">body_text</span><span class="p">:</span>
</span><span id="__span-0-4243"><a id="__codelineno-0-4243" name="__codelineno-0-4243"></a>                    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_url_from_message_body</span><span class="p">(</span>
</span><span id="__span-0-4244"><a id="__codelineno-0-4244" name="__codelineno-0-4244"></a>                        <span class="n">message_body</span><span class="o">=</span><span class="n">body_text</span><span class="p">,</span>
</span><span id="__span-0-4245"><a id="__codelineno-0-4245" name="__codelineno-0-4245"></a>                        <span class="n">search_pattern</span><span class="o">=</span><span class="n">url_search_pattern</span><span class="p">,</span>
</span><span id="__span-0-4246"><a id="__codelineno-0-4246" name="__codelineno-0-4246"></a>                        <span class="n">line_end_marker</span><span class="o">=</span><span class="n">line_end_marker</span><span class="p">,</span>
</span><span id="__span-0-4247"><a id="__codelineno-0-4247" name="__codelineno-0-4247"></a>                        <span class="n">multi_line</span><span class="o">=</span><span class="n">multi_line</span><span class="p">,</span>
</span><span id="__span-0-4248"><a id="__codelineno-0-4248" name="__codelineno-0-4248"></a>                        <span class="n">multi_line_end_marker</span><span class="o">=</span><span class="n">multi_line_end_marker</span><span class="p">,</span>
</span><span id="__span-0-4249"><a id="__codelineno-0-4249" name="__codelineno-0-4249"></a>                        <span class="n">replacements</span><span class="o">=</span><span class="n">replacements</span><span class="p">,</span>
</span><span id="__span-0-4250"><a id="__codelineno-0-4250" name="__codelineno-0-4250"></a>                    <span class="p">)</span>
</span><span id="__span-0-4251"><a id="__codelineno-0-4251" name="__codelineno-0-4251"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4252"><a id="__codelineno-0-4252" name="__codelineno-0-4252"></a>                    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-4253"><a id="__codelineno-0-4253" name="__codelineno-0-4253"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
</span><span id="__span-0-4254"><a id="__codelineno-0-4254" name="__codelineno-0-4254"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-4255"><a id="__codelineno-0-4255" name="__codelineno-0-4255"></a>                        <span class="s2">&quot;Cannot find verification link in the email body!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4256"><a id="__codelineno-0-4256" name="__codelineno-0-4256"></a>                    <span class="p">)</span>
</span><span id="__span-0-4257"><a id="__codelineno-0-4257" name="__codelineno-0-4257"></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4258"><a id="__codelineno-0-4258" name="__codelineno-0-4258"></a>                <span class="c1"># Simulate a &quot;click&quot; on this URL:</span>
</span><span id="__span-0-4259"><a id="__codelineno-0-4259" name="__codelineno-0-4259"></a>                <span class="k">if</span> <span class="n">use_browser_automation</span><span class="p">:</span>
</span><span id="__span-0-4260"><a id="__codelineno-0-4260" name="__codelineno-0-4260"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using browser automation for email verification...&quot;</span><span class="p">)</span>
</span><span id="__span-0-4261"><a id="__codelineno-0-4261" name="__codelineno-0-4261"></a>                    <span class="c1"># Core Share needs a full browser:</span>
</span><span id="__span-0-4262"><a id="__codelineno-0-4262" name="__codelineno-0-4262"></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-4263"><a id="__codelineno-0-4263" name="__codelineno-0-4263"></a>                        <span class="n">browser_automation_object</span> <span class="o">=</span> <span class="n">BrowserAutomation</span><span class="p">(</span>
</span><span id="__span-0-4264"><a id="__codelineno-0-4264" name="__codelineno-0-4264"></a>                            <span class="n">take_screenshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4265"><a id="__codelineno-0-4265" name="__codelineno-0-4265"></a>                            <span class="n">automation_name</span><span class="o">=</span><span class="s2">&quot;email-verification&quot;</span><span class="p">,</span>
</span><span id="__span-0-4266"><a id="__codelineno-0-4266" name="__codelineno-0-4266"></a>                            <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">,</span>
</span><span id="__span-0-4267"><a id="__codelineno-0-4267" name="__codelineno-0-4267"></a>                        <span class="p">)</span>
</span><span id="__span-0-4268"><a id="__codelineno-0-4268" name="__codelineno-0-4268"></a>                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="__span-0-4269"><a id="__codelineno-0-4269" name="__codelineno-0-4269"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create browser automation object. Bailing out...&quot;</span><span class="p">)</span>
</span><span id="__span-0-4270"><a id="__codelineno-0-4270" name="__codelineno-0-4270"></a>                        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4271"><a id="__codelineno-0-4271" name="__codelineno-0-4271"></a>
</span><span id="__span-0-4272"><a id="__codelineno-0-4272" name="__codelineno-0-4272"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4273"><a id="__codelineno-0-4273" name="__codelineno-0-4273"></a>                        <span class="s2">&quot;Open URL -&gt; </span><span class="si">%s</span><span class="s2"> to verify account or email change...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4274"><a id="__codelineno-0-4274" name="__codelineno-0-4274"></a>                        <span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-4275"><a id="__codelineno-0-4275" name="__codelineno-0-4275"></a>                    <span class="p">)</span>
</span><span id="__span-0-4276"><a id="__codelineno-0-4276" name="__codelineno-0-4276"></a>                    <span class="n">success</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">get_page</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</span><span id="__span-0-4277"><a id="__codelineno-0-4277" name="__codelineno-0-4277"></a>                    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="__span-0-4278"><a id="__codelineno-0-4278" name="__codelineno-0-4278"></a>                        <span class="n">user_interaction_required</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4279"><a id="__codelineno-0-4279" name="__codelineno-0-4279"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4280"><a id="__codelineno-0-4280" name="__codelineno-0-4280"></a>                            <span class="s2">&quot;Successfully opened URL. Browser title is -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4281"><a id="__codelineno-0-4281" name="__codelineno-0-4281"></a>                            <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span>
</span><span id="__span-0-4282"><a id="__codelineno-0-4282" name="__codelineno-0-4282"></a>                        <span class="p">)</span>
</span><span id="__span-0-4283"><a id="__codelineno-0-4283" name="__codelineno-0-4283"></a>                        <span class="k">if</span> <span class="n">password_field_id</span><span class="p">:</span>
</span><span id="__span-0-4284"><a id="__codelineno-0-4284" name="__codelineno-0-4284"></a>                            <span class="n">password_field</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4285"><a id="__codelineno-0-4285" name="__codelineno-0-4285"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">password_field_id</span><span class="p">,</span>
</span><span id="__span-0-4286"><a id="__codelineno-0-4286" name="__codelineno-0-4286"></a>                                <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4287"><a id="__codelineno-0-4287" name="__codelineno-0-4287"></a>                            <span class="p">)</span>
</span><span id="__span-0-4288"><a id="__codelineno-0-4288" name="__codelineno-0-4288"></a>                            <span class="k">if</span> <span class="n">password_field</span><span class="p">:</span>
</span><span id="__span-0-4289"><a id="__codelineno-0-4289" name="__codelineno-0-4289"></a>                                <span class="c1"># The subsequent processing is only required if</span>
</span><span id="__span-0-4290"><a id="__codelineno-0-4290" name="__codelineno-0-4290"></a>                                <span class="c1"># the returned page requests a password change:</span>
</span><span id="__span-0-4291"><a id="__codelineno-0-4291" name="__codelineno-0-4291"></a>                                <span class="n">user_interaction_required</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-4292"><a id="__codelineno-0-4292" name="__codelineno-0-4292"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4293"><a id="__codelineno-0-4293" name="__codelineno-0-4293"></a>                                    <span class="s2">&quot;Found password field on returned page - it seems email verification requests password entry!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4294"><a id="__codelineno-0-4294" name="__codelineno-0-4294"></a>                                <span class="p">)</span>
</span><span id="__span-0-4295"><a id="__codelineno-0-4295" name="__codelineno-0-4295"></a>                                <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_set</span><span class="p">(</span>
</span><span id="__span-0-4296"><a id="__codelineno-0-4296" name="__codelineno-0-4296"></a>                                    <span class="n">selector</span><span class="o">=</span><span class="n">password_field_id</span><span class="p">,</span>
</span><span id="__span-0-4297"><a id="__codelineno-0-4297" name="__codelineno-0-4297"></a>                                    <span class="n">value</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-4298"><a id="__codelineno-0-4298" name="__codelineno-0-4298"></a>                                    <span class="n">is_sensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4299"><a id="__codelineno-0-4299" name="__codelineno-0-4299"></a>                                <span class="p">)</span>
</span><span id="__span-0-4300"><a id="__codelineno-0-4300" name="__codelineno-0-4300"></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4301"><a id="__codelineno-0-4301" name="__codelineno-0-4301"></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4302"><a id="__codelineno-0-4302" name="__codelineno-0-4302"></a>                                        <span class="s2">&quot;Failed to enter password in field -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4303"><a id="__codelineno-0-4303" name="__codelineno-0-4303"></a>                                        <span class="n">password_field_id</span><span class="p">,</span>
</span><span id="__span-0-4304"><a id="__codelineno-0-4304" name="__codelineno-0-4304"></a>                                    <span class="p">)</span>
</span><span id="__span-0-4305"><a id="__codelineno-0-4305" name="__codelineno-0-4305"></a>                                    <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4306"><a id="__codelineno-0-4306" name="__codelineno-0-4306"></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4307"><a id="__codelineno-0-4307" name="__codelineno-0-4307"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4308"><a id="__codelineno-0-4308" name="__codelineno-0-4308"></a>                                    <span class="s2">&quot;No user interaction required (no password change or terms of service acceptance).&quot;</span><span class="p">,</span>
</span><span id="__span-0-4309"><a id="__codelineno-0-4309" name="__codelineno-0-4309"></a>                                <span class="p">)</span>
</span><span id="__span-0-4310"><a id="__codelineno-0-4310" name="__codelineno-0-4310"></a>                        <span class="k">if</span> <span class="n">user_interaction_required</span> <span class="ow">and</span> <span class="n">password_confirmation_field_id</span><span class="p">:</span>
</span><span id="__span-0-4311"><a id="__codelineno-0-4311" name="__codelineno-0-4311"></a>                            <span class="n">password_confirm_field</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4312"><a id="__codelineno-0-4312" name="__codelineno-0-4312"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">password_confirmation_field_id</span><span class="p">,</span>
</span><span id="__span-0-4313"><a id="__codelineno-0-4313" name="__codelineno-0-4313"></a>                                <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4314"><a id="__codelineno-0-4314" name="__codelineno-0-4314"></a>                            <span class="p">)</span>
</span><span id="__span-0-4315"><a id="__codelineno-0-4315" name="__codelineno-0-4315"></a>                            <span class="k">if</span> <span class="n">password_confirm_field</span><span class="p">:</span>
</span><span id="__span-0-4316"><a id="__codelineno-0-4316" name="__codelineno-0-4316"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4317"><a id="__codelineno-0-4317" name="__codelineno-0-4317"></a>                                    <span class="s2">&quot;Found password confirmation field on returned page - it seems email verification requests consecutive password.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4318"><a id="__codelineno-0-4318" name="__codelineno-0-4318"></a>                                <span class="p">)</span>
</span><span id="__span-0-4319"><a id="__codelineno-0-4319" name="__codelineno-0-4319"></a>                                <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_set</span><span class="p">(</span>
</span><span id="__span-0-4320"><a id="__codelineno-0-4320" name="__codelineno-0-4320"></a>                                    <span class="n">selector</span><span class="o">=</span><span class="n">password_confirmation_field_id</span><span class="p">,</span>
</span><span id="__span-0-4321"><a id="__codelineno-0-4321" name="__codelineno-0-4321"></a>                                    <span class="n">value</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-4322"><a id="__codelineno-0-4322" name="__codelineno-0-4322"></a>                                    <span class="n">is_sensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4323"><a id="__codelineno-0-4323" name="__codelineno-0-4323"></a>                                <span class="p">)</span>
</span><span id="__span-0-4324"><a id="__codelineno-0-4324" name="__codelineno-0-4324"></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4325"><a id="__codelineno-0-4325" name="__codelineno-0-4325"></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4326"><a id="__codelineno-0-4326" name="__codelineno-0-4326"></a>                                        <span class="s2">&quot;Failed to enter password in field -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4327"><a id="__codelineno-0-4327" name="__codelineno-0-4327"></a>                                        <span class="n">password_confirmation_field_id</span><span class="p">,</span>
</span><span id="__span-0-4328"><a id="__codelineno-0-4328" name="__codelineno-0-4328"></a>                                    <span class="p">)</span>
</span><span id="__span-0-4329"><a id="__codelineno-0-4329" name="__codelineno-0-4329"></a>                                    <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4330"><a id="__codelineno-0-4330" name="__codelineno-0-4330"></a>                        <span class="k">if</span> <span class="n">user_interaction_required</span> <span class="ow">and</span> <span class="n">password_submit_xpath</span><span class="p">:</span>
</span><span id="__span-0-4331"><a id="__codelineno-0-4331" name="__codelineno-0-4331"></a>                            <span class="n">password_submit_button</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4332"><a id="__codelineno-0-4332" name="__codelineno-0-4332"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4333"><a id="__codelineno-0-4333" name="__codelineno-0-4333"></a>                                <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4334"><a id="__codelineno-0-4334" name="__codelineno-0-4334"></a>                                <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4335"><a id="__codelineno-0-4335" name="__codelineno-0-4335"></a>                            <span class="p">)</span>
</span><span id="__span-0-4336"><a id="__codelineno-0-4336" name="__codelineno-0-4336"></a>                            <span class="k">if</span> <span class="n">password_submit_button</span><span class="p">:</span>
</span><span id="__span-0-4337"><a id="__codelineno-0-4337" name="__codelineno-0-4337"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4338"><a id="__codelineno-0-4338" name="__codelineno-0-4338"></a>                                    <span class="s2">&quot;Submit password change dialog with button -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (found with XPath -&gt; </span><span class="si">%s</span><span class="s2">).&quot;</span><span class="p">,</span>
</span><span id="__span-0-4339"><a id="__codelineno-0-4339" name="__codelineno-0-4339"></a>                                    <span class="n">password_submit_button</span><span class="o">.</span><span class="n">inner_text</span><span class="p">(),</span>
</span><span id="__span-0-4340"><a id="__codelineno-0-4340" name="__codelineno-0-4340"></a>                                    <span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4341"><a id="__codelineno-0-4341" name="__codelineno-0-4341"></a>                                <span class="p">)</span>
</span><span id="__span-0-4342"><a id="__codelineno-0-4342" name="__codelineno-0-4342"></a>                                <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_click</span><span class="p">(</span>
</span><span id="__span-0-4343"><a id="__codelineno-0-4343" name="__codelineno-0-4343"></a>                                    <span class="n">selector</span><span class="o">=</span><span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4344"><a id="__codelineno-0-4344" name="__codelineno-0-4344"></a>                                    <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4345"><a id="__codelineno-0-4345" name="__codelineno-0-4345"></a>                                <span class="p">)</span>
</span><span id="__span-0-4346"><a id="__codelineno-0-4346" name="__codelineno-0-4346"></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4347"><a id="__codelineno-0-4347" name="__codelineno-0-4347"></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4348"><a id="__codelineno-0-4348" name="__codelineno-0-4348"></a>                                        <span class="s2">&quot;Failed to press submit button -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-4349"><a id="__codelineno-0-4349" name="__codelineno-0-4349"></a>                                        <span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4350"><a id="__codelineno-0-4350" name="__codelineno-0-4350"></a>                                    <span class="p">)</span>
</span><span id="__span-0-4351"><a id="__codelineno-0-4351" name="__codelineno-0-4351"></a>                                    <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4352"><a id="__codelineno-0-4352" name="__codelineno-0-4352"></a>                            <span class="c1"># The Terms of service dialog has some weird animation</span>
</span><span id="__span-0-4353"><a id="__codelineno-0-4353" name="__codelineno-0-4353"></a>                            <span class="c1"># which require a short wait time. It seems it is required!</span>
</span><span id="__span-0-4354"><a id="__codelineno-0-4354" name="__codelineno-0-4354"></a>                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-4355"><a id="__codelineno-0-4355" name="__codelineno-0-4355"></a>                            <span class="n">terms_accept_button</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4356"><a id="__codelineno-0-4356" name="__codelineno-0-4356"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">terms_of_service_xpath</span><span class="p">,</span>
</span><span id="__span-0-4357"><a id="__codelineno-0-4357" name="__codelineno-0-4357"></a>                                <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4358"><a id="__codelineno-0-4358" name="__codelineno-0-4358"></a>                                <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4359"><a id="__codelineno-0-4359" name="__codelineno-0-4359"></a>                            <span class="p">)</span>
</span><span id="__span-0-4360"><a id="__codelineno-0-4360" name="__codelineno-0-4360"></a>                            <span class="k">if</span> <span class="n">terms_accept_button</span><span class="p">:</span>
</span><span id="__span-0-4361"><a id="__codelineno-0-4361" name="__codelineno-0-4361"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4362"><a id="__codelineno-0-4362" name="__codelineno-0-4362"></a>                                    <span class="s2">&quot;Accept terms of service with button -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (found with XPath -&gt; </span><span class="si">%s</span><span class="s2">).&quot;</span><span class="p">,</span>
</span><span id="__span-0-4363"><a id="__codelineno-0-4363" name="__codelineno-0-4363"></a>                                    <span class="n">terms_accept_button</span><span class="o">.</span><span class="n">inner_text</span><span class="p">(),</span>
</span><span id="__span-0-4364"><a id="__codelineno-0-4364" name="__codelineno-0-4364"></a>                                    <span class="n">terms_of_service_xpath</span><span class="p">,</span>
</span><span id="__span-0-4365"><a id="__codelineno-0-4365" name="__codelineno-0-4365"></a>                                <span class="p">)</span>
</span><span id="__span-0-4366"><a id="__codelineno-0-4366" name="__codelineno-0-4366"></a>                                <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_click</span><span class="p">(</span>
</span><span id="__span-0-4367"><a id="__codelineno-0-4367" name="__codelineno-0-4367"></a>                                    <span class="n">selector</span><span class="o">=</span><span class="n">terms_of_service_xpath</span><span class="p">,</span>
</span><span id="__span-0-4368"><a id="__codelineno-0-4368" name="__codelineno-0-4368"></a>                                    <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4369"><a id="__codelineno-0-4369" name="__codelineno-0-4369"></a>                                <span class="p">)</span>
</span><span id="__span-0-4370"><a id="__codelineno-0-4370" name="__codelineno-0-4370"></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4371"><a id="__codelineno-0-4371" name="__codelineno-0-4371"></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4372"><a id="__codelineno-0-4372" name="__codelineno-0-4372"></a>                                        <span class="s2">&quot;Failed to accept terms of service with button -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4373"><a id="__codelineno-0-4373" name="__codelineno-0-4373"></a>                                        <span class="n">terms_accept_button</span><span class="o">.</span><span class="n">inner_text</span><span class="p">(),</span>
</span><span id="__span-0-4374"><a id="__codelineno-0-4374" name="__codelineno-0-4374"></a>                                    <span class="p">)</span>
</span><span id="__span-0-4375"><a id="__codelineno-0-4375" name="__codelineno-0-4375"></a>                                    <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4376"><a id="__codelineno-0-4376" name="__codelineno-0-4376"></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4377"><a id="__codelineno-0-4377" name="__codelineno-0-4377"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4378"><a id="__codelineno-0-4378" name="__codelineno-0-4378"></a>                                    <span class="s2">&quot;No Terms of Service acceptance required.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4379"><a id="__codelineno-0-4379" name="__codelineno-0-4379"></a>                                <span class="p">)</span>
</span><span id="__span-0-4380"><a id="__codelineno-0-4380" name="__codelineno-0-4380"></a>                        <span class="c1"># end if user_interaction_required and password_submit_xpath:</span>
</span><span id="__span-0-4381"><a id="__codelineno-0-4381" name="__codelineno-0-4381"></a>                    <span class="c1"># end if success:</span>
</span><span id="__span-0-4382"><a id="__codelineno-0-4382" name="__codelineno-0-4382"></a>                <span class="c1"># end if use_browser_automation</span>
</span><span id="__span-0-4383"><a id="__codelineno-0-4383" name="__codelineno-0-4383"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4384"><a id="__codelineno-0-4384" name="__codelineno-0-4384"></a>                    <span class="c1"># Salesforce (other than Core Share) is OK with the simple HTTP GET request:</span>
</span><span id="__span-0-4385"><a id="__codelineno-0-4385" name="__codelineno-0-4385"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4386"><a id="__codelineno-0-4386" name="__codelineno-0-4386"></a>                        <span class="s2">&quot;Open URL -&gt; </span><span class="si">%s</span><span class="s2"> to verify account or email change...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4387"><a id="__codelineno-0-4387" name="__codelineno-0-4387"></a>                        <span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-4388"><a id="__codelineno-0-4388" name="__codelineno-0-4388"></a>                    <span class="p">)</span>
</span><span id="__span-0-4389"><a id="__codelineno-0-4389" name="__codelineno-0-4389"></a>                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_object</span><span class="o">.</span><span class="n">http_request</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">)</span>
</span><span id="__span-0-4390"><a id="__codelineno-0-4390" name="__codelineno-0-4390"></a>                    <span class="n">success</span> <span class="o">=</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span>
</span><span id="__span-0-4391"><a id="__codelineno-0-4391" name="__codelineno-0-4391"></a>
</span><span id="__span-0-4392"><a id="__codelineno-0-4392" name="__codelineno-0-4392"></a>                <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="__span-0-4393"><a id="__codelineno-0-4393" name="__codelineno-0-4393"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4394"><a id="__codelineno-0-4394" name="__codelineno-0-4394"></a>                        <span class="s2">&quot;Remove email from inbox of user -&gt; </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4395"><a id="__codelineno-0-4395" name="__codelineno-0-4395"></a>                        <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4396"><a id="__codelineno-0-4396" name="__codelineno-0-4396"></a>                    <span class="p">)</span>
</span><span id="__span-0-4397"><a id="__codelineno-0-4397" name="__codelineno-0-4397"></a>                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_mail</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">m365_user_id</span><span class="p">,</span> <span class="n">email_id</span><span class="o">=</span><span class="n">email_id</span><span class="p">)</span>
</span><span id="__span-0-4398"><a id="__codelineno-0-4398" name="__codelineno-0-4398"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-4399"><a id="__codelineno-0-4399" name="__codelineno-0-4399"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-4400"><a id="__codelineno-0-4400" name="__codelineno-0-4400"></a>                            <span class="s2">&quot;Couldn&#39;t remove the mail from the inbox of user -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4401"><a id="__codelineno-0-4401" name="__codelineno-0-4401"></a>                            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4402"><a id="__codelineno-0-4402" name="__codelineno-0-4402"></a>                        <span class="p">)</span>
</span><span id="__span-0-4403"><a id="__codelineno-0-4403" name="__codelineno-0-4403"></a>                    <span class="c1"># We have success now and can break from the while loop</span>
</span><span id="__span-0-4404"><a id="__codelineno-0-4404" name="__codelineno-0-4404"></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-4405"><a id="__codelineno-0-4405" name="__codelineno-0-4405"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4406"><a id="__codelineno-0-4406" name="__codelineno-0-4406"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4407"><a id="__codelineno-0-4407" name="__codelineno-0-4407"></a>                        <span class="s2">&quot;Failed to process e-mail verification for user -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4408"><a id="__codelineno-0-4408" name="__codelineno-0-4408"></a>                        <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4409"><a id="__codelineno-0-4409" name="__codelineno-0-4409"></a>                    <span class="p">)</span>
</span><span id="__span-0-4410"><a id="__codelineno-0-4410" name="__codelineno-0-4410"></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4411"><a id="__codelineno-0-4411" name="__codelineno-0-4411"></a>            <span class="c1"># end if response and response[&quot;value&quot;]</span>
</span><span id="__span-0-4412"><a id="__codelineno-0-4412" name="__codelineno-0-4412"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4413"><a id="__codelineno-0-4413" name="__codelineno-0-4413"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4414"><a id="__codelineno-0-4414" name="__codelineno-0-4414"></a>                    <span class="s2">&quot;Verification email not yet received (no mails with sender -&gt; </span><span class="si">%s</span><span class="s2"> and subject -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; found). Waiting </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4415"><a id="__codelineno-0-4415" name="__codelineno-0-4415"></a>                    <span class="n">sender</span><span class="p">,</span>
</span><span id="__span-0-4416"><a id="__codelineno-0-4416" name="__codelineno-0-4416"></a>                    <span class="n">subject</span><span class="p">,</span>
</span><span id="__span-0-4417"><a id="__codelineno-0-4417" name="__codelineno-0-4417"></a>                    <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-0-4418"><a id="__codelineno-0-4418" name="__codelineno-0-4418"></a>                <span class="p">)</span>
</span><span id="__span-0-4419"><a id="__codelineno-0-4419" name="__codelineno-0-4419"></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-4420"><a id="__codelineno-0-4420" name="__codelineno-0-4420"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-4421"><a id="__codelineno-0-4421" name="__codelineno-0-4421"></a>        <span class="c1"># end while</span>
</span><span id="__span-0-4422"><a id="__codelineno-0-4422" name="__codelineno-0-4422"></a>
</span><span id="__span-0-4423"><a id="__codelineno-0-4423" name="__codelineno-0-4423"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-4424"><a id="__codelineno-0-4424" name="__codelineno-0-4424"></a>            <span class="s2">&quot;Verification mail for user -&gt; </span><span class="si">%s</span><span class="s2"> has not arrived in time.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4425"><a id="__codelineno-0-4425" name="__codelineno-0-4425"></a>            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4426"><a id="__codelineno-0-4426" name="__codelineno-0-4426"></a>        <span class="p">)</span>
</span><span id="__span-0-4427"><a id="__codelineno-0-4427" name="__codelineno-0-4427"></a>
</span><span id="__span-0-4428"><a id="__codelineno-0-4428" name="__codelineno-0-4428"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4429"><a id="__codelineno-0-4429" name="__codelineno-0-4429"></a>
</span><span id="__span-0-4430"><a id="__codelineno-0-4430" name="__codelineno-0-4430"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4431"><a id="__codelineno-0-4431" name="__codelineno-0-4431"></a>
</span><span id="__span-0-4432"><a id="__codelineno-0-4432" name="__codelineno-0-4432"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_sites</span><span class="p">(</span>
</span><span id="__span-0-4433"><a id="__codelineno-0-4433" name="__codelineno-0-4433"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4434"><a id="__codelineno-0-4434" name="__codelineno-0-4434"></a>        <span class="n">search</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4435"><a id="__codelineno-0-4435" name="__codelineno-0-4435"></a>        <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4436"><a id="__codelineno-0-4436" name="__codelineno-0-4436"></a>        <span class="n">select</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4437"><a id="__codelineno-0-4437" name="__codelineno-0-4437"></a>        <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
</span><span id="__span-0-4438"><a id="__codelineno-0-4438" name="__codelineno-0-4438"></a>        <span class="n">next_page_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4439"><a id="__codelineno-0-4439" name="__codelineno-0-4439"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4440"><a id="__codelineno-0-4440" name="__codelineno-0-4440"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a list of SharePoint sites.</span>
</span><span id="__span-0-4441"><a id="__codelineno-0-4441" name="__codelineno-0-4441"></a>
</span><span id="__span-0-4442"><a id="__codelineno-0-4442" name="__codelineno-0-4442"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4443"><a id="__codelineno-0-4443" name="__codelineno-0-4443"></a><span class="sd">            search (str, optional):</span>
</span><span id="__span-0-4444"><a id="__codelineno-0-4444" name="__codelineno-0-4444"></a><span class="sd">                A string to search for to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4445"><a id="__codelineno-0-4445" name="__codelineno-0-4445"></a><span class="sd">            filter_expression (str | None, optional):</span>
</span><span id="__span-0-4446"><a id="__codelineno-0-4446" name="__codelineno-0-4446"></a><span class="sd">                Filter string to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4447"><a id="__codelineno-0-4447" name="__codelineno-0-4447"></a><span class="sd">            select (str | None, optional):</span>
</span><span id="__span-0-4448"><a id="__codelineno-0-4448" name="__codelineno-0-4448"></a><span class="sd">                Fields to select. Make sure that all fields are selected that are used in filters.</span>
</span><span id="__span-0-4449"><a id="__codelineno-0-4449" name="__codelineno-0-4449"></a><span class="sd">                Otherwise you will get no results.</span>
</span><span id="__span-0-4450"><a id="__codelineno-0-4450" name="__codelineno-0-4450"></a><span class="sd">            limit (int, optional):</span>
</span><span id="__span-0-4451"><a id="__codelineno-0-4451" name="__codelineno-0-4451"></a><span class="sd">                The maximum number of sites to return in one call.</span>
</span><span id="__span-0-4452"><a id="__codelineno-0-4452" name="__codelineno-0-4452"></a><span class="sd">                Default is set to 50.</span>
</span><span id="__span-0-4453"><a id="__codelineno-0-4453" name="__codelineno-0-4453"></a><span class="sd">            next_page_url (str | None, optional):</span>
</span><span id="__span-0-4454"><a id="__codelineno-0-4454" name="__codelineno-0-4454"></a><span class="sd">                The MS Graph URL to retrieve the next page of SharePoint sites (pagination).</span>
</span><span id="__span-0-4455"><a id="__codelineno-0-4455" name="__codelineno-0-4455"></a><span class="sd">                This is used for the iterator get_sharepoint_sites_iterator() below.</span>
</span><span id="__span-0-4456"><a id="__codelineno-0-4456" name="__codelineno-0-4456"></a>
</span><span id="__span-0-4457"><a id="__codelineno-0-4457" name="__codelineno-0-4457"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4458"><a id="__codelineno-0-4458" name="__codelineno-0-4458"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-4459"><a id="__codelineno-0-4459" name="__codelineno-0-4459"></a><span class="sd">                A list of SharePoint sites embedded in a &quot;value&quot; key in the dictionary.</span>
</span><span id="__span-0-4460"><a id="__codelineno-0-4460" name="__codelineno-0-4460"></a>
</span><span id="__span-0-4461"><a id="__codelineno-0-4461" name="__codelineno-0-4461"></a><span class="sd">        Example response:</span>
</span><span id="__span-0-4462"><a id="__codelineno-0-4462" name="__codelineno-0-4462"></a><span class="sd">        {</span>
</span><span id="__span-0-4463"><a id="__codelineno-0-4463" name="__codelineno-0-4463"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites&#39;,</span>
</span><span id="__span-0-4464"><a id="__codelineno-0-4464" name="__codelineno-0-4464"></a><span class="sd">            &#39;@odata.nextLink&#39;: &#39;https://graph.microsoft.com/beta/sites?$top=50&amp;$skiptoken=UGFnZWQ9VFJVRSZwX1RpbWVEZWxldGVkPSZwX0lEPTE5MDM4&#39;,</span>
</span><span id="__span-0-4465"><a id="__codelineno-0-4465" name="__codelineno-0-4465"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-4466"><a id="__codelineno-0-4466" name="__codelineno-0-4466"></a><span class="sd">                {</span>
</span><span id="__span-0-4467"><a id="__codelineno-0-4467" name="__codelineno-0-4467"></a><span class="sd">                    &#39;createdDateTime&#39;: &#39;2025-02-11T12:11:49Z&#39;,</span>
</span><span id="__span-0-4468"><a id="__codelineno-0-4468" name="__codelineno-0-4468"></a><span class="sd">                    &#39;id&#39;: &#39;ideatedev-my.sharepoint.com,eeed2961-91ba-46c1-abc2-159f0277130f,5aa8a98d-659d-4a52-8701-6b9a728092d8&#39;,</span>
</span><span id="__span-0-4469"><a id="__codelineno-0-4469" name="__codelineno-0-4469"></a><span class="sd">                    &#39;name&#39;: &#39;Diane Conner&#39;,</span>
</span><span id="__span-0-4470"><a id="__codelineno-0-4470" name="__codelineno-0-4470"></a><span class="sd">                    &#39;webUrl&#39;: &#39;https://ideatedev-my.sharepoint.com/personal/dconner_dev_idea-te_eimdemo_com&#39;,</span>
</span><span id="__span-0-4471"><a id="__codelineno-0-4471" name="__codelineno-0-4471"></a><span class="sd">                    &#39;displayName&#39;: &#39;Diane Conner&#39;,</span>
</span><span id="__span-0-4472"><a id="__codelineno-0-4472" name="__codelineno-0-4472"></a><span class="sd">                    &#39;isPersonalSite&#39;: True,</span>
</span><span id="__span-0-4473"><a id="__codelineno-0-4473" name="__codelineno-0-4473"></a><span class="sd">                    &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4474"><a id="__codelineno-0-4474" name="__codelineno-0-4474"></a><span class="sd">                        &#39;hostname&#39;: &#39;ideatedev-my.sharepoint.com&#39;</span>
</span><span id="__span-0-4475"><a id="__codelineno-0-4475" name="__codelineno-0-4475"></a><span class="sd">                    },</span>
</span><span id="__span-0-4476"><a id="__codelineno-0-4476" name="__codelineno-0-4476"></a><span class="sd">                    &#39;root&#39;: {}</span>
</span><span id="__span-0-4477"><a id="__codelineno-0-4477" name="__codelineno-0-4477"></a><span class="sd">                },</span>
</span><span id="__span-0-4478"><a id="__codelineno-0-4478" name="__codelineno-0-4478"></a><span class="sd">                {</span>
</span><span id="__span-0-4479"><a id="__codelineno-0-4479" name="__codelineno-0-4479"></a><span class="sd">                    &#39;createdDateTime&#39;: &#39;2025-02-06T07:44:44Z&#39;,</span>
</span><span id="__span-0-4480"><a id="__codelineno-0-4480" name="__codelineno-0-4480"></a><span class="sd">                    &#39;id&#39;: &#39;ideatedev.sharepoint.com,570e67bc-1e69-4a62-89ea-994be9642b93,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4481"><a id="__codelineno-0-4481" name="__codelineno-0-4481"></a><span class="sd">                    &#39;name&#39;: &#39;SG325B - SEMI325B,ECM,PD,ExternalProcurement&#39;,</span>
</span><span id="__span-0-4482"><a id="__codelineno-0-4482" name="__codelineno-0-4482"></a><span class="sd">                    &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/SG325B-SEMI325BECMPDExternalProcurement698&#39;,</span>
</span><span id="__span-0-4483"><a id="__codelineno-0-4483" name="__codelineno-0-4483"></a><span class="sd">                    &#39;displayName&#39;: &#39;SG325B - SEMI325B,ECM,PD,ExternalProcurement&#39;,</span>
</span><span id="__span-0-4484"><a id="__codelineno-0-4484" name="__codelineno-0-4484"></a><span class="sd">                    &#39;isPersonalSite&#39;: False,</span>
</span><span id="__span-0-4485"><a id="__codelineno-0-4485" name="__codelineno-0-4485"></a><span class="sd">                    &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4486"><a id="__codelineno-0-4486" name="__codelineno-0-4486"></a><span class="sd">                        &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4487"><a id="__codelineno-0-4487" name="__codelineno-0-4487"></a><span class="sd">                    },</span>
</span><span id="__span-0-4488"><a id="__codelineno-0-4488" name="__codelineno-0-4488"></a><span class="sd">                    &#39;root&#39;: {}</span>
</span><span id="__span-0-4489"><a id="__codelineno-0-4489" name="__codelineno-0-4489"></a><span class="sd">                },</span>
</span><span id="__span-0-4490"><a id="__codelineno-0-4490" name="__codelineno-0-4490"></a><span class="sd">                ...</span>
</span><span id="__span-0-4491"><a id="__codelineno-0-4491" name="__codelineno-0-4491"></a><span class="sd">            ]</span>
</span><span id="__span-0-4492"><a id="__codelineno-0-4492" name="__codelineno-0-4492"></a><span class="sd">        ]</span>
</span><span id="__span-0-4493"><a id="__codelineno-0-4493" name="__codelineno-0-4493"></a>
</span><span id="__span-0-4494"><a id="__codelineno-0-4494" name="__codelineno-0-4494"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4495"><a id="__codelineno-0-4495" name="__codelineno-0-4495"></a>
</span><span id="__span-0-4496"><a id="__codelineno-0-4496" name="__codelineno-0-4496"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-4497"><a id="__codelineno-0-4497" name="__codelineno-0-4497"></a>            <span class="n">query</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-4498"><a id="__codelineno-0-4498" name="__codelineno-0-4498"></a>            <span class="k">if</span> <span class="n">select</span><span class="p">:</span>
</span><span id="__span-0-4499"><a id="__codelineno-0-4499" name="__codelineno-0-4499"></a>                <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$select&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">select</span>
</span><span id="__span-0-4500"><a id="__codelineno-0-4500" name="__codelineno-0-4500"></a>            <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-4501"><a id="__codelineno-0-4501" name="__codelineno-0-4501"></a>                <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-4502"><a id="__codelineno-0-4502" name="__codelineno-0-4502"></a>            <span class="k">if</span> <span class="n">search</span><span class="p">:</span>
</span><span id="__span-0-4503"><a id="__codelineno-0-4503" name="__codelineno-0-4503"></a>                <span class="n">query</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search</span>
</span><span id="__span-0-4504"><a id="__codelineno-0-4504" name="__codelineno-0-4504"></a>            <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
</span><span id="__span-0-4505"><a id="__codelineno-0-4505" name="__codelineno-0-4505"></a>                <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span>
</span><span id="__span-0-4506"><a id="__codelineno-0-4506" name="__codelineno-0-4506"></a>
</span><span id="__span-0-4507"><a id="__codelineno-0-4507" name="__codelineno-0-4507"></a>            <span class="n">encoded_query</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">query</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-4508"><a id="__codelineno-0-4508" name="__codelineno-0-4508"></a>            <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-4509"><a id="__codelineno-0-4509" name="__codelineno-0-4509"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4510"><a id="__codelineno-0-4510" name="__codelineno-0-4510"></a>            <span class="n">request_url</span> <span class="o">=</span> <span class="n">next_page_url</span>
</span><span id="__span-0-4511"><a id="__codelineno-0-4511" name="__codelineno-0-4511"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4512"><a id="__codelineno-0-4512" name="__codelineno-0-4512"></a>
</span><span id="__span-0-4513"><a id="__codelineno-0-4513" name="__codelineno-0-4513"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4514"><a id="__codelineno-0-4514" name="__codelineno-0-4514"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4515"><a id="__codelineno-0-4515" name="__codelineno-0-4515"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4516"><a id="__codelineno-0-4516" name="__codelineno-0-4516"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4517"><a id="__codelineno-0-4517" name="__codelineno-0-4517"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4518"><a id="__codelineno-0-4518" name="__codelineno-0-4518"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint sites&quot;</span><span class="p">,</span>
</span><span id="__span-0-4519"><a id="__codelineno-0-4519" name="__codelineno-0-4519"></a>        <span class="p">)</span>
</span><span id="__span-0-4520"><a id="__codelineno-0-4520" name="__codelineno-0-4520"></a>
</span><span id="__span-0-4521"><a id="__codelineno-0-4521" name="__codelineno-0-4521"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4522"><a id="__codelineno-0-4522" name="__codelineno-0-4522"></a>
</span><span id="__span-0-4523"><a id="__codelineno-0-4523" name="__codelineno-0-4523"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4524"><a id="__codelineno-0-4524" name="__codelineno-0-4524"></a>
</span><span id="__span-0-4525"><a id="__codelineno-0-4525" name="__codelineno-0-4525"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_root_sites</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4526"><a id="__codelineno-0-4526" name="__codelineno-0-4526"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all SharePoint root sites.</span>
</span><span id="__span-0-4527"><a id="__codelineno-0-4527" name="__codelineno-0-4527"></a>
</span><span id="__span-0-4528"><a id="__codelineno-0-4528" name="__codelineno-0-4528"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4529"><a id="__codelineno-0-4529" name="__codelineno-0-4529"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-4530"><a id="__codelineno-0-4530" name="__codelineno-0-4530"></a><span class="sd">                Dictionary that includes a list of root sites in the &quot;value&quot; key.</span>
</span><span id="__span-0-4531"><a id="__codelineno-0-4531" name="__codelineno-0-4531"></a>
</span><span id="__span-0-4532"><a id="__codelineno-0-4532" name="__codelineno-0-4532"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4533"><a id="__codelineno-0-4533" name="__codelineno-0-4533"></a>
</span><span id="__span-0-4534"><a id="__codelineno-0-4534" name="__codelineno-0-4534"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_sites</span><span class="p">(</span>
</span><span id="__span-0-4535"><a id="__codelineno-0-4535" name="__codelineno-0-4535"></a>            <span class="n">select</span><span class="o">=</span><span class="s2">&quot;siteCollection,webUrl&quot;</span><span class="p">,</span>
</span><span id="__span-0-4536"><a id="__codelineno-0-4536" name="__codelineno-0-4536"></a>            <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;siteCollection/root ne null&quot;</span><span class="p">,</span>
</span><span id="__span-0-4537"><a id="__codelineno-0-4537" name="__codelineno-0-4537"></a>        <span class="p">)</span>
</span><span id="__span-0-4538"><a id="__codelineno-0-4538" name="__codelineno-0-4538"></a>
</span><span id="__span-0-4539"><a id="__codelineno-0-4539" name="__codelineno-0-4539"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4540"><a id="__codelineno-0-4540" name="__codelineno-0-4540"></a>
</span><span id="__span-0-4541"><a id="__codelineno-0-4541" name="__codelineno-0-4541"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4542"><a id="__codelineno-0-4542" name="__codelineno-0-4542"></a>
</span><span id="__span-0-4543"><a id="__codelineno-0-4543" name="__codelineno-0-4543"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_sites_iterator</span><span class="p">(</span>
</span><span id="__span-0-4544"><a id="__codelineno-0-4544" name="__codelineno-0-4544"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4545"><a id="__codelineno-0-4545" name="__codelineno-0-4545"></a>        <span class="n">search</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4546"><a id="__codelineno-0-4546" name="__codelineno-0-4546"></a>        <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4547"><a id="__codelineno-0-4547" name="__codelineno-0-4547"></a>        <span class="n">select</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4548"><a id="__codelineno-0-4548" name="__codelineno-0-4548"></a>        <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
</span><span id="__span-0-4549"><a id="__codelineno-0-4549" name="__codelineno-0-4549"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">iter</span><span class="p">:</span>
</span><span id="__span-0-4550"><a id="__codelineno-0-4550" name="__codelineno-0-4550"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an iterator object that can be used to traverse all SharePoint sites matching the filter.</span>
</span><span id="__span-0-4551"><a id="__codelineno-0-4551" name="__codelineno-0-4551"></a>
</span><span id="__span-0-4552"><a id="__codelineno-0-4552" name="__codelineno-0-4552"></a><span class="sd">        Returning a generator avoids loading a large number of nodes into memory at once. Instead you</span>
</span><span id="__span-0-4553"><a id="__codelineno-0-4553" name="__codelineno-0-4553"></a><span class="sd">        can iterate over the potential large list of SharePoint sites.</span>
</span><span id="__span-0-4554"><a id="__codelineno-0-4554" name="__codelineno-0-4554"></a>
</span><span id="__span-0-4555"><a id="__codelineno-0-4555" name="__codelineno-0-4555"></a><span class="sd">        Example usage:</span>
</span><span id="__span-0-4556"><a id="__codelineno-0-4556" name="__codelineno-0-4556"></a><span class="sd">            sites = m365_object.get_sharepoint_sites_iterator(limit=10)</span>
</span><span id="__span-0-4557"><a id="__codelineno-0-4557" name="__codelineno-0-4557"></a><span class="sd">            for site in sites:</span>
</span><span id="__span-0-4558"><a id="__codelineno-0-4558" name="__codelineno-0-4558"></a><span class="sd">                logger.info(&quot;Traversing SharePoint site -&gt; &#39;%s&#39;...&quot;, site.get(&quot;name&quot;, &quot;&lt;undefined name&gt;&quot;))</span>
</span><span id="__span-0-4559"><a id="__codelineno-0-4559" name="__codelineno-0-4559"></a>
</span><span id="__span-0-4560"><a id="__codelineno-0-4560" name="__codelineno-0-4560"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4561"><a id="__codelineno-0-4561" name="__codelineno-0-4561"></a><span class="sd">            search (str | None, optional):</span>
</span><span id="__span-0-4562"><a id="__codelineno-0-4562" name="__codelineno-0-4562"></a><span class="sd">                A string to search for to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4563"><a id="__codelineno-0-4563" name="__codelineno-0-4563"></a><span class="sd">            filter_expression (str | None, optional):</span>
</span><span id="__span-0-4564"><a id="__codelineno-0-4564" name="__codelineno-0-4564"></a><span class="sd">                Filter string to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4565"><a id="__codelineno-0-4565" name="__codelineno-0-4565"></a><span class="sd">            select (str | None, optional):</span>
</span><span id="__span-0-4566"><a id="__codelineno-0-4566" name="__codelineno-0-4566"></a><span class="sd">                Fields to select. Make sure that all fields are selected that are used in filters.</span>
</span><span id="__span-0-4567"><a id="__codelineno-0-4567" name="__codelineno-0-4567"></a><span class="sd">                Otherwise you will get no results.</span>
</span><span id="__span-0-4568"><a id="__codelineno-0-4568" name="__codelineno-0-4568"></a><span class="sd">            limit (int, optional):</span>
</span><span id="__span-0-4569"><a id="__codelineno-0-4569" name="__codelineno-0-4569"></a><span class="sd">                The maximum number of sites to return in one call.</span>
</span><span id="__span-0-4570"><a id="__codelineno-0-4570" name="__codelineno-0-4570"></a><span class="sd">                Default is set to 50.</span>
</span><span id="__span-0-4571"><a id="__codelineno-0-4571" name="__codelineno-0-4571"></a>
</span><span id="__span-0-4572"><a id="__codelineno-0-4572" name="__codelineno-0-4572"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4573"><a id="__codelineno-0-4573" name="__codelineno-0-4573"></a><span class="sd">            iter:</span>
</span><span id="__span-0-4574"><a id="__codelineno-0-4574" name="__codelineno-0-4574"></a><span class="sd">                A generator yielding one SharePoint site per iteration.</span>
</span><span id="__span-0-4575"><a id="__codelineno-0-4575" name="__codelineno-0-4575"></a><span class="sd">                If the REST API fails, returns no value.</span>
</span><span id="__span-0-4576"><a id="__codelineno-0-4576" name="__codelineno-0-4576"></a>
</span><span id="__span-0-4577"><a id="__codelineno-0-4577" name="__codelineno-0-4577"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4578"><a id="__codelineno-0-4578" name="__codelineno-0-4578"></a>
</span><span id="__span-0-4579"><a id="__codelineno-0-4579" name="__codelineno-0-4579"></a>        <span class="n">next_page_url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-4580"><a id="__codelineno-0-4580" name="__codelineno-0-4580"></a>
</span><span id="__span-0-4581"><a id="__codelineno-0-4581" name="__codelineno-0-4581"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-4582"><a id="__codelineno-0-4582" name="__codelineno-0-4582"></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_sites</span><span class="p">(</span>
</span><span id="__span-0-4583"><a id="__codelineno-0-4583" name="__codelineno-0-4583"></a>                <span class="n">search</span><span class="o">=</span><span class="n">search</span><span class="p">,</span>
</span><span id="__span-0-4584"><a id="__codelineno-0-4584" name="__codelineno-0-4584"></a>                <span class="n">filter_expression</span><span class="o">=</span><span class="n">filter_expression</span><span class="p">,</span>
</span><span id="__span-0-4585"><a id="__codelineno-0-4585" name="__codelineno-0-4585"></a>                <span class="n">select</span><span class="o">=</span><span class="n">select</span><span class="p">,</span>
</span><span id="__span-0-4586"><a id="__codelineno-0-4586" name="__codelineno-0-4586"></a>                <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
</span><span id="__span-0-4587"><a id="__codelineno-0-4587" name="__codelineno-0-4587"></a>                <span class="n">next_page_url</span><span class="o">=</span><span class="n">next_page_url</span><span class="p">,</span>
</span><span id="__span-0-4588"><a id="__codelineno-0-4588" name="__codelineno-0-4588"></a>            <span class="p">)</span>
</span><span id="__span-0-4589"><a id="__codelineno-0-4589" name="__codelineno-0-4589"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-4590"><a id="__codelineno-0-4590" name="__codelineno-0-4590"></a>                <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-4591"><a id="__codelineno-0-4591" name="__codelineno-0-4591"></a>                <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-4592"><a id="__codelineno-0-4592" name="__codelineno-0-4592"></a>                <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-4593"><a id="__codelineno-0-4593" name="__codelineno-0-4593"></a>                <span class="k">return</span>
</span><span id="__span-0-4594"><a id="__codelineno-0-4594" name="__codelineno-0-4594"></a>
</span><span id="__span-0-4595"><a id="__codelineno-0-4595" name="__codelineno-0-4595"></a>            <span class="c1"># Yield users one at a time:</span>
</span><span id="__span-0-4596"><a id="__codelineno-0-4596" name="__codelineno-0-4596"></a>            <span class="k">yield from</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-4597"><a id="__codelineno-0-4597" name="__codelineno-0-4597"></a>
</span><span id="__span-0-4598"><a id="__codelineno-0-4598" name="__codelineno-0-4598"></a>            <span class="c1"># See if we have an additional result page.</span>
</span><span id="__span-0-4599"><a id="__codelineno-0-4599" name="__codelineno-0-4599"></a>            <span class="c1"># If not terminate the iterator and return</span>
</span><span id="__span-0-4600"><a id="__codelineno-0-4600" name="__codelineno-0-4600"></a>            <span class="c1"># no value.</span>
</span><span id="__span-0-4601"><a id="__codelineno-0-4601" name="__codelineno-0-4601"></a>            <span class="n">next_page_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.nextLink&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-4602"><a id="__codelineno-0-4602" name="__codelineno-0-4602"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-4603"><a id="__codelineno-0-4603" name="__codelineno-0-4603"></a>                <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-4604"><a id="__codelineno-0-4604" name="__codelineno-0-4604"></a>                <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-4605"><a id="__codelineno-0-4605" name="__codelineno-0-4605"></a>                <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-4606"><a id="__codelineno-0-4606" name="__codelineno-0-4606"></a>                <span class="k">return</span>
</span><span id="__span-0-4607"><a id="__codelineno-0-4607" name="__codelineno-0-4607"></a>
</span><span id="__span-0-4608"><a id="__codelineno-0-4608" name="__codelineno-0-4608"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4609"><a id="__codelineno-0-4609" name="__codelineno-0-4609"></a>
</span><span id="__span-0-4610"><a id="__codelineno-0-4610" name="__codelineno-0-4610"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4611"><a id="__codelineno-0-4611" name="__codelineno-0-4611"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a SharePoint site by its ID.</span>
</span><span id="__span-0-4612"><a id="__codelineno-0-4612" name="__codelineno-0-4612"></a>
</span><span id="__span-0-4613"><a id="__codelineno-0-4613" name="__codelineno-0-4613"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4614"><a id="__codelineno-0-4614" name="__codelineno-0-4614"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-4615"><a id="__codelineno-0-4615" name="__codelineno-0-4615"></a><span class="sd">                The ID of the SharePoint site the to retrieve.</span>
</span><span id="__span-0-4616"><a id="__codelineno-0-4616" name="__codelineno-0-4616"></a>
</span><span id="__span-0-4617"><a id="__codelineno-0-4617" name="__codelineno-0-4617"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4618"><a id="__codelineno-0-4618" name="__codelineno-0-4618"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-4619"><a id="__codelineno-0-4619" name="__codelineno-0-4619"></a><span class="sd">                The data of the SharePoint site.</span>
</span><span id="__span-0-4620"><a id="__codelineno-0-4620" name="__codelineno-0-4620"></a>
</span><span id="__span-0-4621"><a id="__codelineno-0-4621" name="__codelineno-0-4621"></a><span class="sd">        Example:</span>
</span><span id="__span-0-4622"><a id="__codelineno-0-4622" name="__codelineno-0-4622"></a><span class="sd">        {</span>
</span><span id="__span-0-4623"><a id="__codelineno-0-4623" name="__codelineno-0-4623"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites/$entity&#39;,</span>
</span><span id="__span-0-4624"><a id="__codelineno-0-4624" name="__codelineno-0-4624"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2025-02-06T07:41:53.41Z&#39;,</span>
</span><span id="__span-0-4625"><a id="__codelineno-0-4625" name="__codelineno-0-4625"></a><span class="sd">            &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-4626"><a id="__codelineno-0-4626" name="__codelineno-0-4626"></a><span class="sd">            &#39;id&#39;: &#39;ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4627"><a id="__codelineno-0-4627" name="__codelineno-0-4627"></a><span class="sd">            &#39;lastModifiedDateTime&#39;: &#39;2025-02-10T20:37:11Z&#39;,</span>
</span><span id="__span-0-4628"><a id="__codelineno-0-4628" name="__codelineno-0-4628"></a><span class="sd">            &#39;name&#39;: &#39;TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4629"><a id="__codelineno-0-4629" name="__codelineno-0-4629"></a><span class="sd">            &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4630"><a id="__codelineno-0-4630" name="__codelineno-0-4630"></a><span class="sd">            &#39;displayName&#39;: &#39;TG11 - Trad.Good 11,PD,Reg.Trading&#39;,</span>
</span><span id="__span-0-4631"><a id="__codelineno-0-4631" name="__codelineno-0-4631"></a><span class="sd">            &#39;root&#39;: {},</span>
</span><span id="__span-0-4632"><a id="__codelineno-0-4632" name="__codelineno-0-4632"></a><span class="sd">            &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4633"><a id="__codelineno-0-4633" name="__codelineno-0-4633"></a><span class="sd">                &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4634"><a id="__codelineno-0-4634" name="__codelineno-0-4634"></a><span class="sd">            }</span>
</span><span id="__span-0-4635"><a id="__codelineno-0-4635" name="__codelineno-0-4635"></a><span class="sd">        }</span>
</span><span id="__span-0-4636"><a id="__codelineno-0-4636" name="__codelineno-0-4636"></a>
</span><span id="__span-0-4637"><a id="__codelineno-0-4637" name="__codelineno-0-4637"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4638"><a id="__codelineno-0-4638" name="__codelineno-0-4638"></a>
</span><span id="__span-0-4639"><a id="__codelineno-0-4639" name="__codelineno-0-4639"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-4640"><a id="__codelineno-0-4640" name="__codelineno-0-4640"></a>
</span><span id="__span-0-4641"><a id="__codelineno-0-4641" name="__codelineno-0-4641"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4642"><a id="__codelineno-0-4642" name="__codelineno-0-4642"></a>
</span><span id="__span-0-4643"><a id="__codelineno-0-4643" name="__codelineno-0-4643"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4644"><a id="__codelineno-0-4644" name="__codelineno-0-4644"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4645"><a id="__codelineno-0-4645" name="__codelineno-0-4645"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4646"><a id="__codelineno-0-4646" name="__codelineno-0-4646"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4647"><a id="__codelineno-0-4647" name="__codelineno-0-4647"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4648"><a id="__codelineno-0-4648" name="__codelineno-0-4648"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint site with ID -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_id</span><span class="p">),</span>
</span><span id="__span-0-4649"><a id="__codelineno-0-4649" name="__codelineno-0-4649"></a>        <span class="p">)</span>
</span><span id="__span-0-4650"><a id="__codelineno-0-4650" name="__codelineno-0-4650"></a>
</span><span id="__span-0-4651"><a id="__codelineno-0-4651" name="__codelineno-0-4651"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4652"><a id="__codelineno-0-4652" name="__codelineno-0-4652"></a>
</span><span id="__span-0-4653"><a id="__codelineno-0-4653" name="__codelineno-0-4653"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4654"><a id="__codelineno-0-4654" name="__codelineno-0-4654"></a>
</span><span id="__span-0-4655"><a id="__codelineno-0-4655" name="__codelineno-0-4655"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_site_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4656"><a id="__codelineno-0-4656" name="__codelineno-0-4656"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a SharePoint site by its name.</span>
</span><span id="__span-0-4657"><a id="__codelineno-0-4657" name="__codelineno-0-4657"></a>
</span><span id="__span-0-4658"><a id="__codelineno-0-4658" name="__codelineno-0-4658"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4659"><a id="__codelineno-0-4659" name="__codelineno-0-4659"></a><span class="sd">            site_name (str):</span>
</span><span id="__span-0-4660"><a id="__codelineno-0-4660" name="__codelineno-0-4660"></a><span class="sd">                The name of the SharePoint site to retrieve.</span>
</span><span id="__span-0-4661"><a id="__codelineno-0-4661" name="__codelineno-0-4661"></a>
</span><span id="__span-0-4662"><a id="__codelineno-0-4662" name="__codelineno-0-4662"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4663"><a id="__codelineno-0-4663" name="__codelineno-0-4663"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-4664"><a id="__codelineno-0-4664" name="__codelineno-0-4664"></a><span class="sd">                The data of the SharePoint site.</span>
</span><span id="__span-0-4665"><a id="__codelineno-0-4665" name="__codelineno-0-4665"></a>
</span><span id="__span-0-4666"><a id="__codelineno-0-4666" name="__codelineno-0-4666"></a><span class="sd">        Example:</span>
</span><span id="__span-0-4667"><a id="__codelineno-0-4667" name="__codelineno-0-4667"></a><span class="sd">        {</span>
</span><span id="__span-0-4668"><a id="__codelineno-0-4668" name="__codelineno-0-4668"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites/$entity&#39;,</span>
</span><span id="__span-0-4669"><a id="__codelineno-0-4669" name="__codelineno-0-4669"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2025-02-06T07:41:53.41Z&#39;,</span>
</span><span id="__span-0-4670"><a id="__codelineno-0-4670" name="__codelineno-0-4670"></a><span class="sd">            &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-4671"><a id="__codelineno-0-4671" name="__codelineno-0-4671"></a><span class="sd">            &#39;id&#39;: &#39;ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4672"><a id="__codelineno-0-4672" name="__codelineno-0-4672"></a><span class="sd">            &#39;lastModifiedDateTime&#39;: &#39;2025-02-10T20:37:11Z&#39;,</span>
</span><span id="__span-0-4673"><a id="__codelineno-0-4673" name="__codelineno-0-4673"></a><span class="sd">            &#39;name&#39;: &#39;TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4674"><a id="__codelineno-0-4674" name="__codelineno-0-4674"></a><span class="sd">            &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4675"><a id="__codelineno-0-4675" name="__codelineno-0-4675"></a><span class="sd">            &#39;displayName&#39;: &#39;TG11 - Trad.Good 11,PD,Reg.Trading&#39;,</span>
</span><span id="__span-0-4676"><a id="__codelineno-0-4676" name="__codelineno-0-4676"></a><span class="sd">            &#39;root&#39;: {},</span>
</span><span id="__span-0-4677"><a id="__codelineno-0-4677" name="__codelineno-0-4677"></a><span class="sd">            &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4678"><a id="__codelineno-0-4678" name="__codelineno-0-4678"></a><span class="sd">                &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4679"><a id="__codelineno-0-4679" name="__codelineno-0-4679"></a><span class="sd">            }</span>
</span><span id="__span-0-4680"><a id="__codelineno-0-4680" name="__codelineno-0-4680"></a><span class="sd">        }</span>
</span><span id="__span-0-4681"><a id="__codelineno-0-4681" name="__codelineno-0-4681"></a>
</span><span id="__span-0-4682"><a id="__codelineno-0-4682" name="__codelineno-0-4682"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4683"><a id="__codelineno-0-4683" name="__codelineno-0-4683"></a>
</span><span id="__span-0-4684"><a id="__codelineno-0-4684" name="__codelineno-0-4684"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?search=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_name</span><span class="p">)</span>
</span><span id="__span-0-4685"><a id="__codelineno-0-4685" name="__codelineno-0-4685"></a>
</span><span id="__span-0-4686"><a id="__codelineno-0-4686" name="__codelineno-0-4686"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4687"><a id="__codelineno-0-4687" name="__codelineno-0-4687"></a>
</span><span id="__span-0-4688"><a id="__codelineno-0-4688" name="__codelineno-0-4688"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4689"><a id="__codelineno-0-4689" name="__codelineno-0-4689"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4690"><a id="__codelineno-0-4690" name="__codelineno-0-4690"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4691"><a id="__codelineno-0-4691" name="__codelineno-0-4691"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4692"><a id="__codelineno-0-4692" name="__codelineno-0-4692"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4693"><a id="__codelineno-0-4693" name="__codelineno-0-4693"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_name</span><span class="p">),</span>
</span><span id="__span-0-4694"><a id="__codelineno-0-4694" name="__codelineno-0-4694"></a>        <span class="p">)</span>
</span><span id="__span-0-4695"><a id="__codelineno-0-4695" name="__codelineno-0-4695"></a>
</span><span id="__span-0-4696"><a id="__codelineno-0-4696" name="__codelineno-0-4696"></a>        <span class="c1"># As we lookup the site by search we could have multiple results.</span>
</span><span id="__span-0-4697"><a id="__codelineno-0-4697" name="__codelineno-0-4697"></a>        <span class="c1"># The Graph API does not do an exact match. So we check the results</span>
</span><span id="__span-0-4698"><a id="__codelineno-0-4698" name="__codelineno-0-4698"></a>        <span class="c1"># for an exact match:</span>
</span><span id="__span-0-4699"><a id="__codelineno-0-4699" name="__codelineno-0-4699"></a>        <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-4700"><a id="__codelineno-0-4700" name="__codelineno-0-4700"></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-0-4701"><a id="__codelineno-0-4701" name="__codelineno-0-4701"></a>            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-4702"><a id="__codelineno-0-4702" name="__codelineno-0-4702"></a>                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">site_name</span><span class="p">:</span>
</span><span id="__span-0-4703"><a id="__codelineno-0-4703" name="__codelineno-0-4703"></a>                    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-0-4704"><a id="__codelineno-0-4704" name="__codelineno-0-4704"></a>
</span><span id="__span-0-4705"><a id="__codelineno-0-4705" name="__codelineno-0-4705"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-4706"><a id="__codelineno-0-4706" name="__codelineno-0-4706"></a>
</span><span id="__span-0-4707"><a id="__codelineno-0-4707" name="__codelineno-0-4707"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4708"><a id="__codelineno-0-4708" name="__codelineno-0-4708"></a>
</span><span id="__span-0-4709"><a id="__codelineno-0-4709" name="__codelineno-0-4709"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_site_for_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4710"><a id="__codelineno-0-4710" name="__codelineno-0-4710"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a SharePoint site for a M365 group.</span>
</span><span id="__span-0-4711"><a id="__codelineno-0-4711" name="__codelineno-0-4711"></a>
</span><span id="__span-0-4712"><a id="__codelineno-0-4712" name="__codelineno-0-4712"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4713"><a id="__codelineno-0-4713" name="__codelineno-0-4713"></a><span class="sd">            group_id (str):</span>
</span><span id="__span-0-4714"><a id="__codelineno-0-4714" name="__codelineno-0-4714"></a><span class="sd">                The ID of the M365 group the site should be retrieved for.</span>
</span><span id="__span-0-4715"><a id="__codelineno-0-4715" name="__codelineno-0-4715"></a>
</span><span id="__span-0-4716"><a id="__codelineno-0-4716" name="__codelineno-0-4716"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4717"><a id="__codelineno-0-4717" name="__codelineno-0-4717"></a><span class="sd">            dict:</span>
</span><span id="__span-0-4718"><a id="__codelineno-0-4718" name="__codelineno-0-4718"></a><span class="sd">                The data of the SharePoint site.</span>
</span><span id="__span-0-4719"><a id="__codelineno-0-4719" name="__codelineno-0-4719"></a>
</span><span id="__span-0-4720"><a id="__codelineno-0-4720" name="__codelineno-0-4720"></a><span class="sd">        Example:</span>
</span><span id="__span-0-4721"><a id="__codelineno-0-4721" name="__codelineno-0-4721"></a><span class="sd">        {</span>
</span><span id="__span-0-4722"><a id="__codelineno-0-4722" name="__codelineno-0-4722"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites/$entity&#39;,</span>
</span><span id="__span-0-4723"><a id="__codelineno-0-4723" name="__codelineno-0-4723"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2025-02-06T07:41:53.41Z&#39;,</span>
</span><span id="__span-0-4724"><a id="__codelineno-0-4724" name="__codelineno-0-4724"></a><span class="sd">            &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-4725"><a id="__codelineno-0-4725" name="__codelineno-0-4725"></a><span class="sd">            &#39;id&#39;: &#39;ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4726"><a id="__codelineno-0-4726" name="__codelineno-0-4726"></a><span class="sd">            &#39;lastModifiedDateTime&#39;: &#39;2025-02-10T20:37:11Z&#39;,</span>
</span><span id="__span-0-4727"><a id="__codelineno-0-4727" name="__codelineno-0-4727"></a><span class="sd">            &#39;name&#39;: &#39;TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4728"><a id="__codelineno-0-4728" name="__codelineno-0-4728"></a><span class="sd">            &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4729"><a id="__codelineno-0-4729" name="__codelineno-0-4729"></a><span class="sd">            &#39;displayName&#39;: &#39;TG11 - Trad.Good 11,PD,Reg.Trading&#39;,</span>
</span><span id="__span-0-4730"><a id="__codelineno-0-4730" name="__codelineno-0-4730"></a><span class="sd">            &#39;root&#39;: {},</span>
</span><span id="__span-0-4731"><a id="__codelineno-0-4731" name="__codelineno-0-4731"></a><span class="sd">            &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4732"><a id="__codelineno-0-4732" name="__codelineno-0-4732"></a><span class="sd">                &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4733"><a id="__codelineno-0-4733" name="__codelineno-0-4733"></a><span class="sd">            }</span>
</span><span id="__span-0-4734"><a id="__codelineno-0-4734" name="__codelineno-0-4734"></a><span class="sd">        }</span>
</span><span id="__span-0-4735"><a id="__codelineno-0-4735" name="__codelineno-0-4735"></a>
</span><span id="__span-0-4736"><a id="__codelineno-0-4736" name="__codelineno-0-4736"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4737"><a id="__codelineno-0-4737" name="__codelineno-0-4737"></a>
</span><span id="__span-0-4738"><a id="__codelineno-0-4738" name="__codelineno-0-4738"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/sites/root&quot;</span>
</span><span id="__span-0-4739"><a id="__codelineno-0-4739" name="__codelineno-0-4739"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4740"><a id="__codelineno-0-4740" name="__codelineno-0-4740"></a>
</span><span id="__span-0-4741"><a id="__codelineno-0-4741" name="__codelineno-0-4741"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4742"><a id="__codelineno-0-4742" name="__codelineno-0-4742"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4743"><a id="__codelineno-0-4743" name="__codelineno-0-4743"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4744"><a id="__codelineno-0-4744" name="__codelineno-0-4744"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4745"><a id="__codelineno-0-4745" name="__codelineno-0-4745"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4746"><a id="__codelineno-0-4746" name="__codelineno-0-4746"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint site for group with ID -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group_id</span><span class="p">),</span>
</span><span id="__span-0-4747"><a id="__codelineno-0-4747" name="__codelineno-0-4747"></a>        <span class="p">)</span>
</span><span id="__span-0-4748"><a id="__codelineno-0-4748" name="__codelineno-0-4748"></a>
</span><span id="__span-0-4749"><a id="__codelineno-0-4749" name="__codelineno-0-4749"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4750"><a id="__codelineno-0-4750" name="__codelineno-0-4750"></a>
</span><span id="__span-0-4751"><a id="__codelineno-0-4751" name="__codelineno-0-4751"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4752"><a id="__codelineno-0-4752" name="__codelineno-0-4752"></a>
</span><span id="__span-0-4753"><a id="__codelineno-0-4753" name="__codelineno-0-4753"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4754"><a id="__codelineno-0-4754" name="__codelineno-0-4754"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a list of SharePoint site pages accessible to the authenticated user.</span>
</span><span id="__span-0-4755"><a id="__codelineno-0-4755" name="__codelineno-0-4755"></a>
</span><span id="__span-0-4756"><a id="__codelineno-0-4756" name="__codelineno-0-4756"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4757"><a id="__codelineno-0-4757" name="__codelineno-0-4757"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-4758"><a id="__codelineno-0-4758" name="__codelineno-0-4758"></a><span class="sd">                The ID of the SharePoint site the pages should be retrieved for.</span>
</span><span id="__span-0-4759"><a id="__codelineno-0-4759" name="__codelineno-0-4759"></a>
</span><span id="__span-0-4760"><a id="__codelineno-0-4760" name="__codelineno-0-4760"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4761"><a id="__codelineno-0-4761" name="__codelineno-0-4761"></a><span class="sd">            dict:</span>
</span><span id="__span-0-4762"><a id="__codelineno-0-4762" name="__codelineno-0-4762"></a><span class="sd">                A dictionary including the list of SharePoint pages for a given page.</span>
</span><span id="__span-0-4763"><a id="__codelineno-0-4763" name="__codelineno-0-4763"></a><span class="sd">                The actual list is included inside the &quot;value&quot; key of the dictionary.</span>
</span><span id="__span-0-4764"><a id="__codelineno-0-4764" name="__codelineno-0-4764"></a>
</span><span id="__span-0-4765"><a id="__codelineno-0-4765" name="__codelineno-0-4765"></a><span class="sd">        Example:</span>
</span><span id="__span-0-4766"><a id="__codelineno-0-4766" name="__codelineno-0-4766"></a><span class="sd">        {</span>
</span><span id="__span-0-4767"><a id="__codelineno-0-4767" name="__codelineno-0-4767"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages&quot;,</span>
</span><span id="__span-0-4768"><a id="__codelineno-0-4768" name="__codelineno-0-4768"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-4769"><a id="__codelineno-0-4769" name="__codelineno-0-4769"></a><span class="sd">                {</span>
</span><span id="__span-0-4770"><a id="__codelineno-0-4770" name="__codelineno-0-4770"></a><span class="sd">                    &#39;@odata.type&#39;: &#39;#microsoft.graph.sitePage&#39;,</span>
</span><span id="__span-0-4771"><a id="__codelineno-0-4771" name="__codelineno-0-4771"></a><span class="sd">                    &#39;@odata.etag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4772"><a id="__codelineno-0-4772" name="__codelineno-0-4772"></a><span class="sd">                    &#39;createdDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4773"><a id="__codelineno-0-4773" name="__codelineno-0-4773"></a><span class="sd">                    &#39;eTag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4774"><a id="__codelineno-0-4774" name="__codelineno-0-4774"></a><span class="sd">                    &#39;id&#39;: &#39;a546ce61-21e6-431d-b2cd-67d1f722be5f&#39;,</span>
</span><span id="__span-0-4775"><a id="__codelineno-0-4775" name="__codelineno-0-4775"></a><span class="sd">                    &#39;lastModifiedDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4776"><a id="__codelineno-0-4776" name="__codelineno-0-4776"></a><span class="sd">                    &#39;name&#39;: &#39;Home.aspx&#39;,</span>
</span><span id="__span-0-4777"><a id="__codelineno-0-4777" name="__codelineno-0-4777"></a><span class="sd">                    &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795/SitePages/Home.aspx&#39;,</span>
</span><span id="__span-0-4778"><a id="__codelineno-0-4778" name="__codelineno-0-4778"></a><span class="sd">                    &#39;title&#39;: &#39;Home&#39;,</span>
</span><span id="__span-0-4779"><a id="__codelineno-0-4779" name="__codelineno-0-4779"></a><span class="sd">                    &#39;pageLayout&#39;: &#39;home&#39;,</span>
</span><span id="__span-0-4780"><a id="__codelineno-0-4780" name="__codelineno-0-4780"></a><span class="sd">                    &#39;promotionKind&#39;: &#39;page&#39;,</span>
</span><span id="__span-0-4781"><a id="__codelineno-0-4781" name="__codelineno-0-4781"></a><span class="sd">                    &#39;showComments&#39;: False,</span>
</span><span id="__span-0-4782"><a id="__codelineno-0-4782" name="__codelineno-0-4782"></a><span class="sd">                    &#39;showRecommendedPages&#39;: False,</span>
</span><span id="__span-0-4783"><a id="__codelineno-0-4783" name="__codelineno-0-4783"></a><span class="sd">                    &#39;contentType&#39;: {</span>
</span><span id="__span-0-4784"><a id="__codelineno-0-4784" name="__codelineno-0-4784"></a><span class="sd">                        &#39;id&#39;: &#39;0x0101009D1CB255DA76424F860D91F20E6C411800813863BBF9FE6A408AE59965D98FE3DA&#39;,</span>
</span><span id="__span-0-4785"><a id="__codelineno-0-4785" name="__codelineno-0-4785"></a><span class="sd">                        &#39;name&#39;: &#39;Site Page&#39;</span>
</span><span id="__span-0-4786"><a id="__codelineno-0-4786" name="__codelineno-0-4786"></a><span class="sd">                    },</span>
</span><span id="__span-0-4787"><a id="__codelineno-0-4787" name="__codelineno-0-4787"></a><span class="sd">                    &#39;createdBy&#39;: {&#39;user&#39;: {&#39;displayName&#39;: &#39;System Account&#39;}},</span>
</span><span id="__span-0-4788"><a id="__codelineno-0-4788" name="__codelineno-0-4788"></a><span class="sd">                    &#39;lastModifiedBy&#39;: {&#39;user&#39;: {&#39;displayName&#39;: &#39;Terrarium Admin&#39;, &#39;email&#39;: &#39;admin@dev.idea-te.eimdemo.com&#39;}},</span>
</span><span id="__span-0-4789"><a id="__codelineno-0-4789" name="__codelineno-0-4789"></a><span class="sd">                    &#39;parentReference&#39;: {&#39;siteId&#39;: &#39;61c0f9cb-39d3-4c04-b60c-31576954a2ab&#39;},</span>
</span><span id="__span-0-4790"><a id="__codelineno-0-4790" name="__codelineno-0-4790"></a><span class="sd">                    &#39;publishingState&#39;: {&#39;level&#39;: &#39;published&#39;, &#39;versionId&#39;: &#39;4.0&#39;},</span>
</span><span id="__span-0-4791"><a id="__codelineno-0-4791" name="__codelineno-0-4791"></a><span class="sd">                    &#39;reactions&#39;: {}</span>
</span><span id="__span-0-4792"><a id="__codelineno-0-4792" name="__codelineno-0-4792"></a><span class="sd">                },</span>
</span><span id="__span-0-4793"><a id="__codelineno-0-4793" name="__codelineno-0-4793"></a><span class="sd">                ...</span>
</span><span id="__span-0-4794"><a id="__codelineno-0-4794" name="__codelineno-0-4794"></a><span class="sd">            ]</span>
</span><span id="__span-0-4795"><a id="__codelineno-0-4795" name="__codelineno-0-4795"></a><span class="sd">        }</span>
</span><span id="__span-0-4796"><a id="__codelineno-0-4796" name="__codelineno-0-4796"></a>
</span><span id="__span-0-4797"><a id="__codelineno-0-4797" name="__codelineno-0-4797"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4798"><a id="__codelineno-0-4798" name="__codelineno-0-4798"></a>
</span><span id="__span-0-4799"><a id="__codelineno-0-4799" name="__codelineno-0-4799"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/pages&quot;</span>
</span><span id="__span-0-4800"><a id="__codelineno-0-4800" name="__codelineno-0-4800"></a>
</span><span id="__span-0-4801"><a id="__codelineno-0-4801" name="__codelineno-0-4801"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4802"><a id="__codelineno-0-4802" name="__codelineno-0-4802"></a>
</span><span id="__span-0-4803"><a id="__codelineno-0-4803" name="__codelineno-0-4803"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4804"><a id="__codelineno-0-4804" name="__codelineno-0-4804"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4805"><a id="__codelineno-0-4805" name="__codelineno-0-4805"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4806"><a id="__codelineno-0-4806" name="__codelineno-0-4806"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4807"><a id="__codelineno-0-4807" name="__codelineno-0-4807"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4808"><a id="__codelineno-0-4808" name="__codelineno-0-4808"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get pages of SharePoint site with ID -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_id</span><span class="p">),</span>
</span><span id="__span-0-4809"><a id="__codelineno-0-4809" name="__codelineno-0-4809"></a>        <span class="p">)</span>
</span><span id="__span-0-4810"><a id="__codelineno-0-4810" name="__codelineno-0-4810"></a>
</span><span id="__span-0-4811"><a id="__codelineno-0-4811" name="__codelineno-0-4811"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4812"><a id="__codelineno-0-4812" name="__codelineno-0-4812"></a>
</span><span id="__span-0-4813"><a id="__codelineno-0-4813" name="__codelineno-0-4813"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4814"><a id="__codelineno-0-4814" name="__codelineno-0-4814"></a>
</span><span id="__span-0-4815"><a id="__codelineno-0-4815" name="__codelineno-0-4815"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4816"><a id="__codelineno-0-4816" name="__codelineno-0-4816"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a page of a SharePoint site accessible to the authenticated user.</span>
</span><span id="__span-0-4817"><a id="__codelineno-0-4817" name="__codelineno-0-4817"></a>
</span><span id="__span-0-4818"><a id="__codelineno-0-4818" name="__codelineno-0-4818"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4819"><a id="__codelineno-0-4819" name="__codelineno-0-4819"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-4820"><a id="__codelineno-0-4820" name="__codelineno-0-4820"></a><span class="sd">                The ID of the SharePoint site the page should be get for.</span>
</span><span id="__span-0-4821"><a id="__codelineno-0-4821" name="__codelineno-0-4821"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-4822"><a id="__codelineno-0-4822" name="__codelineno-0-4822"></a><span class="sd">                The ID of the page to be retrieved.</span>
</span><span id="__span-0-4823"><a id="__codelineno-0-4823" name="__codelineno-0-4823"></a>
</span><span id="__span-0-4824"><a id="__codelineno-0-4824" name="__codelineno-0-4824"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4825"><a id="__codelineno-0-4825" name="__codelineno-0-4825"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-4826"><a id="__codelineno-0-4826" name="__codelineno-0-4826"></a><span class="sd">                A SharePoint site page.</span>
</span><span id="__span-0-4827"><a id="__codelineno-0-4827" name="__codelineno-0-4827"></a>
</span><span id="__span-0-4828"><a id="__codelineno-0-4828" name="__codelineno-0-4828"></a><span class="sd">        Example:</span>
</span><span id="__span-0-4829"><a id="__codelineno-0-4829" name="__codelineno-0-4829"></a><span class="sd">        {</span>
</span><span id="__span-0-4830"><a id="__codelineno-0-4830" name="__codelineno-0-4830"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C9b203cbe-27ca-45b2-944a-663cc99e5e8f%2Ca1462b54-26f9-4a24-9660-2bc7859ce9af&#39;)/pages/$entity&quot;,</span>
</span><span id="__span-0-4831"><a id="__codelineno-0-4831" name="__codelineno-0-4831"></a><span class="sd">            &#39;@odata.type&#39;: &#39;#microsoft.graph.sitePage&#39;,</span>
</span><span id="__span-0-4832"><a id="__codelineno-0-4832" name="__codelineno-0-4832"></a><span class="sd">            &#39;@odata.etag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4833"><a id="__codelineno-0-4833" name="__codelineno-0-4833"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4834"><a id="__codelineno-0-4834" name="__codelineno-0-4834"></a><span class="sd">            &#39;eTag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4835"><a id="__codelineno-0-4835" name="__codelineno-0-4835"></a><span class="sd">            &#39;id&#39;: &#39;a546ce61-21e6-431d-b2cd-67d1f722be5f&#39;,</span>
</span><span id="__span-0-4836"><a id="__codelineno-0-4836" name="__codelineno-0-4836"></a><span class="sd">            &#39;lastModifiedDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4837"><a id="__codelineno-0-4837" name="__codelineno-0-4837"></a><span class="sd">            &#39;name&#39;: &#39;Home.aspx&#39;,</span>
</span><span id="__span-0-4838"><a id="__codelineno-0-4838" name="__codelineno-0-4838"></a><span class="sd">            &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795/SitePages/Home.aspx&#39;,</span>
</span><span id="__span-0-4839"><a id="__codelineno-0-4839" name="__codelineno-0-4839"></a><span class="sd">            &#39;title&#39;: &#39;Home&#39;,</span>
</span><span id="__span-0-4840"><a id="__codelineno-0-4840" name="__codelineno-0-4840"></a><span class="sd">            &#39;pageLayout&#39;: &#39;home&#39;,</span>
</span><span id="__span-0-4841"><a id="__codelineno-0-4841" name="__codelineno-0-4841"></a><span class="sd">            &#39;promotionKind&#39;: &#39;page&#39;,</span>
</span><span id="__span-0-4842"><a id="__codelineno-0-4842" name="__codelineno-0-4842"></a><span class="sd">            &#39;showComments&#39;: False,</span>
</span><span id="__span-0-4843"><a id="__codelineno-0-4843" name="__codelineno-0-4843"></a><span class="sd">            &#39;showRecommendedPages&#39;: False,</span>
</span><span id="__span-0-4844"><a id="__codelineno-0-4844" name="__codelineno-0-4844"></a><span class="sd">            &#39;contentType&#39;: {</span>
</span><span id="__span-0-4845"><a id="__codelineno-0-4845" name="__codelineno-0-4845"></a><span class="sd">                &#39;id&#39;: &#39;0x0101009D1CB255DA76424F860D91F20E6C4118003CD261A156017A45BA0F28B5923AE8F6&#39;,</span>
</span><span id="__span-0-4846"><a id="__codelineno-0-4846" name="__codelineno-0-4846"></a><span class="sd">                &#39;name&#39;: &#39;Site Page&#39;</span>
</span><span id="__span-0-4847"><a id="__codelineno-0-4847" name="__codelineno-0-4847"></a><span class="sd">            },</span>
</span><span id="__span-0-4848"><a id="__codelineno-0-4848" name="__codelineno-0-4848"></a><span class="sd">            &#39;createdBy&#39;: {</span>
</span><span id="__span-0-4849"><a id="__codelineno-0-4849" name="__codelineno-0-4849"></a><span class="sd">                &#39;user&#39;: {...}</span>
</span><span id="__span-0-4850"><a id="__codelineno-0-4850" name="__codelineno-0-4850"></a><span class="sd">            },</span>
</span><span id="__span-0-4851"><a id="__codelineno-0-4851" name="__codelineno-0-4851"></a><span class="sd">            &#39;lastModifiedBy&#39;: {</span>
</span><span id="__span-0-4852"><a id="__codelineno-0-4852" name="__codelineno-0-4852"></a><span class="sd">                &#39;user&#39;: {...}</span>
</span><span id="__span-0-4853"><a id="__codelineno-0-4853" name="__codelineno-0-4853"></a><span class="sd">            },</span>
</span><span id="__span-0-4854"><a id="__codelineno-0-4854" name="__codelineno-0-4854"></a><span class="sd">            &#39;parentReference&#39;: {</span>
</span><span id="__span-0-4855"><a id="__codelineno-0-4855" name="__codelineno-0-4855"></a><span class="sd">                &#39;siteId&#39;: &#39;9b203cbe-27ca-45b2-944a-663cc99e5e8f&#39;</span>
</span><span id="__span-0-4856"><a id="__codelineno-0-4856" name="__codelineno-0-4856"></a><span class="sd">            },</span>
</span><span id="__span-0-4857"><a id="__codelineno-0-4857" name="__codelineno-0-4857"></a><span class="sd">            &#39;publishingState&#39;: {</span>
</span><span id="__span-0-4858"><a id="__codelineno-0-4858" name="__codelineno-0-4858"></a><span class="sd">                &#39;level&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-4859"><a id="__codelineno-0-4859" name="__codelineno-0-4859"></a><span class="sd">                &#39;versionId&#39;: &#39;1.0&#39;</span>
</span><span id="__span-0-4860"><a id="__codelineno-0-4860" name="__codelineno-0-4860"></a><span class="sd">            },</span>
</span><span id="__span-0-4861"><a id="__codelineno-0-4861" name="__codelineno-0-4861"></a><span class="sd">            &#39;reactions&#39;: {}</span>
</span><span id="__span-0-4862"><a id="__codelineno-0-4862" name="__codelineno-0-4862"></a><span class="sd">        }</span>
</span><span id="__span-0-4863"><a id="__codelineno-0-4863" name="__codelineno-0-4863"></a>
</span><span id="__span-0-4864"><a id="__codelineno-0-4864" name="__codelineno-0-4864"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4865"><a id="__codelineno-0-4865" name="__codelineno-0-4865"></a>
</span><span id="__span-0-4866"><a id="__codelineno-0-4866" name="__codelineno-0-4866"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span> <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-4867"><a id="__codelineno-0-4867" name="__codelineno-0-4867"></a>
</span><span id="__span-0-4868"><a id="__codelineno-0-4868" name="__codelineno-0-4868"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4869"><a id="__codelineno-0-4869" name="__codelineno-0-4869"></a>
</span><span id="__span-0-4870"><a id="__codelineno-0-4870" name="__codelineno-0-4870"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4871"><a id="__codelineno-0-4871" name="__codelineno-0-4871"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4872"><a id="__codelineno-0-4872" name="__codelineno-0-4872"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4873"><a id="__codelineno-0-4873" name="__codelineno-0-4873"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4874"><a id="__codelineno-0-4874" name="__codelineno-0-4874"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4875"><a id="__codelineno-0-4875" name="__codelineno-0-4875"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; for site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">page_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">),</span>
</span><span id="__span-0-4876"><a id="__codelineno-0-4876" name="__codelineno-0-4876"></a>        <span class="p">)</span>
</span><span id="__span-0-4877"><a id="__codelineno-0-4877" name="__codelineno-0-4877"></a>
</span><span id="__span-0-4878"><a id="__codelineno-0-4878" name="__codelineno-0-4878"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4879"><a id="__codelineno-0-4879" name="__codelineno-0-4879"></a>
</span><span id="__span-0-4880"><a id="__codelineno-0-4880" name="__codelineno-0-4880"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4881"><a id="__codelineno-0-4881" name="__codelineno-0-4881"></a>
</span><span id="__span-0-4882"><a id="__codelineno-0-4882" name="__codelineno-0-4882"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_sharepoint_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">publish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4883"><a id="__codelineno-0-4883" name="__codelineno-0-4883"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new SharePoint site page using Microsoft Graph API.</span>
</span><span id="__span-0-4884"><a id="__codelineno-0-4884" name="__codelineno-0-4884"></a>
</span><span id="__span-0-4885"><a id="__codelineno-0-4885" name="__codelineno-0-4885"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4886"><a id="__codelineno-0-4886" name="__codelineno-0-4886"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-4887"><a id="__codelineno-0-4887" name="__codelineno-0-4887"></a><span class="sd">                The ID of the SharePoint site the page should be created on.</span>
</span><span id="__span-0-4888"><a id="__codelineno-0-4888" name="__codelineno-0-4888"></a><span class="sd">            page_name (str):</span>
</span><span id="__span-0-4889"><a id="__codelineno-0-4889" name="__codelineno-0-4889"></a><span class="sd">                The name/title of the new page.</span>
</span><span id="__span-0-4890"><a id="__codelineno-0-4890" name="__codelineno-0-4890"></a><span class="sd">            publish (bool, optional):</span>
</span><span id="__span-0-4891"><a id="__codelineno-0-4891" name="__codelineno-0-4891"></a><span class="sd">                If True, the page is immediately published.</span>
</span><span id="__span-0-4892"><a id="__codelineno-0-4892" name="__codelineno-0-4892"></a>
</span><span id="__span-0-4893"><a id="__codelineno-0-4893" name="__codelineno-0-4893"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4894"><a id="__codelineno-0-4894" name="__codelineno-0-4894"></a><span class="sd">            dict:</span>
</span><span id="__span-0-4895"><a id="__codelineno-0-4895" name="__codelineno-0-4895"></a><span class="sd">                Details of the created SharePoint page or an error response.</span>
</span><span id="__span-0-4896"><a id="__codelineno-0-4896" name="__codelineno-0-4896"></a>
</span><span id="__span-0-4897"><a id="__codelineno-0-4897" name="__codelineno-0-4897"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4898"><a id="__codelineno-0-4898" name="__codelineno-0-4898"></a>
</span><span id="__span-0-4899"><a id="__codelineno-0-4899" name="__codelineno-0-4899"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages&quot;</span>
</span><span id="__span-0-4900"><a id="__codelineno-0-4900" name="__codelineno-0-4900"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4901"><a id="__codelineno-0-4901" name="__codelineno-0-4901"></a>
</span><span id="__span-0-4902"><a id="__codelineno-0-4902" name="__codelineno-0-4902"></a>        <span class="c1"># Page payload for a basic site page</span>
</span><span id="__span-0-4903"><a id="__codelineno-0-4903" name="__codelineno-0-4903"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-4904"><a id="__codelineno-0-4904" name="__codelineno-0-4904"></a>            <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.sitePage&quot;</span><span class="p">,</span>
</span><span id="__span-0-4905"><a id="__codelineno-0-4905" name="__codelineno-0-4905"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">page_name</span> <span class="o">+</span> <span class="s2">&quot;.aspx&quot;</span><span class="p">,</span>
</span><span id="__span-0-4906"><a id="__codelineno-0-4906" name="__codelineno-0-4906"></a>            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">page_name</span><span class="p">,</span>
</span><span id="__span-0-4907"><a id="__codelineno-0-4907" name="__codelineno-0-4907"></a>            <span class="s2">&quot;publishingState&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-4908"><a id="__codelineno-0-4908" name="__codelineno-0-4908"></a>                <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;published&quot;</span><span class="p">,</span>
</span><span id="__span-0-4909"><a id="__codelineno-0-4909" name="__codelineno-0-4909"></a>            <span class="p">},</span>
</span><span id="__span-0-4910"><a id="__codelineno-0-4910" name="__codelineno-0-4910"></a>        <span class="p">}</span>
</span><span id="__span-0-4911"><a id="__codelineno-0-4911" name="__codelineno-0-4911"></a>
</span><span id="__span-0-4912"><a id="__codelineno-0-4912" name="__codelineno-0-4912"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4913"><a id="__codelineno-0-4913" name="__codelineno-0-4913"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4914"><a id="__codelineno-0-4914" name="__codelineno-0-4914"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-4915"><a id="__codelineno-0-4915" name="__codelineno-0-4915"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4916"><a id="__codelineno-0-4916" name="__codelineno-0-4916"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-4917"><a id="__codelineno-0-4917" name="__codelineno-0-4917"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4918"><a id="__codelineno-0-4918" name="__codelineno-0-4918"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to create SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4919"><a id="__codelineno-0-4919" name="__codelineno-0-4919"></a>                <span class="n">page_name</span><span class="p">,</span>
</span><span id="__span-0-4920"><a id="__codelineno-0-4920" name="__codelineno-0-4920"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-4921"><a id="__codelineno-0-4921" name="__codelineno-0-4921"></a>            <span class="p">),</span>
</span><span id="__span-0-4922"><a id="__codelineno-0-4922" name="__codelineno-0-4922"></a>        <span class="p">)</span>
</span><span id="__span-0-4923"><a id="__codelineno-0-4923" name="__codelineno-0-4923"></a>
</span><span id="__span-0-4924"><a id="__codelineno-0-4924" name="__codelineno-0-4924"></a>        <span class="c1"># Check if the page should be directly published:</span>
</span><span id="__span-0-4925"><a id="__codelineno-0-4925" name="__codelineno-0-4925"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">publish</span><span class="p">:</span>
</span><span id="__span-0-4926"><a id="__codelineno-0-4926" name="__codelineno-0-4926"></a>            <span class="n">page_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-4927"><a id="__codelineno-0-4927" name="__codelineno-0-4927"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-4928"><a id="__codelineno-0-4928" name="__codelineno-0-4928"></a>
</span><span id="__span-0-4929"><a id="__codelineno-0-4929" name="__codelineno-0-4929"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-4930"><a id="__codelineno-0-4930" name="__codelineno-0-4930"></a>
</span><span id="__span-0-4931"><a id="__codelineno-0-4931" name="__codelineno-0-4931"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4932"><a id="__codelineno-0-4932" name="__codelineno-0-4932"></a>
</span><span id="__span-0-4933"><a id="__codelineno-0-4933" name="__codelineno-0-4933"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">publish_sharepoint_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-4934"><a id="__codelineno-0-4934" name="__codelineno-0-4934"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Publish a page of a SharePoint site.</span>
</span><span id="__span-0-4935"><a id="__codelineno-0-4935" name="__codelineno-0-4935"></a>
</span><span id="__span-0-4936"><a id="__codelineno-0-4936" name="__codelineno-0-4936"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4937"><a id="__codelineno-0-4937" name="__codelineno-0-4937"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-4938"><a id="__codelineno-0-4938" name="__codelineno-0-4938"></a><span class="sd">                The ID of the SharePoint site the page should be published on.</span>
</span><span id="__span-0-4939"><a id="__codelineno-0-4939" name="__codelineno-0-4939"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-4940"><a id="__codelineno-0-4940" name="__codelineno-0-4940"></a><span class="sd">                The ID of the page to be published.</span>
</span><span id="__span-0-4941"><a id="__codelineno-0-4941" name="__codelineno-0-4941"></a>
</span><span id="__span-0-4942"><a id="__codelineno-0-4942" name="__codelineno-0-4942"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4943"><a id="__codelineno-0-4943" name="__codelineno-0-4943"></a><span class="sd">            bool:</span>
</span><span id="__span-0-4944"><a id="__codelineno-0-4944" name="__codelineno-0-4944"></a><span class="sd">                True = Success, False = Error.</span>
</span><span id="__span-0-4945"><a id="__codelineno-0-4945" name="__codelineno-0-4945"></a>
</span><span id="__span-0-4946"><a id="__codelineno-0-4946" name="__codelineno-0-4946"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-4947"><a id="__codelineno-0-4947" name="__codelineno-0-4947"></a>
</span><span id="__span-0-4948"><a id="__codelineno-0-4948" name="__codelineno-0-4948"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-4949"><a id="__codelineno-0-4949" name="__codelineno-0-4949"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span> <span class="o">+</span> <span class="n">page_id</span> <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/publish&quot;</span>
</span><span id="__span-0-4950"><a id="__codelineno-0-4950" name="__codelineno-0-4950"></a>        <span class="p">)</span>
</span><span id="__span-0-4951"><a id="__codelineno-0-4951" name="__codelineno-0-4951"></a>
</span><span id="__span-0-4952"><a id="__codelineno-0-4952" name="__codelineno-0-4952"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4953"><a id="__codelineno-0-4953" name="__codelineno-0-4953"></a>
</span><span id="__span-0-4954"><a id="__codelineno-0-4954" name="__codelineno-0-4954"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4955"><a id="__codelineno-0-4955" name="__codelineno-0-4955"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4956"><a id="__codelineno-0-4956" name="__codelineno-0-4956"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-4957"><a id="__codelineno-0-4957" name="__codelineno-0-4957"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4958"><a id="__codelineno-0-4958" name="__codelineno-0-4958"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4959"><a id="__codelineno-0-4959" name="__codelineno-0-4959"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot publish SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4960"><a id="__codelineno-0-4960" name="__codelineno-0-4960"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-4961"><a id="__codelineno-0-4961" name="__codelineno-0-4961"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-4962"><a id="__codelineno-0-4962" name="__codelineno-0-4962"></a>            <span class="p">),</span>
</span><span id="__span-0-4963"><a id="__codelineno-0-4963" name="__codelineno-0-4963"></a>            <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4964"><a id="__codelineno-0-4964" name="__codelineno-0-4964"></a>        <span class="p">)</span>
</span><span id="__span-0-4965"><a id="__codelineno-0-4965" name="__codelineno-0-4965"></a>
</span><span id="__span-0-4966"><a id="__codelineno-0-4966" name="__codelineno-0-4966"></a>        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span>
</span><span id="__span-0-4967"><a id="__codelineno-0-4967" name="__codelineno-0-4967"></a>
</span><span id="__span-0-4968"><a id="__codelineno-0-4968" name="__codelineno-0-4968"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-4969"><a id="__codelineno-0-4969" name="__codelineno-0-4969"></a>
</span><span id="__span-0-4970"><a id="__codelineno-0-4970" name="__codelineno-0-4970"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_sections</span><span class="p">(</span>
</span><span id="__span-0-4971"><a id="__codelineno-0-4971" name="__codelineno-0-4971"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4972"><a id="__codelineno-0-4972" name="__codelineno-0-4972"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4973"><a id="__codelineno-0-4973" name="__codelineno-0-4973"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4974"><a id="__codelineno-0-4974" name="__codelineno-0-4974"></a>        <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-4975"><a id="__codelineno-0-4975" name="__codelineno-0-4975"></a>        <span class="n">section_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4976"><a id="__codelineno-0-4976" name="__codelineno-0-4976"></a>        <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4977"><a id="__codelineno-0-4977" name="__codelineno-0-4977"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4978"><a id="__codelineno-0-4978" name="__codelineno-0-4978"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve all sections SharePoint site page.</span>
</span><span id="__span-0-4979"><a id="__codelineno-0-4979" name="__codelineno-0-4979"></a>
</span><span id="__span-0-4980"><a id="__codelineno-0-4980" name="__codelineno-0-4980"></a><span class="sd">        Args:</span>
</span><span id="__span-0-4981"><a id="__codelineno-0-4981" name="__codelineno-0-4981"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-4982"><a id="__codelineno-0-4982" name="__codelineno-0-4982"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-4983"><a id="__codelineno-0-4983" name="__codelineno-0-4983"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-4984"><a id="__codelineno-0-4984" name="__codelineno-0-4984"></a><span class="sd">                The ID of the SharePoint page containing the sections.</span>
</span><span id="__span-0-4985"><a id="__codelineno-0-4985" name="__codelineno-0-4985"></a><span class="sd">            section_type (str, optional):</span>
</span><span id="__span-0-4986"><a id="__codelineno-0-4986" name="__codelineno-0-4986"></a><span class="sd">                &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-4987"><a id="__codelineno-0-4987" name="__codelineno-0-4987"></a><span class="sd">                &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-4988"><a id="__codelineno-0-4988" name="__codelineno-0-4988"></a><span class="sd">            section_id (str | int | None):</span>
</span><span id="__span-0-4989"><a id="__codelineno-0-4989" name="__codelineno-0-4989"></a><span class="sd">                The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-4990"><a id="__codelineno-0-4990" name="__codelineno-0-4990"></a><span class="sd">                Simple values like 1,2,3...</span>
</span><span id="__span-0-4991"><a id="__codelineno-0-4991" name="__codelineno-0-4991"></a><span class="sd">                Should be None for vertical section.</span>
</span><span id="__span-0-4992"><a id="__codelineno-0-4992" name="__codelineno-0-4992"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-4993"><a id="__codelineno-0-4993" name="__codelineno-0-4993"></a><span class="sd">                Whether or not an error should be displayed if the</span>
</span><span id="__span-0-4994"><a id="__codelineno-0-4994" name="__codelineno-0-4994"></a><span class="sd">                section is not found.</span>
</span><span id="__span-0-4995"><a id="__codelineno-0-4995" name="__codelineno-0-4995"></a>
</span><span id="__span-0-4996"><a id="__codelineno-0-4996" name="__codelineno-0-4996"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-4997"><a id="__codelineno-0-4997" name="__codelineno-0-4997"></a><span class="sd">            dict:</span>
</span><span id="__span-0-4998"><a id="__codelineno-0-4998" name="__codelineno-0-4998"></a><span class="sd">                A dictionary including the list of SharePoint sections for a given page.</span>
</span><span id="__span-0-4999"><a id="__codelineno-0-4999" name="__codelineno-0-4999"></a><span class="sd">                The actual list is included inside the &quot;value&quot; key of the dictionary.</span>
</span><span id="__span-0-5000"><a id="__codelineno-0-5000" name="__codelineno-0-5000"></a>
</span><span id="__span-0-5001"><a id="__codelineno-0-5001" name="__codelineno-0-5001"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5002"><a id="__codelineno-0-5002" name="__codelineno-0-5002"></a><span class="sd">        {</span>
</span><span id="__span-0-5003"><a id="__codelineno-0-5003" name="__codelineno-0-5003"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections&quot;,</span>
</span><span id="__span-0-5004"><a id="__codelineno-0-5004" name="__codelineno-0-5004"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-5005"><a id="__codelineno-0-5005" name="__codelineno-0-5005"></a><span class="sd">                {</span>
</span><span id="__span-0-5006"><a id="__codelineno-0-5006" name="__codelineno-0-5006"></a><span class="sd">                    &#39;layout&#39;: &#39;fullWidth&#39;,</span>
</span><span id="__span-0-5007"><a id="__codelineno-0-5007" name="__codelineno-0-5007"></a><span class="sd">                    &#39;id&#39;: &#39;1&#39;,</span>
</span><span id="__span-0-5008"><a id="__codelineno-0-5008" name="__codelineno-0-5008"></a><span class="sd">                    &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5009"><a id="__codelineno-0-5009" name="__codelineno-0-5009"></a><span class="sd">                },</span>
</span><span id="__span-0-5010"><a id="__codelineno-0-5010" name="__codelineno-0-5010"></a><span class="sd">                {</span>
</span><span id="__span-0-5011"><a id="__codelineno-0-5011" name="__codelineno-0-5011"></a><span class="sd">                    &#39;layout&#39;: &#39;twoColumns&#39;,</span>
</span><span id="__span-0-5012"><a id="__codelineno-0-5012" name="__codelineno-0-5012"></a><span class="sd">                    &#39;id&#39;: &#39;2&#39;,</span>
</span><span id="__span-0-5013"><a id="__codelineno-0-5013" name="__codelineno-0-5013"></a><span class="sd">                    &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5014"><a id="__codelineno-0-5014" name="__codelineno-0-5014"></a><span class="sd">                }</span>
</span><span id="__span-0-5015"><a id="__codelineno-0-5015" name="__codelineno-0-5015"></a><span class="sd">            ]</span>
</span><span id="__span-0-5016"><a id="__codelineno-0-5016" name="__codelineno-0-5016"></a><span class="sd">        }</span>
</span><span id="__span-0-5017"><a id="__codelineno-0-5017" name="__codelineno-0-5017"></a>
</span><span id="__span-0-5018"><a id="__codelineno-0-5018" name="__codelineno-0-5018"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5019"><a id="__codelineno-0-5019" name="__codelineno-0-5019"></a>
</span><span id="__span-0-5020"><a id="__codelineno-0-5020" name="__codelineno-0-5020"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5021"><a id="__codelineno-0-5021" name="__codelineno-0-5021"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5022"><a id="__codelineno-0-5022" name="__codelineno-0-5022"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5023"><a id="__codelineno-0-5023" name="__codelineno-0-5023"></a>            <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5024"><a id="__codelineno-0-5024" name="__codelineno-0-5024"></a>            <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5025"><a id="__codelineno-0-5025" name="__codelineno-0-5025"></a>            <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5026"><a id="__codelineno-0-5026" name="__codelineno-0-5026"></a>            <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5027"><a id="__codelineno-0-5027" name="__codelineno-0-5027"></a>            <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5028"><a id="__codelineno-0-5028" name="__codelineno-0-5028"></a>        <span class="p">)</span>
</span><span id="__span-0-5029"><a id="__codelineno-0-5029" name="__codelineno-0-5029"></a>
</span><span id="__span-0-5030"><a id="__codelineno-0-5030" name="__codelineno-0-5030"></a>        <span class="k">if</span> <span class="n">section_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5031"><a id="__codelineno-0-5031" name="__codelineno-0-5031"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5032"><a id="__codelineno-0-5032" name="__codelineno-0-5032"></a>
</span><span id="__span-0-5033"><a id="__codelineno-0-5033" name="__codelineno-0-5033"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5034"><a id="__codelineno-0-5034" name="__codelineno-0-5034"></a>
</span><span id="__span-0-5035"><a id="__codelineno-0-5035" name="__codelineno-0-5035"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5036"><a id="__codelineno-0-5036" name="__codelineno-0-5036"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5037"><a id="__codelineno-0-5037" name="__codelineno-0-5037"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-5038"><a id="__codelineno-0-5038" name="__codelineno-0-5038"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5039"><a id="__codelineno-0-5039" name="__codelineno-0-5039"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5040"><a id="__codelineno-0-5040" name="__codelineno-0-5040"></a>            <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;Cannot find section</span><span class="si">{}</span><span class="s2"> for SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; of SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5041"><a id="__codelineno-0-5041" name="__codelineno-0-5041"></a>                <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">section_id</span> <span class="k">else</span> <span class="s2">&quot; -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section_id</span><span class="p">),</span>
</span><span id="__span-0-5042"><a id="__codelineno-0-5042" name="__codelineno-0-5042"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5043"><a id="__codelineno-0-5043" name="__codelineno-0-5043"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5044"><a id="__codelineno-0-5044" name="__codelineno-0-5044"></a>            <span class="p">),</span>
</span><span id="__span-0-5045"><a id="__codelineno-0-5045" name="__codelineno-0-5045"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get section</span><span class="si">{}</span><span class="s2"> for SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; of SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5046"><a id="__codelineno-0-5046" name="__codelineno-0-5046"></a>                <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">section_id</span> <span class="k">else</span> <span class="s2">&quot; -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section_id</span><span class="p">),</span>
</span><span id="__span-0-5047"><a id="__codelineno-0-5047" name="__codelineno-0-5047"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5048"><a id="__codelineno-0-5048" name="__codelineno-0-5048"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5049"><a id="__codelineno-0-5049" name="__codelineno-0-5049"></a>            <span class="p">),</span>
</span><span id="__span-0-5050"><a id="__codelineno-0-5050" name="__codelineno-0-5050"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-5051"><a id="__codelineno-0-5051" name="__codelineno-0-5051"></a>        <span class="p">)</span>
</span><span id="__span-0-5052"><a id="__codelineno-0-5052" name="__codelineno-0-5052"></a>
</span><span id="__span-0-5053"><a id="__codelineno-0-5053" name="__codelineno-0-5053"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5054"><a id="__codelineno-0-5054" name="__codelineno-0-5054"></a>
</span><span id="__span-0-5055"><a id="__codelineno-0-5055" name="__codelineno-0-5055"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5056"><a id="__codelineno-0-5056" name="__codelineno-0-5056"></a>
</span><span id="__span-0-5057"><a id="__codelineno-0-5057" name="__codelineno-0-5057"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_section</span><span class="p">(</span>
</span><span id="__span-0-5058"><a id="__codelineno-0-5058" name="__codelineno-0-5058"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5059"><a id="__codelineno-0-5059" name="__codelineno-0-5059"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5060"><a id="__codelineno-0-5060" name="__codelineno-0-5060"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5061"><a id="__codelineno-0-5061" name="__codelineno-0-5061"></a>        <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5062"><a id="__codelineno-0-5062" name="__codelineno-0-5062"></a>        <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5063"><a id="__codelineno-0-5063" name="__codelineno-0-5063"></a>        <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5064"><a id="__codelineno-0-5064" name="__codelineno-0-5064"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-5065"><a id="__codelineno-0-5065" name="__codelineno-0-5065"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a section of a SharePoint site page.</span>
</span><span id="__span-0-5066"><a id="__codelineno-0-5066" name="__codelineno-0-5066"></a>
</span><span id="__span-0-5067"><a id="__codelineno-0-5067" name="__codelineno-0-5067"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5068"><a id="__codelineno-0-5068" name="__codelineno-0-5068"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5069"><a id="__codelineno-0-5069" name="__codelineno-0-5069"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5070"><a id="__codelineno-0-5070" name="__codelineno-0-5070"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5071"><a id="__codelineno-0-5071" name="__codelineno-0-5071"></a><span class="sd">                The ID of the SharePoint page containing the section.</span>
</span><span id="__span-0-5072"><a id="__codelineno-0-5072" name="__codelineno-0-5072"></a><span class="sd">            section_type (str, optional):</span>
</span><span id="__span-0-5073"><a id="__codelineno-0-5073" name="__codelineno-0-5073"></a><span class="sd">                &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5074"><a id="__codelineno-0-5074" name="__codelineno-0-5074"></a><span class="sd">                &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5075"><a id="__codelineno-0-5075" name="__codelineno-0-5075"></a><span class="sd">            section_id (int | str):</span>
</span><span id="__span-0-5076"><a id="__codelineno-0-5076" name="__codelineno-0-5076"></a><span class="sd">                The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5077"><a id="__codelineno-0-5077" name="__codelineno-0-5077"></a><span class="sd">                Simple values like 1,2,3...</span>
</span><span id="__span-0-5078"><a id="__codelineno-0-5078" name="__codelineno-0-5078"></a><span class="sd">            show_error (bool, optional):</span>
</span><span id="__span-0-5079"><a id="__codelineno-0-5079" name="__codelineno-0-5079"></a><span class="sd">                Whether or not an error should be displayed if the</span>
</span><span id="__span-0-5080"><a id="__codelineno-0-5080" name="__codelineno-0-5080"></a><span class="sd">                section is not found.</span>
</span><span id="__span-0-5081"><a id="__codelineno-0-5081" name="__codelineno-0-5081"></a>
</span><span id="__span-0-5082"><a id="__codelineno-0-5082" name="__codelineno-0-5082"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5083"><a id="__codelineno-0-5083" name="__codelineno-0-5083"></a><span class="sd">            dict:</span>
</span><span id="__span-0-5084"><a id="__codelineno-0-5084" name="__codelineno-0-5084"></a><span class="sd">                A SharePoint site page section.</span>
</span><span id="__span-0-5085"><a id="__codelineno-0-5085" name="__codelineno-0-5085"></a>
</span><span id="__span-0-5086"><a id="__codelineno-0-5086" name="__codelineno-0-5086"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5087"><a id="__codelineno-0-5087" name="__codelineno-0-5087"></a><span class="sd">        {</span>
</span><span id="__span-0-5088"><a id="__codelineno-0-5088" name="__codelineno-0-5088"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections/$entity&quot;,</span>
</span><span id="__span-0-5089"><a id="__codelineno-0-5089" name="__codelineno-0-5089"></a><span class="sd">            &#39;layout&#39;: &#39;fullWidth&#39;,</span>
</span><span id="__span-0-5090"><a id="__codelineno-0-5090" name="__codelineno-0-5090"></a><span class="sd">            &#39;id&#39;: &#39;1&#39;,</span>
</span><span id="__span-0-5091"><a id="__codelineno-0-5091" name="__codelineno-0-5091"></a><span class="sd">            &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5092"><a id="__codelineno-0-5092" name="__codelineno-0-5092"></a><span class="sd">        }</span>
</span><span id="__span-0-5093"><a id="__codelineno-0-5093" name="__codelineno-0-5093"></a>
</span><span id="__span-0-5094"><a id="__codelineno-0-5094" name="__codelineno-0-5094"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5095"><a id="__codelineno-0-5095" name="__codelineno-0-5095"></a>
</span><span id="__span-0-5096"><a id="__codelineno-0-5096" name="__codelineno-0-5096"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_sections</span><span class="p">(</span>
</span><span id="__span-0-5097"><a id="__codelineno-0-5097" name="__codelineno-0-5097"></a>            <span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5098"><a id="__codelineno-0-5098" name="__codelineno-0-5098"></a>            <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5099"><a id="__codelineno-0-5099" name="__codelineno-0-5099"></a>            <span class="n">section_type</span><span class="o">=</span><span class="n">section_type</span><span class="p">,</span>
</span><span id="__span-0-5100"><a id="__codelineno-0-5100" name="__codelineno-0-5100"></a>            <span class="n">section_id</span><span class="o">=</span><span class="n">section_id</span><span class="p">,</span>
</span><span id="__span-0-5101"><a id="__codelineno-0-5101" name="__codelineno-0-5101"></a>            <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-5102"><a id="__codelineno-0-5102" name="__codelineno-0-5102"></a>        <span class="p">)</span>
</span><span id="__span-0-5103"><a id="__codelineno-0-5103" name="__codelineno-0-5103"></a>
</span><span id="__span-0-5104"><a id="__codelineno-0-5104" name="__codelineno-0-5104"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5105"><a id="__codelineno-0-5105" name="__codelineno-0-5105"></a>
</span><span id="__span-0-5106"><a id="__codelineno-0-5106" name="__codelineno-0-5106"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5107"><a id="__codelineno-0-5107" name="__codelineno-0-5107"></a>
</span><span id="__span-0-5108"><a id="__codelineno-0-5108" name="__codelineno-0-5108"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_sharepoint_section</span><span class="p">(</span>
</span><span id="__span-0-5109"><a id="__codelineno-0-5109" name="__codelineno-0-5109"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5110"><a id="__codelineno-0-5110" name="__codelineno-0-5110"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5111"><a id="__codelineno-0-5111" name="__codelineno-0-5111"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5112"><a id="__codelineno-0-5112" name="__codelineno-0-5112"></a>        <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5113"><a id="__codelineno-0-5113" name="__codelineno-0-5113"></a>        <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5114"><a id="__codelineno-0-5114" name="__codelineno-0-5114"></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;oneColumn&quot;</span><span class="p">,</span>
</span><span id="__span-0-5115"><a id="__codelineno-0-5115" name="__codelineno-0-5115"></a>        <span class="n">emphasis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
</span><span id="__span-0-5116"><a id="__codelineno-0-5116" name="__codelineno-0-5116"></a>        <span class="n">republish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5117"><a id="__codelineno-0-5117" name="__codelineno-0-5117"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5118"><a id="__codelineno-0-5118" name="__codelineno-0-5118"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a specific section (horizontal or vertical) on a SharePoint page.</span>
</span><span id="__span-0-5119"><a id="__codelineno-0-5119" name="__codelineno-0-5119"></a>
</span><span id="__span-0-5120"><a id="__codelineno-0-5120" name="__codelineno-0-5120"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5121"><a id="__codelineno-0-5121" name="__codelineno-0-5121"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5122"><a id="__codelineno-0-5122" name="__codelineno-0-5122"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5123"><a id="__codelineno-0-5123" name="__codelineno-0-5123"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5124"><a id="__codelineno-0-5124" name="__codelineno-0-5124"></a><span class="sd">                The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5125"><a id="__codelineno-0-5125" name="__codelineno-0-5125"></a><span class="sd">            section_type (str, optional):</span>
</span><span id="__span-0-5126"><a id="__codelineno-0-5126" name="__codelineno-0-5126"></a><span class="sd">                &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5127"><a id="__codelineno-0-5127" name="__codelineno-0-5127"></a><span class="sd">                &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5128"><a id="__codelineno-0-5128" name="__codelineno-0-5128"></a><span class="sd">            section_id (int | str):</span>
</span><span id="__span-0-5129"><a id="__codelineno-0-5129" name="__codelineno-0-5129"></a><span class="sd">                The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5130"><a id="__codelineno-0-5130" name="__codelineno-0-5130"></a><span class="sd">                Simple values like 1,2,3...</span>
</span><span id="__span-0-5131"><a id="__codelineno-0-5131" name="__codelineno-0-5131"></a><span class="sd">            columns (str, optional):</span>
</span><span id="__span-0-5132"><a id="__codelineno-0-5132" name="__codelineno-0-5132"></a><span class="sd">                &quot;fullWidth&quot;</span>
</span><span id="__span-0-5133"><a id="__codelineno-0-5133" name="__codelineno-0-5133"></a><span class="sd">                &quot;oneColumn&quot;</span>
</span><span id="__span-0-5134"><a id="__codelineno-0-5134" name="__codelineno-0-5134"></a><span class="sd">                &quot;twoColumns&quot;</span>
</span><span id="__span-0-5135"><a id="__codelineno-0-5135" name="__codelineno-0-5135"></a><span class="sd">                &quot;threeColumns&quot;</span>
</span><span id="__span-0-5136"><a id="__codelineno-0-5136" name="__codelineno-0-5136"></a><span class="sd">            emphasis (str, optional):</span>
</span><span id="__span-0-5137"><a id="__codelineno-0-5137" name="__codelineno-0-5137"></a><span class="sd">                The emphasis for the section. Possible values:</span>
</span><span id="__span-0-5138"><a id="__codelineno-0-5138" name="__codelineno-0-5138"></a><span class="sd">                &quot;none&quot; (default)</span>
</span><span id="__span-0-5139"><a id="__codelineno-0-5139" name="__codelineno-0-5139"></a><span class="sd">                &quot;neutral&quot;</span>
</span><span id="__span-0-5140"><a id="__codelineno-0-5140" name="__codelineno-0-5140"></a><span class="sd">                &quot;soft&quot;</span>
</span><span id="__span-0-5141"><a id="__codelineno-0-5141" name="__codelineno-0-5141"></a><span class="sd">                &quot;strong&quot;</span>
</span><span id="__span-0-5142"><a id="__codelineno-0-5142" name="__codelineno-0-5142"></a><span class="sd">            republish (bool, optional):</span>
</span><span id="__span-0-5143"><a id="__codelineno-0-5143" name="__codelineno-0-5143"></a><span class="sd">                If True, the page is republished to make the section active.</span>
</span><span id="__span-0-5144"><a id="__codelineno-0-5144" name="__codelineno-0-5144"></a>
</span><span id="__span-0-5145"><a id="__codelineno-0-5145" name="__codelineno-0-5145"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5146"><a id="__codelineno-0-5146" name="__codelineno-0-5146"></a><span class="sd">            dict:</span>
</span><span id="__span-0-5147"><a id="__codelineno-0-5147" name="__codelineno-0-5147"></a><span class="sd">                The horizontal or vertical section.</span>
</span><span id="__span-0-5148"><a id="__codelineno-0-5148" name="__codelineno-0-5148"></a>
</span><span id="__span-0-5149"><a id="__codelineno-0-5149" name="__codelineno-0-5149"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5150"><a id="__codelineno-0-5150" name="__codelineno-0-5150"></a><span class="sd">        {</span>
</span><span id="__span-0-5151"><a id="__codelineno-0-5151" name="__codelineno-0-5151"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections/$entity&quot;,</span>
</span><span id="__span-0-5152"><a id="__codelineno-0-5152" name="__codelineno-0-5152"></a><span class="sd">            &#39;layout&#39;: &#39;fullWidth&#39;,</span>
</span><span id="__span-0-5153"><a id="__codelineno-0-5153" name="__codelineno-0-5153"></a><span class="sd">            &#39;id&#39;: &#39;2&#39;,</span>
</span><span id="__span-0-5154"><a id="__codelineno-0-5154" name="__codelineno-0-5154"></a><span class="sd">            &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5155"><a id="__codelineno-0-5155" name="__codelineno-0-5155"></a><span class="sd">        }</span>
</span><span id="__span-0-5156"><a id="__codelineno-0-5156" name="__codelineno-0-5156"></a>
</span><span id="__span-0-5157"><a id="__codelineno-0-5157" name="__codelineno-0-5157"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5158"><a id="__codelineno-0-5158" name="__codelineno-0-5158"></a>
</span><span id="__span-0-5159"><a id="__codelineno-0-5159" name="__codelineno-0-5159"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5160"><a id="__codelineno-0-5160" name="__codelineno-0-5160"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5161"><a id="__codelineno-0-5161" name="__codelineno-0-5161"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5162"><a id="__codelineno-0-5162" name="__codelineno-0-5162"></a>            <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5163"><a id="__codelineno-0-5163" name="__codelineno-0-5163"></a>            <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5164"><a id="__codelineno-0-5164" name="__codelineno-0-5164"></a>            <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5165"><a id="__codelineno-0-5165" name="__codelineno-0-5165"></a>            <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5166"><a id="__codelineno-0-5166" name="__codelineno-0-5166"></a>            <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5167"><a id="__codelineno-0-5167" name="__codelineno-0-5167"></a>        <span class="p">)</span>
</span><span id="__span-0-5168"><a id="__codelineno-0-5168" name="__codelineno-0-5168"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5169"><a id="__codelineno-0-5169" name="__codelineno-0-5169"></a>
</span><span id="__span-0-5170"><a id="__codelineno-0-5170" name="__codelineno-0-5170"></a>        <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5171"><a id="__codelineno-0-5171" name="__codelineno-0-5171"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5172"><a id="__codelineno-0-5172" name="__codelineno-0-5172"></a>            <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5173"><a id="__codelineno-0-5173" name="__codelineno-0-5173"></a>                <span class="n">section_type</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">),</span>
</span><span id="__span-0-5174"><a id="__codelineno-0-5174" name="__codelineno-0-5174"></a>            <span class="p">),</span>
</span><span id="__span-0-5175"><a id="__codelineno-0-5175" name="__codelineno-0-5175"></a>        <span class="p">}</span>
</span><span id="__span-0-5176"><a id="__codelineno-0-5176" name="__codelineno-0-5176"></a>        <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5177"><a id="__codelineno-0-5177" name="__codelineno-0-5177"></a>            <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="__span-0-5178"><a id="__codelineno-0-5178" name="__codelineno-0-5178"></a>            <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;emphasis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emphasis</span>
</span><span id="__span-0-5179"><a id="__codelineno-0-5179" name="__codelineno-0-5179"></a>            <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5180"><a id="__codelineno-0-5180" name="__codelineno-0-5180"></a>
</span><span id="__span-0-5181"><a id="__codelineno-0-5181" name="__codelineno-0-5181"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5182"><a id="__codelineno-0-5182" name="__codelineno-0-5182"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5183"><a id="__codelineno-0-5183" name="__codelineno-0-5183"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-5184"><a id="__codelineno-0-5184" name="__codelineno-0-5184"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5185"><a id="__codelineno-0-5185" name="__codelineno-0-5185"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5186"><a id="__codelineno-0-5186" name="__codelineno-0-5186"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5187"><a id="__codelineno-0-5187" name="__codelineno-0-5187"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to create SharePoint section of type -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5188"><a id="__codelineno-0-5188" name="__codelineno-0-5188"></a>                <span class="n">section_type</span><span class="p">,</span>
</span><span id="__span-0-5189"><a id="__codelineno-0-5189" name="__codelineno-0-5189"></a>                <span class="n">columns</span><span class="p">,</span>
</span><span id="__span-0-5190"><a id="__codelineno-0-5190" name="__codelineno-0-5190"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5191"><a id="__codelineno-0-5191" name="__codelineno-0-5191"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5192"><a id="__codelineno-0-5192" name="__codelineno-0-5192"></a>            <span class="p">),</span>
</span><span id="__span-0-5193"><a id="__codelineno-0-5193" name="__codelineno-0-5193"></a>        <span class="p">)</span>
</span><span id="__span-0-5194"><a id="__codelineno-0-5194" name="__codelineno-0-5194"></a>
</span><span id="__span-0-5195"><a id="__codelineno-0-5195" name="__codelineno-0-5195"></a>        <span class="c1"># Check if the page should be republished:</span>
</span><span id="__span-0-5196"><a id="__codelineno-0-5196" name="__codelineno-0-5196"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">republish</span><span class="p">:</span>
</span><span id="__span-0-5197"><a id="__codelineno-0-5197" name="__codelineno-0-5197"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-5198"><a id="__codelineno-0-5198" name="__codelineno-0-5198"></a>
</span><span id="__span-0-5199"><a id="__codelineno-0-5199" name="__codelineno-0-5199"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5200"><a id="__codelineno-0-5200" name="__codelineno-0-5200"></a>
</span><span id="__span-0-5201"><a id="__codelineno-0-5201" name="__codelineno-0-5201"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5202"><a id="__codelineno-0-5202" name="__codelineno-0-5202"></a>
</span><span id="__span-0-5203"><a id="__codelineno-0-5203" name="__codelineno-0-5203"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_sharepoint_section</span><span class="p">(</span>
</span><span id="__span-0-5204"><a id="__codelineno-0-5204" name="__codelineno-0-5204"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5205"><a id="__codelineno-0-5205" name="__codelineno-0-5205"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5206"><a id="__codelineno-0-5206" name="__codelineno-0-5206"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5207"><a id="__codelineno-0-5207" name="__codelineno-0-5207"></a>        <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5208"><a id="__codelineno-0-5208" name="__codelineno-0-5208"></a>        <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5209"><a id="__codelineno-0-5209" name="__codelineno-0-5209"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5210"><a id="__codelineno-0-5210" name="__codelineno-0-5210"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a specific section (horizontal or vertical) on a SharePoint page.</span>
</span><span id="__span-0-5211"><a id="__codelineno-0-5211" name="__codelineno-0-5211"></a>
</span><span id="__span-0-5212"><a id="__codelineno-0-5212" name="__codelineno-0-5212"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5213"><a id="__codelineno-0-5213" name="__codelineno-0-5213"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5214"><a id="__codelineno-0-5214" name="__codelineno-0-5214"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5215"><a id="__codelineno-0-5215" name="__codelineno-0-5215"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5216"><a id="__codelineno-0-5216" name="__codelineno-0-5216"></a><span class="sd">                The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5217"><a id="__codelineno-0-5217" name="__codelineno-0-5217"></a><span class="sd">            section_type (str, optional):</span>
</span><span id="__span-0-5218"><a id="__codelineno-0-5218" name="__codelineno-0-5218"></a><span class="sd">                &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5219"><a id="__codelineno-0-5219" name="__codelineno-0-5219"></a><span class="sd">                &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5220"><a id="__codelineno-0-5220" name="__codelineno-0-5220"></a><span class="sd">            section_id (int | str):</span>
</span><span id="__span-0-5221"><a id="__codelineno-0-5221" name="__codelineno-0-5221"></a><span class="sd">                The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5222"><a id="__codelineno-0-5222" name="__codelineno-0-5222"></a><span class="sd">                Simple values like 1,2,3...</span>
</span><span id="__span-0-5223"><a id="__codelineno-0-5223" name="__codelineno-0-5223"></a>
</span><span id="__span-0-5224"><a id="__codelineno-0-5224" name="__codelineno-0-5224"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5225"><a id="__codelineno-0-5225" name="__codelineno-0-5225"></a><span class="sd">            dict:</span>
</span><span id="__span-0-5226"><a id="__codelineno-0-5226" name="__codelineno-0-5226"></a><span class="sd">                Empty response.</span>
</span><span id="__span-0-5227"><a id="__codelineno-0-5227" name="__codelineno-0-5227"></a>
</span><span id="__span-0-5228"><a id="__codelineno-0-5228" name="__codelineno-0-5228"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5229"><a id="__codelineno-0-5229" name="__codelineno-0-5229"></a><span class="sd">        {</span>
</span><span id="__span-0-5230"><a id="__codelineno-0-5230" name="__codelineno-0-5230"></a><span class="sd">            &#39;_content&#39;: b&#39;&#39;,</span>
</span><span id="__span-0-5231"><a id="__codelineno-0-5231" name="__codelineno-0-5231"></a><span class="sd">            &#39;_content_consumed&#39;: True,</span>
</span><span id="__span-0-5232"><a id="__codelineno-0-5232" name="__codelineno-0-5232"></a><span class="sd">            &#39;_next&#39;: None,</span>
</span><span id="__span-0-5233"><a id="__codelineno-0-5233" name="__codelineno-0-5233"></a><span class="sd">            &#39;status_code&#39;: 204,</span>
</span><span id="__span-0-5234"><a id="__codelineno-0-5234" name="__codelineno-0-5234"></a><span class="sd">            &#39;headers&#39;: {</span>
</span><span id="__span-0-5235"><a id="__codelineno-0-5235" name="__codelineno-0-5235"></a><span class="sd">                &#39;Cache-Control&#39;: &#39;no-store, no-cache&#39;,</span>
</span><span id="__span-0-5236"><a id="__codelineno-0-5236" name="__codelineno-0-5236"></a><span class="sd">                &#39;Strict-Transport-Security&#39;: &#39;max-age=31536000&#39;,</span>
</span><span id="__span-0-5237"><a id="__codelineno-0-5237" name="__codelineno-0-5237"></a><span class="sd">                &#39;request-id&#39;: &#39;bd21c7fa-751c-43ca-b290-12c30f50d7e1&#39;,</span>
</span><span id="__span-0-5238"><a id="__codelineno-0-5238" name="__codelineno-0-5238"></a><span class="sd">                &#39;client-request-id&#39;: &#39;bd21c7fa-751c-43ca-b290-12c30f50d7e1&#39;,</span>
</span><span id="__span-0-5239"><a id="__codelineno-0-5239" name="__codelineno-0-5239"></a><span class="sd">                &#39;x-ms-ags-diagnostic&#39;: &#39;{&quot;ServerInfo&quot;:{&quot;DataCenter&quot;:&quot;Germany West Central&quot;,&quot;Slice&quot;:&quot;E&quot;,&quot;Ring&quot;:&quot;4&quot;,&quot;ScaleUnit&quot;:&quot;004&quot;,&quot;RoleInstance&quot;:&quot;FR2PEPF00000393&quot;}}&#39;, &#39;Date&#39;: &#39;Fri, 14 Feb 2025 20:40:06 GMT&#39;},</span>
</span><span id="__span-0-5240"><a id="__codelineno-0-5240" name="__codelineno-0-5240"></a><span class="sd">                &#39;raw&#39;: &lt;urllib3.response.HTTPResponse object at 0x10f210d90&gt;,</span>
</span><span id="__span-0-5241"><a id="__codelineno-0-5241" name="__codelineno-0-5241"></a><span class="sd">                &#39;url&#39;: &#39;https://graph.microsoft.com/beta/sites/ideatedev.sharepoint.com,61c0f9cb-39d3-4c04-b60c-31576954a2ab,a678aeab-68ac-46a1-bd95-28020c12de26/pages/ac7675ee-8891-43b9-b1b2-2d2ced8eb17e/microsoft.graph.sitePage/canvasLayout/horizontalSections/1&#39;,</span>
</span><span id="__span-0-5242"><a id="__codelineno-0-5242" name="__codelineno-0-5242"></a><span class="sd">                &#39;encoding&#39;: None,</span>
</span><span id="__span-0-5243"><a id="__codelineno-0-5243" name="__codelineno-0-5243"></a><span class="sd">                &#39;history&#39;: [],</span>
</span><span id="__span-0-5244"><a id="__codelineno-0-5244" name="__codelineno-0-5244"></a><span class="sd">                &#39;reason&#39;: &#39;No Content&#39;,</span>
</span><span id="__span-0-5245"><a id="__codelineno-0-5245" name="__codelineno-0-5245"></a><span class="sd">                &#39;cookies&#39;: &lt;RequestsCookieJar[]&gt;,</span>
</span><span id="__span-0-5246"><a id="__codelineno-0-5246" name="__codelineno-0-5246"></a><span class="sd">                &#39;elapsed&#39;: datetime.timedelta(microseconds=514597),</span>
</span><span id="__span-0-5247"><a id="__codelineno-0-5247" name="__codelineno-0-5247"></a><span class="sd">                &#39;request&#39;: &lt;PreparedRequest [DELETE]&gt;,</span>
</span><span id="__span-0-5248"><a id="__codelineno-0-5248" name="__codelineno-0-5248"></a><span class="sd">                &#39;connection&#39;: &lt;requests.adapters.HTTPAdapter object at 0x11841d700&gt;</span>
</span><span id="__span-0-5249"><a id="__codelineno-0-5249" name="__codelineno-0-5249"></a><span class="sd">            }</span>
</span><span id="__span-0-5250"><a id="__codelineno-0-5250" name="__codelineno-0-5250"></a>
</span><span id="__span-0-5251"><a id="__codelineno-0-5251" name="__codelineno-0-5251"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5252"><a id="__codelineno-0-5252" name="__codelineno-0-5252"></a>
</span><span id="__span-0-5253"><a id="__codelineno-0-5253" name="__codelineno-0-5253"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5254"><a id="__codelineno-0-5254" name="__codelineno-0-5254"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5255"><a id="__codelineno-0-5255" name="__codelineno-0-5255"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5256"><a id="__codelineno-0-5256" name="__codelineno-0-5256"></a>            <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5257"><a id="__codelineno-0-5257" name="__codelineno-0-5257"></a>            <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5258"><a id="__codelineno-0-5258" name="__codelineno-0-5258"></a>            <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5259"><a id="__codelineno-0-5259" name="__codelineno-0-5259"></a>            <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5260"><a id="__codelineno-0-5260" name="__codelineno-0-5260"></a>            <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5261"><a id="__codelineno-0-5261" name="__codelineno-0-5261"></a>        <span class="p">)</span>
</span><span id="__span-0-5262"><a id="__codelineno-0-5262" name="__codelineno-0-5262"></a>
</span><span id="__span-0-5263"><a id="__codelineno-0-5263" name="__codelineno-0-5263"></a>        <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5264"><a id="__codelineno-0-5264" name="__codelineno-0-5264"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5265"><a id="__codelineno-0-5265" name="__codelineno-0-5265"></a>
</span><span id="__span-0-5266"><a id="__codelineno-0-5266" name="__codelineno-0-5266"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5267"><a id="__codelineno-0-5267" name="__codelineno-0-5267"></a>
</span><span id="__span-0-5268"><a id="__codelineno-0-5268" name="__codelineno-0-5268"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5269"><a id="__codelineno-0-5269" name="__codelineno-0-5269"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5270"><a id="__codelineno-0-5270" name="__codelineno-0-5270"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-5271"><a id="__codelineno-0-5271" name="__codelineno-0-5271"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5272"><a id="__codelineno-0-5272" name="__codelineno-0-5272"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5273"><a id="__codelineno-0-5273" name="__codelineno-0-5273"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to delete SharePoint section of type -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in Sharepoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5274"><a id="__codelineno-0-5274" name="__codelineno-0-5274"></a>                <span class="n">section_type</span><span class="p">,</span>
</span><span id="__span-0-5275"><a id="__codelineno-0-5275" name="__codelineno-0-5275"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5276"><a id="__codelineno-0-5276" name="__codelineno-0-5276"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5277"><a id="__codelineno-0-5277" name="__codelineno-0-5277"></a>            <span class="p">),</span>
</span><span id="__span-0-5278"><a id="__codelineno-0-5278" name="__codelineno-0-5278"></a>        <span class="p">)</span>
</span><span id="__span-0-5279"><a id="__codelineno-0-5279" name="__codelineno-0-5279"></a>
</span><span id="__span-0-5280"><a id="__codelineno-0-5280" name="__codelineno-0-5280"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5281"><a id="__codelineno-0-5281" name="__codelineno-0-5281"></a>
</span><span id="__span-0-5282"><a id="__codelineno-0-5282" name="__codelineno-0-5282"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5283"><a id="__codelineno-0-5283" name="__codelineno-0-5283"></a>
</span><span id="__span-0-5284"><a id="__codelineno-0-5284" name="__codelineno-0-5284"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_webparts</span><span class="p">(</span>
</span><span id="__span-0-5285"><a id="__codelineno-0-5285" name="__codelineno-0-5285"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5286"><a id="__codelineno-0-5286" name="__codelineno-0-5286"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5287"><a id="__codelineno-0-5287" name="__codelineno-0-5287"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5288"><a id="__codelineno-0-5288" name="__codelineno-0-5288"></a>        <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5289"><a id="__codelineno-0-5289" name="__codelineno-0-5289"></a>        <span class="n">section_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5290"><a id="__codelineno-0-5290" name="__codelineno-0-5290"></a>        <span class="n">column_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5291"><a id="__codelineno-0-5291" name="__codelineno-0-5291"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5292"><a id="__codelineno-0-5292" name="__codelineno-0-5292"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the configured webparts on a SharePoint site page.</span>
</span><span id="__span-0-5293"><a id="__codelineno-0-5293" name="__codelineno-0-5293"></a>
</span><span id="__span-0-5294"><a id="__codelineno-0-5294" name="__codelineno-0-5294"></a><span class="sd">        Can retrieve all webparts on the page or the ones in a defined</span>
</span><span id="__span-0-5295"><a id="__codelineno-0-5295" name="__codelineno-0-5295"></a><span class="sd">        page section (like horizontal section or vertical section).</span>
</span><span id="__span-0-5296"><a id="__codelineno-0-5296" name="__codelineno-0-5296"></a>
</span><span id="__span-0-5297"><a id="__codelineno-0-5297" name="__codelineno-0-5297"></a><span class="sd">        OpenText WebPart Type IDs:</span>
</span><span id="__span-0-5298"><a id="__codelineno-0-5298" name="__codelineno-0-5298"></a><span class="sd">            Content Browser: &#39;cecfdba4-2e82-4538-9436-dbd1c4c01a80&#39;</span>
</span><span id="__span-0-5299"><a id="__codelineno-0-5299" name="__codelineno-0-5299"></a><span class="sd">            Related Workspaces: &#39;e24d7154-4554-4db6-a44f-d306b6b3a5d4&#39;</span>
</span><span id="__span-0-5300"><a id="__codelineno-0-5300" name="__codelineno-0-5300"></a><span class="sd">            Team members of Workspace: &#39;635a2800-8833-410d-b1f1-f209b28ea2ad&#39;</span>
</span><span id="__span-0-5301"><a id="__codelineno-0-5301" name="__codelineno-0-5301"></a>
</span><span id="__span-0-5302"><a id="__codelineno-0-5302" name="__codelineno-0-5302"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5303"><a id="__codelineno-0-5303" name="__codelineno-0-5303"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5304"><a id="__codelineno-0-5304" name="__codelineno-0-5304"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5305"><a id="__codelineno-0-5305" name="__codelineno-0-5305"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5306"><a id="__codelineno-0-5306" name="__codelineno-0-5306"></a><span class="sd">                The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5307"><a id="__codelineno-0-5307" name="__codelineno-0-5307"></a><span class="sd">            section_type (str, optional):</span>
</span><span id="__span-0-5308"><a id="__codelineno-0-5308" name="__codelineno-0-5308"></a><span class="sd">                &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5309"><a id="__codelineno-0-5309" name="__codelineno-0-5309"></a><span class="sd">                &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5310"><a id="__codelineno-0-5310" name="__codelineno-0-5310"></a><span class="sd">                Use None if you want to retrieve all webparts on page.</span>
</span><span id="__span-0-5311"><a id="__codelineno-0-5311" name="__codelineno-0-5311"></a><span class="sd">            section_id (str | int | None):</span>
</span><span id="__span-0-5312"><a id="__codelineno-0-5312" name="__codelineno-0-5312"></a><span class="sd">                The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5313"><a id="__codelineno-0-5313" name="__codelineno-0-5313"></a><span class="sd">                Simple values like 1,2,3...</span>
</span><span id="__span-0-5314"><a id="__codelineno-0-5314" name="__codelineno-0-5314"></a><span class="sd">                Not relevant for vertical section or if you want to retrieve</span>
</span><span id="__span-0-5315"><a id="__codelineno-0-5315" name="__codelineno-0-5315"></a><span class="sd">                all webparts on the page.</span>
</span><span id="__span-0-5316"><a id="__codelineno-0-5316" name="__codelineno-0-5316"></a><span class="sd">            column_id (int | str, optional):</span>
</span><span id="__span-0-5317"><a id="__codelineno-0-5317" name="__codelineno-0-5317"></a><span class="sd">                For horizontalSections the column ID has to be provided.</span>
</span><span id="__span-0-5318"><a id="__codelineno-0-5318" name="__codelineno-0-5318"></a><span class="sd">                Defaults to 1.</span>
</span><span id="__span-0-5319"><a id="__codelineno-0-5319" name="__codelineno-0-5319"></a>
</span><span id="__span-0-5320"><a id="__codelineno-0-5320" name="__codelineno-0-5320"></a>
</span><span id="__span-0-5321"><a id="__codelineno-0-5321" name="__codelineno-0-5321"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5322"><a id="__codelineno-0-5322" name="__codelineno-0-5322"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-5323"><a id="__codelineno-0-5323" name="__codelineno-0-5323"></a><span class="sd">                A dictionary including the SharePoint webparts of a given page for a given site.</span>
</span><span id="__span-0-5324"><a id="__codelineno-0-5324" name="__codelineno-0-5324"></a><span class="sd">                The actual list is included inside the &quot;value&quot; key of the dictionary.</span>
</span><span id="__span-0-5325"><a id="__codelineno-0-5325" name="__codelineno-0-5325"></a>
</span><span id="__span-0-5326"><a id="__codelineno-0-5326" name="__codelineno-0-5326"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5327"><a id="__codelineno-0-5327" name="__codelineno-0-5327"></a><span class="sd">        {</span>
</span><span id="__span-0-5328"><a id="__codelineno-0-5328" name="__codelineno-0-5328"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;561c65b4-3418-4698-a4c3-7ca7f04812bb&#39;)/microsoft.graph.sitePage/webParts&quot;,</span>
</span><span id="__span-0-5329"><a id="__codelineno-0-5329" name="__codelineno-0-5329"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-5330"><a id="__codelineno-0-5330" name="__codelineno-0-5330"></a><span class="sd">                {</span>
</span><span id="__span-0-5331"><a id="__codelineno-0-5331" name="__codelineno-0-5331"></a><span class="sd">                    &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5332"><a id="__codelineno-0-5332" name="__codelineno-0-5332"></a><span class="sd">                    &#39;id&#39;: &#39;405b669e-3c09-45fe-822f-ff60ac7fffce&#39;,</span>
</span><span id="__span-0-5333"><a id="__codelineno-0-5333" name="__codelineno-0-5333"></a><span class="sd">                    &#39;webPartType&#39;: &#39;c4bd7b2f-7b6e-4599-8485-16504575f590&#39;,</span>
</span><span id="__span-0-5334"><a id="__codelineno-0-5334" name="__codelineno-0-5334"></a><span class="sd">                    &#39;data&#39;: {</span>
</span><span id="__span-0-5335"><a id="__codelineno-0-5335" name="__codelineno-0-5335"></a><span class="sd">                        &#39;audiences&#39;: [],</span>
</span><span id="__span-0-5336"><a id="__codelineno-0-5336" name="__codelineno-0-5336"></a><span class="sd">                        &#39;dataVersion&#39;: &#39;1.5&#39;,</span>
</span><span id="__span-0-5337"><a id="__codelineno-0-5337" name="__codelineno-0-5337"></a><span class="sd">                        &#39;description&#39;: &#39;Prominently display up to 5 pieces of content with links, images, pictures, videos, or photos in a highly visual layout.&#39;,</span>
</span><span id="__span-0-5338"><a id="__codelineno-0-5338" name="__codelineno-0-5338"></a><span class="sd">                        &#39;title&#39;: &#39;Hero&#39;,</span>
</span><span id="__span-0-5339"><a id="__codelineno-0-5339" name="__codelineno-0-5339"></a><span class="sd">                        &#39;properties&#39;: {</span>
</span><span id="__span-0-5340"><a id="__codelineno-0-5340" name="__codelineno-0-5340"></a><span class="sd">                            &#39;heroLayoutThreshold&#39;: 640,</span>
</span><span id="__span-0-5341"><a id="__codelineno-0-5341" name="__codelineno-0-5341"></a><span class="sd">                            &#39;carouselLayoutMaxWidth&#39;: 639,</span>
</span><span id="__span-0-5342"><a id="__codelineno-0-5342" name="__codelineno-0-5342"></a><span class="sd">                            &#39;layoutCategory&#39;: 1,</span>
</span><span id="__span-0-5343"><a id="__codelineno-0-5343" name="__codelineno-0-5343"></a><span class="sd">                            &#39;layout&#39;: 5,</span>
</span><span id="__span-0-5344"><a id="__codelineno-0-5344" name="__codelineno-0-5344"></a><span class="sd">                            &#39;content@odata.type&#39;: &#39;#Collection(graph.Json)&#39;,</span>
</span><span id="__span-0-5345"><a id="__codelineno-0-5345" name="__codelineno-0-5345"></a><span class="sd">                            &#39;content&#39;: [</span>
</span><span id="__span-0-5346"><a id="__codelineno-0-5346" name="__codelineno-0-5346"></a><span class="sd">                                {</span>
</span><span id="__span-0-5347"><a id="__codelineno-0-5347" name="__codelineno-0-5347"></a><span class="sd">                                    &#39;id&#39;: &#39;20cb6611-c7cc-4ba7-91e1-65a6cb576025&#39;,</span>
</span><span id="__span-0-5348"><a id="__codelineno-0-5348" name="__codelineno-0-5348"></a><span class="sd">                                    &#39;type&#39;: &#39;UrlLink&#39;,</span>
</span><span id="__span-0-5349"><a id="__codelineno-0-5349" name="__codelineno-0-5349"></a><span class="sd">                                    &#39;color&#39;: 4,</span>
</span><span id="__span-0-5350"><a id="__codelineno-0-5350" name="__codelineno-0-5350"></a><span class="sd">                                    &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5351"><a id="__codelineno-0-5351" name="__codelineno-0-5351"></a><span class="sd">                                    &#39;title&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5352"><a id="__codelineno-0-5352" name="__codelineno-0-5352"></a><span class="sd">                                    &#39;showDescription&#39;: False,</span>
</span><span id="__span-0-5353"><a id="__codelineno-0-5353" name="__codelineno-0-5353"></a><span class="sd">                                    &#39;showTitle&#39;: True,</span>
</span><span id="__span-0-5354"><a id="__codelineno-0-5354" name="__codelineno-0-5354"></a><span class="sd">                                    &#39;alternateText&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5355"><a id="__codelineno-0-5355" name="__codelineno-0-5355"></a><span class="sd">                                    &#39;imageDisplayOption&#39;: 1,</span>
</span><span id="__span-0-5356"><a id="__codelineno-0-5356" name="__codelineno-0-5356"></a><span class="sd">                                    &#39;isDefaultImage&#39;: False,</span>
</span><span id="__span-0-5357"><a id="__codelineno-0-5357" name="__codelineno-0-5357"></a><span class="sd">                                    &#39;showCallToAction&#39;: True,</span>
</span><span id="__span-0-5358"><a id="__codelineno-0-5358" name="__codelineno-0-5358"></a><span class="sd">                                    &#39;isDefaultImageLoaded&#39;: False,</span>
</span><span id="__span-0-5359"><a id="__codelineno-0-5359" name="__codelineno-0-5359"></a><span class="sd">                                    &#39;isCustomImageLoaded&#39;: False,</span>
</span><span id="__span-0-5360"><a id="__codelineno-0-5360" name="__codelineno-0-5360"></a><span class="sd">                                    &#39;showFeatureText&#39;: False,</span>
</span><span id="__span-0-5361"><a id="__codelineno-0-5361" name="__codelineno-0-5361"></a><span class="sd">                                    &#39;previewImage&#39;: {...}</span>
</span><span id="__span-0-5362"><a id="__codelineno-0-5362" name="__codelineno-0-5362"></a><span class="sd">                                },</span>
</span><span id="__span-0-5363"><a id="__codelineno-0-5363" name="__codelineno-0-5363"></a><span class="sd">                                {</span>
</span><span id="__span-0-5364"><a id="__codelineno-0-5364" name="__codelineno-0-5364"></a><span class="sd">                                    &#39;id&#39;: &#39;83133733-960b-4139-a73f-17ce2ca5f71c&#39;,</span>
</span><span id="__span-0-5365"><a id="__codelineno-0-5365" name="__codelineno-0-5365"></a><span class="sd">                                    &#39;type&#39;: &#39;Image&#39;,</span>
</span><span id="__span-0-5366"><a id="__codelineno-0-5366" name="__codelineno-0-5366"></a><span class="sd">                                    &#39;color&#39;: 4,</span>
</span><span id="__span-0-5367"><a id="__codelineno-0-5367" name="__codelineno-0-5367"></a><span class="sd">                                    &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5368"><a id="__codelineno-0-5368" name="__codelineno-0-5368"></a><span class="sd">                                    &#39;title&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5369"><a id="__codelineno-0-5369" name="__codelineno-0-5369"></a><span class="sd">                                    &#39;showDescription&#39;: False,</span>
</span><span id="__span-0-5370"><a id="__codelineno-0-5370" name="__codelineno-0-5370"></a><span class="sd">                                    &#39;showTitle&#39;: True,</span>
</span><span id="__span-0-5371"><a id="__codelineno-0-5371" name="__codelineno-0-5371"></a><span class="sd">                                    &#39;alternateText&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5372"><a id="__codelineno-0-5372" name="__codelineno-0-5372"></a><span class="sd">                                    &#39;imageDisplayOption&#39;: 0,</span>
</span><span id="__span-0-5373"><a id="__codelineno-0-5373" name="__codelineno-0-5373"></a><span class="sd">                                    &#39;isDefaultImage&#39;: False,</span>
</span><span id="__span-0-5374"><a id="__codelineno-0-5374" name="__codelineno-0-5374"></a><span class="sd">                                    &#39;showCallToAction&#39;: False,</span>
</span><span id="__span-0-5375"><a id="__codelineno-0-5375" name="__codelineno-0-5375"></a><span class="sd">                                    &#39;isDefaultImageLoaded&#39;: False,</span>
</span><span id="__span-0-5376"><a id="__codelineno-0-5376" name="__codelineno-0-5376"></a><span class="sd">                                    &#39;isCustomImageLoaded&#39;: False,</span>
</span><span id="__span-0-5377"><a id="__codelineno-0-5377" name="__codelineno-0-5377"></a><span class="sd">                                    &#39;showFeatureText&#39;: False</span>
</span><span id="__span-0-5378"><a id="__codelineno-0-5378" name="__codelineno-0-5378"></a><span class="sd">                                },</span>
</span><span id="__span-0-5379"><a id="__codelineno-0-5379" name="__codelineno-0-5379"></a><span class="sd">                                ...</span>
</span><span id="__span-0-5380"><a id="__codelineno-0-5380" name="__codelineno-0-5380"></a><span class="sd">                            ]</span>
</span><span id="__span-0-5381"><a id="__codelineno-0-5381" name="__codelineno-0-5381"></a><span class="sd">                        },</span>
</span><span id="__span-0-5382"><a id="__codelineno-0-5382" name="__codelineno-0-5382"></a><span class="sd">                        &#39;serverProcessedContent&#39;: {</span>
</span><span id="__span-0-5383"><a id="__codelineno-0-5383" name="__codelineno-0-5383"></a><span class="sd">                            &#39;htmlStrings&#39;: [...],</span>
</span><span id="__span-0-5384"><a id="__codelineno-0-5384" name="__codelineno-0-5384"></a><span class="sd">                            &#39;searchablePlainTexts&#39;: [...],</span>
</span><span id="__span-0-5385"><a id="__codelineno-0-5385" name="__codelineno-0-5385"></a><span class="sd">                            &#39;links&#39;: [...],</span>
</span><span id="__span-0-5386"><a id="__codelineno-0-5386" name="__codelineno-0-5386"></a><span class="sd">                            &#39;imageSources&#39;: [...],</span>
</span><span id="__span-0-5387"><a id="__codelineno-0-5387" name="__codelineno-0-5387"></a><span class="sd">                            &#39;componentDependencies&#39;: [...],</span>
</span><span id="__span-0-5388"><a id="__codelineno-0-5388" name="__codelineno-0-5388"></a><span class="sd">                            &#39;customMetadata&#39;: [...]</span>
</span><span id="__span-0-5389"><a id="__codelineno-0-5389" name="__codelineno-0-5389"></a><span class="sd">                        }</span>
</span><span id="__span-0-5390"><a id="__codelineno-0-5390" name="__codelineno-0-5390"></a><span class="sd">                    }</span>
</span><span id="__span-0-5391"><a id="__codelineno-0-5391" name="__codelineno-0-5391"></a><span class="sd">                },</span>
</span><span id="__span-0-5392"><a id="__codelineno-0-5392" name="__codelineno-0-5392"></a><span class="sd">                {</span>
</span><span id="__span-0-5393"><a id="__codelineno-0-5393" name="__codelineno-0-5393"></a><span class="sd">                    &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5394"><a id="__codelineno-0-5394" name="__codelineno-0-5394"></a><span class="sd">                    &#39;id&#39;: &#39;f7bfdec9-09c5-4fb6-bc97-3ba225d35ad4&#39;,</span>
</span><span id="__span-0-5395"><a id="__codelineno-0-5395" name="__codelineno-0-5395"></a><span class="sd">                    &#39;webPartType&#39;: &#39;8c88f208-6c77-4bdb-86a0-0c47b4316588&#39;,</span>
</span><span id="__span-0-5396"><a id="__codelineno-0-5396" name="__codelineno-0-5396"></a><span class="sd">                    &#39;data&#39;: {...}</span>
</span><span id="__span-0-5397"><a id="__codelineno-0-5397" name="__codelineno-0-5397"></a><span class="sd">                },</span>
</span><span id="__span-0-5398"><a id="__codelineno-0-5398" name="__codelineno-0-5398"></a><span class="sd">                {</span>
</span><span id="__span-0-5399"><a id="__codelineno-0-5399" name="__codelineno-0-5399"></a><span class="sd">                    &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5400"><a id="__codelineno-0-5400" name="__codelineno-0-5400"></a><span class="sd">                    &#39;id&#39;: &#39;f2a8650b-5ea0-4ac2-9cde-56e0fd0279b0&#39;,</span>
</span><span id="__span-0-5401"><a id="__codelineno-0-5401" name="__codelineno-0-5401"></a><span class="sd">                    &#39;webPartType&#39;: &#39;eb95c819-ab8f-4689-bd03-0c2d65d47b1f&#39;,</span>
</span><span id="__span-0-5402"><a id="__codelineno-0-5402" name="__codelineno-0-5402"></a><span class="sd">                    &#39;data&#39;: {...}</span>
</span><span id="__span-0-5403"><a id="__codelineno-0-5403" name="__codelineno-0-5403"></a><span class="sd">                },</span>
</span><span id="__span-0-5404"><a id="__codelineno-0-5404" name="__codelineno-0-5404"></a><span class="sd">                {</span>
</span><span id="__span-0-5405"><a id="__codelineno-0-5405" name="__codelineno-0-5405"></a><span class="sd">                    &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5406"><a id="__codelineno-0-5406" name="__codelineno-0-5406"></a><span class="sd">                    &#39;id&#39;: &#39;418ba70b-4cf7-410a-a5fd-ea38386915ac&#39;,</span>
</span><span id="__span-0-5407"><a id="__codelineno-0-5407" name="__codelineno-0-5407"></a><span class="sd">                    &#39;webPartType&#39;: &#39;c70391ea-0b10-4ee9-b2b4-006d3fcad0cd&#39;,</span>
</span><span id="__span-0-5408"><a id="__codelineno-0-5408" name="__codelineno-0-5408"></a><span class="sd">                    &#39;data&#39;: {...}</span>
</span><span id="__span-0-5409"><a id="__codelineno-0-5409" name="__codelineno-0-5409"></a><span class="sd">                },</span>
</span><span id="__span-0-5410"><a id="__codelineno-0-5410" name="__codelineno-0-5410"></a><span class="sd">                {</span>
</span><span id="__span-0-5411"><a id="__codelineno-0-5411" name="__codelineno-0-5411"></a><span class="sd">                    &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5412"><a id="__codelineno-0-5412" name="__codelineno-0-5412"></a><span class="sd">                    &#39;id&#39;: &#39;416a4c58-61fc-4166-aa19-1099fad50545&#39;,</span>
</span><span id="__span-0-5413"><a id="__codelineno-0-5413" name="__codelineno-0-5413"></a><span class="sd">                    &#39;webPartType&#39;: &#39;f92bf067-bc19-489e-a556-7fe95f508720&#39;,</span>
</span><span id="__span-0-5414"><a id="__codelineno-0-5414" name="__codelineno-0-5414"></a><span class="sd">                    &#39;data&#39;: {...}</span>
</span><span id="__span-0-5415"><a id="__codelineno-0-5415" name="__codelineno-0-5415"></a><span class="sd">                }</span>
</span><span id="__span-0-5416"><a id="__codelineno-0-5416" name="__codelineno-0-5416"></a><span class="sd">            ]</span>
</span><span id="__span-0-5417"><a id="__codelineno-0-5417" name="__codelineno-0-5417"></a><span class="sd">        }</span>
</span><span id="__span-0-5418"><a id="__codelineno-0-5418" name="__codelineno-0-5418"></a>
</span><span id="__span-0-5419"><a id="__codelineno-0-5419" name="__codelineno-0-5419"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5420"><a id="__codelineno-0-5420" name="__codelineno-0-5420"></a>
</span><span id="__span-0-5421"><a id="__codelineno-0-5421" name="__codelineno-0-5421"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span> <span class="o">+</span> <span class="n">page_id</span> <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage&quot;</span>
</span><span id="__span-0-5422"><a id="__codelineno-0-5422" name="__codelineno-0-5422"></a>        <span class="k">if</span> <span class="n">section_type</span><span class="p">:</span>
</span><span id="__span-0-5423"><a id="__codelineno-0-5423" name="__codelineno-0-5423"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/canvasLayout/&quot;</span> <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5424"><a id="__codelineno-0-5424" name="__codelineno-0-5424"></a>        <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5425"><a id="__codelineno-0-5425" name="__codelineno-0-5425"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5426"><a id="__codelineno-0-5426" name="__codelineno-0-5426"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/columns/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">column_id</span><span class="p">)</span>
</span><span id="__span-0-5427"><a id="__codelineno-0-5427" name="__codelineno-0-5427"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/webparts&quot;</span>
</span><span id="__span-0-5428"><a id="__codelineno-0-5428" name="__codelineno-0-5428"></a>
</span><span id="__span-0-5429"><a id="__codelineno-0-5429" name="__codelineno-0-5429"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5430"><a id="__codelineno-0-5430" name="__codelineno-0-5430"></a>
</span><span id="__span-0-5431"><a id="__codelineno-0-5431" name="__codelineno-0-5431"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5432"><a id="__codelineno-0-5432" name="__codelineno-0-5432"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5433"><a id="__codelineno-0-5433" name="__codelineno-0-5433"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-5434"><a id="__codelineno-0-5434" name="__codelineno-0-5434"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5435"><a id="__codelineno-0-5435" name="__codelineno-0-5435"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5436"><a id="__codelineno-0-5436" name="__codelineno-0-5436"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get webparts for page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; of SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5437"><a id="__codelineno-0-5437" name="__codelineno-0-5437"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5438"><a id="__codelineno-0-5438" name="__codelineno-0-5438"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5439"><a id="__codelineno-0-5439" name="__codelineno-0-5439"></a>            <span class="p">),</span>
</span><span id="__span-0-5440"><a id="__codelineno-0-5440" name="__codelineno-0-5440"></a>        <span class="p">)</span>
</span><span id="__span-0-5441"><a id="__codelineno-0-5441" name="__codelineno-0-5441"></a>
</span><span id="__span-0-5442"><a id="__codelineno-0-5442" name="__codelineno-0-5442"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5443"><a id="__codelineno-0-5443" name="__codelineno-0-5443"></a>
</span><span id="__span-0-5444"><a id="__codelineno-0-5444" name="__codelineno-0-5444"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5445"><a id="__codelineno-0-5445" name="__codelineno-0-5445"></a>
</span><span id="__span-0-5446"><a id="__codelineno-0-5446" name="__codelineno-0-5446"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_webpart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">webpart_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5447"><a id="__codelineno-0-5447" name="__codelineno-0-5447"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a page of a SharePoint site accessible to the authenticated user.</span>
</span><span id="__span-0-5448"><a id="__codelineno-0-5448" name="__codelineno-0-5448"></a>
</span><span id="__span-0-5449"><a id="__codelineno-0-5449" name="__codelineno-0-5449"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5450"><a id="__codelineno-0-5450" name="__codelineno-0-5450"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5451"><a id="__codelineno-0-5451" name="__codelineno-0-5451"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5452"><a id="__codelineno-0-5452" name="__codelineno-0-5452"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5453"><a id="__codelineno-0-5453" name="__codelineno-0-5453"></a><span class="sd">                The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5454"><a id="__codelineno-0-5454" name="__codelineno-0-5454"></a><span class="sd">            webpart_id (str):</span>
</span><span id="__span-0-5455"><a id="__codelineno-0-5455" name="__codelineno-0-5455"></a><span class="sd">                The ID of the SharePoint web part to retrieve.</span>
</span><span id="__span-0-5456"><a id="__codelineno-0-5456" name="__codelineno-0-5456"></a>
</span><span id="__span-0-5457"><a id="__codelineno-0-5457" name="__codelineno-0-5457"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5458"><a id="__codelineno-0-5458" name="__codelineno-0-5458"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-5459"><a id="__codelineno-0-5459" name="__codelineno-0-5459"></a><span class="sd">                The data of the SharePoint web part.</span>
</span><span id="__span-0-5460"><a id="__codelineno-0-5460" name="__codelineno-0-5460"></a>
</span><span id="__span-0-5461"><a id="__codelineno-0-5461" name="__codelineno-0-5461"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5462"><a id="__codelineno-0-5462" name="__codelineno-0-5462"></a><span class="sd">        {</span>
</span><span id="__span-0-5463"><a id="__codelineno-0-5463" name="__codelineno-0-5463"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C9b203cbe-27ca-45b2-944a-663cc99e5e8f%2Ca1462b54-26f9-4a24-9660-2bc7859ce9af&#39;)/pages(&#39;a546ce61-21e6-431d-b2cd-67d1f722be5f&#39;)/microsoft.graph.sitePage/webParts/$entity&quot;,</span>
</span><span id="__span-0-5464"><a id="__codelineno-0-5464" name="__codelineno-0-5464"></a><span class="sd">            &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5465"><a id="__codelineno-0-5465" name="__codelineno-0-5465"></a><span class="sd">            &#39;id&#39;: &#39;405b669e-3c09-45fe-822f-ff60ac7fffce&#39;,</span>
</span><span id="__span-0-5466"><a id="__codelineno-0-5466" name="__codelineno-0-5466"></a><span class="sd">            &#39;webPartType&#39;: &#39;c4bd7b2f-7b6e-4599-8485-16504575f590&#39;,</span>
</span><span id="__span-0-5467"><a id="__codelineno-0-5467" name="__codelineno-0-5467"></a><span class="sd">            &#39;data&#39;: {</span>
</span><span id="__span-0-5468"><a id="__codelineno-0-5468" name="__codelineno-0-5468"></a><span class="sd">                &#39;audiences&#39;: [...],</span>
</span><span id="__span-0-5469"><a id="__codelineno-0-5469" name="__codelineno-0-5469"></a><span class="sd">                &#39;dataVersion&#39;: &#39;1.5&#39;,</span>
</span><span id="__span-0-5470"><a id="__codelineno-0-5470" name="__codelineno-0-5470"></a><span class="sd">                &#39;description&#39;: &#39;Prominently display up to 5 pieces of content with links, images, pictures, videos, or photos in a highly visual layout.&#39;,</span>
</span><span id="__span-0-5471"><a id="__codelineno-0-5471" name="__codelineno-0-5471"></a><span class="sd">                &#39;title&#39;: &#39;Hero&#39;,</span>
</span><span id="__span-0-5472"><a id="__codelineno-0-5472" name="__codelineno-0-5472"></a><span class="sd">                &#39;properties&#39;: {</span>
</span><span id="__span-0-5473"><a id="__codelineno-0-5473" name="__codelineno-0-5473"></a><span class="sd">                    &#39;heroLayoutThreshold&#39;: 640,</span>
</span><span id="__span-0-5474"><a id="__codelineno-0-5474" name="__codelineno-0-5474"></a><span class="sd">                    &#39;carouselLayoutMaxWidth&#39;: 639,</span>
</span><span id="__span-0-5475"><a id="__codelineno-0-5475" name="__codelineno-0-5475"></a><span class="sd">                    &#39;layoutCategory&#39;: 1,</span>
</span><span id="__span-0-5476"><a id="__codelineno-0-5476" name="__codelineno-0-5476"></a><span class="sd">                    &#39;layout&#39;: 5,</span>
</span><span id="__span-0-5477"><a id="__codelineno-0-5477" name="__codelineno-0-5477"></a><span class="sd">                    &#39;content@odata.type&#39;: &#39;#Collection(graph.Json)&#39;,</span>
</span><span id="__span-0-5478"><a id="__codelineno-0-5478" name="__codelineno-0-5478"></a><span class="sd">                    &#39;content&#39;: [</span>
</span><span id="__span-0-5479"><a id="__codelineno-0-5479" name="__codelineno-0-5479"></a><span class="sd">                        {</span>
</span><span id="__span-0-5480"><a id="__codelineno-0-5480" name="__codelineno-0-5480"></a><span class="sd">                            &#39;id&#39;: &#39;20cb6611-c7cc-4ba7-91e1-65a6cb576025&#39;,</span>
</span><span id="__span-0-5481"><a id="__codelineno-0-5481" name="__codelineno-0-5481"></a><span class="sd">                            &#39;type&#39;: &#39;UrlLink&#39;,</span>
</span><span id="__span-0-5482"><a id="__codelineno-0-5482" name="__codelineno-0-5482"></a><span class="sd">                            &#39;color&#39;: 4,</span>
</span><span id="__span-0-5483"><a id="__codelineno-0-5483" name="__codelineno-0-5483"></a><span class="sd">                            &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5484"><a id="__codelineno-0-5484" name="__codelineno-0-5484"></a><span class="sd">                            &#39;title&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5485"><a id="__codelineno-0-5485" name="__codelineno-0-5485"></a><span class="sd">                            &#39;showDescription&#39;: False,</span>
</span><span id="__span-0-5486"><a id="__codelineno-0-5486" name="__codelineno-0-5486"></a><span class="sd">                            &#39;showTitle&#39;: True,</span>
</span><span id="__span-0-5487"><a id="__codelineno-0-5487" name="__codelineno-0-5487"></a><span class="sd">                            &#39;alternateText&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5488"><a id="__codelineno-0-5488" name="__codelineno-0-5488"></a><span class="sd">                            &#39;imageDisplayOption&#39;: 1,</span>
</span><span id="__span-0-5489"><a id="__codelineno-0-5489" name="__codelineno-0-5489"></a><span class="sd">                            &#39;isDefaultImage&#39;: False,</span>
</span><span id="__span-0-5490"><a id="__codelineno-0-5490" name="__codelineno-0-5490"></a><span class="sd">                            &#39;showCallToAction&#39;: True,</span>
</span><span id="__span-0-5491"><a id="__codelineno-0-5491" name="__codelineno-0-5491"></a><span class="sd">                            &#39;isDefaultImageLoaded&#39;: False,</span>
</span><span id="__span-0-5492"><a id="__codelineno-0-5492" name="__codelineno-0-5492"></a><span class="sd">                            &#39;isCustomImageLoaded&#39;: False,</span>
</span><span id="__span-0-5493"><a id="__codelineno-0-5493" name="__codelineno-0-5493"></a><span class="sd">                            &#39;showFeatureText&#39;: False,</span>
</span><span id="__span-0-5494"><a id="__codelineno-0-5494" name="__codelineno-0-5494"></a><span class="sd">                            &#39;previewImage&#39;: {</span>
</span><span id="__span-0-5495"><a id="__codelineno-0-5495" name="__codelineno-0-5495"></a><span class="sd">                                &#39;@odata.type&#39;: &#39;#graph.Json&#39;,</span>
</span><span id="__span-0-5496"><a id="__codelineno-0-5496" name="__codelineno-0-5496"></a><span class="sd">                                &#39;zoomRatio&#39;: 1,</span>
</span><span id="__span-0-5497"><a id="__codelineno-0-5497" name="__codelineno-0-5497"></a><span class="sd">                                &#39;resolvedUrl&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5498"><a id="__codelineno-0-5498" name="__codelineno-0-5498"></a><span class="sd">                                &#39;imageUrl&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5499"><a id="__codelineno-0-5499" name="__codelineno-0-5499"></a><span class="sd">                                &#39;widthFactor&#39;: 0.5,</span>
</span><span id="__span-0-5500"><a id="__codelineno-0-5500" name="__codelineno-0-5500"></a><span class="sd">                                &#39;minCanvasWidth&#39;: 1</span>
</span><span id="__span-0-5501"><a id="__codelineno-0-5501" name="__codelineno-0-5501"></a><span class="sd">                            }</span>
</span><span id="__span-0-5502"><a id="__codelineno-0-5502" name="__codelineno-0-5502"></a><span class="sd">                        },</span>
</span><span id="__span-0-5503"><a id="__codelineno-0-5503" name="__codelineno-0-5503"></a><span class="sd">                        {...}</span>
</span><span id="__span-0-5504"><a id="__codelineno-0-5504" name="__codelineno-0-5504"></a><span class="sd">                    ]</span>
</span><span id="__span-0-5505"><a id="__codelineno-0-5505" name="__codelineno-0-5505"></a><span class="sd">                },</span>
</span><span id="__span-0-5506"><a id="__codelineno-0-5506" name="__codelineno-0-5506"></a><span class="sd">                &#39;serverProcessedContent&#39;: {...}</span>
</span><span id="__span-0-5507"><a id="__codelineno-0-5507" name="__codelineno-0-5507"></a><span class="sd">            }</span>
</span><span id="__span-0-5508"><a id="__codelineno-0-5508" name="__codelineno-0-5508"></a><span class="sd">        }</span>
</span><span id="__span-0-5509"><a id="__codelineno-0-5509" name="__codelineno-0-5509"></a>
</span><span id="__span-0-5510"><a id="__codelineno-0-5510" name="__codelineno-0-5510"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5511"><a id="__codelineno-0-5511" name="__codelineno-0-5511"></a>
</span><span id="__span-0-5512"><a id="__codelineno-0-5512" name="__codelineno-0-5512"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5513"><a id="__codelineno-0-5513" name="__codelineno-0-5513"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5514"><a id="__codelineno-0-5514" name="__codelineno-0-5514"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5515"><a id="__codelineno-0-5515" name="__codelineno-0-5515"></a>            <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5516"><a id="__codelineno-0-5516" name="__codelineno-0-5516"></a>            <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5517"><a id="__codelineno-0-5517" name="__codelineno-0-5517"></a>            <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5518"><a id="__codelineno-0-5518" name="__codelineno-0-5518"></a>            <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/webparts/&quot;</span>
</span><span id="__span-0-5519"><a id="__codelineno-0-5519" name="__codelineno-0-5519"></a>            <span class="o">+</span> <span class="n">webpart_id</span>
</span><span id="__span-0-5520"><a id="__codelineno-0-5520" name="__codelineno-0-5520"></a>        <span class="p">)</span>
</span><span id="__span-0-5521"><a id="__codelineno-0-5521" name="__codelineno-0-5521"></a>
</span><span id="__span-0-5522"><a id="__codelineno-0-5522" name="__codelineno-0-5522"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5523"><a id="__codelineno-0-5523" name="__codelineno-0-5523"></a>
</span><span id="__span-0-5524"><a id="__codelineno-0-5524" name="__codelineno-0-5524"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5525"><a id="__codelineno-0-5525" name="__codelineno-0-5525"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5526"><a id="__codelineno-0-5526" name="__codelineno-0-5526"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-5527"><a id="__codelineno-0-5527" name="__codelineno-0-5527"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5528"><a id="__codelineno-0-5528" name="__codelineno-0-5528"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5529"><a id="__codelineno-0-5529" name="__codelineno-0-5529"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint webpart -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5530"><a id="__codelineno-0-5530" name="__codelineno-0-5530"></a>                <span class="n">webpart_id</span><span class="p">,</span>
</span><span id="__span-0-5531"><a id="__codelineno-0-5531" name="__codelineno-0-5531"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5532"><a id="__codelineno-0-5532" name="__codelineno-0-5532"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5533"><a id="__codelineno-0-5533" name="__codelineno-0-5533"></a>            <span class="p">),</span>
</span><span id="__span-0-5534"><a id="__codelineno-0-5534" name="__codelineno-0-5534"></a>        <span class="p">)</span>
</span><span id="__span-0-5535"><a id="__codelineno-0-5535" name="__codelineno-0-5535"></a>
</span><span id="__span-0-5536"><a id="__codelineno-0-5536" name="__codelineno-0-5536"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5537"><a id="__codelineno-0-5537" name="__codelineno-0-5537"></a>
</span><span id="__span-0-5538"><a id="__codelineno-0-5538" name="__codelineno-0-5538"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5539"><a id="__codelineno-0-5539" name="__codelineno-0-5539"></a>
</span><span id="__span-0-5540"><a id="__codelineno-0-5540" name="__codelineno-0-5540"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_sharepoint_webpart</span><span class="p">(</span>
</span><span id="__span-0-5541"><a id="__codelineno-0-5541" name="__codelineno-0-5541"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5542"><a id="__codelineno-0-5542" name="__codelineno-0-5542"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5543"><a id="__codelineno-0-5543" name="__codelineno-0-5543"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5544"><a id="__codelineno-0-5544" name="__codelineno-0-5544"></a>        <span class="n">webpart_type_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5545"><a id="__codelineno-0-5545" name="__codelineno-0-5545"></a>        <span class="n">create_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="__span-0-5546"><a id="__codelineno-0-5546" name="__codelineno-0-5546"></a>        <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5547"><a id="__codelineno-0-5547" name="__codelineno-0-5547"></a>        <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5548"><a id="__codelineno-0-5548" name="__codelineno-0-5548"></a>        <span class="n">column_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5549"><a id="__codelineno-0-5549" name="__codelineno-0-5549"></a>        <span class="n">republish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5550"><a id="__codelineno-0-5550" name="__codelineno-0-5550"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5551"><a id="__codelineno-0-5551" name="__codelineno-0-5551"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a specific web part on a SharePoint page.</span>
</span><span id="__span-0-5552"><a id="__codelineno-0-5552" name="__codelineno-0-5552"></a>
</span><span id="__span-0-5553"><a id="__codelineno-0-5553" name="__codelineno-0-5553"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5554"><a id="__codelineno-0-5554" name="__codelineno-0-5554"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5555"><a id="__codelineno-0-5555" name="__codelineno-0-5555"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5556"><a id="__codelineno-0-5556" name="__codelineno-0-5556"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5557"><a id="__codelineno-0-5557" name="__codelineno-0-5557"></a><span class="sd">                The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5558"><a id="__codelineno-0-5558" name="__codelineno-0-5558"></a><span class="sd">            webpart_type_id (str):</span>
</span><span id="__span-0-5559"><a id="__codelineno-0-5559" name="__codelineno-0-5559"></a><span class="sd">                The ID of the web part to create.</span>
</span><span id="__span-0-5560"><a id="__codelineno-0-5560" name="__codelineno-0-5560"></a><span class="sd">                Content Browser: &#39;cecfdba4-2e82-4538-9436-dbd1c4c01a80&#39;</span>
</span><span id="__span-0-5561"><a id="__codelineno-0-5561" name="__codelineno-0-5561"></a><span class="sd">                Related Workspaces: &#39;e24d7154-4554-4db6-a44f-d306b6b3a5d4&#39;</span>
</span><span id="__span-0-5562"><a id="__codelineno-0-5562" name="__codelineno-0-5562"></a><span class="sd">                Team members of Workspace: &#39;635a2800-8833-410d-b1f1-f209b28ea2ad&#39;</span>
</span><span id="__span-0-5563"><a id="__codelineno-0-5563" name="__codelineno-0-5563"></a><span class="sd">            create_data (dict):</span>
</span><span id="__span-0-5564"><a id="__codelineno-0-5564" name="__codelineno-0-5564"></a><span class="sd">                A dictionary with the webpart data items that will be used</span>
</span><span id="__span-0-5565"><a id="__codelineno-0-5565" name="__codelineno-0-5565"></a><span class="sd">                to update the &quot;data&quot; structure of the webpart.</span>
</span><span id="__span-0-5566"><a id="__codelineno-0-5566" name="__codelineno-0-5566"></a><span class="sd">            section_type (str, optional):</span>
</span><span id="__span-0-5567"><a id="__codelineno-0-5567" name="__codelineno-0-5567"></a><span class="sd">                &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5568"><a id="__codelineno-0-5568" name="__codelineno-0-5568"></a><span class="sd">                &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5569"><a id="__codelineno-0-5569" name="__codelineno-0-5569"></a><span class="sd">            section_id (str | int):</span>
</span><span id="__span-0-5570"><a id="__codelineno-0-5570" name="__codelineno-0-5570"></a><span class="sd">                The ID of the section.Only relevant for horizontal sections.</span>
</span><span id="__span-0-5571"><a id="__codelineno-0-5571" name="__codelineno-0-5571"></a><span class="sd">                Simple values like 1,2,3...</span>
</span><span id="__span-0-5572"><a id="__codelineno-0-5572" name="__codelineno-0-5572"></a><span class="sd">                Defaults to 1.</span>
</span><span id="__span-0-5573"><a id="__codelineno-0-5573" name="__codelineno-0-5573"></a><span class="sd">            column_id (int | str, optional):</span>
</span><span id="__span-0-5574"><a id="__codelineno-0-5574" name="__codelineno-0-5574"></a><span class="sd">                For horizontalSections the column ID has to be provided.</span>
</span><span id="__span-0-5575"><a id="__codelineno-0-5575" name="__codelineno-0-5575"></a><span class="sd">                Defaults to 1.</span>
</span><span id="__span-0-5576"><a id="__codelineno-0-5576" name="__codelineno-0-5576"></a><span class="sd">            republish (bool, optional):</span>
</span><span id="__span-0-5577"><a id="__codelineno-0-5577" name="__codelineno-0-5577"></a><span class="sd">                If True, the page is republished to make the section active.</span>
</span><span id="__span-0-5578"><a id="__codelineno-0-5578" name="__codelineno-0-5578"></a>
</span><span id="__span-0-5579"><a id="__codelineno-0-5579" name="__codelineno-0-5579"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5580"><a id="__codelineno-0-5580" name="__codelineno-0-5580"></a><span class="sd">            dict:</span>
</span><span id="__span-0-5581"><a id="__codelineno-0-5581" name="__codelineno-0-5581"></a><span class="sd">                The updated web part.</span>
</span><span id="__span-0-5582"><a id="__codelineno-0-5582" name="__codelineno-0-5582"></a>
</span><span id="__span-0-5583"><a id="__codelineno-0-5583" name="__codelineno-0-5583"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5584"><a id="__codelineno-0-5584" name="__codelineno-0-5584"></a><span class="sd">        {</span>
</span><span id="__span-0-5585"><a id="__codelineno-0-5585" name="__codelineno-0-5585"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections(&#39;1&#39;)/columns(&#39;1&#39;)/webparts/$entity&quot;,</span>
</span><span id="__span-0-5586"><a id="__codelineno-0-5586" name="__codelineno-0-5586"></a><span class="sd">            &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5587"><a id="__codelineno-0-5587" name="__codelineno-0-5587"></a><span class="sd">            &#39;id&#39;: &#39;3df7fe9a-a1e0-4212-968c-73bd70ca3e31&#39;,</span>
</span><span id="__span-0-5588"><a id="__codelineno-0-5588" name="__codelineno-0-5588"></a><span class="sd">            &#39;webPartType&#39;: &#39;eb95c819-ab8f-4689-bd03-0c2d65d47b1f&#39;,</span>
</span><span id="__span-0-5589"><a id="__codelineno-0-5589" name="__codelineno-0-5589"></a><span class="sd">            &#39;data&#39;: {</span>
</span><span id="__span-0-5590"><a id="__codelineno-0-5590" name="__codelineno-0-5590"></a><span class="sd">                &#39;audiences&#39;: [...],</span>
</span><span id="__span-0-5591"><a id="__codelineno-0-5591" name="__codelineno-0-5591"></a><span class="sd">                &#39;dataVersion&#39;: &#39;1.0&#39;,</span>
</span><span id="__span-0-5592"><a id="__codelineno-0-5592" name="__codelineno-0-5592"></a><span class="sd">                &#39;title&#39;: &#39;Site activity&#39;,</span>
</span><span id="__span-0-5593"><a id="__codelineno-0-5593" name="__codelineno-0-5593"></a><span class="sd">                &#39;properties&#39;: {&#39;maxItems&#39;: 9},</span>
</span><span id="__span-0-5594"><a id="__codelineno-0-5594" name="__codelineno-0-5594"></a><span class="sd">                &#39;serverProcessedContent&#39;: {</span>
</span><span id="__span-0-5595"><a id="__codelineno-0-5595" name="__codelineno-0-5595"></a><span class="sd">                    &#39;htmlStrings&#39;: [],</span>
</span><span id="__span-0-5596"><a id="__codelineno-0-5596" name="__codelineno-0-5596"></a><span class="sd">                    &#39;searchablePlainTexts&#39;: [],</span>
</span><span id="__span-0-5597"><a id="__codelineno-0-5597" name="__codelineno-0-5597"></a><span class="sd">                    &#39;links&#39;: [],</span>
</span><span id="__span-0-5598"><a id="__codelineno-0-5598" name="__codelineno-0-5598"></a><span class="sd">                    &#39;imageSources&#39;: []</span>
</span><span id="__span-0-5599"><a id="__codelineno-0-5599" name="__codelineno-0-5599"></a><span class="sd">                }</span>
</span><span id="__span-0-5600"><a id="__codelineno-0-5600" name="__codelineno-0-5600"></a><span class="sd">            }</span>
</span><span id="__span-0-5601"><a id="__codelineno-0-5601" name="__codelineno-0-5601"></a><span class="sd">        }</span>
</span><span id="__span-0-5602"><a id="__codelineno-0-5602" name="__codelineno-0-5602"></a>
</span><span id="__span-0-5603"><a id="__codelineno-0-5603" name="__codelineno-0-5603"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5604"><a id="__codelineno-0-5604" name="__codelineno-0-5604"></a>
</span><span id="__span-0-5605"><a id="__codelineno-0-5605" name="__codelineno-0-5605"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5606"><a id="__codelineno-0-5606" name="__codelineno-0-5606"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5607"><a id="__codelineno-0-5607" name="__codelineno-0-5607"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5608"><a id="__codelineno-0-5608" name="__codelineno-0-5608"></a>            <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5609"><a id="__codelineno-0-5609" name="__codelineno-0-5609"></a>            <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5610"><a id="__codelineno-0-5610" name="__codelineno-0-5610"></a>            <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5611"><a id="__codelineno-0-5611" name="__codelineno-0-5611"></a>            <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5612"><a id="__codelineno-0-5612" name="__codelineno-0-5612"></a>            <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5613"><a id="__codelineno-0-5613" name="__codelineno-0-5613"></a>        <span class="p">)</span>
</span><span id="__span-0-5614"><a id="__codelineno-0-5614" name="__codelineno-0-5614"></a>        <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5615"><a id="__codelineno-0-5615" name="__codelineno-0-5615"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5616"><a id="__codelineno-0-5616" name="__codelineno-0-5616"></a>            <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/columns/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">column_id</span><span class="p">)</span>
</span><span id="__span-0-5617"><a id="__codelineno-0-5617" name="__codelineno-0-5617"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/webparts&quot;</span>
</span><span id="__span-0-5618"><a id="__codelineno-0-5618" name="__codelineno-0-5618"></a>
</span><span id="__span-0-5619"><a id="__codelineno-0-5619" name="__codelineno-0-5619"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5620"><a id="__codelineno-0-5620" name="__codelineno-0-5620"></a>
</span><span id="__span-0-5621"><a id="__codelineno-0-5621" name="__codelineno-0-5621"></a>        <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5622"><a id="__codelineno-0-5622" name="__codelineno-0-5622"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5623"><a id="__codelineno-0-5623" name="__codelineno-0-5623"></a>            <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.standardWebPart&quot;</span><span class="p">,</span>  <span class="c1"># likle &quot;#microsoft.graph.standardWebPart&quot; - this is mandatory!</span>
</span><span id="__span-0-5624"><a id="__codelineno-0-5624" name="__codelineno-0-5624"></a>            <span class="s2">&quot;webPartType&quot;</span><span class="p">:</span> <span class="n">webpart_type_id</span><span class="p">,</span>  <span class="c1"># this is mandatory!</span>
</span><span id="__span-0-5625"><a id="__codelineno-0-5625" name="__codelineno-0-5625"></a>            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">create_data</span><span class="p">,</span>
</span><span id="__span-0-5626"><a id="__codelineno-0-5626" name="__codelineno-0-5626"></a>        <span class="p">}</span>
</span><span id="__span-0-5627"><a id="__codelineno-0-5627" name="__codelineno-0-5627"></a>
</span><span id="__span-0-5628"><a id="__codelineno-0-5628" name="__codelineno-0-5628"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5629"><a id="__codelineno-0-5629" name="__codelineno-0-5629"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5630"><a id="__codelineno-0-5630" name="__codelineno-0-5630"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-5631"><a id="__codelineno-0-5631" name="__codelineno-0-5631"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5632"><a id="__codelineno-0-5632" name="__codelineno-0-5632"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5633"><a id="__codelineno-0-5633" name="__codelineno-0-5633"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5634"><a id="__codelineno-0-5634" name="__codelineno-0-5634"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to create SharePoint webpart of type -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="si">{}</span><span class="s2"> in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5635"><a id="__codelineno-0-5635" name="__codelineno-0-5635"></a>                <span class="n">webpart_type_id</span><span class="p">,</span>
</span><span id="__span-0-5636"><a id="__codelineno-0-5636" name="__codelineno-0-5636"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5637"><a id="__codelineno-0-5637" name="__codelineno-0-5637"></a>                <span class="s2">&quot; (horizontal section -&gt; </span><span class="si">{}</span><span class="s2">, column -&gt; </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section_id</span><span class="p">,</span> <span class="n">column_id</span><span class="p">)</span>
</span><span id="__span-0-5638"><a id="__codelineno-0-5638" name="__codelineno-0-5638"></a>                <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span>
</span><span id="__span-0-5639"><a id="__codelineno-0-5639" name="__codelineno-0-5639"></a>                <span class="k">else</span> <span class="s2">&quot; (vertical section)&quot;</span><span class="p">,</span>
</span><span id="__span-0-5640"><a id="__codelineno-0-5640" name="__codelineno-0-5640"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5641"><a id="__codelineno-0-5641" name="__codelineno-0-5641"></a>            <span class="p">),</span>
</span><span id="__span-0-5642"><a id="__codelineno-0-5642" name="__codelineno-0-5642"></a>        <span class="p">)</span>
</span><span id="__span-0-5643"><a id="__codelineno-0-5643" name="__codelineno-0-5643"></a>
</span><span id="__span-0-5644"><a id="__codelineno-0-5644" name="__codelineno-0-5644"></a>        <span class="c1"># Check if the page should be republished:</span>
</span><span id="__span-0-5645"><a id="__codelineno-0-5645" name="__codelineno-0-5645"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">republish</span><span class="p">:</span>
</span><span id="__span-0-5646"><a id="__codelineno-0-5646" name="__codelineno-0-5646"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-5647"><a id="__codelineno-0-5647" name="__codelineno-0-5647"></a>
</span><span id="__span-0-5648"><a id="__codelineno-0-5648" name="__codelineno-0-5648"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5649"><a id="__codelineno-0-5649" name="__codelineno-0-5649"></a>
</span><span id="__span-0-5650"><a id="__codelineno-0-5650" name="__codelineno-0-5650"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5651"><a id="__codelineno-0-5651" name="__codelineno-0-5651"></a>
</span><span id="__span-0-5652"><a id="__codelineno-0-5652" name="__codelineno-0-5652"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_sharepoint_webpart</span><span class="p">(</span>
</span><span id="__span-0-5653"><a id="__codelineno-0-5653" name="__codelineno-0-5653"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5654"><a id="__codelineno-0-5654" name="__codelineno-0-5654"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5655"><a id="__codelineno-0-5655" name="__codelineno-0-5655"></a>        <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5656"><a id="__codelineno-0-5656" name="__codelineno-0-5656"></a>        <span class="n">webpart_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5657"><a id="__codelineno-0-5657" name="__codelineno-0-5657"></a>        <span class="n">update_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="__span-0-5658"><a id="__codelineno-0-5658" name="__codelineno-0-5658"></a>        <span class="n">republish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5659"><a id="__codelineno-0-5659" name="__codelineno-0-5659"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5660"><a id="__codelineno-0-5660" name="__codelineno-0-5660"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update a data of a specific web part on a SharePoint page.</span>
</span><span id="__span-0-5661"><a id="__codelineno-0-5661" name="__codelineno-0-5661"></a>
</span><span id="__span-0-5662"><a id="__codelineno-0-5662" name="__codelineno-0-5662"></a><span class="sd">        Any data elements not provided for the update will remain unchanged!</span>
</span><span id="__span-0-5663"><a id="__codelineno-0-5663" name="__codelineno-0-5663"></a>
</span><span id="__span-0-5664"><a id="__codelineno-0-5664" name="__codelineno-0-5664"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5665"><a id="__codelineno-0-5665" name="__codelineno-0-5665"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5666"><a id="__codelineno-0-5666" name="__codelineno-0-5666"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5667"><a id="__codelineno-0-5667" name="__codelineno-0-5667"></a><span class="sd">            page_id (str):</span>
</span><span id="__span-0-5668"><a id="__codelineno-0-5668" name="__codelineno-0-5668"></a><span class="sd">                The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5669"><a id="__codelineno-0-5669" name="__codelineno-0-5669"></a><span class="sd">            webpart_id (str):</span>
</span><span id="__span-0-5670"><a id="__codelineno-0-5670" name="__codelineno-0-5670"></a><span class="sd">                The ID of the web part to update.</span>
</span><span id="__span-0-5671"><a id="__codelineno-0-5671" name="__codelineno-0-5671"></a><span class="sd">            update_data (dict):</span>
</span><span id="__span-0-5672"><a id="__codelineno-0-5672" name="__codelineno-0-5672"></a><span class="sd">                A dictionary with the updated data items that will be used</span>
</span><span id="__span-0-5673"><a id="__codelineno-0-5673" name="__codelineno-0-5673"></a><span class="sd">                to update the &quot;data&quot; structure of the webpart.</span>
</span><span id="__span-0-5674"><a id="__codelineno-0-5674" name="__codelineno-0-5674"></a><span class="sd">            republish (bool, optional):</span>
</span><span id="__span-0-5675"><a id="__codelineno-0-5675" name="__codelineno-0-5675"></a><span class="sd">                If True, the page is republished to make the section active.</span>
</span><span id="__span-0-5676"><a id="__codelineno-0-5676" name="__codelineno-0-5676"></a>
</span><span id="__span-0-5677"><a id="__codelineno-0-5677" name="__codelineno-0-5677"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5678"><a id="__codelineno-0-5678" name="__codelineno-0-5678"></a><span class="sd">            dict | None:</span>
</span><span id="__span-0-5679"><a id="__codelineno-0-5679" name="__codelineno-0-5679"></a><span class="sd">                The updated web part. None in case of an error.</span>
</span><span id="__span-0-5680"><a id="__codelineno-0-5680" name="__codelineno-0-5680"></a>
</span><span id="__span-0-5681"><a id="__codelineno-0-5681" name="__codelineno-0-5681"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5682"><a id="__codelineno-0-5682" name="__codelineno-0-5682"></a>
</span><span id="__span-0-5683"><a id="__codelineno-0-5683" name="__codelineno-0-5683"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">deep_merge</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-5684"><a id="__codelineno-0-5684" name="__codelineno-0-5684"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Recursively merges source dictionary into destination dictionary.</span>
</span><span id="__span-0-5685"><a id="__codelineno-0-5685" name="__codelineno-0-5685"></a>
</span><span id="__span-0-5686"><a id="__codelineno-0-5686" name="__codelineno-0-5686"></a><span class="sd">            If a key exists in both, the value from destination is kept unless</span>
</span><span id="__span-0-5687"><a id="__codelineno-0-5687" name="__codelineno-0-5687"></a><span class="sd">            both values are dictionaries, in which case they are merged recursively.</span>
</span><span id="__span-0-5688"><a id="__codelineno-0-5688" name="__codelineno-0-5688"></a>
</span><span id="__span-0-5689"><a id="__codelineno-0-5689" name="__codelineno-0-5689"></a><span class="sd">            Args:</span>
</span><span id="__span-0-5690"><a id="__codelineno-0-5690" name="__codelineno-0-5690"></a><span class="sd">                source (dict):</span>
</span><span id="__span-0-5691"><a id="__codelineno-0-5691" name="__codelineno-0-5691"></a><span class="sd">                    The dictionary with the current data values. Will be</span>
</span><span id="__span-0-5692"><a id="__codelineno-0-5692" name="__codelineno-0-5692"></a><span class="sd">                    used if not updated data is in update_data for the particular key.</span>
</span><span id="__span-0-5693"><a id="__codelineno-0-5693" name="__codelineno-0-5693"></a><span class="sd">                destination (dict):</span>
</span><span id="__span-0-5694"><a id="__codelineno-0-5694" name="__codelineno-0-5694"></a><span class="sd">                    The dictionary to merge into, which takes precedence.</span>
</span><span id="__span-0-5695"><a id="__codelineno-0-5695" name="__codelineno-0-5695"></a>
</span><span id="__span-0-5696"><a id="__codelineno-0-5696" name="__codelineno-0-5696"></a><span class="sd">            Returns:</span>
</span><span id="__span-0-5697"><a id="__codelineno-0-5697" name="__codelineno-0-5697"></a><span class="sd">                dict: The merged dictionary.</span>
</span><span id="__span-0-5698"><a id="__codelineno-0-5698" name="__codelineno-0-5698"></a>
</span><span id="__span-0-5699"><a id="__codelineno-0-5699" name="__codelineno-0-5699"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-0-5700"><a id="__codelineno-0-5700" name="__codelineno-0-5700"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-5701"><a id="__codelineno-0-5701" name="__codelineno-0-5701"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">destination</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-5702"><a id="__codelineno-0-5702" name="__codelineno-0-5702"></a>                    <span class="c1"># Recursively merge dictionaries if both values are dictionaries</span>
</span><span id="__span-0-5703"><a id="__codelineno-0-5703" name="__codelineno-0-5703"></a>                    <span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">deep_merge</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="__span-0-5704"><a id="__codelineno-0-5704" name="__codelineno-0-5704"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-5705"><a id="__codelineno-0-5705" name="__codelineno-0-5705"></a>                    <span class="c1"># If key does not exist in destination, use value from source</span>
</span><span id="__span-0-5706"><a id="__codelineno-0-5706" name="__codelineno-0-5706"></a>                    <span class="n">destination</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-5707"><a id="__codelineno-0-5707" name="__codelineno-0-5707"></a>            <span class="k">return</span> <span class="n">destination</span>
</span><span id="__span-0-5708"><a id="__codelineno-0-5708" name="__codelineno-0-5708"></a>
</span><span id="__span-0-5709"><a id="__codelineno-0-5709" name="__codelineno-0-5709"></a>        <span class="c1"># end deep_merge()</span>
</span><span id="__span-0-5710"><a id="__codelineno-0-5710" name="__codelineno-0-5710"></a>
</span><span id="__span-0-5711"><a id="__codelineno-0-5711" name="__codelineno-0-5711"></a>        <span class="n">webpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_webpart</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">,</span> <span class="n">webpart_id</span><span class="o">=</span><span class="n">webpart_id</span><span class="p">)</span>
</span><span id="__span-0-5712"><a id="__codelineno-0-5712" name="__codelineno-0-5712"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">webpart</span><span class="p">:</span>
</span><span id="__span-0-5713"><a id="__codelineno-0-5713" name="__codelineno-0-5713"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-5714"><a id="__codelineno-0-5714" name="__codelineno-0-5714"></a>                <span class="s2">&quot;Cannot find web part for site ID -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;, page -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;, webpart ID -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-5715"><a id="__codelineno-0-5715" name="__codelineno-0-5715"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5716"><a id="__codelineno-0-5716" name="__codelineno-0-5716"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5717"><a id="__codelineno-0-5717" name="__codelineno-0-5717"></a>                <span class="n">webpart_id</span><span class="p">,</span>
</span><span id="__span-0-5718"><a id="__codelineno-0-5718" name="__codelineno-0-5718"></a>            <span class="p">)</span>
</span><span id="__span-0-5719"><a id="__codelineno-0-5719" name="__codelineno-0-5719"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-5720"><a id="__codelineno-0-5720" name="__codelineno-0-5720"></a>        <span class="n">webpart_type_id</span> <span class="o">=</span> <span class="n">webpart</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;webPartType&quot;</span><span class="p">)</span>
</span><span id="__span-0-5721"><a id="__codelineno-0-5721" name="__codelineno-0-5721"></a>        <span class="n">webpart_type_name</span> <span class="o">=</span> <span class="n">webpart</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.type&quot;</span><span class="p">)</span>
</span><span id="__span-0-5722"><a id="__codelineno-0-5722" name="__codelineno-0-5722"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">webpart</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</span><span id="__span-0-5723"><a id="__codelineno-0-5723" name="__codelineno-0-5723"></a>
</span><span id="__span-0-5724"><a id="__codelineno-0-5724" name="__codelineno-0-5724"></a>        <span class="c1"># Fill update_data with missing keys from data</span>
</span><span id="__span-0-5725"><a id="__codelineno-0-5725" name="__codelineno-0-5725"></a>        <span class="n">update_data</span> <span class="o">=</span> <span class="n">deep_merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>  <span class="c1"># Merges, giving precedence to update_data</span>
</span><span id="__span-0-5726"><a id="__codelineno-0-5726" name="__codelineno-0-5726"></a>
</span><span id="__span-0-5727"><a id="__codelineno-0-5727" name="__codelineno-0-5727"></a>        <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5728"><a id="__codelineno-0-5728" name="__codelineno-0-5728"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5729"><a id="__codelineno-0-5729" name="__codelineno-0-5729"></a>            <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="n">webpart_type_name</span><span class="p">,</span>  <span class="c1"># likle &quot;#microsoft.graph.standardWebPart&quot; - this is mandatory!</span>
</span><span id="__span-0-5730"><a id="__codelineno-0-5730" name="__codelineno-0-5730"></a>            <span class="s2">&quot;webPartType&quot;</span><span class="p">:</span> <span class="n">webpart_type_id</span><span class="p">,</span>  <span class="c1"># this is mandatory!</span>
</span><span id="__span-0-5731"><a id="__codelineno-0-5731" name="__codelineno-0-5731"></a>            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">update_data</span><span class="p">,</span>
</span><span id="__span-0-5732"><a id="__codelineno-0-5732" name="__codelineno-0-5732"></a>        <span class="p">}</span>
</span><span id="__span-0-5733"><a id="__codelineno-0-5733" name="__codelineno-0-5733"></a>
</span><span id="__span-0-5734"><a id="__codelineno-0-5734" name="__codelineno-0-5734"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5735"><a id="__codelineno-0-5735" name="__codelineno-0-5735"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5736"><a id="__codelineno-0-5736" name="__codelineno-0-5736"></a>            <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5737"><a id="__codelineno-0-5737" name="__codelineno-0-5737"></a>            <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5738"><a id="__codelineno-0-5738" name="__codelineno-0-5738"></a>            <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5739"><a id="__codelineno-0-5739" name="__codelineno-0-5739"></a>            <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5740"><a id="__codelineno-0-5740" name="__codelineno-0-5740"></a>            <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/webparts/&quot;</span>
</span><span id="__span-0-5741"><a id="__codelineno-0-5741" name="__codelineno-0-5741"></a>            <span class="o">+</span> <span class="n">webpart_id</span>
</span><span id="__span-0-5742"><a id="__codelineno-0-5742" name="__codelineno-0-5742"></a>        <span class="p">)</span>
</span><span id="__span-0-5743"><a id="__codelineno-0-5743" name="__codelineno-0-5743"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5744"><a id="__codelineno-0-5744" name="__codelineno-0-5744"></a>
</span><span id="__span-0-5745"><a id="__codelineno-0-5745" name="__codelineno-0-5745"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5746"><a id="__codelineno-0-5746" name="__codelineno-0-5746"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5747"><a id="__codelineno-0-5747" name="__codelineno-0-5747"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-5748"><a id="__codelineno-0-5748" name="__codelineno-0-5748"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5749"><a id="__codelineno-0-5749" name="__codelineno-0-5749"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5750"><a id="__codelineno-0-5750" name="__codelineno-0-5750"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5751"><a id="__codelineno-0-5751" name="__codelineno-0-5751"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot update SharePoint webpart -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; for Sharepoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5752"><a id="__codelineno-0-5752" name="__codelineno-0-5752"></a>                <span class="n">webpart_id</span><span class="p">,</span>
</span><span id="__span-0-5753"><a id="__codelineno-0-5753" name="__codelineno-0-5753"></a>                <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5754"><a id="__codelineno-0-5754" name="__codelineno-0-5754"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5755"><a id="__codelineno-0-5755" name="__codelineno-0-5755"></a>            <span class="p">),</span>
</span><span id="__span-0-5756"><a id="__codelineno-0-5756" name="__codelineno-0-5756"></a>        <span class="p">)</span>
</span><span id="__span-0-5757"><a id="__codelineno-0-5757" name="__codelineno-0-5757"></a>        <span class="c1"># Check if the page should be republished:</span>
</span><span id="__span-0-5758"><a id="__codelineno-0-5758" name="__codelineno-0-5758"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">republish</span><span class="p">:</span>
</span><span id="__span-0-5759"><a id="__codelineno-0-5759" name="__codelineno-0-5759"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-5760"><a id="__codelineno-0-5760" name="__codelineno-0-5760"></a>
</span><span id="__span-0-5761"><a id="__codelineno-0-5761" name="__codelineno-0-5761"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-5762"><a id="__codelineno-0-5762" name="__codelineno-0-5762"></a>
</span><span id="__span-0-5763"><a id="__codelineno-0-5763" name="__codelineno-0-5763"></a>    <span class="c1"># end method definition</span>
</span><span id="__span-0-5764"><a id="__codelineno-0-5764" name="__codelineno-0-5764"></a>
</span><span id="__span-0-5765"><a id="__codelineno-0-5765" name="__codelineno-0-5765"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">follow_sharepoint_site</span><span class="p">(</span>
</span><span id="__span-0-5766"><a id="__codelineno-0-5766" name="__codelineno-0-5766"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5767"><a id="__codelineno-0-5767" name="__codelineno-0-5767"></a>        <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5768"><a id="__codelineno-0-5768" name="__codelineno-0-5768"></a>        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5769"><a id="__codelineno-0-5769" name="__codelineno-0-5769"></a>        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5770"><a id="__codelineno-0-5770" name="__codelineno-0-5770"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5771"><a id="__codelineno-0-5771" name="__codelineno-0-5771"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Let a user follow a particular SharePoint site.</span>
</span><span id="__span-0-5772"><a id="__codelineno-0-5772" name="__codelineno-0-5772"></a>
</span><span id="__span-0-5773"><a id="__codelineno-0-5773" name="__codelineno-0-5773"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5774"><a id="__codelineno-0-5774" name="__codelineno-0-5774"></a><span class="sd">            site_id (str):</span>
</span><span id="__span-0-5775"><a id="__codelineno-0-5775" name="__codelineno-0-5775"></a><span class="sd">                The ID of the SharePoint site.</span>
</span><span id="__span-0-5776"><a id="__codelineno-0-5776" name="__codelineno-0-5776"></a><span class="sd">            username (str):</span>
</span><span id="__span-0-5777"><a id="__codelineno-0-5777" name="__codelineno-0-5777"></a><span class="sd">                The login name of the user. Only relevant if the user ID</span>
</span><span id="__span-0-5778"><a id="__codelineno-0-5778" name="__codelineno-0-5778"></a><span class="sd">                is not provided.</span>
</span><span id="__span-0-5779"><a id="__codelineno-0-5779" name="__codelineno-0-5779"></a><span class="sd">            user_id (str):</span>
</span><span id="__span-0-5780"><a id="__codelineno-0-5780" name="__codelineno-0-5780"></a><span class="sd">                The user ID. If it is not provied it will be derived from</span>
</span><span id="__span-0-5781"><a id="__codelineno-0-5781" name="__codelineno-0-5781"></a><span class="sd">                the username.</span>
</span><span id="__span-0-5782"><a id="__codelineno-0-5782" name="__codelineno-0-5782"></a>
</span><span id="__span-0-5783"><a id="__codelineno-0-5783" name="__codelineno-0-5783"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5784"><a id="__codelineno-0-5784" name="__codelineno-0-5784"></a><span class="sd">            dict:</span>
</span><span id="__span-0-5785"><a id="__codelineno-0-5785" name="__codelineno-0-5785"></a><span class="sd">                The Graph API response or None in case an error occured..</span>
</span><span id="__span-0-5786"><a id="__codelineno-0-5786" name="__codelineno-0-5786"></a>
</span><span id="__span-0-5787"><a id="__codelineno-0-5787" name="__codelineno-0-5787"></a><span class="sd">        Example:</span>
</span><span id="__span-0-5788"><a id="__codelineno-0-5788" name="__codelineno-0-5788"></a><span class="sd">        {</span>
</span><span id="__span-0-5789"><a id="__codelineno-0-5789" name="__codelineno-0-5789"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#sites&#39;,</span>
</span><span id="__span-0-5790"><a id="__codelineno-0-5790" name="__codelineno-0-5790"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-5791"><a id="__codelineno-0-5791" name="__codelineno-0-5791"></a><span class="sd">                {</span>
</span><span id="__span-0-5792"><a id="__codelineno-0-5792" name="__codelineno-0-5792"></a><span class="sd">                    &#39;id&#39;: &#39;ideateqa.sharepoint.com,c605327f-8531-47da-8c85-9bb63845dda6,34b48533-af41-4743-8b41-185a21f0b80f&#39;,</span>
</span><span id="__span-0-5793"><a id="__codelineno-0-5793" name="__codelineno-0-5793"></a><span class="sd">                    &#39;webUrl&#39;: &#39;https://ideateqa.sharepoint.com/sites/Procurement&#39;,</span>
</span><span id="__span-0-5794"><a id="__codelineno-0-5794" name="__codelineno-0-5794"></a><span class="sd">                    &#39;displayName&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-5795"><a id="__codelineno-0-5795" name="__codelineno-0-5795"></a><span class="sd">                    &#39;sharepointIds&#39;: {</span>
</span><span id="__span-0-5796"><a id="__codelineno-0-5796" name="__codelineno-0-5796"></a><span class="sd">                        &#39;siteId&#39;: &#39;c605327f-8531-47da-8c85-9bb63845dda6&#39;,</span>
</span><span id="__span-0-5797"><a id="__codelineno-0-5797" name="__codelineno-0-5797"></a><span class="sd">                        &#39;siteUrl&#39;: &#39;https://ideateqa.sharepoint.com/sites/Procurement&#39;,</span>
</span><span id="__span-0-5798"><a id="__codelineno-0-5798" name="__codelineno-0-5798"></a><span class="sd">                        &#39;webId&#39;: &#39;34b48533-af41-4743-8b41-185a21f0b80f&#39;</span>
</span><span id="__span-0-5799"><a id="__codelineno-0-5799" name="__codelineno-0-5799"></a><span class="sd">                    },</span>
</span><span id="__span-0-5800"><a id="__codelineno-0-5800" name="__codelineno-0-5800"></a><span class="sd">                    &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-5801"><a id="__codelineno-0-5801" name="__codelineno-0-5801"></a><span class="sd">                        &#39;hostname&#39;: &#39;ideateqa.sharepoint.com&#39;</span>
</span><span id="__span-0-5802"><a id="__codelineno-0-5802" name="__codelineno-0-5802"></a><span class="sd">                    }</span>
</span><span id="__span-0-5803"><a id="__codelineno-0-5803" name="__codelineno-0-5803"></a><span class="sd">                }</span>
</span><span id="__span-0-5804"><a id="__codelineno-0-5804" name="__codelineno-0-5804"></a><span class="sd">            ]</span>
</span><span id="__span-0-5805"><a id="__codelineno-0-5805" name="__codelineno-0-5805"></a><span class="sd">        }</span>
</span><span id="__span-0-5806"><a id="__codelineno-0-5806" name="__codelineno-0-5806"></a>
</span><span id="__span-0-5807"><a id="__codelineno-0-5807" name="__codelineno-0-5807"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5808"><a id="__codelineno-0-5808" name="__codelineno-0-5808"></a>
</span><span id="__span-0-5809"><a id="__codelineno-0-5809" name="__codelineno-0-5809"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">username</span><span class="p">:</span>
</span><span id="__span-0-5810"><a id="__codelineno-0-5810" name="__codelineno-0-5810"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No user given to follow SharePoint site. Provide the user ID or its email address!&quot;</span><span class="p">)</span>
</span><span id="__span-0-5811"><a id="__codelineno-0-5811" name="__codelineno-0-5811"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-5812"><a id="__codelineno-0-5812" name="__codelineno-0-5812"></a>
</span><span id="__span-0-5813"><a id="__codelineno-0-5813" name="__codelineno-0-5813"></a>        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_email</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>
</span><span id="__span-0-5814"><a id="__codelineno-0-5814" name="__codelineno-0-5814"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span><span class="p">:</span>
</span><span id="__span-0-5815"><a id="__codelineno-0-5815" name="__codelineno-0-5815"></a>            <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-5816"><a id="__codelineno-0-5816" name="__codelineno-0-5816"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="p">:</span>
</span><span id="__span-0-5817"><a id="__codelineno-0-5817" name="__codelineno-0-5817"></a>            <span class="n">username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">)</span>
</span><span id="__span-0-5818"><a id="__codelineno-0-5818" name="__codelineno-0-5818"></a>
</span><span id="__span-0-5819"><a id="__codelineno-0-5819" name="__codelineno-0-5819"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/followedSites/add&quot;</span>
</span><span id="__span-0-5820"><a id="__codelineno-0-5820" name="__codelineno-0-5820"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5821"><a id="__codelineno-0-5821" name="__codelineno-0-5821"></a>
</span><span id="__span-0-5822"><a id="__codelineno-0-5822" name="__codelineno-0-5822"></a>        <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5823"><a id="__codelineno-0-5823" name="__codelineno-0-5823"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5824"><a id="__codelineno-0-5824" name="__codelineno-0-5824"></a>            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">site_id</span><span class="p">}],</span>
</span><span id="__span-0-5825"><a id="__codelineno-0-5825" name="__codelineno-0-5825"></a>        <span class="p">}</span>
</span><span id="__span-0-5826"><a id="__codelineno-0-5826" name="__codelineno-0-5826"></a>
</span><span id="__span-0-5827"><a id="__codelineno-0-5827" name="__codelineno-0-5827"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5828"><a id="__codelineno-0-5828" name="__codelineno-0-5828"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5829"><a id="__codelineno-0-5829" name="__codelineno-0-5829"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-5830"><a id="__codelineno-0-5830" name="__codelineno-0-5830"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5831"><a id="__codelineno-0-5831" name="__codelineno-0-5831"></a>            <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5832"><a id="__codelineno-0-5832" name="__codelineno-0-5832"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5833"><a id="__codelineno-0-5833" name="__codelineno-0-5833"></a>            <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;Failed to follow SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; as user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5834"><a id="__codelineno-0-5834" name="__codelineno-0-5834"></a>                <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5835"><a id="__codelineno-0-5835" name="__codelineno-0-5835"></a>                <span class="n">username</span> <span class="k">if</span> <span class="n">username</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-5836"><a id="__codelineno-0-5836" name="__codelineno-0-5836"></a>            <span class="p">),</span>
</span><span id="__span-0-5837"><a id="__codelineno-0-5837" name="__codelineno-0-5837"></a>            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-5838"><a id="__codelineno-0-5838" name="__codelineno-0-5838"></a>            <span class="n">show_warning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5839"><a id="__codelineno-0-5839" name="__codelineno-0-5839"></a>        <span class="p">)</span>
</span><span id="__span-0-5840"><a id="__codelineno-0-5840" name="__codelineno-0-5840"></a>
</span><span id="__span-0-5841"><a id="__codelineno-0-5841" name="__codelineno-0-5841"></a>        <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tenant_id</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">sku_id</span><span class="p">,</span> <span class="n">teams_app_name</span><span class="p">,</span> <span class="n">teams_app_external_id</span><span class="p">,</span> <span class="n">sharepoint_app_root_site</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sharepoint_app_client_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sharepoint_app_client_secret</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">default_logger</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the M365 object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tenant_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 Tenant ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 Client ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 Client Secret.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 domain.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sku_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>License SKU for M365 users.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>teams_app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Extended ECM app for MS Teams.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>teams_app_external_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The external ID of the Extended ECM app for MS Teams</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sharepoint_app_root_site</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL to the SharePoint root site.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sharepoint_app_client_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SharePoint App client ID.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sharepoint_app_client_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SharePoint App client secret.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging object to use for all log messages. Defaults to default_logger.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyxecm_customizer.m365.default_logger">default_logger</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">tenant_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">client_secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">sku_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">teams_app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">teams_app_external_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">sharepoint_app_root_site</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">sharepoint_app_client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">sharepoint_app_client_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">default_logger</span><span class="p">,</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the M365 object.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Args:</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        tenant_id (str):</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            The M365 Tenant ID.</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        client_id (str):</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            The M365 Client ID.</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        client_secret (str):</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            The M365 Client Secret.</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        domain (str):</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            The M365 domain.</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        sku_id (str):</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            License SKU for M365 users.</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        teams_app_name (str):</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            The name of the Extended ECM app for MS Teams.</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        teams_app_external_id (str):</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            The external ID of the Extended ECM app for MS Teams</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        sharepoint_app_root_site (str):</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">            The URL to the SharePoint root site.</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        sharepoint_app_client_id (str):</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            The SharePoint App client ID.</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        sharepoint_app_client_secret (str):</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            The SharePoint App client secret.</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        logger (logging.Logger, optional):</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            The logging object to use for all log messages. Defaults to default_logger.</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="n">logger</span> <span class="o">!=</span> <span class="n">default_logger</span><span class="p">:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="s2">&quot;m365&quot;</span><span class="p">)</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">for</span> <span class="n">logfilter</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">logfilter</span><span class="p">)</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">m365_config</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="c1"># Set the authentication endpoints and credentials</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;tenantId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tenant_id</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;clientId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_id</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;clientSecret&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_secret</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">domain</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;skuId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sku_id</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teams_app_name</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppExternalId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teams_app_external_id</span>  <span class="c1"># this is the external App ID</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppInternalId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># will be set later...</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sharepointAppRootSite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharepoint_app_root_site</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sharepointAppClientId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharepoint_app_client_id</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sharepointAppClientSecret&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sharepoint_app_client_secret</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://login.microsoftonline.com/</span><span class="si">{}</span><span class="s2">/oauth2/v2.0/token&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tenant_id</span><span class="p">)</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://graph.microsoft.com/v1.0/&quot;</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;betaUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://graph.microsoft.com/beta/&quot;</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;directoryObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;directoryObjects&quot;</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="c1"># Set the data for the token request</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;tokenData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">client_secret</span><span class="p">,</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;client_credentials&quot;</span><span class="p">,</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;https://graph.microsoft.com/.default&quot;</span><span class="p">,</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="p">}</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;meUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;me&quot;</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;groups&quot;</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;users&quot;</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;teams&quot;</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsTemplatesUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;teamsTemplates&quot;</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;appCatalogs/teamsApps&quot;</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;directory&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;securityUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;betaUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;security&quot;</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;graphUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;applications&quot;</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m365_config</span><span class="p">[</span><span class="s2">&quot;betaUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;sites&quot;</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">m365_config</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_http_object</span> <span class="o">=</span> <span class="n">HTTP</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_app_registration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_app_registration</span><span class="p">(</span><span class="n">app_registration_name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">api_permissions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">supported_account_type</span><span class="o">=</span><span class="s1">&#39;AzureADMyOrg&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add an Azure App Registration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_registration_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the App Registration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The description of the app.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_permissions</code>
            </td>
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API permissions.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>supported_account_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of account that is supposed to use
the App Registration.</p>
              </div>
            </td>
            <td>
                  <code>&#39;AzureADMyOrg&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>App Registration data or None of the request fails.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Example data:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>{
'id': 'd70bee91-3689-4239-a626-30756968e99c',
'deletedDateTime': None,
'appId': 'd288ba5f-9313-4b38-b4a4-d7edcce089b0',
'applicationTemplateId': None,
'disabledByMicrosoftStatus': None,
'createdDateTime': '2023-09-06T21:06:05Z',
'displayName': 'Test 1',
'description': None,
'groupMembershipClaims': None,
'identifierUris': [],
'isDeviceOnlyAuthSupported': None,
'isFallbackPublicClient': None,
'notes': None,
'publisherDomain': 'M365x41497014.onmicrosoft.com',
'signInAudience': 'AzureADMyOrg',
...
'requiredResourceAccess': [
    {
        'resourceAppId': '00000003-0000-0ff1-ce00-000000000000',
        'resourceAccess': [
            {
                'id': '741f803b-c850-494e-b5df-cde7c675a1ca',
                'type': 'Role'
            },
            {
                'id': 'c8e3537c-ec53-43b9-bed3-b2bd3617ae97',
                'type': 'Role'
            },
        ]
    },
]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3761">3761</a></span>
<span class="normal"><a href="#__codelineno-0-3762">3762</a></span>
<span class="normal"><a href="#__codelineno-0-3763">3763</a></span>
<span class="normal"><a href="#__codelineno-0-3764">3764</a></span>
<span class="normal"><a href="#__codelineno-0-3765">3765</a></span>
<span class="normal"><a href="#__codelineno-0-3766">3766</a></span>
<span class="normal"><a href="#__codelineno-0-3767">3767</a></span>
<span class="normal"><a href="#__codelineno-0-3768">3768</a></span>
<span class="normal"><a href="#__codelineno-0-3769">3769</a></span>
<span class="normal"><a href="#__codelineno-0-3770">3770</a></span>
<span class="normal"><a href="#__codelineno-0-3771">3771</a></span>
<span class="normal"><a href="#__codelineno-0-3772">3772</a></span>
<span class="normal"><a href="#__codelineno-0-3773">3773</a></span>
<span class="normal"><a href="#__codelineno-0-3774">3774</a></span>
<span class="normal"><a href="#__codelineno-0-3775">3775</a></span>
<span class="normal"><a href="#__codelineno-0-3776">3776</a></span>
<span class="normal"><a href="#__codelineno-0-3777">3777</a></span>
<span class="normal"><a href="#__codelineno-0-3778">3778</a></span>
<span class="normal"><a href="#__codelineno-0-3779">3779</a></span>
<span class="normal"><a href="#__codelineno-0-3780">3780</a></span>
<span class="normal"><a href="#__codelineno-0-3781">3781</a></span>
<span class="normal"><a href="#__codelineno-0-3782">3782</a></span>
<span class="normal"><a href="#__codelineno-0-3783">3783</a></span>
<span class="normal"><a href="#__codelineno-0-3784">3784</a></span>
<span class="normal"><a href="#__codelineno-0-3785">3785</a></span>
<span class="normal"><a href="#__codelineno-0-3786">3786</a></span>
<span class="normal"><a href="#__codelineno-0-3787">3787</a></span>
<span class="normal"><a href="#__codelineno-0-3788">3788</a></span>
<span class="normal"><a href="#__codelineno-0-3789">3789</a></span>
<span class="normal"><a href="#__codelineno-0-3790">3790</a></span>
<span class="normal"><a href="#__codelineno-0-3791">3791</a></span>
<span class="normal"><a href="#__codelineno-0-3792">3792</a></span>
<span class="normal"><a href="#__codelineno-0-3793">3793</a></span>
<span class="normal"><a href="#__codelineno-0-3794">3794</a></span>
<span class="normal"><a href="#__codelineno-0-3795">3795</a></span>
<span class="normal"><a href="#__codelineno-0-3796">3796</a></span>
<span class="normal"><a href="#__codelineno-0-3797">3797</a></span>
<span class="normal"><a href="#__codelineno-0-3798">3798</a></span>
<span class="normal"><a href="#__codelineno-0-3799">3799</a></span>
<span class="normal"><a href="#__codelineno-0-3800">3800</a></span>
<span class="normal"><a href="#__codelineno-0-3801">3801</a></span>
<span class="normal"><a href="#__codelineno-0-3802">3802</a></span>
<span class="normal"><a href="#__codelineno-0-3803">3803</a></span>
<span class="normal"><a href="#__codelineno-0-3804">3804</a></span>
<span class="normal"><a href="#__codelineno-0-3805">3805</a></span>
<span class="normal"><a href="#__codelineno-0-3806">3806</a></span>
<span class="normal"><a href="#__codelineno-0-3807">3807</a></span>
<span class="normal"><a href="#__codelineno-0-3808">3808</a></span>
<span class="normal"><a href="#__codelineno-0-3809">3809</a></span>
<span class="normal"><a href="#__codelineno-0-3810">3810</a></span>
<span class="normal"><a href="#__codelineno-0-3811">3811</a></span>
<span class="normal"><a href="#__codelineno-0-3812">3812</a></span>
<span class="normal"><a href="#__codelineno-0-3813">3813</a></span>
<span class="normal"><a href="#__codelineno-0-3814">3814</a></span>
<span class="normal"><a href="#__codelineno-0-3815">3815</a></span>
<span class="normal"><a href="#__codelineno-0-3816">3816</a></span>
<span class="normal"><a href="#__codelineno-0-3817">3817</a></span>
<span class="normal"><a href="#__codelineno-0-3818">3818</a></span>
<span class="normal"><a href="#__codelineno-0-3819">3819</a></span>
<span class="normal"><a href="#__codelineno-0-3820">3820</a></span>
<span class="normal"><a href="#__codelineno-0-3821">3821</a></span>
<span class="normal"><a href="#__codelineno-0-3822">3822</a></span>
<span class="normal"><a href="#__codelineno-0-3823">3823</a></span>
<span class="normal"><a href="#__codelineno-0-3824">3824</a></span>
<span class="normal"><a href="#__codelineno-0-3825">3825</a></span>
<span class="normal"><a href="#__codelineno-0-3826">3826</a></span>
<span class="normal"><a href="#__codelineno-0-3827">3827</a></span>
<span class="normal"><a href="#__codelineno-0-3828">3828</a></span>
<span class="normal"><a href="#__codelineno-0-3829">3829</a></span>
<span class="normal"><a href="#__codelineno-0-3830">3830</a></span>
<span class="normal"><a href="#__codelineno-0-3831">3831</a></span>
<span class="normal"><a href="#__codelineno-0-3832">3832</a></span>
<span class="normal"><a href="#__codelineno-0-3833">3833</a></span>
<span class="normal"><a href="#__codelineno-0-3834">3834</a></span>
<span class="normal"><a href="#__codelineno-0-3835">3835</a></span>
<span class="normal"><a href="#__codelineno-0-3836">3836</a></span>
<span class="normal"><a href="#__codelineno-0-3837">3837</a></span>
<span class="normal"><a href="#__codelineno-0-3838">3838</a></span>
<span class="normal"><a href="#__codelineno-0-3839">3839</a></span>
<span class="normal"><a href="#__codelineno-0-3840">3840</a></span>
<span class="normal"><a href="#__codelineno-0-3841">3841</a></span>
<span class="normal"><a href="#__codelineno-0-3842">3842</a></span>
<span class="normal"><a href="#__codelineno-0-3843">3843</a></span>
<span class="normal"><a href="#__codelineno-0-3844">3844</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3761"><a id="__codelineno-0-3761" name="__codelineno-0-3761"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_app_registration</span><span class="p">(</span>
</span><span id="__span-0-3762"><a id="__codelineno-0-3762" name="__codelineno-0-3762"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3763"><a id="__codelineno-0-3763" name="__codelineno-0-3763"></a>    <span class="n">app_registration_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3764"><a id="__codelineno-0-3764" name="__codelineno-0-3764"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3765"><a id="__codelineno-0-3765" name="__codelineno-0-3765"></a>    <span class="n">api_permissions</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3766"><a id="__codelineno-0-3766" name="__codelineno-0-3766"></a>    <span class="n">supported_account_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AzureADMyOrg&quot;</span><span class="p">,</span>
</span><span id="__span-0-3767"><a id="__codelineno-0-3767" name="__codelineno-0-3767"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-3768"><a id="__codelineno-0-3768" name="__codelineno-0-3768"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an Azure App Registration.</span>
</span><span id="__span-0-3769"><a id="__codelineno-0-3769" name="__codelineno-0-3769"></a>
</span><span id="__span-0-3770"><a id="__codelineno-0-3770" name="__codelineno-0-3770"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3771"><a id="__codelineno-0-3771" name="__codelineno-0-3771"></a><span class="sd">        app_registration_name (str):</span>
</span><span id="__span-0-3772"><a id="__codelineno-0-3772" name="__codelineno-0-3772"></a><span class="sd">            The name of the App Registration.</span>
</span><span id="__span-0-3773"><a id="__codelineno-0-3773" name="__codelineno-0-3773"></a><span class="sd">        description (str, optional):</span>
</span><span id="__span-0-3774"><a id="__codelineno-0-3774" name="__codelineno-0-3774"></a><span class="sd">            The description of the app.</span>
</span><span id="__span-0-3775"><a id="__codelineno-0-3775" name="__codelineno-0-3775"></a><span class="sd">        api_permissions (list | None, optional):</span>
</span><span id="__span-0-3776"><a id="__codelineno-0-3776" name="__codelineno-0-3776"></a><span class="sd">            The API permissions.</span>
</span><span id="__span-0-3777"><a id="__codelineno-0-3777" name="__codelineno-0-3777"></a><span class="sd">        supported_account_type (str, optional):</span>
</span><span id="__span-0-3778"><a id="__codelineno-0-3778" name="__codelineno-0-3778"></a><span class="sd">            The type of account that is supposed to use</span>
</span><span id="__span-0-3779"><a id="__codelineno-0-3779" name="__codelineno-0-3779"></a><span class="sd">            the App Registration.</span>
</span><span id="__span-0-3780"><a id="__codelineno-0-3780" name="__codelineno-0-3780"></a>
</span><span id="__span-0-3781"><a id="__codelineno-0-3781" name="__codelineno-0-3781"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3782"><a id="__codelineno-0-3782" name="__codelineno-0-3782"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3783"><a id="__codelineno-0-3783" name="__codelineno-0-3783"></a><span class="sd">            App Registration data or None of the request fails.</span>
</span><span id="__span-0-3784"><a id="__codelineno-0-3784" name="__codelineno-0-3784"></a>
</span><span id="__span-0-3785"><a id="__codelineno-0-3785" name="__codelineno-0-3785"></a><span class="sd">        Example data:</span>
</span><span id="__span-0-3786"><a id="__codelineno-0-3786" name="__codelineno-0-3786"></a><span class="sd">        {</span>
</span><span id="__span-0-3787"><a id="__codelineno-0-3787" name="__codelineno-0-3787"></a><span class="sd">            &#39;id&#39;: &#39;d70bee91-3689-4239-a626-30756968e99c&#39;,</span>
</span><span id="__span-0-3788"><a id="__codelineno-0-3788" name="__codelineno-0-3788"></a><span class="sd">            &#39;deletedDateTime&#39;: None,</span>
</span><span id="__span-0-3789"><a id="__codelineno-0-3789" name="__codelineno-0-3789"></a><span class="sd">            &#39;appId&#39;: &#39;d288ba5f-9313-4b38-b4a4-d7edcce089b0&#39;,</span>
</span><span id="__span-0-3790"><a id="__codelineno-0-3790" name="__codelineno-0-3790"></a><span class="sd">            &#39;applicationTemplateId&#39;: None,</span>
</span><span id="__span-0-3791"><a id="__codelineno-0-3791" name="__codelineno-0-3791"></a><span class="sd">            &#39;disabledByMicrosoftStatus&#39;: None,</span>
</span><span id="__span-0-3792"><a id="__codelineno-0-3792" name="__codelineno-0-3792"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2023-09-06T21:06:05Z&#39;,</span>
</span><span id="__span-0-3793"><a id="__codelineno-0-3793" name="__codelineno-0-3793"></a><span class="sd">            &#39;displayName&#39;: &#39;Test 1&#39;,</span>
</span><span id="__span-0-3794"><a id="__codelineno-0-3794" name="__codelineno-0-3794"></a><span class="sd">            &#39;description&#39;: None,</span>
</span><span id="__span-0-3795"><a id="__codelineno-0-3795" name="__codelineno-0-3795"></a><span class="sd">            &#39;groupMembershipClaims&#39;: None,</span>
</span><span id="__span-0-3796"><a id="__codelineno-0-3796" name="__codelineno-0-3796"></a><span class="sd">            &#39;identifierUris&#39;: [],</span>
</span><span id="__span-0-3797"><a id="__codelineno-0-3797" name="__codelineno-0-3797"></a><span class="sd">            &#39;isDeviceOnlyAuthSupported&#39;: None,</span>
</span><span id="__span-0-3798"><a id="__codelineno-0-3798" name="__codelineno-0-3798"></a><span class="sd">            &#39;isFallbackPublicClient&#39;: None,</span>
</span><span id="__span-0-3799"><a id="__codelineno-0-3799" name="__codelineno-0-3799"></a><span class="sd">            &#39;notes&#39;: None,</span>
</span><span id="__span-0-3800"><a id="__codelineno-0-3800" name="__codelineno-0-3800"></a><span class="sd">            &#39;publisherDomain&#39;: &#39;M365x41497014.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-3801"><a id="__codelineno-0-3801" name="__codelineno-0-3801"></a><span class="sd">            &#39;signInAudience&#39;: &#39;AzureADMyOrg&#39;,</span>
</span><span id="__span-0-3802"><a id="__codelineno-0-3802" name="__codelineno-0-3802"></a><span class="sd">            ...</span>
</span><span id="__span-0-3803"><a id="__codelineno-0-3803" name="__codelineno-0-3803"></a><span class="sd">            &#39;requiredResourceAccess&#39;: [</span>
</span><span id="__span-0-3804"><a id="__codelineno-0-3804" name="__codelineno-0-3804"></a><span class="sd">                {</span>
</span><span id="__span-0-3805"><a id="__codelineno-0-3805" name="__codelineno-0-3805"></a><span class="sd">                    &#39;resourceAppId&#39;: &#39;00000003-0000-0ff1-ce00-000000000000&#39;,</span>
</span><span id="__span-0-3806"><a id="__codelineno-0-3806" name="__codelineno-0-3806"></a><span class="sd">                    &#39;resourceAccess&#39;: [</span>
</span><span id="__span-0-3807"><a id="__codelineno-0-3807" name="__codelineno-0-3807"></a><span class="sd">                        {</span>
</span><span id="__span-0-3808"><a id="__codelineno-0-3808" name="__codelineno-0-3808"></a><span class="sd">                            &#39;id&#39;: &#39;741f803b-c850-494e-b5df-cde7c675a1ca&#39;,</span>
</span><span id="__span-0-3809"><a id="__codelineno-0-3809" name="__codelineno-0-3809"></a><span class="sd">                            &#39;type&#39;: &#39;Role&#39;</span>
</span><span id="__span-0-3810"><a id="__codelineno-0-3810" name="__codelineno-0-3810"></a><span class="sd">                        },</span>
</span><span id="__span-0-3811"><a id="__codelineno-0-3811" name="__codelineno-0-3811"></a><span class="sd">                        {</span>
</span><span id="__span-0-3812"><a id="__codelineno-0-3812" name="__codelineno-0-3812"></a><span class="sd">                            &#39;id&#39;: &#39;c8e3537c-ec53-43b9-bed3-b2bd3617ae97&#39;,</span>
</span><span id="__span-0-3813"><a id="__codelineno-0-3813" name="__codelineno-0-3813"></a><span class="sd">                            &#39;type&#39;: &#39;Role&#39;</span>
</span><span id="__span-0-3814"><a id="__codelineno-0-3814" name="__codelineno-0-3814"></a><span class="sd">                        },</span>
</span><span id="__span-0-3815"><a id="__codelineno-0-3815" name="__codelineno-0-3815"></a><span class="sd">                    ]</span>
</span><span id="__span-0-3816"><a id="__codelineno-0-3816" name="__codelineno-0-3816"></a><span class="sd">                },</span>
</span><span id="__span-0-3817"><a id="__codelineno-0-3817" name="__codelineno-0-3817"></a><span class="sd">            ]</span>
</span><span id="__span-0-3818"><a id="__codelineno-0-3818" name="__codelineno-0-3818"></a><span class="sd">        }</span>
</span><span id="__span-0-3819"><a id="__codelineno-0-3819" name="__codelineno-0-3819"></a>
</span><span id="__span-0-3820"><a id="__codelineno-0-3820" name="__codelineno-0-3820"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3821"><a id="__codelineno-0-3821" name="__codelineno-0-3821"></a>
</span><span id="__span-0-3822"><a id="__codelineno-0-3822" name="__codelineno-0-3822"></a>    <span class="c1"># Define the request body to create the App Registration</span>
</span><span id="__span-0-3823"><a id="__codelineno-0-3823" name="__codelineno-0-3823"></a>    <span class="n">app_registration_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3824"><a id="__codelineno-0-3824" name="__codelineno-0-3824"></a>        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3825"><a id="__codelineno-0-3825" name="__codelineno-0-3825"></a>        <span class="s2">&quot;signInAudience&quot;</span><span class="p">:</span> <span class="n">supported_account_type</span><span class="p">,</span>
</span><span id="__span-0-3826"><a id="__codelineno-0-3826" name="__codelineno-0-3826"></a>    <span class="p">}</span>
</span><span id="__span-0-3827"><a id="__codelineno-0-3827" name="__codelineno-0-3827"></a>    <span class="k">if</span> <span class="n">api_permissions</span><span class="p">:</span>
</span><span id="__span-0-3828"><a id="__codelineno-0-3828" name="__codelineno-0-3828"></a>        <span class="n">app_registration_data</span><span class="p">[</span><span class="s2">&quot;requiredResourceAccess&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_permissions</span>
</span><span id="__span-0-3829"><a id="__codelineno-0-3829" name="__codelineno-0-3829"></a>    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
</span><span id="__span-0-3830"><a id="__codelineno-0-3830" name="__codelineno-0-3830"></a>        <span class="n">app_registration_data</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
</span><span id="__span-0-3831"><a id="__codelineno-0-3831" name="__codelineno-0-3831"></a>
</span><span id="__span-0-3832"><a id="__codelineno-0-3832" name="__codelineno-0-3832"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-3833"><a id="__codelineno-0-3833" name="__codelineno-0-3833"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3834"><a id="__codelineno-0-3834" name="__codelineno-0-3834"></a>
</span><span id="__span-0-3835"><a id="__codelineno-0-3835" name="__codelineno-0-3835"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3836"><a id="__codelineno-0-3836" name="__codelineno-0-3836"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3837"><a id="__codelineno-0-3837" name="__codelineno-0-3837"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3838"><a id="__codelineno-0-3838" name="__codelineno-0-3838"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3839"><a id="__codelineno-0-3839" name="__codelineno-0-3839"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">app_registration_data</span><span class="p">,</span>
</span><span id="__span-0-3840"><a id="__codelineno-0-3840" name="__codelineno-0-3840"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3841"><a id="__codelineno-0-3841" name="__codelineno-0-3841"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot add App Registration -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3842"><a id="__codelineno-0-3842" name="__codelineno-0-3842"></a>            <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3843"><a id="__codelineno-0-3843" name="__codelineno-0-3843"></a>        <span class="p">),</span>
</span><span id="__span-0-3844"><a id="__codelineno-0-3844" name="__codelineno-0-3844"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_group</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">security_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mail_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a M365 Group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>security_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this group is used for permission management.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mail_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this group is email enabled.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Group information or None if the group couldn't be created (e.g. because it exisits already).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#groups/$entity',
    'id': '28906460-a69c-439e-84ca-c70becf37655',
    'deletedDateTime': None,
    'classification': None,
    'createdDateTime': '2023-04-01T11:40:13Z',
    'creationOptions': [],
    'description': None,
    'displayName': 'Test',
    'expirationDateTime': None,
    'groupTypes': ['Unified'],
    'isAssignableToRole': None,
    'mail': 'Diefenbruch@M365x61936377.onmicrosoft.com',
    'mailEnabled': True,
    'mailNickname': 'Test',
    'membershipRule': None,
    'membershipRuleProcessingState': None,
    'onPremisesDomainName': None,
    'onPremisesLastSyncDateTime': None,
    'onPremisesNetBiosName': None,
    'onPremisesSamAccountName': None,
    'onPremisesSecurityIdentifier': None,
    'onPremisesSyncEnabled': None,
    'onPremisesProvisioningErrors': [],
    'preferredDataLocation': None,
    'preferredLanguage': None,
    'proxyAddresses': ['SMTP:Test@M365x61936377.onmicrosoft.com'],
    'renewedDateTime': '2023-04-01T11:40:13Z',
    'resourceBehaviorOptions': [],
    'resourceProvisioningOptions': [],
    'securityEnabled': True,
    'securityIdentifier': 'S-1-12-1-680551520-1134470812-197642884-1433859052',
    'theme': None,
    'visibility': 'Public'
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1617"><a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_group</span><span class="p">(</span>
</span><span id="__span-0-1618"><a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1619"><a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1620"><a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>    <span class="n">security_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1621"><a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>    <span class="n">mail_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-1622"><a id="__codelineno-0-1622" name="__codelineno-0-1622"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1623"><a id="__codelineno-0-1623" name="__codelineno-0-1623"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a M365 Group.</span>
</span><span id="__span-0-1624"><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>
</span><span id="__span-0-1625"><a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1626"><a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">        name (str):</span>
</span><span id="__span-0-1627"><a id="__codelineno-0-1627" name="__codelineno-0-1627"></a><span class="sd">            The name of the group.</span>
</span><span id="__span-0-1628"><a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><span class="sd">        security_enabled (bool, optional):</span>
</span><span id="__span-0-1629"><a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">            Whether or not this group is used for permission management.</span>
</span><span id="__span-0-1630"><a id="__codelineno-0-1630" name="__codelineno-0-1630"></a><span class="sd">        mail_enabled (bool, optional):</span>
</span><span id="__span-0-1631"><a id="__codelineno-0-1631" name="__codelineno-0-1631"></a><span class="sd">            Whether or not this group is email enabled.</span>
</span><span id="__span-0-1632"><a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>
</span><span id="__span-0-1633"><a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1634"><a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1635"><a id="__codelineno-0-1635" name="__codelineno-0-1635"></a><span class="sd">            Group information or None if the group couldn&#39;t be created (e.g. because it exisits already).</span>
</span><span id="__span-0-1636"><a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>
</span><span id="__span-0-1637"><a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1638"><a id="__codelineno-0-1638" name="__codelineno-0-1638"></a><span class="sd">        {</span>
</span><span id="__span-0-1639"><a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#groups/$entity&#39;,</span>
</span><span id="__span-0-1640"><a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">            &#39;id&#39;: &#39;28906460-a69c-439e-84ca-c70becf37655&#39;,</span>
</span><span id="__span-0-1641"><a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><span class="sd">            &#39;deletedDateTime&#39;: None,</span>
</span><span id="__span-0-1642"><a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="sd">            &#39;classification&#39;: None,</span>
</span><span id="__span-0-1643"><a id="__codelineno-0-1643" name="__codelineno-0-1643"></a><span class="sd">            &#39;createdDateTime&#39;: &#39;2023-04-01T11:40:13Z&#39;,</span>
</span><span id="__span-0-1644"><a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="sd">            &#39;creationOptions&#39;: [],</span>
</span><span id="__span-0-1645"><a id="__codelineno-0-1645" name="__codelineno-0-1645"></a><span class="sd">            &#39;description&#39;: None,</span>
</span><span id="__span-0-1646"><a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">            &#39;displayName&#39;: &#39;Test&#39;,</span>
</span><span id="__span-0-1647"><a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><span class="sd">            &#39;expirationDateTime&#39;: None,</span>
</span><span id="__span-0-1648"><a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">            &#39;groupTypes&#39;: [&#39;Unified&#39;],</span>
</span><span id="__span-0-1649"><a id="__codelineno-0-1649" name="__codelineno-0-1649"></a><span class="sd">            &#39;isAssignableToRole&#39;: None,</span>
</span><span id="__span-0-1650"><a id="__codelineno-0-1650" name="__codelineno-0-1650"></a><span class="sd">            &#39;mail&#39;: &#39;Diefenbruch@M365x61936377.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-1651"><a id="__codelineno-0-1651" name="__codelineno-0-1651"></a><span class="sd">            &#39;mailEnabled&#39;: True,</span>
</span><span id="__span-0-1652"><a id="__codelineno-0-1652" name="__codelineno-0-1652"></a><span class="sd">            &#39;mailNickname&#39;: &#39;Test&#39;,</span>
</span><span id="__span-0-1653"><a id="__codelineno-0-1653" name="__codelineno-0-1653"></a><span class="sd">            &#39;membershipRule&#39;: None,</span>
</span><span id="__span-0-1654"><a id="__codelineno-0-1654" name="__codelineno-0-1654"></a><span class="sd">            &#39;membershipRuleProcessingState&#39;: None,</span>
</span><span id="__span-0-1655"><a id="__codelineno-0-1655" name="__codelineno-0-1655"></a><span class="sd">            &#39;onPremisesDomainName&#39;: None,</span>
</span><span id="__span-0-1656"><a id="__codelineno-0-1656" name="__codelineno-0-1656"></a><span class="sd">            &#39;onPremisesLastSyncDateTime&#39;: None,</span>
</span><span id="__span-0-1657"><a id="__codelineno-0-1657" name="__codelineno-0-1657"></a><span class="sd">            &#39;onPremisesNetBiosName&#39;: None,</span>
</span><span id="__span-0-1658"><a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><span class="sd">            &#39;onPremisesSamAccountName&#39;: None,</span>
</span><span id="__span-0-1659"><a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><span class="sd">            &#39;onPremisesSecurityIdentifier&#39;: None,</span>
</span><span id="__span-0-1660"><a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><span class="sd">            &#39;onPremisesSyncEnabled&#39;: None,</span>
</span><span id="__span-0-1661"><a id="__codelineno-0-1661" name="__codelineno-0-1661"></a><span class="sd">            &#39;onPremisesProvisioningErrors&#39;: [],</span>
</span><span id="__span-0-1662"><a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="sd">            &#39;preferredDataLocation&#39;: None,</span>
</span><span id="__span-0-1663"><a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">            &#39;preferredLanguage&#39;: None,</span>
</span><span id="__span-0-1664"><a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><span class="sd">            &#39;proxyAddresses&#39;: [&#39;SMTP:Test@M365x61936377.onmicrosoft.com&#39;],</span>
</span><span id="__span-0-1665"><a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><span class="sd">            &#39;renewedDateTime&#39;: &#39;2023-04-01T11:40:13Z&#39;,</span>
</span><span id="__span-0-1666"><a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><span class="sd">            &#39;resourceBehaviorOptions&#39;: [],</span>
</span><span id="__span-0-1667"><a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">            &#39;resourceProvisioningOptions&#39;: [],</span>
</span><span id="__span-0-1668"><a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">            &#39;securityEnabled&#39;: True,</span>
</span><span id="__span-0-1669"><a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">            &#39;securityIdentifier&#39;: &#39;S-1-12-1-680551520-1134470812-197642884-1433859052&#39;,</span>
</span><span id="__span-0-1670"><a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">            &#39;theme&#39;: None,</span>
</span><span id="__span-0-1671"><a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">            &#39;visibility&#39;: &#39;Public&#39;</span>
</span><span id="__span-0-1672"><a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">        }</span>
</span><span id="__span-0-1673"><a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>
</span><span id="__span-0-1674"><a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1675"><a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>
</span><span id="__span-0-1676"><a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>    <span class="n">group_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1677"><a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-1678"><a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>        <span class="s2">&quot;mailEnabled&quot;</span><span class="p">:</span> <span class="n">mail_enabled</span><span class="p">,</span>
</span><span id="__span-0-1679"><a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>        <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-0-1680"><a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>        <span class="s2">&quot;securityEnabled&quot;</span><span class="p">:</span> <span class="n">security_enabled</span><span class="p">,</span>
</span><span id="__span-0-1681"><a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>        <span class="s2">&quot;groupTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Unified&quot;</span><span class="p">],</span>
</span><span id="__span-0-1682"><a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>    <span class="p">}</span>
</span><span id="__span-0-1683"><a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>
</span><span id="__span-0-1684"><a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-1685"><a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1686"><a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>
</span><span id="__span-0-1687"><a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding M365 group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-1688"><a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;M365 group attributes -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">group_post_body</span><span class="p">))</span>
</span><span id="__span-0-1689"><a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>
</span><span id="__span-0-1690"><a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1691"><a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1692"><a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1693"><a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1694"><a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">group_post_body</span><span class="p">),</span>
</span><span id="__span-0-1695"><a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1696"><a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
</span><span id="__span-0-1697"><a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_group_member" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_group_member</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">member_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a member (user or group) to a (parent) group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>member_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the new member.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1749"><a id="__codelineno-0-1749" name="__codelineno-0-1749"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_group_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">member_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1750"><a id="__codelineno-0-1750" name="__codelineno-0-1750"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a member (user or group) to a (parent) group.</span>
</span><span id="__span-0-1751"><a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>
</span><span id="__span-0-1752"><a id="__codelineno-0-1752" name="__codelineno-0-1752"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1753"><a id="__codelineno-0-1753" name="__codelineno-0-1753"></a><span class="sd">        group_id (str):</span>
</span><span id="__span-0-1754"><a id="__codelineno-0-1754" name="__codelineno-0-1754"></a><span class="sd">            The M365 GUID of the group.</span>
</span><span id="__span-0-1755"><a id="__codelineno-0-1755" name="__codelineno-0-1755"></a><span class="sd">        member_id (str):</span>
</span><span id="__span-0-1756"><a id="__codelineno-0-1756" name="__codelineno-0-1756"></a><span class="sd">            The M365 GUID of the new member.</span>
</span><span id="__span-0-1757"><a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
</span><span id="__span-0-1758"><a id="__codelineno-0-1758" name="__codelineno-0-1758"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1759"><a id="__codelineno-0-1759" name="__codelineno-0-1759"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1760"><a id="__codelineno-0-1760" name="__codelineno-0-1760"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-1761"><a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>
</span><span id="__span-0-1762"><a id="__codelineno-0-1762" name="__codelineno-0-1762"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1763"><a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
</span><span id="__span-0-1764"><a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/members/$ref&quot;</span>
</span><span id="__span-0-1765"><a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1766"><a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>
</span><span id="__span-0-1767"><a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>    <span class="n">group_member_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1768"><a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>        <span class="s2">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryObjects&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1769"><a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>    <span class="p">}</span>
</span><span id="__span-0-1770"><a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
</span><span id="__span-0-1771"><a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1772"><a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>        <span class="s2">&quot;Adding member -&gt; </span><span class="si">%s</span><span class="s2"> to group -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1773"><a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>        <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1774"><a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>        <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1775"><a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1776"><a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>    <span class="p">)</span>
</span><span id="__span-0-1777"><a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>
</span><span id="__span-0-1778"><a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1779"><a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1780"><a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1781"><a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1782"><a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">group_member_post_body</span><span class="p">),</span>
</span><span id="__span-0-1783"><a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1784"><a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add member -&gt; </span><span class="si">{}</span><span class="s2"> to M365 group -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1785"><a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>            <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1786"><a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1787"><a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>        <span class="p">),</span>
</span><span id="__span-0-1788"><a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_group_owner" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_group_owner</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">owner_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add an owner (user) to a group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>owner_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the new member.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
The response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1885"><a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_group_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">owner_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1886"><a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an owner (user) to a group.</span>
</span><span id="__span-0-1887"><a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>
</span><span id="__span-0-1888"><a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1889"><a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">        group_id (str):</span>
</span><span id="__span-0-1890"><a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">            The M365 GUID of the group.</span>
</span><span id="__span-0-1891"><a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">        owner_id (str):</span>
</span><span id="__span-0-1892"><a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">            The M365 GUID of the new member.</span>
</span><span id="__span-0-1893"><a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>
</span><span id="__span-0-1894"><a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1895"><a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1896"><a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">            The response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-1897"><a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>
</span><span id="__span-0-1898"><a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1899"><a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>
</span><span id="__span-0-1900"><a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/owners/$ref&quot;</span>
</span><span id="__span-0-1901"><a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1902"><a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
</span><span id="__span-0-1903"><a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>    <span class="n">group_member_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1904"><a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>        <span class="s2">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryObjects&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">owner_id</span><span class="p">,</span>
</span><span id="__span-0-1905"><a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>    <span class="p">}</span>
</span><span id="__span-0-1906"><a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>
</span><span id="__span-0-1907"><a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1908"><a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>        <span class="s2">&quot;Adding owner -&gt; </span><span class="si">%s</span><span class="s2"> to M365 group -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1909"><a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>        <span class="n">owner_id</span><span class="p">,</span>
</span><span id="__span-0-1910"><a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>        <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1911"><a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1912"><a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>    <span class="p">)</span>
</span><span id="__span-0-1913"><a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>
</span><span id="__span-0-1914"><a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1915"><a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1916"><a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1917"><a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1918"><a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">group_member_post_body</span><span class="p">),</span>
</span><span id="__span-0-1919"><a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1920"><a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add owner -&gt; </span><span class="si">{}</span><span class="s2"> to M365 group -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1921"><a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>            <span class="n">owner_id</span><span class="p">,</span>
</span><span id="__span-0-1922"><a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1923"><a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>        <span class="p">),</span>
</span><span id="__span-0-1924"><a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_sensitivity_label" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sensitivity_label</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">display_name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">admin_description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">user_description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">enable_encryption</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enable_marking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new sensitivity label in M365.</p>
<p>TODO: THIS IS CURRENTLY NOT WORKING!</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the label.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The display name of the label.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the label. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the label. Defaults to "red".</p>
              </div>
            </td>
            <td>
                  <code>&#39;red&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this label is enabled. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>admin_description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description for administrators. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user_description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description for users. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_encryption</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enable encryption. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_marking</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enable marking. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Request reponse or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3564">3564</a></span>
<span class="normal"><a href="#__codelineno-0-3565">3565</a></span>
<span class="normal"><a href="#__codelineno-0-3566">3566</a></span>
<span class="normal"><a href="#__codelineno-0-3567">3567</a></span>
<span class="normal"><a href="#__codelineno-0-3568">3568</a></span>
<span class="normal"><a href="#__codelineno-0-3569">3569</a></span>
<span class="normal"><a href="#__codelineno-0-3570">3570</a></span>
<span class="normal"><a href="#__codelineno-0-3571">3571</a></span>
<span class="normal"><a href="#__codelineno-0-3572">3572</a></span>
<span class="normal"><a href="#__codelineno-0-3573">3573</a></span>
<span class="normal"><a href="#__codelineno-0-3574">3574</a></span>
<span class="normal"><a href="#__codelineno-0-3575">3575</a></span>
<span class="normal"><a href="#__codelineno-0-3576">3576</a></span>
<span class="normal"><a href="#__codelineno-0-3577">3577</a></span>
<span class="normal"><a href="#__codelineno-0-3578">3578</a></span>
<span class="normal"><a href="#__codelineno-0-3579">3579</a></span>
<span class="normal"><a href="#__codelineno-0-3580">3580</a></span>
<span class="normal"><a href="#__codelineno-0-3581">3581</a></span>
<span class="normal"><a href="#__codelineno-0-3582">3582</a></span>
<span class="normal"><a href="#__codelineno-0-3583">3583</a></span>
<span class="normal"><a href="#__codelineno-0-3584">3584</a></span>
<span class="normal"><a href="#__codelineno-0-3585">3585</a></span>
<span class="normal"><a href="#__codelineno-0-3586">3586</a></span>
<span class="normal"><a href="#__codelineno-0-3587">3587</a></span>
<span class="normal"><a href="#__codelineno-0-3588">3588</a></span>
<span class="normal"><a href="#__codelineno-0-3589">3589</a></span>
<span class="normal"><a href="#__codelineno-0-3590">3590</a></span>
<span class="normal"><a href="#__codelineno-0-3591">3591</a></span>
<span class="normal"><a href="#__codelineno-0-3592">3592</a></span>
<span class="normal"><a href="#__codelineno-0-3593">3593</a></span>
<span class="normal"><a href="#__codelineno-0-3594">3594</a></span>
<span class="normal"><a href="#__codelineno-0-3595">3595</a></span>
<span class="normal"><a href="#__codelineno-0-3596">3596</a></span>
<span class="normal"><a href="#__codelineno-0-3597">3597</a></span>
<span class="normal"><a href="#__codelineno-0-3598">3598</a></span>
<span class="normal"><a href="#__codelineno-0-3599">3599</a></span>
<span class="normal"><a href="#__codelineno-0-3600">3600</a></span>
<span class="normal"><a href="#__codelineno-0-3601">3601</a></span>
<span class="normal"><a href="#__codelineno-0-3602">3602</a></span>
<span class="normal"><a href="#__codelineno-0-3603">3603</a></span>
<span class="normal"><a href="#__codelineno-0-3604">3604</a></span>
<span class="normal"><a href="#__codelineno-0-3605">3605</a></span>
<span class="normal"><a href="#__codelineno-0-3606">3606</a></span>
<span class="normal"><a href="#__codelineno-0-3607">3607</a></span>
<span class="normal"><a href="#__codelineno-0-3608">3608</a></span>
<span class="normal"><a href="#__codelineno-0-3609">3609</a></span>
<span class="normal"><a href="#__codelineno-0-3610">3610</a></span>
<span class="normal"><a href="#__codelineno-0-3611">3611</a></span>
<span class="normal"><a href="#__codelineno-0-3612">3612</a></span>
<span class="normal"><a href="#__codelineno-0-3613">3613</a></span>
<span class="normal"><a href="#__codelineno-0-3614">3614</a></span>
<span class="normal"><a href="#__codelineno-0-3615">3615</a></span>
<span class="normal"><a href="#__codelineno-0-3616">3616</a></span>
<span class="normal"><a href="#__codelineno-0-3617">3617</a></span>
<span class="normal"><a href="#__codelineno-0-3618">3618</a></span>
<span class="normal"><a href="#__codelineno-0-3619">3619</a></span>
<span class="normal"><a href="#__codelineno-0-3620">3620</a></span>
<span class="normal"><a href="#__codelineno-0-3621">3621</a></span>
<span class="normal"><a href="#__codelineno-0-3622">3622</a></span>
<span class="normal"><a href="#__codelineno-0-3623">3623</a></span>
<span class="normal"><a href="#__codelineno-0-3624">3624</a></span>
<span class="normal"><a href="#__codelineno-0-3625">3625</a></span>
<span class="normal"><a href="#__codelineno-0-3626">3626</a></span>
<span class="normal"><a href="#__codelineno-0-3627">3627</a></span>
<span class="normal"><a href="#__codelineno-0-3628">3628</a></span>
<span class="normal"><a href="#__codelineno-0-3629">3629</a></span>
<span class="normal"><a href="#__codelineno-0-3630">3630</a></span>
<span class="normal"><a href="#__codelineno-0-3631">3631</a></span>
<span class="normal"><a href="#__codelineno-0-3632">3632</a></span>
<span class="normal"><a href="#__codelineno-0-3633">3633</a></span>
<span class="normal"><a href="#__codelineno-0-3634">3634</a></span>
<span class="normal"><a href="#__codelineno-0-3635">3635</a></span>
<span class="normal"><a href="#__codelineno-0-3636">3636</a></span>
<span class="normal"><a href="#__codelineno-0-3637">3637</a></span>
<span class="normal"><a href="#__codelineno-0-3638">3638</a></span>
<span class="normal"><a href="#__codelineno-0-3639">3639</a></span>
<span class="normal"><a href="#__codelineno-0-3640">3640</a></span>
<span class="normal"><a href="#__codelineno-0-3641">3641</a></span>
<span class="normal"><a href="#__codelineno-0-3642">3642</a></span>
<span class="normal"><a href="#__codelineno-0-3643">3643</a></span>
<span class="normal"><a href="#__codelineno-0-3644">3644</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3564"><a id="__codelineno-0-3564" name="__codelineno-0-3564"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_sensitivity_label</span><span class="p">(</span>
</span><span id="__span-0-3565"><a id="__codelineno-0-3565" name="__codelineno-0-3565"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3566"><a id="__codelineno-0-3566" name="__codelineno-0-3566"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3567"><a id="__codelineno-0-3567" name="__codelineno-0-3567"></a>    <span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3568"><a id="__codelineno-0-3568" name="__codelineno-0-3568"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3569"><a id="__codelineno-0-3569" name="__codelineno-0-3569"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
</span><span id="__span-0-3570"><a id="__codelineno-0-3570" name="__codelineno-0-3570"></a>    <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-3571"><a id="__codelineno-0-3571" name="__codelineno-0-3571"></a>    <span class="n">admin_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3572"><a id="__codelineno-0-3572" name="__codelineno-0-3572"></a>    <span class="n">user_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3573"><a id="__codelineno-0-3573" name="__codelineno-0-3573"></a>    <span class="n">enable_encryption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3574"><a id="__codelineno-0-3574" name="__codelineno-0-3574"></a>    <span class="n">enable_marking</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3575"><a id="__codelineno-0-3575" name="__codelineno-0-3575"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3576"><a id="__codelineno-0-3576" name="__codelineno-0-3576"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new sensitivity label in M365.</span>
</span><span id="__span-0-3577"><a id="__codelineno-0-3577" name="__codelineno-0-3577"></a>
</span><span id="__span-0-3578"><a id="__codelineno-0-3578" name="__codelineno-0-3578"></a><span class="sd">    TODO: THIS IS CURRENTLY NOT WORKING!</span>
</span><span id="__span-0-3579"><a id="__codelineno-0-3579" name="__codelineno-0-3579"></a>
</span><span id="__span-0-3580"><a id="__codelineno-0-3580" name="__codelineno-0-3580"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3581"><a id="__codelineno-0-3581" name="__codelineno-0-3581"></a><span class="sd">        name (str):</span>
</span><span id="__span-0-3582"><a id="__codelineno-0-3582" name="__codelineno-0-3582"></a><span class="sd">            The name of the label.</span>
</span><span id="__span-0-3583"><a id="__codelineno-0-3583" name="__codelineno-0-3583"></a><span class="sd">        display_name (str):</span>
</span><span id="__span-0-3584"><a id="__codelineno-0-3584" name="__codelineno-0-3584"></a><span class="sd">            The display name of the label.</span>
</span><span id="__span-0-3585"><a id="__codelineno-0-3585" name="__codelineno-0-3585"></a><span class="sd">        description (str, optional):</span>
</span><span id="__span-0-3586"><a id="__codelineno-0-3586" name="__codelineno-0-3586"></a><span class="sd">            Description of the label. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-3587"><a id="__codelineno-0-3587" name="__codelineno-0-3587"></a><span class="sd">        color (str, optional):</span>
</span><span id="__span-0-3588"><a id="__codelineno-0-3588" name="__codelineno-0-3588"></a><span class="sd">            Color of the label. Defaults to &quot;red&quot;.</span>
</span><span id="__span-0-3589"><a id="__codelineno-0-3589" name="__codelineno-0-3589"></a><span class="sd">        enabled (bool, optional):</span>
</span><span id="__span-0-3590"><a id="__codelineno-0-3590" name="__codelineno-0-3590"></a><span class="sd">            Whether this label is enabled. Defaults to True.</span>
</span><span id="__span-0-3591"><a id="__codelineno-0-3591" name="__codelineno-0-3591"></a><span class="sd">        admin_description (str, optional):</span>
</span><span id="__span-0-3592"><a id="__codelineno-0-3592" name="__codelineno-0-3592"></a><span class="sd">            Description for administrators. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-3593"><a id="__codelineno-0-3593" name="__codelineno-0-3593"></a><span class="sd">        user_description (str, optional):</span>
</span><span id="__span-0-3594"><a id="__codelineno-0-3594" name="__codelineno-0-3594"></a><span class="sd">            Description for users. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-3595"><a id="__codelineno-0-3595" name="__codelineno-0-3595"></a><span class="sd">        enable_encryption (bool, optional):</span>
</span><span id="__span-0-3596"><a id="__codelineno-0-3596" name="__codelineno-0-3596"></a><span class="sd">            Enable encryption. Defaults to False.</span>
</span><span id="__span-0-3597"><a id="__codelineno-0-3597" name="__codelineno-0-3597"></a><span class="sd">        enable_marking (bool, optional):</span>
</span><span id="__span-0-3598"><a id="__codelineno-0-3598" name="__codelineno-0-3598"></a><span class="sd">            Enable marking. Defaults to False.</span>
</span><span id="__span-0-3599"><a id="__codelineno-0-3599" name="__codelineno-0-3599"></a>
</span><span id="__span-0-3600"><a id="__codelineno-0-3600" name="__codelineno-0-3600"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3601"><a id="__codelineno-0-3601" name="__codelineno-0-3601"></a><span class="sd">        Request reponse or None if the request fails.</span>
</span><span id="__span-0-3602"><a id="__codelineno-0-3602" name="__codelineno-0-3602"></a>
</span><span id="__span-0-3603"><a id="__codelineno-0-3603" name="__codelineno-0-3603"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3604"><a id="__codelineno-0-3604" name="__codelineno-0-3604"></a>
</span><span id="__span-0-3605"><a id="__codelineno-0-3605" name="__codelineno-0-3605"></a>    <span class="c1"># Prepare the request body</span>
</span><span id="__span-0-3606"><a id="__codelineno-0-3606" name="__codelineno-0-3606"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3607"><a id="__codelineno-0-3607" name="__codelineno-0-3607"></a>        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">display_name</span><span class="p">,</span>
</span><span id="__span-0-3608"><a id="__codelineno-0-3608" name="__codelineno-0-3608"></a>        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
</span><span id="__span-0-3609"><a id="__codelineno-0-3609" name="__codelineno-0-3609"></a>        <span class="s2">&quot;isEnabled&quot;</span><span class="p">:</span> <span class="n">enabled</span><span class="p">,</span>
</span><span id="__span-0-3610"><a id="__codelineno-0-3610" name="__codelineno-0-3610"></a>        <span class="s2">&quot;labelColor&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
</span><span id="__span-0-3611"><a id="__codelineno-0-3611" name="__codelineno-0-3611"></a>        <span class="s2">&quot;adminDescription&quot;</span><span class="p">:</span> <span class="n">admin_description</span><span class="p">,</span>
</span><span id="__span-0-3612"><a id="__codelineno-0-3612" name="__codelineno-0-3612"></a>        <span class="s2">&quot;userDescription&quot;</span><span class="p">:</span> <span class="n">user_description</span><span class="p">,</span>
</span><span id="__span-0-3613"><a id="__codelineno-0-3613" name="__codelineno-0-3613"></a>        <span class="s2">&quot;encryptContent&quot;</span><span class="p">:</span> <span class="n">enable_encryption</span><span class="p">,</span>
</span><span id="__span-0-3614"><a id="__codelineno-0-3614" name="__codelineno-0-3614"></a>        <span class="s2">&quot;contentMarking&quot;</span><span class="p">:</span> <span class="n">enable_marking</span><span class="p">,</span>
</span><span id="__span-0-3615"><a id="__codelineno-0-3615" name="__codelineno-0-3615"></a>    <span class="p">}</span>
</span><span id="__span-0-3616"><a id="__codelineno-0-3616" name="__codelineno-0-3616"></a>
</span><span id="__span-0-3617"><a id="__codelineno-0-3617" name="__codelineno-0-3617"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;securityUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/sensitivityLabels&quot;</span>
</span><span id="__span-0-3618"><a id="__codelineno-0-3618" name="__codelineno-0-3618"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3619"><a id="__codelineno-0-3619" name="__codelineno-0-3619"></a>
</span><span id="__span-0-3620"><a id="__codelineno-0-3620" name="__codelineno-0-3620"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3621"><a id="__codelineno-0-3621" name="__codelineno-0-3621"></a>        <span class="s2">&quot;Create M365 sensitivity label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3622"><a id="__codelineno-0-3622" name="__codelineno-0-3622"></a>        <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-3623"><a id="__codelineno-0-3623" name="__codelineno-0-3623"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3624"><a id="__codelineno-0-3624" name="__codelineno-0-3624"></a>    <span class="p">)</span>
</span><span id="__span-0-3625"><a id="__codelineno-0-3625" name="__codelineno-0-3625"></a>
</span><span id="__span-0-3626"><a id="__codelineno-0-3626" name="__codelineno-0-3626"></a>    <span class="c1"># Send the POST request to create the label</span>
</span><span id="__span-0-3627"><a id="__codelineno-0-3627" name="__codelineno-0-3627"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-3628"><a id="__codelineno-0-3628" name="__codelineno-0-3628"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3629"><a id="__codelineno-0-3629" name="__codelineno-0-3629"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3630"><a id="__codelineno-0-3630" name="__codelineno-0-3630"></a>        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span>
</span><span id="__span-0-3631"><a id="__codelineno-0-3631" name="__codelineno-0-3631"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3632"><a id="__codelineno-0-3632" name="__codelineno-0-3632"></a>    <span class="p">)</span>
</span><span id="__span-0-3633"><a id="__codelineno-0-3633" name="__codelineno-0-3633"></a>
</span><span id="__span-0-3634"><a id="__codelineno-0-3634" name="__codelineno-0-3634"></a>    <span class="c1"># Check the response status code</span>
</span><span id="__span-0-3635"><a id="__codelineno-0-3635" name="__codelineno-0-3635"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
</span><span id="__span-0-3636"><a id="__codelineno-0-3636" name="__codelineno-0-3636"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has been created successfully!&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-3637"><a id="__codelineno-0-3637" name="__codelineno-0-3637"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-3638"><a id="__codelineno-0-3638" name="__codelineno-0-3638"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3639"><a id="__codelineno-0-3639" name="__codelineno-0-3639"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3640"><a id="__codelineno-0-3640" name="__codelineno-0-3640"></a>            <span class="s2">&quot;Failed to create the M365 label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;! Response status code -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3641"><a id="__codelineno-0-3641" name="__codelineno-0-3641"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-3642"><a id="__codelineno-0-3642" name="__codelineno-0-3642"></a>            <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-3643"><a id="__codelineno-0-3643" name="__codelineno-0-3643"></a>        <span class="p">)</span>
</span><span id="__span-0-3644"><a id="__codelineno-0-3644" name="__codelineno-0-3644"></a>        <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_sharepoint_page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_name</span><span class="p">,</span> <span class="n">publish</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a new SharePoint site page using Microsoft Graph API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site the page should be created on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name/title of the new page.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>publish</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the page is immediately published.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Details of the created SharePoint page or an error response.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4882">4882</a></span>
<span class="normal"><a href="#__codelineno-0-4883">4883</a></span>
<span class="normal"><a href="#__codelineno-0-4884">4884</a></span>
<span class="normal"><a href="#__codelineno-0-4885">4885</a></span>
<span class="normal"><a href="#__codelineno-0-4886">4886</a></span>
<span class="normal"><a href="#__codelineno-0-4887">4887</a></span>
<span class="normal"><a href="#__codelineno-0-4888">4888</a></span>
<span class="normal"><a href="#__codelineno-0-4889">4889</a></span>
<span class="normal"><a href="#__codelineno-0-4890">4890</a></span>
<span class="normal"><a href="#__codelineno-0-4891">4891</a></span>
<span class="normal"><a href="#__codelineno-0-4892">4892</a></span>
<span class="normal"><a href="#__codelineno-0-4893">4893</a></span>
<span class="normal"><a href="#__codelineno-0-4894">4894</a></span>
<span class="normal"><a href="#__codelineno-0-4895">4895</a></span>
<span class="normal"><a href="#__codelineno-0-4896">4896</a></span>
<span class="normal"><a href="#__codelineno-0-4897">4897</a></span>
<span class="normal"><a href="#__codelineno-0-4898">4898</a></span>
<span class="normal"><a href="#__codelineno-0-4899">4899</a></span>
<span class="normal"><a href="#__codelineno-0-4900">4900</a></span>
<span class="normal"><a href="#__codelineno-0-4901">4901</a></span>
<span class="normal"><a href="#__codelineno-0-4902">4902</a></span>
<span class="normal"><a href="#__codelineno-0-4903">4903</a></span>
<span class="normal"><a href="#__codelineno-0-4904">4904</a></span>
<span class="normal"><a href="#__codelineno-0-4905">4905</a></span>
<span class="normal"><a href="#__codelineno-0-4906">4906</a></span>
<span class="normal"><a href="#__codelineno-0-4907">4907</a></span>
<span class="normal"><a href="#__codelineno-0-4908">4908</a></span>
<span class="normal"><a href="#__codelineno-0-4909">4909</a></span>
<span class="normal"><a href="#__codelineno-0-4910">4910</a></span>
<span class="normal"><a href="#__codelineno-0-4911">4911</a></span>
<span class="normal"><a href="#__codelineno-0-4912">4912</a></span>
<span class="normal"><a href="#__codelineno-0-4913">4913</a></span>
<span class="normal"><a href="#__codelineno-0-4914">4914</a></span>
<span class="normal"><a href="#__codelineno-0-4915">4915</a></span>
<span class="normal"><a href="#__codelineno-0-4916">4916</a></span>
<span class="normal"><a href="#__codelineno-0-4917">4917</a></span>
<span class="normal"><a href="#__codelineno-0-4918">4918</a></span>
<span class="normal"><a href="#__codelineno-0-4919">4919</a></span>
<span class="normal"><a href="#__codelineno-0-4920">4920</a></span>
<span class="normal"><a href="#__codelineno-0-4921">4921</a></span>
<span class="normal"><a href="#__codelineno-0-4922">4922</a></span>
<span class="normal"><a href="#__codelineno-0-4923">4923</a></span>
<span class="normal"><a href="#__codelineno-0-4924">4924</a></span>
<span class="normal"><a href="#__codelineno-0-4925">4925</a></span>
<span class="normal"><a href="#__codelineno-0-4926">4926</a></span>
<span class="normal"><a href="#__codelineno-0-4927">4927</a></span>
<span class="normal"><a href="#__codelineno-0-4928">4928</a></span>
<span class="normal"><a href="#__codelineno-0-4929">4929</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4882"><a id="__codelineno-0-4882" name="__codelineno-0-4882"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_sharepoint_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">publish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4883"><a id="__codelineno-0-4883" name="__codelineno-0-4883"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a new SharePoint site page using Microsoft Graph API.</span>
</span><span id="__span-0-4884"><a id="__codelineno-0-4884" name="__codelineno-0-4884"></a>
</span><span id="__span-0-4885"><a id="__codelineno-0-4885" name="__codelineno-0-4885"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4886"><a id="__codelineno-0-4886" name="__codelineno-0-4886"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-4887"><a id="__codelineno-0-4887" name="__codelineno-0-4887"></a><span class="sd">            The ID of the SharePoint site the page should be created on.</span>
</span><span id="__span-0-4888"><a id="__codelineno-0-4888" name="__codelineno-0-4888"></a><span class="sd">        page_name (str):</span>
</span><span id="__span-0-4889"><a id="__codelineno-0-4889" name="__codelineno-0-4889"></a><span class="sd">            The name/title of the new page.</span>
</span><span id="__span-0-4890"><a id="__codelineno-0-4890" name="__codelineno-0-4890"></a><span class="sd">        publish (bool, optional):</span>
</span><span id="__span-0-4891"><a id="__codelineno-0-4891" name="__codelineno-0-4891"></a><span class="sd">            If True, the page is immediately published.</span>
</span><span id="__span-0-4892"><a id="__codelineno-0-4892" name="__codelineno-0-4892"></a>
</span><span id="__span-0-4893"><a id="__codelineno-0-4893" name="__codelineno-0-4893"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4894"><a id="__codelineno-0-4894" name="__codelineno-0-4894"></a><span class="sd">        dict:</span>
</span><span id="__span-0-4895"><a id="__codelineno-0-4895" name="__codelineno-0-4895"></a><span class="sd">            Details of the created SharePoint page or an error response.</span>
</span><span id="__span-0-4896"><a id="__codelineno-0-4896" name="__codelineno-0-4896"></a>
</span><span id="__span-0-4897"><a id="__codelineno-0-4897" name="__codelineno-0-4897"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4898"><a id="__codelineno-0-4898" name="__codelineno-0-4898"></a>
</span><span id="__span-0-4899"><a id="__codelineno-0-4899" name="__codelineno-0-4899"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages&quot;</span>
</span><span id="__span-0-4900"><a id="__codelineno-0-4900" name="__codelineno-0-4900"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4901"><a id="__codelineno-0-4901" name="__codelineno-0-4901"></a>
</span><span id="__span-0-4902"><a id="__codelineno-0-4902" name="__codelineno-0-4902"></a>    <span class="c1"># Page payload for a basic site page</span>
</span><span id="__span-0-4903"><a id="__codelineno-0-4903" name="__codelineno-0-4903"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-4904"><a id="__codelineno-0-4904" name="__codelineno-0-4904"></a>        <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.sitePage&quot;</span><span class="p">,</span>
</span><span id="__span-0-4905"><a id="__codelineno-0-4905" name="__codelineno-0-4905"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">page_name</span> <span class="o">+</span> <span class="s2">&quot;.aspx&quot;</span><span class="p">,</span>
</span><span id="__span-0-4906"><a id="__codelineno-0-4906" name="__codelineno-0-4906"></a>        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">page_name</span><span class="p">,</span>
</span><span id="__span-0-4907"><a id="__codelineno-0-4907" name="__codelineno-0-4907"></a>        <span class="s2">&quot;publishingState&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-4908"><a id="__codelineno-0-4908" name="__codelineno-0-4908"></a>            <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;published&quot;</span><span class="p">,</span>
</span><span id="__span-0-4909"><a id="__codelineno-0-4909" name="__codelineno-0-4909"></a>        <span class="p">},</span>
</span><span id="__span-0-4910"><a id="__codelineno-0-4910" name="__codelineno-0-4910"></a>    <span class="p">}</span>
</span><span id="__span-0-4911"><a id="__codelineno-0-4911" name="__codelineno-0-4911"></a>
</span><span id="__span-0-4912"><a id="__codelineno-0-4912" name="__codelineno-0-4912"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4913"><a id="__codelineno-0-4913" name="__codelineno-0-4913"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4914"><a id="__codelineno-0-4914" name="__codelineno-0-4914"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-4915"><a id="__codelineno-0-4915" name="__codelineno-0-4915"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4916"><a id="__codelineno-0-4916" name="__codelineno-0-4916"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-4917"><a id="__codelineno-0-4917" name="__codelineno-0-4917"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4918"><a id="__codelineno-0-4918" name="__codelineno-0-4918"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to create SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4919"><a id="__codelineno-0-4919" name="__codelineno-0-4919"></a>            <span class="n">page_name</span><span class="p">,</span>
</span><span id="__span-0-4920"><a id="__codelineno-0-4920" name="__codelineno-0-4920"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-4921"><a id="__codelineno-0-4921" name="__codelineno-0-4921"></a>        <span class="p">),</span>
</span><span id="__span-0-4922"><a id="__codelineno-0-4922" name="__codelineno-0-4922"></a>    <span class="p">)</span>
</span><span id="__span-0-4923"><a id="__codelineno-0-4923" name="__codelineno-0-4923"></a>
</span><span id="__span-0-4924"><a id="__codelineno-0-4924" name="__codelineno-0-4924"></a>    <span class="c1"># Check if the page should be directly published:</span>
</span><span id="__span-0-4925"><a id="__codelineno-0-4925" name="__codelineno-0-4925"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">publish</span><span class="p">:</span>
</span><span id="__span-0-4926"><a id="__codelineno-0-4926" name="__codelineno-0-4926"></a>        <span class="n">page_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-4927"><a id="__codelineno-0-4927" name="__codelineno-0-4927"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-4928"><a id="__codelineno-0-4928" name="__codelineno-0-4928"></a>
</span><span id="__span-0-4929"><a id="__codelineno-0-4929" name="__codelineno-0-4929"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_sharepoint_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sharepoint_section</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">section_type</span><span class="o">=</span><span class="s1">&#39;horizontalSections&#39;</span><span class="p">,</span> <span class="n">section_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;oneColumn&#39;</span><span class="p">,</span> <span class="n">emphasis</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">republish</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a specific section (horizontal or vertical) on a SharePoint page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the web part.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"horizontalSections" (note the plural!)
"verticalSection" (note the singular!)</p>
              </div>
            </td>
            <td>
                  <code>&#39;horizontalSections&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_id</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the section. Only relevant for horizontal sections.
Simple values like 1,2,3...</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"fullWidth"
"oneColumn"
"twoColumns"
"threeColumns"</p>
              </div>
            </td>
            <td>
                  <code>&#39;oneColumn&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>emphasis</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The emphasis for the section. Possible values:
"none" (default)
"neutral"
"soft"
"strong"</p>
              </div>
            </td>
            <td>
                  <code>&#39;none&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>republish</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the page is republished to make the section active.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The horizontal or vertical section.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26')/pages('ac7675ee-8891-43b9-b1b2-2d2ced8eb17e')/microsoft.graph.sitePage/canvasLayout/horizontalSections/$entity",
    'layout': 'fullWidth',
    'id': '2',
    'emphasis': 'none'
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5108">5108</a></span>
<span class="normal"><a href="#__codelineno-0-5109">5109</a></span>
<span class="normal"><a href="#__codelineno-0-5110">5110</a></span>
<span class="normal"><a href="#__codelineno-0-5111">5111</a></span>
<span class="normal"><a href="#__codelineno-0-5112">5112</a></span>
<span class="normal"><a href="#__codelineno-0-5113">5113</a></span>
<span class="normal"><a href="#__codelineno-0-5114">5114</a></span>
<span class="normal"><a href="#__codelineno-0-5115">5115</a></span>
<span class="normal"><a href="#__codelineno-0-5116">5116</a></span>
<span class="normal"><a href="#__codelineno-0-5117">5117</a></span>
<span class="normal"><a href="#__codelineno-0-5118">5118</a></span>
<span class="normal"><a href="#__codelineno-0-5119">5119</a></span>
<span class="normal"><a href="#__codelineno-0-5120">5120</a></span>
<span class="normal"><a href="#__codelineno-0-5121">5121</a></span>
<span class="normal"><a href="#__codelineno-0-5122">5122</a></span>
<span class="normal"><a href="#__codelineno-0-5123">5123</a></span>
<span class="normal"><a href="#__codelineno-0-5124">5124</a></span>
<span class="normal"><a href="#__codelineno-0-5125">5125</a></span>
<span class="normal"><a href="#__codelineno-0-5126">5126</a></span>
<span class="normal"><a href="#__codelineno-0-5127">5127</a></span>
<span class="normal"><a href="#__codelineno-0-5128">5128</a></span>
<span class="normal"><a href="#__codelineno-0-5129">5129</a></span>
<span class="normal"><a href="#__codelineno-0-5130">5130</a></span>
<span class="normal"><a href="#__codelineno-0-5131">5131</a></span>
<span class="normal"><a href="#__codelineno-0-5132">5132</a></span>
<span class="normal"><a href="#__codelineno-0-5133">5133</a></span>
<span class="normal"><a href="#__codelineno-0-5134">5134</a></span>
<span class="normal"><a href="#__codelineno-0-5135">5135</a></span>
<span class="normal"><a href="#__codelineno-0-5136">5136</a></span>
<span class="normal"><a href="#__codelineno-0-5137">5137</a></span>
<span class="normal"><a href="#__codelineno-0-5138">5138</a></span>
<span class="normal"><a href="#__codelineno-0-5139">5139</a></span>
<span class="normal"><a href="#__codelineno-0-5140">5140</a></span>
<span class="normal"><a href="#__codelineno-0-5141">5141</a></span>
<span class="normal"><a href="#__codelineno-0-5142">5142</a></span>
<span class="normal"><a href="#__codelineno-0-5143">5143</a></span>
<span class="normal"><a href="#__codelineno-0-5144">5144</a></span>
<span class="normal"><a href="#__codelineno-0-5145">5145</a></span>
<span class="normal"><a href="#__codelineno-0-5146">5146</a></span>
<span class="normal"><a href="#__codelineno-0-5147">5147</a></span>
<span class="normal"><a href="#__codelineno-0-5148">5148</a></span>
<span class="normal"><a href="#__codelineno-0-5149">5149</a></span>
<span class="normal"><a href="#__codelineno-0-5150">5150</a></span>
<span class="normal"><a href="#__codelineno-0-5151">5151</a></span>
<span class="normal"><a href="#__codelineno-0-5152">5152</a></span>
<span class="normal"><a href="#__codelineno-0-5153">5153</a></span>
<span class="normal"><a href="#__codelineno-0-5154">5154</a></span>
<span class="normal"><a href="#__codelineno-0-5155">5155</a></span>
<span class="normal"><a href="#__codelineno-0-5156">5156</a></span>
<span class="normal"><a href="#__codelineno-0-5157">5157</a></span>
<span class="normal"><a href="#__codelineno-0-5158">5158</a></span>
<span class="normal"><a href="#__codelineno-0-5159">5159</a></span>
<span class="normal"><a href="#__codelineno-0-5160">5160</a></span>
<span class="normal"><a href="#__codelineno-0-5161">5161</a></span>
<span class="normal"><a href="#__codelineno-0-5162">5162</a></span>
<span class="normal"><a href="#__codelineno-0-5163">5163</a></span>
<span class="normal"><a href="#__codelineno-0-5164">5164</a></span>
<span class="normal"><a href="#__codelineno-0-5165">5165</a></span>
<span class="normal"><a href="#__codelineno-0-5166">5166</a></span>
<span class="normal"><a href="#__codelineno-0-5167">5167</a></span>
<span class="normal"><a href="#__codelineno-0-5168">5168</a></span>
<span class="normal"><a href="#__codelineno-0-5169">5169</a></span>
<span class="normal"><a href="#__codelineno-0-5170">5170</a></span>
<span class="normal"><a href="#__codelineno-0-5171">5171</a></span>
<span class="normal"><a href="#__codelineno-0-5172">5172</a></span>
<span class="normal"><a href="#__codelineno-0-5173">5173</a></span>
<span class="normal"><a href="#__codelineno-0-5174">5174</a></span>
<span class="normal"><a href="#__codelineno-0-5175">5175</a></span>
<span class="normal"><a href="#__codelineno-0-5176">5176</a></span>
<span class="normal"><a href="#__codelineno-0-5177">5177</a></span>
<span class="normal"><a href="#__codelineno-0-5178">5178</a></span>
<span class="normal"><a href="#__codelineno-0-5179">5179</a></span>
<span class="normal"><a href="#__codelineno-0-5180">5180</a></span>
<span class="normal"><a href="#__codelineno-0-5181">5181</a></span>
<span class="normal"><a href="#__codelineno-0-5182">5182</a></span>
<span class="normal"><a href="#__codelineno-0-5183">5183</a></span>
<span class="normal"><a href="#__codelineno-0-5184">5184</a></span>
<span class="normal"><a href="#__codelineno-0-5185">5185</a></span>
<span class="normal"><a href="#__codelineno-0-5186">5186</a></span>
<span class="normal"><a href="#__codelineno-0-5187">5187</a></span>
<span class="normal"><a href="#__codelineno-0-5188">5188</a></span>
<span class="normal"><a href="#__codelineno-0-5189">5189</a></span>
<span class="normal"><a href="#__codelineno-0-5190">5190</a></span>
<span class="normal"><a href="#__codelineno-0-5191">5191</a></span>
<span class="normal"><a href="#__codelineno-0-5192">5192</a></span>
<span class="normal"><a href="#__codelineno-0-5193">5193</a></span>
<span class="normal"><a href="#__codelineno-0-5194">5194</a></span>
<span class="normal"><a href="#__codelineno-0-5195">5195</a></span>
<span class="normal"><a href="#__codelineno-0-5196">5196</a></span>
<span class="normal"><a href="#__codelineno-0-5197">5197</a></span>
<span class="normal"><a href="#__codelineno-0-5198">5198</a></span>
<span class="normal"><a href="#__codelineno-0-5199">5199</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5108"><a id="__codelineno-0-5108" name="__codelineno-0-5108"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_sharepoint_section</span><span class="p">(</span>
</span><span id="__span-0-5109"><a id="__codelineno-0-5109" name="__codelineno-0-5109"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5110"><a id="__codelineno-0-5110" name="__codelineno-0-5110"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5111"><a id="__codelineno-0-5111" name="__codelineno-0-5111"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5112"><a id="__codelineno-0-5112" name="__codelineno-0-5112"></a>    <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5113"><a id="__codelineno-0-5113" name="__codelineno-0-5113"></a>    <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5114"><a id="__codelineno-0-5114" name="__codelineno-0-5114"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;oneColumn&quot;</span><span class="p">,</span>
</span><span id="__span-0-5115"><a id="__codelineno-0-5115" name="__codelineno-0-5115"></a>    <span class="n">emphasis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
</span><span id="__span-0-5116"><a id="__codelineno-0-5116" name="__codelineno-0-5116"></a>    <span class="n">republish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5117"><a id="__codelineno-0-5117" name="__codelineno-0-5117"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5118"><a id="__codelineno-0-5118" name="__codelineno-0-5118"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a specific section (horizontal or vertical) on a SharePoint page.</span>
</span><span id="__span-0-5119"><a id="__codelineno-0-5119" name="__codelineno-0-5119"></a>
</span><span id="__span-0-5120"><a id="__codelineno-0-5120" name="__codelineno-0-5120"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5121"><a id="__codelineno-0-5121" name="__codelineno-0-5121"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5122"><a id="__codelineno-0-5122" name="__codelineno-0-5122"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5123"><a id="__codelineno-0-5123" name="__codelineno-0-5123"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5124"><a id="__codelineno-0-5124" name="__codelineno-0-5124"></a><span class="sd">            The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5125"><a id="__codelineno-0-5125" name="__codelineno-0-5125"></a><span class="sd">        section_type (str, optional):</span>
</span><span id="__span-0-5126"><a id="__codelineno-0-5126" name="__codelineno-0-5126"></a><span class="sd">            &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5127"><a id="__codelineno-0-5127" name="__codelineno-0-5127"></a><span class="sd">            &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5128"><a id="__codelineno-0-5128" name="__codelineno-0-5128"></a><span class="sd">        section_id (int | str):</span>
</span><span id="__span-0-5129"><a id="__codelineno-0-5129" name="__codelineno-0-5129"></a><span class="sd">            The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5130"><a id="__codelineno-0-5130" name="__codelineno-0-5130"></a><span class="sd">            Simple values like 1,2,3...</span>
</span><span id="__span-0-5131"><a id="__codelineno-0-5131" name="__codelineno-0-5131"></a><span class="sd">        columns (str, optional):</span>
</span><span id="__span-0-5132"><a id="__codelineno-0-5132" name="__codelineno-0-5132"></a><span class="sd">            &quot;fullWidth&quot;</span>
</span><span id="__span-0-5133"><a id="__codelineno-0-5133" name="__codelineno-0-5133"></a><span class="sd">            &quot;oneColumn&quot;</span>
</span><span id="__span-0-5134"><a id="__codelineno-0-5134" name="__codelineno-0-5134"></a><span class="sd">            &quot;twoColumns&quot;</span>
</span><span id="__span-0-5135"><a id="__codelineno-0-5135" name="__codelineno-0-5135"></a><span class="sd">            &quot;threeColumns&quot;</span>
</span><span id="__span-0-5136"><a id="__codelineno-0-5136" name="__codelineno-0-5136"></a><span class="sd">        emphasis (str, optional):</span>
</span><span id="__span-0-5137"><a id="__codelineno-0-5137" name="__codelineno-0-5137"></a><span class="sd">            The emphasis for the section. Possible values:</span>
</span><span id="__span-0-5138"><a id="__codelineno-0-5138" name="__codelineno-0-5138"></a><span class="sd">            &quot;none&quot; (default)</span>
</span><span id="__span-0-5139"><a id="__codelineno-0-5139" name="__codelineno-0-5139"></a><span class="sd">            &quot;neutral&quot;</span>
</span><span id="__span-0-5140"><a id="__codelineno-0-5140" name="__codelineno-0-5140"></a><span class="sd">            &quot;soft&quot;</span>
</span><span id="__span-0-5141"><a id="__codelineno-0-5141" name="__codelineno-0-5141"></a><span class="sd">            &quot;strong&quot;</span>
</span><span id="__span-0-5142"><a id="__codelineno-0-5142" name="__codelineno-0-5142"></a><span class="sd">        republish (bool, optional):</span>
</span><span id="__span-0-5143"><a id="__codelineno-0-5143" name="__codelineno-0-5143"></a><span class="sd">            If True, the page is republished to make the section active.</span>
</span><span id="__span-0-5144"><a id="__codelineno-0-5144" name="__codelineno-0-5144"></a>
</span><span id="__span-0-5145"><a id="__codelineno-0-5145" name="__codelineno-0-5145"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5146"><a id="__codelineno-0-5146" name="__codelineno-0-5146"></a><span class="sd">        dict:</span>
</span><span id="__span-0-5147"><a id="__codelineno-0-5147" name="__codelineno-0-5147"></a><span class="sd">            The horizontal or vertical section.</span>
</span><span id="__span-0-5148"><a id="__codelineno-0-5148" name="__codelineno-0-5148"></a>
</span><span id="__span-0-5149"><a id="__codelineno-0-5149" name="__codelineno-0-5149"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5150"><a id="__codelineno-0-5150" name="__codelineno-0-5150"></a><span class="sd">    {</span>
</span><span id="__span-0-5151"><a id="__codelineno-0-5151" name="__codelineno-0-5151"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections/$entity&quot;,</span>
</span><span id="__span-0-5152"><a id="__codelineno-0-5152" name="__codelineno-0-5152"></a><span class="sd">        &#39;layout&#39;: &#39;fullWidth&#39;,</span>
</span><span id="__span-0-5153"><a id="__codelineno-0-5153" name="__codelineno-0-5153"></a><span class="sd">        &#39;id&#39;: &#39;2&#39;,</span>
</span><span id="__span-0-5154"><a id="__codelineno-0-5154" name="__codelineno-0-5154"></a><span class="sd">        &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5155"><a id="__codelineno-0-5155" name="__codelineno-0-5155"></a><span class="sd">    }</span>
</span><span id="__span-0-5156"><a id="__codelineno-0-5156" name="__codelineno-0-5156"></a>
</span><span id="__span-0-5157"><a id="__codelineno-0-5157" name="__codelineno-0-5157"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5158"><a id="__codelineno-0-5158" name="__codelineno-0-5158"></a>
</span><span id="__span-0-5159"><a id="__codelineno-0-5159" name="__codelineno-0-5159"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5160"><a id="__codelineno-0-5160" name="__codelineno-0-5160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5161"><a id="__codelineno-0-5161" name="__codelineno-0-5161"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5162"><a id="__codelineno-0-5162" name="__codelineno-0-5162"></a>        <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5163"><a id="__codelineno-0-5163" name="__codelineno-0-5163"></a>        <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5164"><a id="__codelineno-0-5164" name="__codelineno-0-5164"></a>        <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5165"><a id="__codelineno-0-5165" name="__codelineno-0-5165"></a>        <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5166"><a id="__codelineno-0-5166" name="__codelineno-0-5166"></a>        <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5167"><a id="__codelineno-0-5167" name="__codelineno-0-5167"></a>    <span class="p">)</span>
</span><span id="__span-0-5168"><a id="__codelineno-0-5168" name="__codelineno-0-5168"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5169"><a id="__codelineno-0-5169" name="__codelineno-0-5169"></a>
</span><span id="__span-0-5170"><a id="__codelineno-0-5170" name="__codelineno-0-5170"></a>    <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5171"><a id="__codelineno-0-5171" name="__codelineno-0-5171"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5172"><a id="__codelineno-0-5172" name="__codelineno-0-5172"></a>        <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5173"><a id="__codelineno-0-5173" name="__codelineno-0-5173"></a>            <span class="n">section_type</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">),</span>
</span><span id="__span-0-5174"><a id="__codelineno-0-5174" name="__codelineno-0-5174"></a>        <span class="p">),</span>
</span><span id="__span-0-5175"><a id="__codelineno-0-5175" name="__codelineno-0-5175"></a>    <span class="p">}</span>
</span><span id="__span-0-5176"><a id="__codelineno-0-5176" name="__codelineno-0-5176"></a>    <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5177"><a id="__codelineno-0-5177" name="__codelineno-0-5177"></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="__span-0-5178"><a id="__codelineno-0-5178" name="__codelineno-0-5178"></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;emphasis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emphasis</span>
</span><span id="__span-0-5179"><a id="__codelineno-0-5179" name="__codelineno-0-5179"></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5180"><a id="__codelineno-0-5180" name="__codelineno-0-5180"></a>
</span><span id="__span-0-5181"><a id="__codelineno-0-5181" name="__codelineno-0-5181"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5182"><a id="__codelineno-0-5182" name="__codelineno-0-5182"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5183"><a id="__codelineno-0-5183" name="__codelineno-0-5183"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-5184"><a id="__codelineno-0-5184" name="__codelineno-0-5184"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5185"><a id="__codelineno-0-5185" name="__codelineno-0-5185"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5186"><a id="__codelineno-0-5186" name="__codelineno-0-5186"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5187"><a id="__codelineno-0-5187" name="__codelineno-0-5187"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to create SharePoint section of type -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5188"><a id="__codelineno-0-5188" name="__codelineno-0-5188"></a>            <span class="n">section_type</span><span class="p">,</span>
</span><span id="__span-0-5189"><a id="__codelineno-0-5189" name="__codelineno-0-5189"></a>            <span class="n">columns</span><span class="p">,</span>
</span><span id="__span-0-5190"><a id="__codelineno-0-5190" name="__codelineno-0-5190"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5191"><a id="__codelineno-0-5191" name="__codelineno-0-5191"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5192"><a id="__codelineno-0-5192" name="__codelineno-0-5192"></a>        <span class="p">),</span>
</span><span id="__span-0-5193"><a id="__codelineno-0-5193" name="__codelineno-0-5193"></a>    <span class="p">)</span>
</span><span id="__span-0-5194"><a id="__codelineno-0-5194" name="__codelineno-0-5194"></a>
</span><span id="__span-0-5195"><a id="__codelineno-0-5195" name="__codelineno-0-5195"></a>    <span class="c1"># Check if the page should be republished:</span>
</span><span id="__span-0-5196"><a id="__codelineno-0-5196" name="__codelineno-0-5196"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">republish</span><span class="p">:</span>
</span><span id="__span-0-5197"><a id="__codelineno-0-5197" name="__codelineno-0-5197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-5198"><a id="__codelineno-0-5198" name="__codelineno-0-5198"></a>
</span><span id="__span-0-5199"><a id="__codelineno-0-5199" name="__codelineno-0-5199"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_sharepoint_webpart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sharepoint_webpart</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">webpart_type_id</span><span class="p">,</span> <span class="n">create_data</span><span class="p">,</span> <span class="n">section_type</span><span class="o">=</span><span class="s1">&#39;horizontalSections&#39;</span><span class="p">,</span> <span class="n">section_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">republish</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a specific web part on a SharePoint page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the web part.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>webpart_type_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the web part to create.
Content Browser: 'cecfdba4-2e82-4538-9436-dbd1c4c01a80'
Related Workspaces: 'e24d7154-4554-4db6-a44f-d306b6b3a5d4'
Team members of Workspace: '635a2800-8833-410d-b1f1-f209b28ea2ad'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>create_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with the webpart data items that will be used
to update the "data" structure of the webpart.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"horizontalSections" (note the plural!)
"verticalSection" (note the singular!)</p>
              </div>
            </td>
            <td>
                  <code>&#39;horizontalSections&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the section.Only relevant for horizontal sections.
Simple values like 1,2,3...
Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_id</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For horizontalSections the column ID has to be provided.
Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>republish</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the page is republished to make the section active.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated web part.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26')/pages('ac7675ee-8891-43b9-b1b2-2d2ced8eb17e')/microsoft.graph.sitePage/canvasLayout/horizontalSections('1')/columns('1')/webparts/$entity",
    '@odata.type': '#microsoft.graph.standardWebPart',
    'id': '3df7fe9a-a1e0-4212-968c-73bd70ca3e31',
    'webPartType': 'eb95c819-ab8f-4689-bd03-0c2d65d47b1f',
    'data': {
        'audiences': [...],
        'dataVersion': '1.0',
        'title': 'Site activity',
        'properties': {'maxItems': 9},
        'serverProcessedContent': {
            'htmlStrings': [],
            'searchablePlainTexts': [],
            'links': [],
            'imageSources': []
        }
    }
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5540">5540</a></span>
<span class="normal"><a href="#__codelineno-0-5541">5541</a></span>
<span class="normal"><a href="#__codelineno-0-5542">5542</a></span>
<span class="normal"><a href="#__codelineno-0-5543">5543</a></span>
<span class="normal"><a href="#__codelineno-0-5544">5544</a></span>
<span class="normal"><a href="#__codelineno-0-5545">5545</a></span>
<span class="normal"><a href="#__codelineno-0-5546">5546</a></span>
<span class="normal"><a href="#__codelineno-0-5547">5547</a></span>
<span class="normal"><a href="#__codelineno-0-5548">5548</a></span>
<span class="normal"><a href="#__codelineno-0-5549">5549</a></span>
<span class="normal"><a href="#__codelineno-0-5550">5550</a></span>
<span class="normal"><a href="#__codelineno-0-5551">5551</a></span>
<span class="normal"><a href="#__codelineno-0-5552">5552</a></span>
<span class="normal"><a href="#__codelineno-0-5553">5553</a></span>
<span class="normal"><a href="#__codelineno-0-5554">5554</a></span>
<span class="normal"><a href="#__codelineno-0-5555">5555</a></span>
<span class="normal"><a href="#__codelineno-0-5556">5556</a></span>
<span class="normal"><a href="#__codelineno-0-5557">5557</a></span>
<span class="normal"><a href="#__codelineno-0-5558">5558</a></span>
<span class="normal"><a href="#__codelineno-0-5559">5559</a></span>
<span class="normal"><a href="#__codelineno-0-5560">5560</a></span>
<span class="normal"><a href="#__codelineno-0-5561">5561</a></span>
<span class="normal"><a href="#__codelineno-0-5562">5562</a></span>
<span class="normal"><a href="#__codelineno-0-5563">5563</a></span>
<span class="normal"><a href="#__codelineno-0-5564">5564</a></span>
<span class="normal"><a href="#__codelineno-0-5565">5565</a></span>
<span class="normal"><a href="#__codelineno-0-5566">5566</a></span>
<span class="normal"><a href="#__codelineno-0-5567">5567</a></span>
<span class="normal"><a href="#__codelineno-0-5568">5568</a></span>
<span class="normal"><a href="#__codelineno-0-5569">5569</a></span>
<span class="normal"><a href="#__codelineno-0-5570">5570</a></span>
<span class="normal"><a href="#__codelineno-0-5571">5571</a></span>
<span class="normal"><a href="#__codelineno-0-5572">5572</a></span>
<span class="normal"><a href="#__codelineno-0-5573">5573</a></span>
<span class="normal"><a href="#__codelineno-0-5574">5574</a></span>
<span class="normal"><a href="#__codelineno-0-5575">5575</a></span>
<span class="normal"><a href="#__codelineno-0-5576">5576</a></span>
<span class="normal"><a href="#__codelineno-0-5577">5577</a></span>
<span class="normal"><a href="#__codelineno-0-5578">5578</a></span>
<span class="normal"><a href="#__codelineno-0-5579">5579</a></span>
<span class="normal"><a href="#__codelineno-0-5580">5580</a></span>
<span class="normal"><a href="#__codelineno-0-5581">5581</a></span>
<span class="normal"><a href="#__codelineno-0-5582">5582</a></span>
<span class="normal"><a href="#__codelineno-0-5583">5583</a></span>
<span class="normal"><a href="#__codelineno-0-5584">5584</a></span>
<span class="normal"><a href="#__codelineno-0-5585">5585</a></span>
<span class="normal"><a href="#__codelineno-0-5586">5586</a></span>
<span class="normal"><a href="#__codelineno-0-5587">5587</a></span>
<span class="normal"><a href="#__codelineno-0-5588">5588</a></span>
<span class="normal"><a href="#__codelineno-0-5589">5589</a></span>
<span class="normal"><a href="#__codelineno-0-5590">5590</a></span>
<span class="normal"><a href="#__codelineno-0-5591">5591</a></span>
<span class="normal"><a href="#__codelineno-0-5592">5592</a></span>
<span class="normal"><a href="#__codelineno-0-5593">5593</a></span>
<span class="normal"><a href="#__codelineno-0-5594">5594</a></span>
<span class="normal"><a href="#__codelineno-0-5595">5595</a></span>
<span class="normal"><a href="#__codelineno-0-5596">5596</a></span>
<span class="normal"><a href="#__codelineno-0-5597">5597</a></span>
<span class="normal"><a href="#__codelineno-0-5598">5598</a></span>
<span class="normal"><a href="#__codelineno-0-5599">5599</a></span>
<span class="normal"><a href="#__codelineno-0-5600">5600</a></span>
<span class="normal"><a href="#__codelineno-0-5601">5601</a></span>
<span class="normal"><a href="#__codelineno-0-5602">5602</a></span>
<span class="normal"><a href="#__codelineno-0-5603">5603</a></span>
<span class="normal"><a href="#__codelineno-0-5604">5604</a></span>
<span class="normal"><a href="#__codelineno-0-5605">5605</a></span>
<span class="normal"><a href="#__codelineno-0-5606">5606</a></span>
<span class="normal"><a href="#__codelineno-0-5607">5607</a></span>
<span class="normal"><a href="#__codelineno-0-5608">5608</a></span>
<span class="normal"><a href="#__codelineno-0-5609">5609</a></span>
<span class="normal"><a href="#__codelineno-0-5610">5610</a></span>
<span class="normal"><a href="#__codelineno-0-5611">5611</a></span>
<span class="normal"><a href="#__codelineno-0-5612">5612</a></span>
<span class="normal"><a href="#__codelineno-0-5613">5613</a></span>
<span class="normal"><a href="#__codelineno-0-5614">5614</a></span>
<span class="normal"><a href="#__codelineno-0-5615">5615</a></span>
<span class="normal"><a href="#__codelineno-0-5616">5616</a></span>
<span class="normal"><a href="#__codelineno-0-5617">5617</a></span>
<span class="normal"><a href="#__codelineno-0-5618">5618</a></span>
<span class="normal"><a href="#__codelineno-0-5619">5619</a></span>
<span class="normal"><a href="#__codelineno-0-5620">5620</a></span>
<span class="normal"><a href="#__codelineno-0-5621">5621</a></span>
<span class="normal"><a href="#__codelineno-0-5622">5622</a></span>
<span class="normal"><a href="#__codelineno-0-5623">5623</a></span>
<span class="normal"><a href="#__codelineno-0-5624">5624</a></span>
<span class="normal"><a href="#__codelineno-0-5625">5625</a></span>
<span class="normal"><a href="#__codelineno-0-5626">5626</a></span>
<span class="normal"><a href="#__codelineno-0-5627">5627</a></span>
<span class="normal"><a href="#__codelineno-0-5628">5628</a></span>
<span class="normal"><a href="#__codelineno-0-5629">5629</a></span>
<span class="normal"><a href="#__codelineno-0-5630">5630</a></span>
<span class="normal"><a href="#__codelineno-0-5631">5631</a></span>
<span class="normal"><a href="#__codelineno-0-5632">5632</a></span>
<span class="normal"><a href="#__codelineno-0-5633">5633</a></span>
<span class="normal"><a href="#__codelineno-0-5634">5634</a></span>
<span class="normal"><a href="#__codelineno-0-5635">5635</a></span>
<span class="normal"><a href="#__codelineno-0-5636">5636</a></span>
<span class="normal"><a href="#__codelineno-0-5637">5637</a></span>
<span class="normal"><a href="#__codelineno-0-5638">5638</a></span>
<span class="normal"><a href="#__codelineno-0-5639">5639</a></span>
<span class="normal"><a href="#__codelineno-0-5640">5640</a></span>
<span class="normal"><a href="#__codelineno-0-5641">5641</a></span>
<span class="normal"><a href="#__codelineno-0-5642">5642</a></span>
<span class="normal"><a href="#__codelineno-0-5643">5643</a></span>
<span class="normal"><a href="#__codelineno-0-5644">5644</a></span>
<span class="normal"><a href="#__codelineno-0-5645">5645</a></span>
<span class="normal"><a href="#__codelineno-0-5646">5646</a></span>
<span class="normal"><a href="#__codelineno-0-5647">5647</a></span>
<span class="normal"><a href="#__codelineno-0-5648">5648</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5540"><a id="__codelineno-0-5540" name="__codelineno-0-5540"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_sharepoint_webpart</span><span class="p">(</span>
</span><span id="__span-0-5541"><a id="__codelineno-0-5541" name="__codelineno-0-5541"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5542"><a id="__codelineno-0-5542" name="__codelineno-0-5542"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5543"><a id="__codelineno-0-5543" name="__codelineno-0-5543"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5544"><a id="__codelineno-0-5544" name="__codelineno-0-5544"></a>    <span class="n">webpart_type_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5545"><a id="__codelineno-0-5545" name="__codelineno-0-5545"></a>    <span class="n">create_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="__span-0-5546"><a id="__codelineno-0-5546" name="__codelineno-0-5546"></a>    <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5547"><a id="__codelineno-0-5547" name="__codelineno-0-5547"></a>    <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5548"><a id="__codelineno-0-5548" name="__codelineno-0-5548"></a>    <span class="n">column_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5549"><a id="__codelineno-0-5549" name="__codelineno-0-5549"></a>    <span class="n">republish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5550"><a id="__codelineno-0-5550" name="__codelineno-0-5550"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5551"><a id="__codelineno-0-5551" name="__codelineno-0-5551"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a specific web part on a SharePoint page.</span>
</span><span id="__span-0-5552"><a id="__codelineno-0-5552" name="__codelineno-0-5552"></a>
</span><span id="__span-0-5553"><a id="__codelineno-0-5553" name="__codelineno-0-5553"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5554"><a id="__codelineno-0-5554" name="__codelineno-0-5554"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5555"><a id="__codelineno-0-5555" name="__codelineno-0-5555"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5556"><a id="__codelineno-0-5556" name="__codelineno-0-5556"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5557"><a id="__codelineno-0-5557" name="__codelineno-0-5557"></a><span class="sd">            The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5558"><a id="__codelineno-0-5558" name="__codelineno-0-5558"></a><span class="sd">        webpart_type_id (str):</span>
</span><span id="__span-0-5559"><a id="__codelineno-0-5559" name="__codelineno-0-5559"></a><span class="sd">            The ID of the web part to create.</span>
</span><span id="__span-0-5560"><a id="__codelineno-0-5560" name="__codelineno-0-5560"></a><span class="sd">            Content Browser: &#39;cecfdba4-2e82-4538-9436-dbd1c4c01a80&#39;</span>
</span><span id="__span-0-5561"><a id="__codelineno-0-5561" name="__codelineno-0-5561"></a><span class="sd">            Related Workspaces: &#39;e24d7154-4554-4db6-a44f-d306b6b3a5d4&#39;</span>
</span><span id="__span-0-5562"><a id="__codelineno-0-5562" name="__codelineno-0-5562"></a><span class="sd">            Team members of Workspace: &#39;635a2800-8833-410d-b1f1-f209b28ea2ad&#39;</span>
</span><span id="__span-0-5563"><a id="__codelineno-0-5563" name="__codelineno-0-5563"></a><span class="sd">        create_data (dict):</span>
</span><span id="__span-0-5564"><a id="__codelineno-0-5564" name="__codelineno-0-5564"></a><span class="sd">            A dictionary with the webpart data items that will be used</span>
</span><span id="__span-0-5565"><a id="__codelineno-0-5565" name="__codelineno-0-5565"></a><span class="sd">            to update the &quot;data&quot; structure of the webpart.</span>
</span><span id="__span-0-5566"><a id="__codelineno-0-5566" name="__codelineno-0-5566"></a><span class="sd">        section_type (str, optional):</span>
</span><span id="__span-0-5567"><a id="__codelineno-0-5567" name="__codelineno-0-5567"></a><span class="sd">            &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5568"><a id="__codelineno-0-5568" name="__codelineno-0-5568"></a><span class="sd">            &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5569"><a id="__codelineno-0-5569" name="__codelineno-0-5569"></a><span class="sd">        section_id (str | int):</span>
</span><span id="__span-0-5570"><a id="__codelineno-0-5570" name="__codelineno-0-5570"></a><span class="sd">            The ID of the section.Only relevant for horizontal sections.</span>
</span><span id="__span-0-5571"><a id="__codelineno-0-5571" name="__codelineno-0-5571"></a><span class="sd">            Simple values like 1,2,3...</span>
</span><span id="__span-0-5572"><a id="__codelineno-0-5572" name="__codelineno-0-5572"></a><span class="sd">            Defaults to 1.</span>
</span><span id="__span-0-5573"><a id="__codelineno-0-5573" name="__codelineno-0-5573"></a><span class="sd">        column_id (int | str, optional):</span>
</span><span id="__span-0-5574"><a id="__codelineno-0-5574" name="__codelineno-0-5574"></a><span class="sd">            For horizontalSections the column ID has to be provided.</span>
</span><span id="__span-0-5575"><a id="__codelineno-0-5575" name="__codelineno-0-5575"></a><span class="sd">            Defaults to 1.</span>
</span><span id="__span-0-5576"><a id="__codelineno-0-5576" name="__codelineno-0-5576"></a><span class="sd">        republish (bool, optional):</span>
</span><span id="__span-0-5577"><a id="__codelineno-0-5577" name="__codelineno-0-5577"></a><span class="sd">            If True, the page is republished to make the section active.</span>
</span><span id="__span-0-5578"><a id="__codelineno-0-5578" name="__codelineno-0-5578"></a>
</span><span id="__span-0-5579"><a id="__codelineno-0-5579" name="__codelineno-0-5579"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5580"><a id="__codelineno-0-5580" name="__codelineno-0-5580"></a><span class="sd">        dict:</span>
</span><span id="__span-0-5581"><a id="__codelineno-0-5581" name="__codelineno-0-5581"></a><span class="sd">            The updated web part.</span>
</span><span id="__span-0-5582"><a id="__codelineno-0-5582" name="__codelineno-0-5582"></a>
</span><span id="__span-0-5583"><a id="__codelineno-0-5583" name="__codelineno-0-5583"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5584"><a id="__codelineno-0-5584" name="__codelineno-0-5584"></a><span class="sd">    {</span>
</span><span id="__span-0-5585"><a id="__codelineno-0-5585" name="__codelineno-0-5585"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections(&#39;1&#39;)/columns(&#39;1&#39;)/webparts/$entity&quot;,</span>
</span><span id="__span-0-5586"><a id="__codelineno-0-5586" name="__codelineno-0-5586"></a><span class="sd">        &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5587"><a id="__codelineno-0-5587" name="__codelineno-0-5587"></a><span class="sd">        &#39;id&#39;: &#39;3df7fe9a-a1e0-4212-968c-73bd70ca3e31&#39;,</span>
</span><span id="__span-0-5588"><a id="__codelineno-0-5588" name="__codelineno-0-5588"></a><span class="sd">        &#39;webPartType&#39;: &#39;eb95c819-ab8f-4689-bd03-0c2d65d47b1f&#39;,</span>
</span><span id="__span-0-5589"><a id="__codelineno-0-5589" name="__codelineno-0-5589"></a><span class="sd">        &#39;data&#39;: {</span>
</span><span id="__span-0-5590"><a id="__codelineno-0-5590" name="__codelineno-0-5590"></a><span class="sd">            &#39;audiences&#39;: [...],</span>
</span><span id="__span-0-5591"><a id="__codelineno-0-5591" name="__codelineno-0-5591"></a><span class="sd">            &#39;dataVersion&#39;: &#39;1.0&#39;,</span>
</span><span id="__span-0-5592"><a id="__codelineno-0-5592" name="__codelineno-0-5592"></a><span class="sd">            &#39;title&#39;: &#39;Site activity&#39;,</span>
</span><span id="__span-0-5593"><a id="__codelineno-0-5593" name="__codelineno-0-5593"></a><span class="sd">            &#39;properties&#39;: {&#39;maxItems&#39;: 9},</span>
</span><span id="__span-0-5594"><a id="__codelineno-0-5594" name="__codelineno-0-5594"></a><span class="sd">            &#39;serverProcessedContent&#39;: {</span>
</span><span id="__span-0-5595"><a id="__codelineno-0-5595" name="__codelineno-0-5595"></a><span class="sd">                &#39;htmlStrings&#39;: [],</span>
</span><span id="__span-0-5596"><a id="__codelineno-0-5596" name="__codelineno-0-5596"></a><span class="sd">                &#39;searchablePlainTexts&#39;: [],</span>
</span><span id="__span-0-5597"><a id="__codelineno-0-5597" name="__codelineno-0-5597"></a><span class="sd">                &#39;links&#39;: [],</span>
</span><span id="__span-0-5598"><a id="__codelineno-0-5598" name="__codelineno-0-5598"></a><span class="sd">                &#39;imageSources&#39;: []</span>
</span><span id="__span-0-5599"><a id="__codelineno-0-5599" name="__codelineno-0-5599"></a><span class="sd">            }</span>
</span><span id="__span-0-5600"><a id="__codelineno-0-5600" name="__codelineno-0-5600"></a><span class="sd">        }</span>
</span><span id="__span-0-5601"><a id="__codelineno-0-5601" name="__codelineno-0-5601"></a><span class="sd">    }</span>
</span><span id="__span-0-5602"><a id="__codelineno-0-5602" name="__codelineno-0-5602"></a>
</span><span id="__span-0-5603"><a id="__codelineno-0-5603" name="__codelineno-0-5603"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5604"><a id="__codelineno-0-5604" name="__codelineno-0-5604"></a>
</span><span id="__span-0-5605"><a id="__codelineno-0-5605" name="__codelineno-0-5605"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5606"><a id="__codelineno-0-5606" name="__codelineno-0-5606"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5607"><a id="__codelineno-0-5607" name="__codelineno-0-5607"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5608"><a id="__codelineno-0-5608" name="__codelineno-0-5608"></a>        <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5609"><a id="__codelineno-0-5609" name="__codelineno-0-5609"></a>        <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5610"><a id="__codelineno-0-5610" name="__codelineno-0-5610"></a>        <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5611"><a id="__codelineno-0-5611" name="__codelineno-0-5611"></a>        <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5612"><a id="__codelineno-0-5612" name="__codelineno-0-5612"></a>        <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5613"><a id="__codelineno-0-5613" name="__codelineno-0-5613"></a>    <span class="p">)</span>
</span><span id="__span-0-5614"><a id="__codelineno-0-5614" name="__codelineno-0-5614"></a>    <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5615"><a id="__codelineno-0-5615" name="__codelineno-0-5615"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5616"><a id="__codelineno-0-5616" name="__codelineno-0-5616"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/columns/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">column_id</span><span class="p">)</span>
</span><span id="__span-0-5617"><a id="__codelineno-0-5617" name="__codelineno-0-5617"></a>    <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/webparts&quot;</span>
</span><span id="__span-0-5618"><a id="__codelineno-0-5618" name="__codelineno-0-5618"></a>
</span><span id="__span-0-5619"><a id="__codelineno-0-5619" name="__codelineno-0-5619"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5620"><a id="__codelineno-0-5620" name="__codelineno-0-5620"></a>
</span><span id="__span-0-5621"><a id="__codelineno-0-5621" name="__codelineno-0-5621"></a>    <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5622"><a id="__codelineno-0-5622" name="__codelineno-0-5622"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5623"><a id="__codelineno-0-5623" name="__codelineno-0-5623"></a>        <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.standardWebPart&quot;</span><span class="p">,</span>  <span class="c1"># likle &quot;#microsoft.graph.standardWebPart&quot; - this is mandatory!</span>
</span><span id="__span-0-5624"><a id="__codelineno-0-5624" name="__codelineno-0-5624"></a>        <span class="s2">&quot;webPartType&quot;</span><span class="p">:</span> <span class="n">webpart_type_id</span><span class="p">,</span>  <span class="c1"># this is mandatory!</span>
</span><span id="__span-0-5625"><a id="__codelineno-0-5625" name="__codelineno-0-5625"></a>        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">create_data</span><span class="p">,</span>
</span><span id="__span-0-5626"><a id="__codelineno-0-5626" name="__codelineno-0-5626"></a>    <span class="p">}</span>
</span><span id="__span-0-5627"><a id="__codelineno-0-5627" name="__codelineno-0-5627"></a>
</span><span id="__span-0-5628"><a id="__codelineno-0-5628" name="__codelineno-0-5628"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5629"><a id="__codelineno-0-5629" name="__codelineno-0-5629"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5630"><a id="__codelineno-0-5630" name="__codelineno-0-5630"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-5631"><a id="__codelineno-0-5631" name="__codelineno-0-5631"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5632"><a id="__codelineno-0-5632" name="__codelineno-0-5632"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5633"><a id="__codelineno-0-5633" name="__codelineno-0-5633"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5634"><a id="__codelineno-0-5634" name="__codelineno-0-5634"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to create SharePoint webpart of type -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="si">{}</span><span class="s2"> in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5635"><a id="__codelineno-0-5635" name="__codelineno-0-5635"></a>            <span class="n">webpart_type_id</span><span class="p">,</span>
</span><span id="__span-0-5636"><a id="__codelineno-0-5636" name="__codelineno-0-5636"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5637"><a id="__codelineno-0-5637" name="__codelineno-0-5637"></a>            <span class="s2">&quot; (horizontal section -&gt; </span><span class="si">{}</span><span class="s2">, column -&gt; </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section_id</span><span class="p">,</span> <span class="n">column_id</span><span class="p">)</span>
</span><span id="__span-0-5638"><a id="__codelineno-0-5638" name="__codelineno-0-5638"></a>            <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span>
</span><span id="__span-0-5639"><a id="__codelineno-0-5639" name="__codelineno-0-5639"></a>            <span class="k">else</span> <span class="s2">&quot; (vertical section)&quot;</span><span class="p">,</span>
</span><span id="__span-0-5640"><a id="__codelineno-0-5640" name="__codelineno-0-5640"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5641"><a id="__codelineno-0-5641" name="__codelineno-0-5641"></a>        <span class="p">),</span>
</span><span id="__span-0-5642"><a id="__codelineno-0-5642" name="__codelineno-0-5642"></a>    <span class="p">)</span>
</span><span id="__span-0-5643"><a id="__codelineno-0-5643" name="__codelineno-0-5643"></a>
</span><span id="__span-0-5644"><a id="__codelineno-0-5644" name="__codelineno-0-5644"></a>    <span class="c1"># Check if the page should be republished:</span>
</span><span id="__span-0-5645"><a id="__codelineno-0-5645" name="__codelineno-0-5645"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">republish</span><span class="p">:</span>
</span><span id="__span-0-5646"><a id="__codelineno-0-5646" name="__codelineno-0-5646"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-5647"><a id="__codelineno-0-5647" name="__codelineno-0-5647"></a>
</span><span id="__span-0-5648"><a id="__codelineno-0-5648" name="__codelineno-0-5648"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_team</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">template_name</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add M365 Team based on an existing M365 Group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the team. It is assumed that a group with the same name does already exist!</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>template_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the team template. "standard" is the default value.</p>
              </div>
            </td>
            <td>
                  <code>&#39;standard&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Team information (json - empty text!) or None if the team couldn't be created
(e.g. because it exisits already).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2122"><a id="__codelineno-0-2122" name="__codelineno-0-2122"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2123"><a id="__codelineno-0-2123" name="__codelineno-0-2123"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add M365 Team based on an existing M365 Group.</span>
</span><span id="__span-0-2124"><a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>
</span><span id="__span-0-2125"><a id="__codelineno-0-2125" name="__codelineno-0-2125"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2126"><a id="__codelineno-0-2126" name="__codelineno-0-2126"></a><span class="sd">        name (str):</span>
</span><span id="__span-0-2127"><a id="__codelineno-0-2127" name="__codelineno-0-2127"></a><span class="sd">            The name of the team. It is assumed that a group with the same name does already exist!</span>
</span><span id="__span-0-2128"><a id="__codelineno-0-2128" name="__codelineno-0-2128"></a><span class="sd">        template_name (str, optional):</span>
</span><span id="__span-0-2129"><a id="__codelineno-0-2129" name="__codelineno-0-2129"></a><span class="sd">            The name of the team template. &quot;standard&quot; is the default value.</span>
</span><span id="__span-0-2130"><a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>
</span><span id="__span-0-2131"><a id="__codelineno-0-2131" name="__codelineno-0-2131"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2132"><a id="__codelineno-0-2132" name="__codelineno-0-2132"></a><span class="sd">        dict:</span>
</span><span id="__span-0-2133"><a id="__codelineno-0-2133" name="__codelineno-0-2133"></a><span class="sd">            Team information (json - empty text!) or None if the team couldn&#39;t be created</span>
</span><span id="__span-0-2134"><a id="__codelineno-0-2134" name="__codelineno-0-2134"></a><span class="sd">            (e.g. because it exisits already).</span>
</span><span id="__span-0-2135"><a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>
</span><span id="__span-0-2136"><a id="__codelineno-0-2136" name="__codelineno-0-2136"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2137"><a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>
</span><span id="__span-0-2138"><a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2139"><a id="__codelineno-0-2139" name="__codelineno-0-2139"></a>    <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2140"><a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-2141"><a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2142"><a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>            <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found! It is required for creating a corresponding M365 Team.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2143"><a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2144"><a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>        <span class="p">)</span>
</span><span id="__span-0-2145"><a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2146"><a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>
</span><span id="__span-0-2147"><a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group_owners</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2148"><a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]:</span>
</span><span id="__span-0-2149"><a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-2150"><a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>            <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has no owners. This is required for creating a corresponding M365 Team.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2151"><a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2152"><a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>        <span class="p">)</span>
</span><span id="__span-0-2153"><a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2154"><a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>
</span><span id="__span-0-2155"><a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>    <span class="n">team_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2156"><a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>        <span class="s2">&quot;template@odata.bind&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(&#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2157"><a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsTemplatesUrl&quot;</span><span class="p">],</span>
</span><span id="__span-0-2158"><a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>            <span class="n">template_name</span><span class="p">,</span>
</span><span id="__span-0-2159"><a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>        <span class="p">),</span>
</span><span id="__span-0-2160"><a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>        <span class="s2">&quot;group@odata.bind&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(&#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">],</span> <span class="n">group_id</span><span class="p">),</span>
</span><span id="__span-0-2161"><a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>    <span class="p">}</span>
</span><span id="__span-0-2162"><a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>
</span><span id="__span-0-2163"><a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-2164"><a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2165"><a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>
</span><span id="__span-0-2166"><a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-2167"><a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;M365 Team attributes -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_post_body</span><span class="p">))</span>
</span><span id="__span-0-2168"><a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>
</span><span id="__span-0-2169"><a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2170"><a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2171"><a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-2172"><a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">team_post_body</span><span class="p">),</span>
</span><span id="__span-0-2173"><a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2174"><a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2175"><a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
</span><span id="__span-0-2176"><a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_teams_app_to_channel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_teams_app_to_channel</span><span class="p">(</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">app_id</span><span class="p">,</span> <span class="n">tab_name</span><span class="p">,</span> <span class="n">app_url</span><span class="p">,</span> <span class="n">cs_node_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add tab for Extended ECM app to an M365 Team channel.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 Team</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the channel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the MS Teams Application (e.g. the Extended ECM Teams App).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tab_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tab.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The web URL of the app.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cs_node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node ID of the target workspace or container in Extended ECM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return data structure (dictionary) or None if the request fails.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Example return data:</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3236">3236</a></span>
<span class="normal"><a href="#__codelineno-0-3237">3237</a></span>
<span class="normal"><a href="#__codelineno-0-3238">3238</a></span>
<span class="normal"><a href="#__codelineno-0-3239">3239</a></span>
<span class="normal"><a href="#__codelineno-0-3240">3240</a></span>
<span class="normal"><a href="#__codelineno-0-3241">3241</a></span>
<span class="normal"><a href="#__codelineno-0-3242">3242</a></span>
<span class="normal"><a href="#__codelineno-0-3243">3243</a></span>
<span class="normal"><a href="#__codelineno-0-3244">3244</a></span>
<span class="normal"><a href="#__codelineno-0-3245">3245</a></span>
<span class="normal"><a href="#__codelineno-0-3246">3246</a></span>
<span class="normal"><a href="#__codelineno-0-3247">3247</a></span>
<span class="normal"><a href="#__codelineno-0-3248">3248</a></span>
<span class="normal"><a href="#__codelineno-0-3249">3249</a></span>
<span class="normal"><a href="#__codelineno-0-3250">3250</a></span>
<span class="normal"><a href="#__codelineno-0-3251">3251</a></span>
<span class="normal"><a href="#__codelineno-0-3252">3252</a></span>
<span class="normal"><a href="#__codelineno-0-3253">3253</a></span>
<span class="normal"><a href="#__codelineno-0-3254">3254</a></span>
<span class="normal"><a href="#__codelineno-0-3255">3255</a></span>
<span class="normal"><a href="#__codelineno-0-3256">3256</a></span>
<span class="normal"><a href="#__codelineno-0-3257">3257</a></span>
<span class="normal"><a href="#__codelineno-0-3258">3258</a></span>
<span class="normal"><a href="#__codelineno-0-3259">3259</a></span>
<span class="normal"><a href="#__codelineno-0-3260">3260</a></span>
<span class="normal"><a href="#__codelineno-0-3261">3261</a></span>
<span class="normal"><a href="#__codelineno-0-3262">3262</a></span>
<span class="normal"><a href="#__codelineno-0-3263">3263</a></span>
<span class="normal"><a href="#__codelineno-0-3264">3264</a></span>
<span class="normal"><a href="#__codelineno-0-3265">3265</a></span>
<span class="normal"><a href="#__codelineno-0-3266">3266</a></span>
<span class="normal"><a href="#__codelineno-0-3267">3267</a></span>
<span class="normal"><a href="#__codelineno-0-3268">3268</a></span>
<span class="normal"><a href="#__codelineno-0-3269">3269</a></span>
<span class="normal"><a href="#__codelineno-0-3270">3270</a></span>
<span class="normal"><a href="#__codelineno-0-3271">3271</a></span>
<span class="normal"><a href="#__codelineno-0-3272">3272</a></span>
<span class="normal"><a href="#__codelineno-0-3273">3273</a></span>
<span class="normal"><a href="#__codelineno-0-3274">3274</a></span>
<span class="normal"><a href="#__codelineno-0-3275">3275</a></span>
<span class="normal"><a href="#__codelineno-0-3276">3276</a></span>
<span class="normal"><a href="#__codelineno-0-3277">3277</a></span>
<span class="normal"><a href="#__codelineno-0-3278">3278</a></span>
<span class="normal"><a href="#__codelineno-0-3279">3279</a></span>
<span class="normal"><a href="#__codelineno-0-3280">3280</a></span>
<span class="normal"><a href="#__codelineno-0-3281">3281</a></span>
<span class="normal"><a href="#__codelineno-0-3282">3282</a></span>
<span class="normal"><a href="#__codelineno-0-3283">3283</a></span>
<span class="normal"><a href="#__codelineno-0-3284">3284</a></span>
<span class="normal"><a href="#__codelineno-0-3285">3285</a></span>
<span class="normal"><a href="#__codelineno-0-3286">3286</a></span>
<span class="normal"><a href="#__codelineno-0-3287">3287</a></span>
<span class="normal"><a href="#__codelineno-0-3288">3288</a></span>
<span class="normal"><a href="#__codelineno-0-3289">3289</a></span>
<span class="normal"><a href="#__codelineno-0-3290">3290</a></span>
<span class="normal"><a href="#__codelineno-0-3291">3291</a></span>
<span class="normal"><a href="#__codelineno-0-3292">3292</a></span>
<span class="normal"><a href="#__codelineno-0-3293">3293</a></span>
<span class="normal"><a href="#__codelineno-0-3294">3294</a></span>
<span class="normal"><a href="#__codelineno-0-3295">3295</a></span>
<span class="normal"><a href="#__codelineno-0-3296">3296</a></span>
<span class="normal"><a href="#__codelineno-0-3297">3297</a></span>
<span class="normal"><a href="#__codelineno-0-3298">3298</a></span>
<span class="normal"><a href="#__codelineno-0-3299">3299</a></span>
<span class="normal"><a href="#__codelineno-0-3300">3300</a></span>
<span class="normal"><a href="#__codelineno-0-3301">3301</a></span>
<span class="normal"><a href="#__codelineno-0-3302">3302</a></span>
<span class="normal"><a href="#__codelineno-0-3303">3303</a></span>
<span class="normal"><a href="#__codelineno-0-3304">3304</a></span>
<span class="normal"><a href="#__codelineno-0-3305">3305</a></span>
<span class="normal"><a href="#__codelineno-0-3306">3306</a></span>
<span class="normal"><a href="#__codelineno-0-3307">3307</a></span>
<span class="normal"><a href="#__codelineno-0-3308">3308</a></span>
<span class="normal"><a href="#__codelineno-0-3309">3309</a></span>
<span class="normal"><a href="#__codelineno-0-3310">3310</a></span>
<span class="normal"><a href="#__codelineno-0-3311">3311</a></span>
<span class="normal"><a href="#__codelineno-0-3312">3312</a></span>
<span class="normal"><a href="#__codelineno-0-3313">3313</a></span>
<span class="normal"><a href="#__codelineno-0-3314">3314</a></span>
<span class="normal"><a href="#__codelineno-0-3315">3315</a></span>
<span class="normal"><a href="#__codelineno-0-3316">3316</a></span>
<span class="normal"><a href="#__codelineno-0-3317">3317</a></span>
<span class="normal"><a href="#__codelineno-0-3318">3318</a></span>
<span class="normal"><a href="#__codelineno-0-3319">3319</a></span>
<span class="normal"><a href="#__codelineno-0-3320">3320</a></span>
<span class="normal"><a href="#__codelineno-0-3321">3321</a></span>
<span class="normal"><a href="#__codelineno-0-3322">3322</a></span>
<span class="normal"><a href="#__codelineno-0-3323">3323</a></span>
<span class="normal"><a href="#__codelineno-0-3324">3324</a></span>
<span class="normal"><a href="#__codelineno-0-3325">3325</a></span>
<span class="normal"><a href="#__codelineno-0-3326">3326</a></span>
<span class="normal"><a href="#__codelineno-0-3327">3327</a></span>
<span class="normal"><a href="#__codelineno-0-3328">3328</a></span>
<span class="normal"><a href="#__codelineno-0-3329">3329</a></span>
<span class="normal"><a href="#__codelineno-0-3330">3330</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3236"><a id="__codelineno-0-3236" name="__codelineno-0-3236"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_teams_app_to_channel</span><span class="p">(</span>
</span><span id="__span-0-3237"><a id="__codelineno-0-3237" name="__codelineno-0-3237"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3238"><a id="__codelineno-0-3238" name="__codelineno-0-3238"></a>    <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3239"><a id="__codelineno-0-3239" name="__codelineno-0-3239"></a>    <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3240"><a id="__codelineno-0-3240" name="__codelineno-0-3240"></a>    <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3241"><a id="__codelineno-0-3241" name="__codelineno-0-3241"></a>    <span class="n">tab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3242"><a id="__codelineno-0-3242" name="__codelineno-0-3242"></a>    <span class="n">app_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3243"><a id="__codelineno-0-3243" name="__codelineno-0-3243"></a>    <span class="n">cs_node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3244"><a id="__codelineno-0-3244" name="__codelineno-0-3244"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3245"><a id="__codelineno-0-3245" name="__codelineno-0-3245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add tab for Extended ECM app to an M365 Team channel.</span>
</span><span id="__span-0-3246"><a id="__codelineno-0-3246" name="__codelineno-0-3246"></a>
</span><span id="__span-0-3247"><a id="__codelineno-0-3247" name="__codelineno-0-3247"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3248"><a id="__codelineno-0-3248" name="__codelineno-0-3248"></a><span class="sd">        team_name (str):</span>
</span><span id="__span-0-3249"><a id="__codelineno-0-3249" name="__codelineno-0-3249"></a><span class="sd">            The name of the M365 Team</span>
</span><span id="__span-0-3250"><a id="__codelineno-0-3250" name="__codelineno-0-3250"></a><span class="sd">        channel_name (str):</span>
</span><span id="__span-0-3251"><a id="__codelineno-0-3251" name="__codelineno-0-3251"></a><span class="sd">            The name of the channel.</span>
</span><span id="__span-0-3252"><a id="__codelineno-0-3252" name="__codelineno-0-3252"></a><span class="sd">        app_id (str):</span>
</span><span id="__span-0-3253"><a id="__codelineno-0-3253" name="__codelineno-0-3253"></a><span class="sd">            ID of the MS Teams Application (e.g. the Extended ECM Teams App).</span>
</span><span id="__span-0-3254"><a id="__codelineno-0-3254" name="__codelineno-0-3254"></a><span class="sd">        tab_name (str):</span>
</span><span id="__span-0-3255"><a id="__codelineno-0-3255" name="__codelineno-0-3255"></a><span class="sd">            The name of the tab.</span>
</span><span id="__span-0-3256"><a id="__codelineno-0-3256" name="__codelineno-0-3256"></a><span class="sd">        app_url (str):</span>
</span><span id="__span-0-3257"><a id="__codelineno-0-3257" name="__codelineno-0-3257"></a><span class="sd">            The web URL of the app.</span>
</span><span id="__span-0-3258"><a id="__codelineno-0-3258" name="__codelineno-0-3258"></a><span class="sd">        cs_node_id (int):</span>
</span><span id="__span-0-3259"><a id="__codelineno-0-3259" name="__codelineno-0-3259"></a><span class="sd">            The node ID of the target workspace or container in Extended ECM.</span>
</span><span id="__span-0-3260"><a id="__codelineno-0-3260" name="__codelineno-0-3260"></a>
</span><span id="__span-0-3261"><a id="__codelineno-0-3261" name="__codelineno-0-3261"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3262"><a id="__codelineno-0-3262" name="__codelineno-0-3262"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3263"><a id="__codelineno-0-3263" name="__codelineno-0-3263"></a><span class="sd">            Return data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-3264"><a id="__codelineno-0-3264" name="__codelineno-0-3264"></a>
</span><span id="__span-0-3265"><a id="__codelineno-0-3265" name="__codelineno-0-3265"></a><span class="sd">        Example return data:</span>
</span><span id="__span-0-3266"><a id="__codelineno-0-3266" name="__codelineno-0-3266"></a>
</span><span id="__span-0-3267"><a id="__codelineno-0-3267" name="__codelineno-0-3267"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3268"><a id="__codelineno-0-3268" name="__codelineno-0-3268"></a>
</span><span id="__span-0-3269"><a id="__codelineno-0-3269" name="__codelineno-0-3269"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3270"><a id="__codelineno-0-3270" name="__codelineno-0-3270"></a>    <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3271"><a id="__codelineno-0-3271" name="__codelineno-0-3271"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-3272"><a id="__codelineno-0-3272" name="__codelineno-0-3272"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3273"><a id="__codelineno-0-3273" name="__codelineno-0-3273"></a>
</span><span id="__span-0-3274"><a id="__codelineno-0-3274" name="__codelineno-0-3274"></a>    <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-3275"><a id="__codelineno-0-3275" name="__codelineno-0-3275"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3276"><a id="__codelineno-0-3276" name="__codelineno-0-3276"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3277"><a id="__codelineno-0-3277" name="__codelineno-0-3277"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3278"><a id="__codelineno-0-3278" name="__codelineno-0-3278"></a>
</span><span id="__span-0-3279"><a id="__codelineno-0-3279" name="__codelineno-0-3279"></a>    <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-3280"><a id="__codelineno-0-3280" name="__codelineno-0-3280"></a>    <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3281"><a id="__codelineno-0-3281" name="__codelineno-0-3281"></a>        <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-3282"><a id="__codelineno-0-3282" name="__codelineno-0-3282"></a>        <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3283"><a id="__codelineno-0-3283" name="__codelineno-0-3283"></a>    <span class="p">)</span>
</span><span id="__span-0-3284"><a id="__codelineno-0-3284" name="__codelineno-0-3284"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-3285"><a id="__codelineno-0-3285" name="__codelineno-0-3285"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3286"><a id="__codelineno-0-3286" name="__codelineno-0-3286"></a>            <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3287"><a id="__codelineno-0-3287" name="__codelineno-0-3287"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3288"><a id="__codelineno-0-3288" name="__codelineno-0-3288"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3289"><a id="__codelineno-0-3289" name="__codelineno-0-3289"></a>        <span class="p">)</span>
</span><span id="__span-0-3290"><a id="__codelineno-0-3290" name="__codelineno-0-3290"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3291"><a id="__codelineno-0-3291" name="__codelineno-0-3291"></a>    <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3292"><a id="__codelineno-0-3292" name="__codelineno-0-3292"></a>
</span><span id="__span-0-3293"><a id="__codelineno-0-3293" name="__codelineno-0-3293"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs&quot;</span>
</span><span id="__span-0-3294"><a id="__codelineno-0-3294" name="__codelineno-0-3294"></a>
</span><span id="__span-0-3295"><a id="__codelineno-0-3295" name="__codelineno-0-3295"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3296"><a id="__codelineno-0-3296" name="__codelineno-0-3296"></a>
</span><span id="__span-0-3297"><a id="__codelineno-0-3297" name="__codelineno-0-3297"></a>    <span class="c1"># Create tab configuration payload:</span>
</span><span id="__span-0-3298"><a id="__codelineno-0-3298" name="__codelineno-0-3298"></a>    <span class="n">tab_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3299"><a id="__codelineno-0-3299" name="__codelineno-0-3299"></a>        <span class="s2">&quot;teamsApp@odata.bind&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/</span><span class="si">{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3300"><a id="__codelineno-0-3300" name="__codelineno-0-3300"></a>        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3301"><a id="__codelineno-0-3301" name="__codelineno-0-3301"></a>        <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-3302"><a id="__codelineno-0-3302" name="__codelineno-0-3302"></a>            <span class="s2">&quot;entityId&quot;</span><span class="p">:</span> <span class="n">cs_node_id</span><span class="p">,</span>  <span class="c1"># Unique identifier for the tab</span>
</span><span id="__span-0-3303"><a id="__codelineno-0-3303" name="__codelineno-0-3303"></a>            <span class="s2">&quot;contentUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span><span class="p">,</span>
</span><span id="__span-0-3304"><a id="__codelineno-0-3304" name="__codelineno-0-3304"></a>            <span class="s2">&quot;removeUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3305"><a id="__codelineno-0-3305" name="__codelineno-0-3305"></a>            <span class="s2">&quot;websiteUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span> <span class="o">+</span> <span class="s2">&quot;&amp;showBW=true&amp;title=&quot;</span> <span class="o">+</span> <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3306"><a id="__codelineno-0-3306" name="__codelineno-0-3306"></a>        <span class="p">},</span>
</span><span id="__span-0-3307"><a id="__codelineno-0-3307" name="__codelineno-0-3307"></a>    <span class="p">}</span>
</span><span id="__span-0-3308"><a id="__codelineno-0-3308" name="__codelineno-0-3308"></a>
</span><span id="__span-0-3309"><a id="__codelineno-0-3309" name="__codelineno-0-3309"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3310"><a id="__codelineno-0-3310" name="__codelineno-0-3310"></a>        <span class="s2">&quot;Add Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; with App ID -&gt; </span><span class="si">%s</span><span class="s2"> to Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; of Microsoft 365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3311"><a id="__codelineno-0-3311" name="__codelineno-0-3311"></a>        <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3312"><a id="__codelineno-0-3312" name="__codelineno-0-3312"></a>        <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3313"><a id="__codelineno-0-3313" name="__codelineno-0-3313"></a>        <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3314"><a id="__codelineno-0-3314" name="__codelineno-0-3314"></a>        <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3315"><a id="__codelineno-0-3315" name="__codelineno-0-3315"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3316"><a id="__codelineno-0-3316" name="__codelineno-0-3316"></a>    <span class="p">)</span>
</span><span id="__span-0-3317"><a id="__codelineno-0-3317" name="__codelineno-0-3317"></a>
</span><span id="__span-0-3318"><a id="__codelineno-0-3318" name="__codelineno-0-3318"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3319"><a id="__codelineno-0-3319" name="__codelineno-0-3319"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3320"><a id="__codelineno-0-3320" name="__codelineno-0-3320"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3321"><a id="__codelineno-0-3321" name="__codelineno-0-3321"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3322"><a id="__codelineno-0-3322" name="__codelineno-0-3322"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">tab_config</span><span class="p">,</span>
</span><span id="__span-0-3323"><a id="__codelineno-0-3323" name="__codelineno-0-3323"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3324"><a id="__codelineno-0-3324" name="__codelineno-0-3324"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add Tab for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3325"><a id="__codelineno-0-3325" name="__codelineno-0-3325"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3326"><a id="__codelineno-0-3326" name="__codelineno-0-3326"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3327"><a id="__codelineno-0-3327" name="__codelineno-0-3327"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3328"><a id="__codelineno-0-3328" name="__codelineno-0-3328"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3329"><a id="__codelineno-0-3329" name="__codelineno-0-3329"></a>        <span class="p">),</span>
</span><span id="__span-0-3330"><a id="__codelineno-0-3330" name="__codelineno-0-3330"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.add_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_user</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="n">department</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">company_name</span><span class="o">=</span><span class="s1">&#39;Innovate&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a M365 user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>email</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The email address of the user. This is also the unique identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The password of the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>first_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first name of the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The last name of the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The country ISO 3166-1 alpha-2 code (e.g. US, CA, FR, DE, CN, ...)</p>
              </div>
            </td>
            <td>
                  <code>&#39;US&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>department</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The department of the user.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>company_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the company the user works for.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Innovate&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
User information or None if the user couldn't be created (e.g. because it exisits already
or if a permission problem occurs).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_user</span><span class="p">(</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>    <span class="n">department</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="n">company_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Innovate&quot;</span><span class="p">,</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a M365 user.</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">        email (str):</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">            The email address of the user. This is also the unique identifier.</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">        password (str):</span>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">            The password of the user.</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        first_name (str):</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">            The first name of the user.</span>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">        last_name (str):</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">            The last name of the user.</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        location (str, optional):</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">            The country ISO 3166-1 alpha-2 code (e.g. US, CA, FR, DE, CN, ...)</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        department (str, optional):</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            The department of the user.</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">        company_name (str):</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">            The name of the company the user works for.</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">            User information or None if the user couldn&#39;t be created (e.g. because it exisits already</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">            or if a permission problem occurs).</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>    <span class="n">user_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="s2">&quot;accountEnabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">last_name</span><span class="p">,</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="s2">&quot;givenName&quot;</span><span class="p">:</span> <span class="n">first_name</span><span class="p">,</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>        <span class="s2">&quot;surname&quot;</span><span class="p">:</span> <span class="n">last_name</span><span class="p">,</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="n">email</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="s2">&quot;passwordProfile&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>            <span class="s2">&quot;forceChangePasswordNextSignIn&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>        <span class="p">},</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="s2">&quot;usageLocation&quot;</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="p">}</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>    <span class="k">if</span> <span class="n">department</span><span class="p">:</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>        <span class="n">user_post_body</span><span class="p">[</span><span class="s2">&quot;department&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">department</span>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>    <span class="k">if</span> <span class="n">company_name</span><span class="p">:</span>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>        <span class="n">user_post_body</span><span class="p">[</span><span class="s2">&quot;companyName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">company_name</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding M365 user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">user_post_body</span><span class="p">),</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to add M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email</span><span class="p">),</span>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.assign_license_to_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_license_to_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">sku_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add an M365 license to a user (e.g. to use Office 365).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sku_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>M365 GUID of the SKU.
(e.g. c7df2760-2c81-4ef7-b578-5b5392b571df for E5 and
6fd2c87f-b296-42f0-b197-1e91e994b900 for E3)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API response or None if request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="k">def</span><span class="w"> </span><span class="nf">assign_license_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sku_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an M365 license to a user (e.g. to use Office 365).</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user)</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        sku_id (str):</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">            M365 GUID of the SKU.</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">            (e.g. c7df2760-2c81-4ef7-b578-5b5392b571df for E5 and</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">            6fd2c87f-b296-42f0-b197-1e91e994b900 for E3)</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">        dict:</span>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">            The API response or None if request fails.</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/assignLicense&quot;</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>    <span class="c1"># Construct the request body for assigning the E5 license</span>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>    <span class="n">license_post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="s2">&quot;addLicenses&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="p">{</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>                <span class="s2">&quot;disabledPlans&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>                <span class="s2">&quot;skuId&quot;</span><span class="p">:</span> <span class="n">sku_id</span><span class="p">,</span>  <span class="c1"># &quot;c42b9cae-ea4f-4a69-9ca5-c53bd8779c42&quot;</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>            <span class="p">},</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="p">],</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="s2">&quot;removeLicenses&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>    <span class="p">}</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="s2">&quot;Assign M365 license -&gt; </span><span class="si">%s</span><span class="s2"> to M365 user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="n">sku_id</span><span class="p">,</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="p">)</span>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">license_post_body</span><span class="p">,</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 license -&gt; </span><span class="si">{}</span><span class="s2"> to M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>            <span class="n">sku_id</span><span class="p">,</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>        <span class="p">),</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.assign_sensitivity_label_to_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_sensitivity_label_to_user</span><span class="p">(</span><span class="n">user_email</span><span class="p">,</span> <span class="n">label_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assign a existing sensitivity label to a user.</p>
<p>TODO: THIS IS CURRENTLY NOT WORKING!</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_email</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The email address of the user (as unique identifier).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the label (need to exist).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Return the request response or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3648">3648</a></span>
<span class="normal"><a href="#__codelineno-0-3649">3649</a></span>
<span class="normal"><a href="#__codelineno-0-3650">3650</a></span>
<span class="normal"><a href="#__codelineno-0-3651">3651</a></span>
<span class="normal"><a href="#__codelineno-0-3652">3652</a></span>
<span class="normal"><a href="#__codelineno-0-3653">3653</a></span>
<span class="normal"><a href="#__codelineno-0-3654">3654</a></span>
<span class="normal"><a href="#__codelineno-0-3655">3655</a></span>
<span class="normal"><a href="#__codelineno-0-3656">3656</a></span>
<span class="normal"><a href="#__codelineno-0-3657">3657</a></span>
<span class="normal"><a href="#__codelineno-0-3658">3658</a></span>
<span class="normal"><a href="#__codelineno-0-3659">3659</a></span>
<span class="normal"><a href="#__codelineno-0-3660">3660</a></span>
<span class="normal"><a href="#__codelineno-0-3661">3661</a></span>
<span class="normal"><a href="#__codelineno-0-3662">3662</a></span>
<span class="normal"><a href="#__codelineno-0-3663">3663</a></span>
<span class="normal"><a href="#__codelineno-0-3664">3664</a></span>
<span class="normal"><a href="#__codelineno-0-3665">3665</a></span>
<span class="normal"><a href="#__codelineno-0-3666">3666</a></span>
<span class="normal"><a href="#__codelineno-0-3667">3667</a></span>
<span class="normal"><a href="#__codelineno-0-3668">3668</a></span>
<span class="normal"><a href="#__codelineno-0-3669">3669</a></span>
<span class="normal"><a href="#__codelineno-0-3670">3670</a></span>
<span class="normal"><a href="#__codelineno-0-3671">3671</a></span>
<span class="normal"><a href="#__codelineno-0-3672">3672</a></span>
<span class="normal"><a href="#__codelineno-0-3673">3673</a></span>
<span class="normal"><a href="#__codelineno-0-3674">3674</a></span>
<span class="normal"><a href="#__codelineno-0-3675">3675</a></span>
<span class="normal"><a href="#__codelineno-0-3676">3676</a></span>
<span class="normal"><a href="#__codelineno-0-3677">3677</a></span>
<span class="normal"><a href="#__codelineno-0-3678">3678</a></span>
<span class="normal"><a href="#__codelineno-0-3679">3679</a></span>
<span class="normal"><a href="#__codelineno-0-3680">3680</a></span>
<span class="normal"><a href="#__codelineno-0-3681">3681</a></span>
<span class="normal"><a href="#__codelineno-0-3682">3682</a></span>
<span class="normal"><a href="#__codelineno-0-3683">3683</a></span>
<span class="normal"><a href="#__codelineno-0-3684">3684</a></span>
<span class="normal"><a href="#__codelineno-0-3685">3685</a></span>
<span class="normal"><a href="#__codelineno-0-3686">3686</a></span>
<span class="normal"><a href="#__codelineno-0-3687">3687</a></span>
<span class="normal"><a href="#__codelineno-0-3688">3688</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3648"><a id="__codelineno-0-3648" name="__codelineno-0-3648"></a><span class="k">def</span><span class="w"> </span><span class="nf">assign_sensitivity_label_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3649"><a id="__codelineno-0-3649" name="__codelineno-0-3649"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign a existing sensitivity label to a user.</span>
</span><span id="__span-0-3650"><a id="__codelineno-0-3650" name="__codelineno-0-3650"></a>
</span><span id="__span-0-3651"><a id="__codelineno-0-3651" name="__codelineno-0-3651"></a><span class="sd">    TODO: THIS IS CURRENTLY NOT WORKING!</span>
</span><span id="__span-0-3652"><a id="__codelineno-0-3652" name="__codelineno-0-3652"></a>
</span><span id="__span-0-3653"><a id="__codelineno-0-3653" name="__codelineno-0-3653"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3654"><a id="__codelineno-0-3654" name="__codelineno-0-3654"></a><span class="sd">        user_email (str):</span>
</span><span id="__span-0-3655"><a id="__codelineno-0-3655" name="__codelineno-0-3655"></a><span class="sd">            The email address of the user (as unique identifier).</span>
</span><span id="__span-0-3656"><a id="__codelineno-0-3656" name="__codelineno-0-3656"></a><span class="sd">        label_name (str):</span>
</span><span id="__span-0-3657"><a id="__codelineno-0-3657" name="__codelineno-0-3657"></a><span class="sd">            The name of the label (need to exist).</span>
</span><span id="__span-0-3658"><a id="__codelineno-0-3658" name="__codelineno-0-3658"></a>
</span><span id="__span-0-3659"><a id="__codelineno-0-3659" name="__codelineno-0-3659"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3660"><a id="__codelineno-0-3660" name="__codelineno-0-3660"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-3661"><a id="__codelineno-0-3661" name="__codelineno-0-3661"></a><span class="sd">            Return the request response or None if the request fails.</span>
</span><span id="__span-0-3662"><a id="__codelineno-0-3662" name="__codelineno-0-3662"></a>
</span><span id="__span-0-3663"><a id="__codelineno-0-3663" name="__codelineno-0-3663"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3664"><a id="__codelineno-0-3664" name="__codelineno-0-3664"></a>
</span><span id="__span-0-3665"><a id="__codelineno-0-3665" name="__codelineno-0-3665"></a>    <span class="c1"># Set up the request body with the label name</span>
</span><span id="__span-0-3666"><a id="__codelineno-0-3666" name="__codelineno-0-3666"></a>    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;labelName&quot;</span><span class="p">:</span> <span class="n">label_name</span><span class="p">}</span>
</span><span id="__span-0-3667"><a id="__codelineno-0-3667" name="__codelineno-0-3667"></a>
</span><span id="__span-0-3668"><a id="__codelineno-0-3668" name="__codelineno-0-3668"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_email</span> <span class="o">+</span> <span class="s2">&quot;/assignSensitivityLabels&quot;</span>
</span><span id="__span-0-3669"><a id="__codelineno-0-3669" name="__codelineno-0-3669"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3670"><a id="__codelineno-0-3670" name="__codelineno-0-3670"></a>
</span><span id="__span-0-3671"><a id="__codelineno-0-3671" name="__codelineno-0-3671"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3672"><a id="__codelineno-0-3672" name="__codelineno-0-3672"></a>        <span class="s2">&quot;Assign label -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; to user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3673"><a id="__codelineno-0-3673" name="__codelineno-0-3673"></a>        <span class="n">label_name</span><span class="p">,</span>
</span><span id="__span-0-3674"><a id="__codelineno-0-3674" name="__codelineno-0-3674"></a>        <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-3675"><a id="__codelineno-0-3675" name="__codelineno-0-3675"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3676"><a id="__codelineno-0-3676" name="__codelineno-0-3676"></a>    <span class="p">)</span>
</span><span id="__span-0-3677"><a id="__codelineno-0-3677" name="__codelineno-0-3677"></a>
</span><span id="__span-0-3678"><a id="__codelineno-0-3678" name="__codelineno-0-3678"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3679"><a id="__codelineno-0-3679" name="__codelineno-0-3679"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3680"><a id="__codelineno-0-3680" name="__codelineno-0-3680"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3681"><a id="__codelineno-0-3681" name="__codelineno-0-3681"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3682"><a id="__codelineno-0-3682" name="__codelineno-0-3682"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
</span><span id="__span-0-3683"><a id="__codelineno-0-3683" name="__codelineno-0-3683"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3684"><a id="__codelineno-0-3684" name="__codelineno-0-3684"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign label -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; to M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3685"><a id="__codelineno-0-3685" name="__codelineno-0-3685"></a>            <span class="n">label_name</span><span class="p">,</span>
</span><span id="__span-0-3686"><a id="__codelineno-0-3686" name="__codelineno-0-3686"></a>            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-3687"><a id="__codelineno-0-3687" name="__codelineno-0-3687"></a>        <span class="p">),</span>
</span><span id="__span-0-3688"><a id="__codelineno-0-3688" name="__codelineno-0-3688"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.assign_teams_app_to_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_teams_app_to_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">,</span> <span class="n">app_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assign (add) a MS Teams app to a M365 team.</p>
<p>Afterwards the app can be added as a Tab in a M365 Teams Channel).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the Microsoft 365 Team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the M365 Team App.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
API response or None if the Graph API call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3130">3130</a></span>
<span class="normal"><a href="#__codelineno-0-3131">3131</a></span>
<span class="normal"><a href="#__codelineno-0-3132">3132</a></span>
<span class="normal"><a href="#__codelineno-0-3133">3133</a></span>
<span class="normal"><a href="#__codelineno-0-3134">3134</a></span>
<span class="normal"><a href="#__codelineno-0-3135">3135</a></span>
<span class="normal"><a href="#__codelineno-0-3136">3136</a></span>
<span class="normal"><a href="#__codelineno-0-3137">3137</a></span>
<span class="normal"><a href="#__codelineno-0-3138">3138</a></span>
<span class="normal"><a href="#__codelineno-0-3139">3139</a></span>
<span class="normal"><a href="#__codelineno-0-3140">3140</a></span>
<span class="normal"><a href="#__codelineno-0-3141">3141</a></span>
<span class="normal"><a href="#__codelineno-0-3142">3142</a></span>
<span class="normal"><a href="#__codelineno-0-3143">3143</a></span>
<span class="normal"><a href="#__codelineno-0-3144">3144</a></span>
<span class="normal"><a href="#__codelineno-0-3145">3145</a></span>
<span class="normal"><a href="#__codelineno-0-3146">3146</a></span>
<span class="normal"><a href="#__codelineno-0-3147">3147</a></span>
<span class="normal"><a href="#__codelineno-0-3148">3148</a></span>
<span class="normal"><a href="#__codelineno-0-3149">3149</a></span>
<span class="normal"><a href="#__codelineno-0-3150">3150</a></span>
<span class="normal"><a href="#__codelineno-0-3151">3151</a></span>
<span class="normal"><a href="#__codelineno-0-3152">3152</a></span>
<span class="normal"><a href="#__codelineno-0-3153">3153</a></span>
<span class="normal"><a href="#__codelineno-0-3154">3154</a></span>
<span class="normal"><a href="#__codelineno-0-3155">3155</a></span>
<span class="normal"><a href="#__codelineno-0-3156">3156</a></span>
<span class="normal"><a href="#__codelineno-0-3157">3157</a></span>
<span class="normal"><a href="#__codelineno-0-3158">3158</a></span>
<span class="normal"><a href="#__codelineno-0-3159">3159</a></span>
<span class="normal"><a href="#__codelineno-0-3160">3160</a></span>
<span class="normal"><a href="#__codelineno-0-3161">3161</a></span>
<span class="normal"><a href="#__codelineno-0-3162">3162</a></span>
<span class="normal"><a href="#__codelineno-0-3163">3163</a></span>
<span class="normal"><a href="#__codelineno-0-3164">3164</a></span>
<span class="normal"><a href="#__codelineno-0-3165">3165</a></span>
<span class="normal"><a href="#__codelineno-0-3166">3166</a></span>
<span class="normal"><a href="#__codelineno-0-3167">3167</a></span>
<span class="normal"><a href="#__codelineno-0-3168">3168</a></span>
<span class="normal"><a href="#__codelineno-0-3169">3169</a></span>
<span class="normal"><a href="#__codelineno-0-3170">3170</a></span>
<span class="normal"><a href="#__codelineno-0-3171">3171</a></span>
<span class="normal"><a href="#__codelineno-0-3172">3172</a></span>
<span class="normal"><a href="#__codelineno-0-3173">3173</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3130"><a id="__codelineno-0-3130" name="__codelineno-0-3130"></a><span class="k">def</span><span class="w"> </span><span class="nf">assign_teams_app_to_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3131"><a id="__codelineno-0-3131" name="__codelineno-0-3131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign (add) a MS Teams app to a M365 team.</span>
</span><span id="__span-0-3132"><a id="__codelineno-0-3132" name="__codelineno-0-3132"></a>
</span><span id="__span-0-3133"><a id="__codelineno-0-3133" name="__codelineno-0-3133"></a><span class="sd">    Afterwards the app can be added as a Tab in a M365 Teams Channel).</span>
</span><span id="__span-0-3134"><a id="__codelineno-0-3134" name="__codelineno-0-3134"></a>
</span><span id="__span-0-3135"><a id="__codelineno-0-3135" name="__codelineno-0-3135"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3136"><a id="__codelineno-0-3136" name="__codelineno-0-3136"></a><span class="sd">        team_id (str):</span>
</span><span id="__span-0-3137"><a id="__codelineno-0-3137" name="__codelineno-0-3137"></a><span class="sd">            The ID of the Microsoft 365 Team.</span>
</span><span id="__span-0-3138"><a id="__codelineno-0-3138" name="__codelineno-0-3138"></a><span class="sd">        app_id (str):</span>
</span><span id="__span-0-3139"><a id="__codelineno-0-3139" name="__codelineno-0-3139"></a><span class="sd">            The ID of the M365 Team App.</span>
</span><span id="__span-0-3140"><a id="__codelineno-0-3140" name="__codelineno-0-3140"></a>
</span><span id="__span-0-3141"><a id="__codelineno-0-3141" name="__codelineno-0-3141"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3142"><a id="__codelineno-0-3142" name="__codelineno-0-3142"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-3143"><a id="__codelineno-0-3143" name="__codelineno-0-3143"></a><span class="sd">            API response or None if the Graph API call fails.</span>
</span><span id="__span-0-3144"><a id="__codelineno-0-3144" name="__codelineno-0-3144"></a>
</span><span id="__span-0-3145"><a id="__codelineno-0-3145" name="__codelineno-0-3145"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3146"><a id="__codelineno-0-3146" name="__codelineno-0-3146"></a>
</span><span id="__span-0-3147"><a id="__codelineno-0-3147" name="__codelineno-0-3147"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span> <span class="o">+</span> <span class="s2">&quot;/installedApps&quot;</span>
</span><span id="__span-0-3148"><a id="__codelineno-0-3148" name="__codelineno-0-3148"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3149"><a id="__codelineno-0-3149" name="__codelineno-0-3149"></a>
</span><span id="__span-0-3150"><a id="__codelineno-0-3150" name="__codelineno-0-3150"></a>    <span class="n">post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3151"><a id="__codelineno-0-3151" name="__codelineno-0-3151"></a>        <span class="s2">&quot;teamsApp@odata.bind&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3152"><a id="__codelineno-0-3152" name="__codelineno-0-3152"></a>    <span class="p">}</span>
</span><span id="__span-0-3153"><a id="__codelineno-0-3153" name="__codelineno-0-3153"></a>
</span><span id="__span-0-3154"><a id="__codelineno-0-3154" name="__codelineno-0-3154"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3155"><a id="__codelineno-0-3155" name="__codelineno-0-3155"></a>        <span class="s2">&quot;Assign M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) to M365 Team -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3156"><a id="__codelineno-0-3156" name="__codelineno-0-3156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppName&quot;</span><span class="p">],</span>
</span><span id="__span-0-3157"><a id="__codelineno-0-3157" name="__codelineno-0-3157"></a>        <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3158"><a id="__codelineno-0-3158" name="__codelineno-0-3158"></a>        <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3159"><a id="__codelineno-0-3159" name="__codelineno-0-3159"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3160"><a id="__codelineno-0-3160" name="__codelineno-0-3160"></a>    <span class="p">)</span>
</span><span id="__span-0-3161"><a id="__codelineno-0-3161" name="__codelineno-0-3161"></a>
</span><span id="__span-0-3162"><a id="__codelineno-0-3162" name="__codelineno-0-3162"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3163"><a id="__codelineno-0-3163" name="__codelineno-0-3163"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3164"><a id="__codelineno-0-3164" name="__codelineno-0-3164"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3165"><a id="__codelineno-0-3165" name="__codelineno-0-3165"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3166"><a id="__codelineno-0-3166" name="__codelineno-0-3166"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">post_body</span><span class="p">,</span>
</span><span id="__span-0-3167"><a id="__codelineno-0-3167" name="__codelineno-0-3167"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3168"><a id="__codelineno-0-3168" name="__codelineno-0-3168"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) to M365 Team -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3169"><a id="__codelineno-0-3169" name="__codelineno-0-3169"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppName&quot;</span><span class="p">],</span>
</span><span id="__span-0-3170"><a id="__codelineno-0-3170" name="__codelineno-0-3170"></a>            <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-3171"><a id="__codelineno-0-3171" name="__codelineno-0-3171"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3172"><a id="__codelineno-0-3172" name="__codelineno-0-3172"></a>        <span class="p">),</span>
</span><span id="__span-0-3173"><a id="__codelineno-0-3173" name="__codelineno-0-3173"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.assign_teams_app_to_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_teams_app_to_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">app_internal_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assign (add) a M365 Teams app to a M365 user.</p>
<p>See: https://learn.microsoft.com/en-us/graph/api/userteamwork-post-installedapps?view=graph-rest-1.0&amp;tabs=http</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact name of the app. Not needed if app_internal_id is provided.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_internal_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The internal ID of the app. If not provided it will be derived from app_name.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be displayed if the user is not found.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
The response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2906">2906</a></span>
<span class="normal"><a href="#__codelineno-0-2907">2907</a></span>
<span class="normal"><a href="#__codelineno-0-2908">2908</a></span>
<span class="normal"><a href="#__codelineno-0-2909">2909</a></span>
<span class="normal"><a href="#__codelineno-0-2910">2910</a></span>
<span class="normal"><a href="#__codelineno-0-2911">2911</a></span>
<span class="normal"><a href="#__codelineno-0-2912">2912</a></span>
<span class="normal"><a href="#__codelineno-0-2913">2913</a></span>
<span class="normal"><a href="#__codelineno-0-2914">2914</a></span>
<span class="normal"><a href="#__codelineno-0-2915">2915</a></span>
<span class="normal"><a href="#__codelineno-0-2916">2916</a></span>
<span class="normal"><a href="#__codelineno-0-2917">2917</a></span>
<span class="normal"><a href="#__codelineno-0-2918">2918</a></span>
<span class="normal"><a href="#__codelineno-0-2919">2919</a></span>
<span class="normal"><a href="#__codelineno-0-2920">2920</a></span>
<span class="normal"><a href="#__codelineno-0-2921">2921</a></span>
<span class="normal"><a href="#__codelineno-0-2922">2922</a></span>
<span class="normal"><a href="#__codelineno-0-2923">2923</a></span>
<span class="normal"><a href="#__codelineno-0-2924">2924</a></span>
<span class="normal"><a href="#__codelineno-0-2925">2925</a></span>
<span class="normal"><a href="#__codelineno-0-2926">2926</a></span>
<span class="normal"><a href="#__codelineno-0-2927">2927</a></span>
<span class="normal"><a href="#__codelineno-0-2928">2928</a></span>
<span class="normal"><a href="#__codelineno-0-2929">2929</a></span>
<span class="normal"><a href="#__codelineno-0-2930">2930</a></span>
<span class="normal"><a href="#__codelineno-0-2931">2931</a></span>
<span class="normal"><a href="#__codelineno-0-2932">2932</a></span>
<span class="normal"><a href="#__codelineno-0-2933">2933</a></span>
<span class="normal"><a href="#__codelineno-0-2934">2934</a></span>
<span class="normal"><a href="#__codelineno-0-2935">2935</a></span>
<span class="normal"><a href="#__codelineno-0-2936">2936</a></span>
<span class="normal"><a href="#__codelineno-0-2937">2937</a></span>
<span class="normal"><a href="#__codelineno-0-2938">2938</a></span>
<span class="normal"><a href="#__codelineno-0-2939">2939</a></span>
<span class="normal"><a href="#__codelineno-0-2940">2940</a></span>
<span class="normal"><a href="#__codelineno-0-2941">2941</a></span>
<span class="normal"><a href="#__codelineno-0-2942">2942</a></span>
<span class="normal"><a href="#__codelineno-0-2943">2943</a></span>
<span class="normal"><a href="#__codelineno-0-2944">2944</a></span>
<span class="normal"><a href="#__codelineno-0-2945">2945</a></span>
<span class="normal"><a href="#__codelineno-0-2946">2946</a></span>
<span class="normal"><a href="#__codelineno-0-2947">2947</a></span>
<span class="normal"><a href="#__codelineno-0-2948">2948</a></span>
<span class="normal"><a href="#__codelineno-0-2949">2949</a></span>
<span class="normal"><a href="#__codelineno-0-2950">2950</a></span>
<span class="normal"><a href="#__codelineno-0-2951">2951</a></span>
<span class="normal"><a href="#__codelineno-0-2952">2952</a></span>
<span class="normal"><a href="#__codelineno-0-2953">2953</a></span>
<span class="normal"><a href="#__codelineno-0-2954">2954</a></span>
<span class="normal"><a href="#__codelineno-0-2955">2955</a></span>
<span class="normal"><a href="#__codelineno-0-2956">2956</a></span>
<span class="normal"><a href="#__codelineno-0-2957">2957</a></span>
<span class="normal"><a href="#__codelineno-0-2958">2958</a></span>
<span class="normal"><a href="#__codelineno-0-2959">2959</a></span>
<span class="normal"><a href="#__codelineno-0-2960">2960</a></span>
<span class="normal"><a href="#__codelineno-0-2961">2961</a></span>
<span class="normal"><a href="#__codelineno-0-2962">2962</a></span>
<span class="normal"><a href="#__codelineno-0-2963">2963</a></span>
<span class="normal"><a href="#__codelineno-0-2964">2964</a></span>
<span class="normal"><a href="#__codelineno-0-2965">2965</a></span>
<span class="normal"><a href="#__codelineno-0-2966">2966</a></span>
<span class="normal"><a href="#__codelineno-0-2967">2967</a></span>
<span class="normal"><a href="#__codelineno-0-2968">2968</a></span>
<span class="normal"><a href="#__codelineno-0-2969">2969</a></span>
<span class="normal"><a href="#__codelineno-0-2970">2970</a></span>
<span class="normal"><a href="#__codelineno-0-2971">2971</a></span>
<span class="normal"><a href="#__codelineno-0-2972">2972</a></span>
<span class="normal"><a href="#__codelineno-0-2973">2973</a></span>
<span class="normal"><a href="#__codelineno-0-2974">2974</a></span>
<span class="normal"><a href="#__codelineno-0-2975">2975</a></span>
<span class="normal"><a href="#__codelineno-0-2976">2976</a></span>
<span class="normal"><a href="#__codelineno-0-2977">2977</a></span>
<span class="normal"><a href="#__codelineno-0-2978">2978</a></span>
<span class="normal"><a href="#__codelineno-0-2979">2979</a></span>
<span class="normal"><a href="#__codelineno-0-2980">2980</a></span>
<span class="normal"><a href="#__codelineno-0-2981">2981</a></span>
<span class="normal"><a href="#__codelineno-0-2982">2982</a></span>
<span class="normal"><a href="#__codelineno-0-2983">2983</a></span>
<span class="normal"><a href="#__codelineno-0-2984">2984</a></span>
<span class="normal"><a href="#__codelineno-0-2985">2985</a></span>
<span class="normal"><a href="#__codelineno-0-2986">2986</a></span>
<span class="normal"><a href="#__codelineno-0-2987">2987</a></span>
<span class="normal"><a href="#__codelineno-0-2988">2988</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2906"><a id="__codelineno-0-2906" name="__codelineno-0-2906"></a><span class="k">def</span><span class="w"> </span><span class="nf">assign_teams_app_to_user</span><span class="p">(</span>
</span><span id="__span-0-2907"><a id="__codelineno-0-2907" name="__codelineno-0-2907"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2908"><a id="__codelineno-0-2908" name="__codelineno-0-2908"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2909"><a id="__codelineno-0-2909" name="__codelineno-0-2909"></a>    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2910"><a id="__codelineno-0-2910" name="__codelineno-0-2910"></a>    <span class="n">app_internal_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2911"><a id="__codelineno-0-2911" name="__codelineno-0-2911"></a>    <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2912"><a id="__codelineno-0-2912" name="__codelineno-0-2912"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2913"><a id="__codelineno-0-2913" name="__codelineno-0-2913"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign (add) a M365 Teams app to a M365 user.</span>
</span><span id="__span-0-2914"><a id="__codelineno-0-2914" name="__codelineno-0-2914"></a>
</span><span id="__span-0-2915"><a id="__codelineno-0-2915" name="__codelineno-0-2915"></a><span class="sd">    See: https://learn.microsoft.com/en-us/graph/api/userteamwork-post-installedapps?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-2916"><a id="__codelineno-0-2916" name="__codelineno-0-2916"></a>
</span><span id="__span-0-2917"><a id="__codelineno-0-2917" name="__codelineno-0-2917"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2918"><a id="__codelineno-0-2918" name="__codelineno-0-2918"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-2919"><a id="__codelineno-0-2919" name="__codelineno-0-2919"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-2920"><a id="__codelineno-0-2920" name="__codelineno-0-2920"></a><span class="sd">        app_name (str, optional):</span>
</span><span id="__span-0-2921"><a id="__codelineno-0-2921" name="__codelineno-0-2921"></a><span class="sd">            The exact name of the app. Not needed if app_internal_id is provided.</span>
</span><span id="__span-0-2922"><a id="__codelineno-0-2922" name="__codelineno-0-2922"></a><span class="sd">        app_internal_id (str, optional):</span>
</span><span id="__span-0-2923"><a id="__codelineno-0-2923" name="__codelineno-0-2923"></a><span class="sd">            The internal ID of the app. If not provided it will be derived from app_name.</span>
</span><span id="__span-0-2924"><a id="__codelineno-0-2924" name="__codelineno-0-2924"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-2925"><a id="__codelineno-0-2925" name="__codelineno-0-2925"></a><span class="sd">            Whether or not an error should be displayed if the user is not found.</span>
</span><span id="__span-0-2926"><a id="__codelineno-0-2926" name="__codelineno-0-2926"></a>
</span><span id="__span-0-2927"><a id="__codelineno-0-2927" name="__codelineno-0-2927"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2928"><a id="__codelineno-0-2928" name="__codelineno-0-2928"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2929"><a id="__codelineno-0-2929" name="__codelineno-0-2929"></a><span class="sd">            The response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2930"><a id="__codelineno-0-2930" name="__codelineno-0-2930"></a>
</span><span id="__span-0-2931"><a id="__codelineno-0-2931" name="__codelineno-0-2931"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2932"><a id="__codelineno-0-2932" name="__codelineno-0-2932"></a>
</span><span id="__span-0-2933"><a id="__codelineno-0-2933" name="__codelineno-0-2933"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_internal_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">app_name</span><span class="p">:</span>
</span><span id="__span-0-2934"><a id="__codelineno-0-2934" name="__codelineno-0-2934"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2935"><a id="__codelineno-0-2935" name="__codelineno-0-2935"></a>            <span class="s2">&quot;Either the internal App ID or the App name need to be provided!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2936"><a id="__codelineno-0-2936" name="__codelineno-0-2936"></a>        <span class="p">)</span>
</span><span id="__span-0-2937"><a id="__codelineno-0-2937" name="__codelineno-0-2937"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2938"><a id="__codelineno-0-2938" name="__codelineno-0-2938"></a>
</span><span id="__span-0-2939"><a id="__codelineno-0-2939" name="__codelineno-0-2939"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_internal_id</span><span class="p">:</span>
</span><span id="__span-0-2940"><a id="__codelineno-0-2940" name="__codelineno-0-2940"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps</span><span class="p">(</span>
</span><span id="__span-0-2941"><a id="__codelineno-0-2941" name="__codelineno-0-2941"></a>            <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_name</span><span class="p">),</span>
</span><span id="__span-0-2942"><a id="__codelineno-0-2942" name="__codelineno-0-2942"></a>        <span class="p">)</span>
</span><span id="__span-0-2943"><a id="__codelineno-0-2943" name="__codelineno-0-2943"></a>        <span class="n">app_internal_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span>
</span><span id="__span-0-2944"><a id="__codelineno-0-2944" name="__codelineno-0-2944"></a>            <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
</span><span id="__span-0-2945"><a id="__codelineno-0-2945" name="__codelineno-0-2945"></a>            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span>
</span><span id="__span-0-2946"><a id="__codelineno-0-2946" name="__codelineno-0-2946"></a>            <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-2947"><a id="__codelineno-0-2947" name="__codelineno-0-2947"></a>        <span class="p">)</span>
</span><span id="__span-0-2948"><a id="__codelineno-0-2948" name="__codelineno-0-2948"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_internal_id</span><span class="p">:</span>
</span><span id="__span-0-2949"><a id="__codelineno-0-2949" name="__codelineno-0-2949"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2950"><a id="__codelineno-0-2950" name="__codelineno-0-2950"></a>                <span class="s2">&quot;M365 Teams App -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found! Cannot assign App to user -&gt; </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2951"><a id="__codelineno-0-2951" name="__codelineno-0-2951"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2952"><a id="__codelineno-0-2952" name="__codelineno-0-2952"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2953"><a id="__codelineno-0-2953" name="__codelineno-0-2953"></a>            <span class="p">)</span>
</span><span id="__span-0-2954"><a id="__codelineno-0-2954" name="__codelineno-0-2954"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2955"><a id="__codelineno-0-2955" name="__codelineno-0-2955"></a>
</span><span id="__span-0-2956"><a id="__codelineno-0-2956" name="__codelineno-0-2956"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps&quot;</span>
</span><span id="__span-0-2957"><a id="__codelineno-0-2957" name="__codelineno-0-2957"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2958"><a id="__codelineno-0-2958" name="__codelineno-0-2958"></a>
</span><span id="__span-0-2959"><a id="__codelineno-0-2959" name="__codelineno-0-2959"></a>    <span class="n">post_body</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2960"><a id="__codelineno-0-2960" name="__codelineno-0-2960"></a>        <span class="s2">&quot;teamsApp@odata.bind&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2961"><a id="__codelineno-0-2961" name="__codelineno-0-2961"></a>    <span class="p">}</span>
</span><span id="__span-0-2962"><a id="__codelineno-0-2962" name="__codelineno-0-2962"></a>
</span><span id="__span-0-2963"><a id="__codelineno-0-2963" name="__codelineno-0-2963"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2964"><a id="__codelineno-0-2964" name="__codelineno-0-2964"></a>        <span class="s2">&quot;Assign M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) to M365 user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2965"><a id="__codelineno-0-2965" name="__codelineno-0-2965"></a>        <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2966"><a id="__codelineno-0-2966" name="__codelineno-0-2966"></a>        <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2967"><a id="__codelineno-0-2967" name="__codelineno-0-2967"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2968"><a id="__codelineno-0-2968" name="__codelineno-0-2968"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2969"><a id="__codelineno-0-2969" name="__codelineno-0-2969"></a>    <span class="p">)</span>
</span><span id="__span-0-2970"><a id="__codelineno-0-2970" name="__codelineno-0-2970"></a>
</span><span id="__span-0-2971"><a id="__codelineno-0-2971" name="__codelineno-0-2971"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2972"><a id="__codelineno-0-2972" name="__codelineno-0-2972"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2973"><a id="__codelineno-0-2973" name="__codelineno-0-2973"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-2974"><a id="__codelineno-0-2974" name="__codelineno-0-2974"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2975"><a id="__codelineno-0-2975" name="__codelineno-0-2975"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">post_body</span><span class="p">,</span>
</span><span id="__span-0-2976"><a id="__codelineno-0-2976" name="__codelineno-0-2976"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2977"><a id="__codelineno-0-2977" name="__codelineno-0-2977"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) to M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2978"><a id="__codelineno-0-2978" name="__codelineno-0-2978"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2979"><a id="__codelineno-0-2979" name="__codelineno-0-2979"></a>            <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2980"><a id="__codelineno-0-2980" name="__codelineno-0-2980"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2981"><a id="__codelineno-0-2981" name="__codelineno-0-2981"></a>        <span class="p">),</span>
</span><span id="__span-0-2982"><a id="__codelineno-0-2982" name="__codelineno-0-2982"></a>        <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;Failed to assign M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) to M365 user -&gt; </span><span class="si">{}</span><span class="s2"> (could be the app is assigned organization-wide)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2983"><a id="__codelineno-0-2983" name="__codelineno-0-2983"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-2984"><a id="__codelineno-0-2984" name="__codelineno-0-2984"></a>            <span class="n">app_internal_id</span><span class="p">,</span>
</span><span id="__span-0-2985"><a id="__codelineno-0-2985" name="__codelineno-0-2985"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2986"><a id="__codelineno-0-2986" name="__codelineno-0-2986"></a>        <span class="p">),</span>
</span><span id="__span-0-2987"><a id="__codelineno-0-2987" name="__codelineno-0-2987"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-2988"><a id="__codelineno-0-2988" name="__codelineno-0-2988"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.authenticate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">authenticate</span><span class="p">(</span><span class="n">revalidate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Authenticate at M365 Graph API with client ID and client secret.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>revalidate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determins if a re-athentication is enforced.
(e.g. if session has timed out with 401 error)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
The access token. Also stores access token in self._access_token.
None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">revalidate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Authenticate at M365 Graph API with client ID and client secret.</span>
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690"></a>
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">    Args:</span>
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">        revalidate (bool, optional):</span>
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">            Determins if a re-athentication is enforced.</span>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">            (e.g. if session has timed out with 401 error)</span>
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695"></a>
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">            The access token. Also stores access token in self._access_token.</span>
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">            None in case of an error.</span>
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="c1"># Already authenticated and session still valid?</span>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">revalidate</span><span class="p">:</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="s2">&quot;Session still valid - return existing access token -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span><span class="p">),</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="p">)</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="n">request_login_headers</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Requesting M365 Access Token from -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">request_url</span><span class="p">)</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>    <span class="n">authenticate_post_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">()</span>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="n">authenticate_response</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="n">authenticate_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="n">data</span><span class="o">=</span><span class="n">authenticate_post_body</span><span class="p">,</span>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="p">)</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="s2">&quot;Unable to connect to -&gt; </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">],</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="p">)</span>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="k">if</span> <span class="n">authenticate_response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="n">authenticate_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">authenticate_response</span><span class="p">)</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">authenticate_dict</span><span class="p">:</span>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">access_token</span> <span class="o">=</span> <span class="n">authenticate_dict</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Access Token -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">access_token</span><span class="p">)</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="s2">&quot;Failed to request an M365 Access Token; error -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="n">authenticate_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a>        <span class="p">)</span>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a>    <span class="c1"># Store authentication access_token:</span>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span> <span class="o">=</span> <span class="n">access_token</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.authenticate_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">authenticate_user</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Authenticate at M365 Graph API with username and password.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>username</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name (email) of the M365 user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The password of the M365 user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scope</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scope of the delegated permission. E.g. "Files.ReadWrite".
Multiple delegated permissions should be separated by spaces.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
The access token for the user. Also stores access token in self._access_token.
None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="k">def</span><span class="w"> </span><span class="nf">authenticate_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Authenticate at M365 Graph API with username and password.</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">    Args:</span>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">        username (str):</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">            The name (email) of the M365 user.</span>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">        password (str):</span>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">            The password of the M365 user.</span>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">        scope (str):</span>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">            The scope of the delegated permission. E.g. &quot;Files.ReadWrite&quot;.</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">            Multiple delegated permissions should be separated by spaces.</span>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            The access token for the user. Also stores access token in self._access_token.</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">            None in case of an error.</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="n">request_login_headers</span>
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775"></a>
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="p">:</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Missing user name - cannot authenticate at M365!&quot;</span><span class="p">)</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a>            <span class="s2">&quot;Missing password for user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; - cannot authenticate at M365!&quot;</span><span class="p">,</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a>            <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="p">)</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="s2">&quot;Requesting M365 Access Token for user -&gt; </span><span class="si">%s</span><span class="s2"> from -&gt; </span><span class="si">%s%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="s2">&quot; with scope -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span> <span class="k">if</span> <span class="n">scope</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="p">)</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a>    <span class="n">authenticate_post_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials_user</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">)</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="n">authenticate_response</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="n">authenticate_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a>            <span class="n">data</span><span class="o">=</span><span class="n">authenticate_post_body</span><span class="p">,</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="p">)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a>            <span class="s2">&quot;Unable to connect to -&gt; </span><span class="si">%s</span><span class="s2"> with username -&gt; </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;authenticationUrl&quot;</span><span class="p">],</span>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a>            <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="p">)</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="k">if</span> <span class="n">authenticate_response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="n">authenticate_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">authenticate_response</span><span class="p">)</span>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">authenticate_dict</span><span class="p">:</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a>        <span class="n">access_token</span> <span class="o">=</span> <span class="n">authenticate_dict</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;User Access Token -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">access_token</span><span class="p">)</span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="s2">&quot;Failed to request an M365 Access Token for user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; error -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a>            <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a>            <span class="n">authenticate_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="p">)</span>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="c1"># Store authentication access_token:</span>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span> <span class="o">=</span> <span class="n">access_token</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the configuration dictionary.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the configuration dictionary.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        dict: Configuration dictionary</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.credentials" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">credentials</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the login credentials.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with (admin) login credentials for M365.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="k">def</span><span class="w"> </span><span class="nf">credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the login credentials.</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        dict:</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            A dictionary with (admin) login credentials for M365.</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;tokenData&quot;</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.credentials_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">credentials_user</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;Files.ReadWrite&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get user credentials.</p>
<p>In some cases MS Graph APIs cannot be called via
application permissions (client_id, client_secret)
but requires a token of a user authenticated
with username + password. This is e.g. the case
to upload a MS teams app to the catalog.</p>
<p>See https://learn.microsoft.com/en-us/graph/api/teamsapp-publish</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>username</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 username.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The password of the M365 user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scope</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scope of the delegated permission.
It is important to provide a scope for the intended operation
like "Files.ReadWrite".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Files.ReadWrite&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with the (user) credentials for M365.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="k">def</span><span class="w"> </span><span class="nf">credentials_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Files.ReadWrite&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get user credentials.</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    In some cases MS Graph APIs cannot be called via</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    application permissions (client_id, client_secret)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    but requires a token of a user authenticated</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    with username + password. This is e.g. the case</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    to upload a MS teams app to the catalog.</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    See https://learn.microsoft.com/en-us/graph/api/teamsapp-publish</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Args:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        username (str):</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            The M365 username.</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        password (str):</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            The password of the M365 user.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        scope (str):</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            The scope of the delegated permission.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            It is important to provide a scope for the intended operation</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            like &quot;Files.ReadWrite&quot;.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        dict:</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            A dictionary with the (user) credentials for M365.</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="c1"># Use OAuth2 / ROPC (Resource Owner Password Credentials):</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;clientId&quot;</span><span class="p">],</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;clientSecret&quot;</span><span class="p">],</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="n">scope</span><span class="p">,</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="p">}</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">return</span> <span class="n">credentials</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.delete_all_teams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_all_teams</span><span class="p">(</span><span class="n">exception_list</span><span class="p">,</span> <span class="n">pattern_list</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete all teams (groups) based on patterns and exceptions.</p>
<p>Only delete MS Teams that are NOT on the exception list AND
that are matching at least one of the patterns in the provided pattern list.</p>
<p>This method is used for general cleanup of teams. Be aware that deleted teams
are still listed under https://admin.microsoft.com/#/deletedgroups and it
may take some days until M365 finally deletes them.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exception_list</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of group names that should not be deleted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pattern_list</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of patterns for group names to be deleted
(regular expression).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if teams have been deleted, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2285"><a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_all_teams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pattern_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2286"><a id="__codelineno-0-2286" name="__codelineno-0-2286"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all teams (groups) based on patterns and exceptions.</span>
</span><span id="__span-0-2287"><a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>
</span><span id="__span-0-2288"><a id="__codelineno-0-2288" name="__codelineno-0-2288"></a><span class="sd">    Only delete MS Teams that are NOT on the exception list AND</span>
</span><span id="__span-0-2289"><a id="__codelineno-0-2289" name="__codelineno-0-2289"></a><span class="sd">    that are matching at least one of the patterns in the provided pattern list.</span>
</span><span id="__span-0-2290"><a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>
</span><span id="__span-0-2291"><a id="__codelineno-0-2291" name="__codelineno-0-2291"></a><span class="sd">    This method is used for general cleanup of teams. Be aware that deleted teams</span>
</span><span id="__span-0-2292"><a id="__codelineno-0-2292" name="__codelineno-0-2292"></a><span class="sd">    are still listed under https://admin.microsoft.com/#/deletedgroups and it</span>
</span><span id="__span-0-2293"><a id="__codelineno-0-2293" name="__codelineno-0-2293"></a><span class="sd">    may take some days until M365 finally deletes them.</span>
</span><span id="__span-0-2294"><a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>
</span><span id="__span-0-2295"><a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2296"><a id="__codelineno-0-2296" name="__codelineno-0-2296"></a><span class="sd">        exception_list (list):</span>
</span><span id="__span-0-2297"><a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><span class="sd">            A list of group names that should not be deleted.</span>
</span><span id="__span-0-2298"><a id="__codelineno-0-2298" name="__codelineno-0-2298"></a><span class="sd">        pattern_list (list):</span>
</span><span id="__span-0-2299"><a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="sd">            A list of patterns for group names to be deleted</span>
</span><span id="__span-0-2300"><a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><span class="sd">            (regular expression).</span>
</span><span id="__span-0-2301"><a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>
</span><span id="__span-0-2302"><a id="__codelineno-0-2302" name="__codelineno-0-2302"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2303"><a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="sd">        bool:</span>
</span><span id="__span-0-2304"><a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="sd">            True if teams have been deleted, False otherwise.</span>
</span><span id="__span-0-2305"><a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
</span><span id="__span-0-2306"><a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2307"><a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>
</span><span id="__span-0-2308"><a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2309"><a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>        <span class="s2">&quot;Delete existing M365 groups/teams matching delete pattern and not on exception list...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2310"><a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>    <span class="p">)</span>
</span><span id="__span-0-2311"><a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>
</span><span id="__span-0-2312"><a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>    <span class="c1"># Get list of all existing M365 groups/teams:</span>
</span><span id="__span-0-2313"><a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>    <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_groups_iterator</span><span class="p">()</span>
</span><span id="__span-0-2314"><a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>
</span><span id="__span-0-2315"><a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>    <span class="c1"># Process all groups and check if they should be deleted:</span>
</span><span id="__span-0-2316"><a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="__span-0-2317"><a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-2318"><a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_name</span><span class="p">:</span>
</span><span id="__span-0-2319"><a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>            <span class="k">continue</span>
</span><span id="__span-0-2320"><a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>        <span class="c1"># Check if group is in exception list:</span>
</span><span id="__span-0-2321"><a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">in</span> <span class="n">exception_list</span><span class="p">:</span>
</span><span id="__span-0-2322"><a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2323"><a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>                <span class="s2">&quot;M365 Group name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; is on the exception list. Skipping...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2324"><a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2325"><a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>            <span class="p">)</span>
</span><span id="__span-0-2326"><a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>            <span class="k">continue</span>
</span><span id="__span-0-2327"><a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>        <span class="c1"># Check that at least one pattern is found that matches the group:</span>
</span><span id="__span-0-2328"><a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">pattern_list</span><span class="p">:</span>
</span><span id="__span-0-2329"><a id="__codelineno-0-2329" name="__codelineno-0-2329"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2330"><a id="__codelineno-0-2330" name="__codelineno-0-2330"></a>            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-2331"><a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2332"><a id="__codelineno-0-2332" name="__codelineno-0-2332"></a>                    <span class="s2">&quot;M365 Group name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; is matching pattern -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;. Deleting...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2333"><a id="__codelineno-0-2333" name="__codelineno-0-2333"></a>                    <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2334"><a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>                    <span class="n">pattern</span><span class="p">,</span>
</span><span id="__span-0-2335"><a id="__codelineno-0-2335" name="__codelineno-0-2335"></a>                <span class="p">)</span>
</span><span id="__span-0-2336"><a id="__codelineno-0-2336" name="__codelineno-0-2336"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">delete_teams</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2337"><a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>                <span class="k">break</span>
</span><span id="__span-0-2338"><a id="__codelineno-0-2338" name="__codelineno-0-2338"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2339"><a id="__codelineno-0-2339" name="__codelineno-0-2339"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2340"><a id="__codelineno-0-2340" name="__codelineno-0-2340"></a>                <span class="s2">&quot;M365 Group name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; is not matching any delete pattern. Skipping...&quot;</span><span class="p">,</span>
</span><span id="__span-0-2341"><a id="__codelineno-0-2341" name="__codelineno-0-2341"></a>                <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2342"><a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>            <span class="p">)</span>
</span><span id="__span-0-2343"><a id="__codelineno-0-2343" name="__codelineno-0-2343"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.delete_mail" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_mail</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">email_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete email from inbox of a given user and a given email ID.</p>
<p>This requires Mail.ReadWrite Application permissions for the Azure App being used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 ID of the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>email_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 ID of the email.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Email or None of the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4105">4105</a></span>
<span class="normal"><a href="#__codelineno-0-4106">4106</a></span>
<span class="normal"><a href="#__codelineno-0-4107">4107</a></span>
<span class="normal"><a href="#__codelineno-0-4108">4108</a></span>
<span class="normal"><a href="#__codelineno-0-4109">4109</a></span>
<span class="normal"><a href="#__codelineno-0-4110">4110</a></span>
<span class="normal"><a href="#__codelineno-0-4111">4111</a></span>
<span class="normal"><a href="#__codelineno-0-4112">4112</a></span>
<span class="normal"><a href="#__codelineno-0-4113">4113</a></span>
<span class="normal"><a href="#__codelineno-0-4114">4114</a></span>
<span class="normal"><a href="#__codelineno-0-4115">4115</a></span>
<span class="normal"><a href="#__codelineno-0-4116">4116</a></span>
<span class="normal"><a href="#__codelineno-0-4117">4117</a></span>
<span class="normal"><a href="#__codelineno-0-4118">4118</a></span>
<span class="normal"><a href="#__codelineno-0-4119">4119</a></span>
<span class="normal"><a href="#__codelineno-0-4120">4120</a></span>
<span class="normal"><a href="#__codelineno-0-4121">4121</a></span>
<span class="normal"><a href="#__codelineno-0-4122">4122</a></span>
<span class="normal"><a href="#__codelineno-0-4123">4123</a></span>
<span class="normal"><a href="#__codelineno-0-4124">4124</a></span>
<span class="normal"><a href="#__codelineno-0-4125">4125</a></span>
<span class="normal"><a href="#__codelineno-0-4126">4126</a></span>
<span class="normal"><a href="#__codelineno-0-4127">4127</a></span>
<span class="normal"><a href="#__codelineno-0-4128">4128</a></span>
<span class="normal"><a href="#__codelineno-0-4129">4129</a></span>
<span class="normal"><a href="#__codelineno-0-4130">4130</a></span>
<span class="normal"><a href="#__codelineno-0-4131">4131</a></span>
<span class="normal"><a href="#__codelineno-0-4132">4132</a></span>
<span class="normal"><a href="#__codelineno-0-4133">4133</a></span>
<span class="normal"><a href="#__codelineno-0-4134">4134</a></span>
<span class="normal"><a href="#__codelineno-0-4135">4135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4105"><a id="__codelineno-0-4105" name="__codelineno-0-4105"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_mail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4106"><a id="__codelineno-0-4106" name="__codelineno-0-4106"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete email from inbox of a given user and a given email ID.</span>
</span><span id="__span-0-4107"><a id="__codelineno-0-4107" name="__codelineno-0-4107"></a>
</span><span id="__span-0-4108"><a id="__codelineno-0-4108" name="__codelineno-0-4108"></a><span class="sd">    This requires Mail.ReadWrite Application permissions for the Azure App being used.</span>
</span><span id="__span-0-4109"><a id="__codelineno-0-4109" name="__codelineno-0-4109"></a>
</span><span id="__span-0-4110"><a id="__codelineno-0-4110" name="__codelineno-0-4110"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4111"><a id="__codelineno-0-4111" name="__codelineno-0-4111"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-4112"><a id="__codelineno-0-4112" name="__codelineno-0-4112"></a><span class="sd">            The M365 ID of the user.</span>
</span><span id="__span-0-4113"><a id="__codelineno-0-4113" name="__codelineno-0-4113"></a><span class="sd">        email_id (str):</span>
</span><span id="__span-0-4114"><a id="__codelineno-0-4114" name="__codelineno-0-4114"></a><span class="sd">            The M365 ID of the email.</span>
</span><span id="__span-0-4115"><a id="__codelineno-0-4115" name="__codelineno-0-4115"></a>
</span><span id="__span-0-4116"><a id="__codelineno-0-4116" name="__codelineno-0-4116"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4117"><a id="__codelineno-0-4117" name="__codelineno-0-4117"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-4118"><a id="__codelineno-0-4118" name="__codelineno-0-4118"></a><span class="sd">            Email or None of the request fails.</span>
</span><span id="__span-0-4119"><a id="__codelineno-0-4119" name="__codelineno-0-4119"></a>
</span><span id="__span-0-4120"><a id="__codelineno-0-4120" name="__codelineno-0-4120"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4121"><a id="__codelineno-0-4121" name="__codelineno-0-4121"></a>
</span><span id="__span-0-4122"><a id="__codelineno-0-4122" name="__codelineno-0-4122"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/messages/&quot;</span> <span class="o">+</span> <span class="n">email_id</span>
</span><span id="__span-0-4123"><a id="__codelineno-0-4123" name="__codelineno-0-4123"></a>
</span><span id="__span-0-4124"><a id="__codelineno-0-4124" name="__codelineno-0-4124"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4125"><a id="__codelineno-0-4125" name="__codelineno-0-4125"></a>
</span><span id="__span-0-4126"><a id="__codelineno-0-4126" name="__codelineno-0-4126"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4127"><a id="__codelineno-0-4127" name="__codelineno-0-4127"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4128"><a id="__codelineno-0-4128" name="__codelineno-0-4128"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-4129"><a id="__codelineno-0-4129" name="__codelineno-0-4129"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4130"><a id="__codelineno-0-4130" name="__codelineno-0-4130"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4131"><a id="__codelineno-0-4131" name="__codelineno-0-4131"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot delete email with ID -&gt; </span><span class="si">{}</span><span class="s2"> from inbox of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4132"><a id="__codelineno-0-4132" name="__codelineno-0-4132"></a>            <span class="n">email_id</span><span class="p">,</span>
</span><span id="__span-0-4133"><a id="__codelineno-0-4133" name="__codelineno-0-4133"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-4134"><a id="__codelineno-0-4134" name="__codelineno-0-4134"></a>        <span class="p">),</span>
</span><span id="__span-0-4135"><a id="__codelineno-0-4135" name="__codelineno-0-4135"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.delete_sharepoint_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_sharepoint_section</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">section_type</span><span class="o">=</span><span class="s1">&#39;horizontalSections&#39;</span><span class="p">,</span> <span class="n">section_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a specific section (horizontal or vertical) on a SharePoint page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the web part.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"horizontalSections" (note the plural!)
"verticalSection" (note the singular!)</p>
              </div>
            </td>
            <td>
                  <code>&#39;horizontalSections&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_id</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the section. Only relevant for horizontal sections.
Simple values like 1,2,3...</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Empty response.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '_content': b'',
    '_content_consumed': True,
    '_next': None,
    'status_code': 204,
    'headers': {
        'Cache-Control': 'no-store, no-cache',
        'Strict-Transport-Security': 'max-age=31536000',
        'request-id': 'bd21c7fa-751c-43ca-b290-12c30f50d7e1',
        'client-request-id': 'bd21c7fa-751c-43ca-b290-12c30f50d7e1',
        'x-ms-ags-diagnostic': '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"004","RoleInstance":"FR2PEPF00000393"}}', 'Date': 'Fri, 14 Feb 2025 20:40:06 GMT'},
        'raw': <urllib3.response.HTTPResponse object at 0x10f210d90>,
        'url': 'https://graph.microsoft.com/beta/sites/ideatedev.sharepoint.com,61c0f9cb-39d3-4c04-b60c-31576954a2ab,a678aeab-68ac-46a1-bd95-28020c12de26/pages/ac7675ee-8891-43b9-b1b2-2d2ced8eb17e/microsoft.graph.sitePage/canvasLayout/horizontalSections/1',
        'encoding': None,
        'history': [],
        'reason': 'No Content',
        'cookies': <RequestsCookieJar[]>,
        'elapsed': datetime.timedelta(microseconds=514597),
        'request': <PreparedRequest [DELETE]>,
        'connection': <requests.adapters.HTTPAdapter object at 0x11841d700>
    }</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5203">5203</a></span>
<span class="normal"><a href="#__codelineno-0-5204">5204</a></span>
<span class="normal"><a href="#__codelineno-0-5205">5205</a></span>
<span class="normal"><a href="#__codelineno-0-5206">5206</a></span>
<span class="normal"><a href="#__codelineno-0-5207">5207</a></span>
<span class="normal"><a href="#__codelineno-0-5208">5208</a></span>
<span class="normal"><a href="#__codelineno-0-5209">5209</a></span>
<span class="normal"><a href="#__codelineno-0-5210">5210</a></span>
<span class="normal"><a href="#__codelineno-0-5211">5211</a></span>
<span class="normal"><a href="#__codelineno-0-5212">5212</a></span>
<span class="normal"><a href="#__codelineno-0-5213">5213</a></span>
<span class="normal"><a href="#__codelineno-0-5214">5214</a></span>
<span class="normal"><a href="#__codelineno-0-5215">5215</a></span>
<span class="normal"><a href="#__codelineno-0-5216">5216</a></span>
<span class="normal"><a href="#__codelineno-0-5217">5217</a></span>
<span class="normal"><a href="#__codelineno-0-5218">5218</a></span>
<span class="normal"><a href="#__codelineno-0-5219">5219</a></span>
<span class="normal"><a href="#__codelineno-0-5220">5220</a></span>
<span class="normal"><a href="#__codelineno-0-5221">5221</a></span>
<span class="normal"><a href="#__codelineno-0-5222">5222</a></span>
<span class="normal"><a href="#__codelineno-0-5223">5223</a></span>
<span class="normal"><a href="#__codelineno-0-5224">5224</a></span>
<span class="normal"><a href="#__codelineno-0-5225">5225</a></span>
<span class="normal"><a href="#__codelineno-0-5226">5226</a></span>
<span class="normal"><a href="#__codelineno-0-5227">5227</a></span>
<span class="normal"><a href="#__codelineno-0-5228">5228</a></span>
<span class="normal"><a href="#__codelineno-0-5229">5229</a></span>
<span class="normal"><a href="#__codelineno-0-5230">5230</a></span>
<span class="normal"><a href="#__codelineno-0-5231">5231</a></span>
<span class="normal"><a href="#__codelineno-0-5232">5232</a></span>
<span class="normal"><a href="#__codelineno-0-5233">5233</a></span>
<span class="normal"><a href="#__codelineno-0-5234">5234</a></span>
<span class="normal"><a href="#__codelineno-0-5235">5235</a></span>
<span class="normal"><a href="#__codelineno-0-5236">5236</a></span>
<span class="normal"><a href="#__codelineno-0-5237">5237</a></span>
<span class="normal"><a href="#__codelineno-0-5238">5238</a></span>
<span class="normal"><a href="#__codelineno-0-5239">5239</a></span>
<span class="normal"><a href="#__codelineno-0-5240">5240</a></span>
<span class="normal"><a href="#__codelineno-0-5241">5241</a></span>
<span class="normal"><a href="#__codelineno-0-5242">5242</a></span>
<span class="normal"><a href="#__codelineno-0-5243">5243</a></span>
<span class="normal"><a href="#__codelineno-0-5244">5244</a></span>
<span class="normal"><a href="#__codelineno-0-5245">5245</a></span>
<span class="normal"><a href="#__codelineno-0-5246">5246</a></span>
<span class="normal"><a href="#__codelineno-0-5247">5247</a></span>
<span class="normal"><a href="#__codelineno-0-5248">5248</a></span>
<span class="normal"><a href="#__codelineno-0-5249">5249</a></span>
<span class="normal"><a href="#__codelineno-0-5250">5250</a></span>
<span class="normal"><a href="#__codelineno-0-5251">5251</a></span>
<span class="normal"><a href="#__codelineno-0-5252">5252</a></span>
<span class="normal"><a href="#__codelineno-0-5253">5253</a></span>
<span class="normal"><a href="#__codelineno-0-5254">5254</a></span>
<span class="normal"><a href="#__codelineno-0-5255">5255</a></span>
<span class="normal"><a href="#__codelineno-0-5256">5256</a></span>
<span class="normal"><a href="#__codelineno-0-5257">5257</a></span>
<span class="normal"><a href="#__codelineno-0-5258">5258</a></span>
<span class="normal"><a href="#__codelineno-0-5259">5259</a></span>
<span class="normal"><a href="#__codelineno-0-5260">5260</a></span>
<span class="normal"><a href="#__codelineno-0-5261">5261</a></span>
<span class="normal"><a href="#__codelineno-0-5262">5262</a></span>
<span class="normal"><a href="#__codelineno-0-5263">5263</a></span>
<span class="normal"><a href="#__codelineno-0-5264">5264</a></span>
<span class="normal"><a href="#__codelineno-0-5265">5265</a></span>
<span class="normal"><a href="#__codelineno-0-5266">5266</a></span>
<span class="normal"><a href="#__codelineno-0-5267">5267</a></span>
<span class="normal"><a href="#__codelineno-0-5268">5268</a></span>
<span class="normal"><a href="#__codelineno-0-5269">5269</a></span>
<span class="normal"><a href="#__codelineno-0-5270">5270</a></span>
<span class="normal"><a href="#__codelineno-0-5271">5271</a></span>
<span class="normal"><a href="#__codelineno-0-5272">5272</a></span>
<span class="normal"><a href="#__codelineno-0-5273">5273</a></span>
<span class="normal"><a href="#__codelineno-0-5274">5274</a></span>
<span class="normal"><a href="#__codelineno-0-5275">5275</a></span>
<span class="normal"><a href="#__codelineno-0-5276">5276</a></span>
<span class="normal"><a href="#__codelineno-0-5277">5277</a></span>
<span class="normal"><a href="#__codelineno-0-5278">5278</a></span>
<span class="normal"><a href="#__codelineno-0-5279">5279</a></span>
<span class="normal"><a href="#__codelineno-0-5280">5280</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5203"><a id="__codelineno-0-5203" name="__codelineno-0-5203"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_sharepoint_section</span><span class="p">(</span>
</span><span id="__span-0-5204"><a id="__codelineno-0-5204" name="__codelineno-0-5204"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5205"><a id="__codelineno-0-5205" name="__codelineno-0-5205"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5206"><a id="__codelineno-0-5206" name="__codelineno-0-5206"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5207"><a id="__codelineno-0-5207" name="__codelineno-0-5207"></a>    <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5208"><a id="__codelineno-0-5208" name="__codelineno-0-5208"></a>    <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5209"><a id="__codelineno-0-5209" name="__codelineno-0-5209"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5210"><a id="__codelineno-0-5210" name="__codelineno-0-5210"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a specific section (horizontal or vertical) on a SharePoint page.</span>
</span><span id="__span-0-5211"><a id="__codelineno-0-5211" name="__codelineno-0-5211"></a>
</span><span id="__span-0-5212"><a id="__codelineno-0-5212" name="__codelineno-0-5212"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5213"><a id="__codelineno-0-5213" name="__codelineno-0-5213"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5214"><a id="__codelineno-0-5214" name="__codelineno-0-5214"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5215"><a id="__codelineno-0-5215" name="__codelineno-0-5215"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5216"><a id="__codelineno-0-5216" name="__codelineno-0-5216"></a><span class="sd">            The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5217"><a id="__codelineno-0-5217" name="__codelineno-0-5217"></a><span class="sd">        section_type (str, optional):</span>
</span><span id="__span-0-5218"><a id="__codelineno-0-5218" name="__codelineno-0-5218"></a><span class="sd">            &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5219"><a id="__codelineno-0-5219" name="__codelineno-0-5219"></a><span class="sd">            &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5220"><a id="__codelineno-0-5220" name="__codelineno-0-5220"></a><span class="sd">        section_id (int | str):</span>
</span><span id="__span-0-5221"><a id="__codelineno-0-5221" name="__codelineno-0-5221"></a><span class="sd">            The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5222"><a id="__codelineno-0-5222" name="__codelineno-0-5222"></a><span class="sd">            Simple values like 1,2,3...</span>
</span><span id="__span-0-5223"><a id="__codelineno-0-5223" name="__codelineno-0-5223"></a>
</span><span id="__span-0-5224"><a id="__codelineno-0-5224" name="__codelineno-0-5224"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5225"><a id="__codelineno-0-5225" name="__codelineno-0-5225"></a><span class="sd">        dict:</span>
</span><span id="__span-0-5226"><a id="__codelineno-0-5226" name="__codelineno-0-5226"></a><span class="sd">            Empty response.</span>
</span><span id="__span-0-5227"><a id="__codelineno-0-5227" name="__codelineno-0-5227"></a>
</span><span id="__span-0-5228"><a id="__codelineno-0-5228" name="__codelineno-0-5228"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5229"><a id="__codelineno-0-5229" name="__codelineno-0-5229"></a><span class="sd">    {</span>
</span><span id="__span-0-5230"><a id="__codelineno-0-5230" name="__codelineno-0-5230"></a><span class="sd">        &#39;_content&#39;: b&#39;&#39;,</span>
</span><span id="__span-0-5231"><a id="__codelineno-0-5231" name="__codelineno-0-5231"></a><span class="sd">        &#39;_content_consumed&#39;: True,</span>
</span><span id="__span-0-5232"><a id="__codelineno-0-5232" name="__codelineno-0-5232"></a><span class="sd">        &#39;_next&#39;: None,</span>
</span><span id="__span-0-5233"><a id="__codelineno-0-5233" name="__codelineno-0-5233"></a><span class="sd">        &#39;status_code&#39;: 204,</span>
</span><span id="__span-0-5234"><a id="__codelineno-0-5234" name="__codelineno-0-5234"></a><span class="sd">        &#39;headers&#39;: {</span>
</span><span id="__span-0-5235"><a id="__codelineno-0-5235" name="__codelineno-0-5235"></a><span class="sd">            &#39;Cache-Control&#39;: &#39;no-store, no-cache&#39;,</span>
</span><span id="__span-0-5236"><a id="__codelineno-0-5236" name="__codelineno-0-5236"></a><span class="sd">            &#39;Strict-Transport-Security&#39;: &#39;max-age=31536000&#39;,</span>
</span><span id="__span-0-5237"><a id="__codelineno-0-5237" name="__codelineno-0-5237"></a><span class="sd">            &#39;request-id&#39;: &#39;bd21c7fa-751c-43ca-b290-12c30f50d7e1&#39;,</span>
</span><span id="__span-0-5238"><a id="__codelineno-0-5238" name="__codelineno-0-5238"></a><span class="sd">            &#39;client-request-id&#39;: &#39;bd21c7fa-751c-43ca-b290-12c30f50d7e1&#39;,</span>
</span><span id="__span-0-5239"><a id="__codelineno-0-5239" name="__codelineno-0-5239"></a><span class="sd">            &#39;x-ms-ags-diagnostic&#39;: &#39;{&quot;ServerInfo&quot;:{&quot;DataCenter&quot;:&quot;Germany West Central&quot;,&quot;Slice&quot;:&quot;E&quot;,&quot;Ring&quot;:&quot;4&quot;,&quot;ScaleUnit&quot;:&quot;004&quot;,&quot;RoleInstance&quot;:&quot;FR2PEPF00000393&quot;}}&#39;, &#39;Date&#39;: &#39;Fri, 14 Feb 2025 20:40:06 GMT&#39;},</span>
</span><span id="__span-0-5240"><a id="__codelineno-0-5240" name="__codelineno-0-5240"></a><span class="sd">            &#39;raw&#39;: &lt;urllib3.response.HTTPResponse object at 0x10f210d90&gt;,</span>
</span><span id="__span-0-5241"><a id="__codelineno-0-5241" name="__codelineno-0-5241"></a><span class="sd">            &#39;url&#39;: &#39;https://graph.microsoft.com/beta/sites/ideatedev.sharepoint.com,61c0f9cb-39d3-4c04-b60c-31576954a2ab,a678aeab-68ac-46a1-bd95-28020c12de26/pages/ac7675ee-8891-43b9-b1b2-2d2ced8eb17e/microsoft.graph.sitePage/canvasLayout/horizontalSections/1&#39;,</span>
</span><span id="__span-0-5242"><a id="__codelineno-0-5242" name="__codelineno-0-5242"></a><span class="sd">            &#39;encoding&#39;: None,</span>
</span><span id="__span-0-5243"><a id="__codelineno-0-5243" name="__codelineno-0-5243"></a><span class="sd">            &#39;history&#39;: [],</span>
</span><span id="__span-0-5244"><a id="__codelineno-0-5244" name="__codelineno-0-5244"></a><span class="sd">            &#39;reason&#39;: &#39;No Content&#39;,</span>
</span><span id="__span-0-5245"><a id="__codelineno-0-5245" name="__codelineno-0-5245"></a><span class="sd">            &#39;cookies&#39;: &lt;RequestsCookieJar[]&gt;,</span>
</span><span id="__span-0-5246"><a id="__codelineno-0-5246" name="__codelineno-0-5246"></a><span class="sd">            &#39;elapsed&#39;: datetime.timedelta(microseconds=514597),</span>
</span><span id="__span-0-5247"><a id="__codelineno-0-5247" name="__codelineno-0-5247"></a><span class="sd">            &#39;request&#39;: &lt;PreparedRequest [DELETE]&gt;,</span>
</span><span id="__span-0-5248"><a id="__codelineno-0-5248" name="__codelineno-0-5248"></a><span class="sd">            &#39;connection&#39;: &lt;requests.adapters.HTTPAdapter object at 0x11841d700&gt;</span>
</span><span id="__span-0-5249"><a id="__codelineno-0-5249" name="__codelineno-0-5249"></a><span class="sd">        }</span>
</span><span id="__span-0-5250"><a id="__codelineno-0-5250" name="__codelineno-0-5250"></a>
</span><span id="__span-0-5251"><a id="__codelineno-0-5251" name="__codelineno-0-5251"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5252"><a id="__codelineno-0-5252" name="__codelineno-0-5252"></a>
</span><span id="__span-0-5253"><a id="__codelineno-0-5253" name="__codelineno-0-5253"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5254"><a id="__codelineno-0-5254" name="__codelineno-0-5254"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5255"><a id="__codelineno-0-5255" name="__codelineno-0-5255"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5256"><a id="__codelineno-0-5256" name="__codelineno-0-5256"></a>        <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5257"><a id="__codelineno-0-5257" name="__codelineno-0-5257"></a>        <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5258"><a id="__codelineno-0-5258" name="__codelineno-0-5258"></a>        <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5259"><a id="__codelineno-0-5259" name="__codelineno-0-5259"></a>        <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5260"><a id="__codelineno-0-5260" name="__codelineno-0-5260"></a>        <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5261"><a id="__codelineno-0-5261" name="__codelineno-0-5261"></a>    <span class="p">)</span>
</span><span id="__span-0-5262"><a id="__codelineno-0-5262" name="__codelineno-0-5262"></a>
</span><span id="__span-0-5263"><a id="__codelineno-0-5263" name="__codelineno-0-5263"></a>    <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5264"><a id="__codelineno-0-5264" name="__codelineno-0-5264"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5265"><a id="__codelineno-0-5265" name="__codelineno-0-5265"></a>
</span><span id="__span-0-5266"><a id="__codelineno-0-5266" name="__codelineno-0-5266"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5267"><a id="__codelineno-0-5267" name="__codelineno-0-5267"></a>
</span><span id="__span-0-5268"><a id="__codelineno-0-5268" name="__codelineno-0-5268"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5269"><a id="__codelineno-0-5269" name="__codelineno-0-5269"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5270"><a id="__codelineno-0-5270" name="__codelineno-0-5270"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-5271"><a id="__codelineno-0-5271" name="__codelineno-0-5271"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5272"><a id="__codelineno-0-5272" name="__codelineno-0-5272"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5273"><a id="__codelineno-0-5273" name="__codelineno-0-5273"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to delete SharePoint section of type -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in Sharepoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5274"><a id="__codelineno-0-5274" name="__codelineno-0-5274"></a>            <span class="n">section_type</span><span class="p">,</span>
</span><span id="__span-0-5275"><a id="__codelineno-0-5275" name="__codelineno-0-5275"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5276"><a id="__codelineno-0-5276" name="__codelineno-0-5276"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5277"><a id="__codelineno-0-5277" name="__codelineno-0-5277"></a>        <span class="p">),</span>
</span><span id="__span-0-5278"><a id="__codelineno-0-5278" name="__codelineno-0-5278"></a>    <span class="p">)</span>
</span><span id="__span-0-5279"><a id="__codelineno-0-5279" name="__codelineno-0-5279"></a>
</span><span id="__span-0-5280"><a id="__codelineno-0-5280" name="__codelineno-0-5280"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.delete_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete Microsoft 365 Team with a specific ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the Microsoft 365 Team to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response dictionary if the team has been deleted, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2180"><a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2181"><a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete Microsoft 365 Team with a specific ID.</span>
</span><span id="__span-0-2182"><a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
</span><span id="__span-0-2183"><a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2184"><a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">        team_id (str):</span>
</span><span id="__span-0-2185"><a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">            The ID of the Microsoft 365 Team to delete.</span>
</span><span id="__span-0-2186"><a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>
</span><span id="__span-0-2187"><a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2188"><a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2189"><a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">            Response dictionary if the team has been deleted, False otherwise.</span>
</span><span id="__span-0-2190"><a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>
</span><span id="__span-0-2191"><a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2192"><a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>
</span><span id="__span-0-2193"><a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span>
</span><span id="__span-0-2194"><a id="__codelineno-0-2194" name="__codelineno-0-2194"></a>
</span><span id="__span-0-2195"><a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2196"><a id="__codelineno-0-2196" name="__codelineno-0-2196"></a>
</span><span id="__span-0-2197"><a id="__codelineno-0-2197" name="__codelineno-0-2197"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2198"><a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>        <span class="s2">&quot;Delete Microsoft 365 Teams with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2199"><a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>        <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2200"><a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2201"><a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>    <span class="p">)</span>
</span><span id="__span-0-2202"><a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
</span><span id="__span-0-2203"><a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2204"><a id="__codelineno-0-2204" name="__codelineno-0-2204"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2205"><a id="__codelineno-0-2205" name="__codelineno-0-2205"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-2206"><a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2207"><a id="__codelineno-0-2207" name="__codelineno-0-2207"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2208"><a id="__codelineno-0-2208" name="__codelineno-0-2208"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to delete M365 Team with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
</span><span id="__span-0-2209"><a id="__codelineno-0-2209" name="__codelineno-0-2209"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.delete_teams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_teams</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete Microsoft 365 Teams with a specific name.</p>
<p>Microsoft 365 allows to have multiple teams with the same name. So this method may delete
multiple teams if the have the same name. The Graph API we use here
is the M365 Group API as deleting the group also deletes the associated team.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Microsoft 365 Team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if teams have been deleted, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2213"><a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_teams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2214"><a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete Microsoft 365 Teams with a specific name.</span>
</span><span id="__span-0-2215"><a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>
</span><span id="__span-0-2216"><a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">    Microsoft 365 allows to have multiple teams with the same name. So this method may delete</span>
</span><span id="__span-0-2217"><a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">    multiple teams if the have the same name. The Graph API we use here</span>
</span><span id="__span-0-2218"><a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">    is the M365 Group API as deleting the group also deletes the associated team.</span>
</span><span id="__span-0-2219"><a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>
</span><span id="__span-0-2220"><a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2221"><a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">        name (str):</span>
</span><span id="__span-0-2222"><a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">            The name of the Microsoft 365 Team.</span>
</span><span id="__span-0-2223"><a id="__codelineno-0-2223" name="__codelineno-0-2223"></a>
</span><span id="__span-0-2224"><a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2225"><a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">        bool:</span>
</span><span id="__span-0-2226"><a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">            True if teams have been deleted, False otherwise.</span>
</span><span id="__span-0-2227"><a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>
</span><span id="__span-0-2228"><a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2229"><a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>
</span><span id="__span-0-2230"><a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>    <span class="c1"># We need a special handling of team names with single quotes:</span>
</span><span id="__span-0-2231"><a id="__codelineno-0-2231" name="__codelineno-0-2231"></a>    <span class="n">escaped_group_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
</span><span id="__span-0-2232"><a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>    <span class="n">encoded_group_name</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">escaped_group_name</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-2233"><a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?$filter=displayName eq &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">encoded_group_name</span><span class="p">)</span>
</span><span id="__span-0-2234"><a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
</span><span id="__span-0-2235"><a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2236"><a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
</span><span id="__span-0-2237"><a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2238"><a id="__codelineno-0-2238" name="__codelineno-0-2238"></a>        <span class="s2">&quot;Delete all Microsoft 365 Teams with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2239"><a id="__codelineno-0-2239" name="__codelineno-0-2239"></a>        <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2240"><a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2241"><a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>    <span class="p">)</span>
</span><span id="__span-0-2242"><a id="__codelineno-0-2242" name="__codelineno-0-2242"></a>
</span><span id="__span-0-2243"><a id="__codelineno-0-2243" name="__codelineno-0-2243"></a>    <span class="n">existing_teams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2244"><a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2245"><a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2246"><a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2247"><a id="__codelineno-0-2247" name="__codelineno-0-2247"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2248"><a id="__codelineno-0-2248" name="__codelineno-0-2248"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 Teams to delete&quot;</span><span class="p">,</span>
</span><span id="__span-0-2249"><a id="__codelineno-0-2249" name="__codelineno-0-2249"></a>    <span class="p">)</span>
</span><span id="__span-0-2250"><a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>
</span><span id="__span-0-2251"><a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>    <span class="k">if</span> <span class="n">existing_teams</span><span class="p">:</span>
</span><span id="__span-0-2252"><a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">existing_teams</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-2253"><a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span><span id="__span-0-2254"><a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-2255"><a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>            <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="__span-0-2256"><a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>                <span class="n">team_id</span> <span class="o">=</span> <span class="n">team</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-2257"><a id="__codelineno-0-2257" name="__codelineno-0-2257"></a>                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span>
</span><span id="__span-0-2258"><a id="__codelineno-0-2258" name="__codelineno-0-2258"></a>
</span><span id="__span-0-2259"><a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-2260"><a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2261"><a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>                        <span class="s2">&quot;Failed to delete M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">)!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2262"><a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>                        <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2263"><a id="__codelineno-0-2263" name="__codelineno-0-2263"></a>                        <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2264"><a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>                    <span class="p">)</span>
</span><span id="__span-0-2265"><a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>                    <span class="k">continue</span>
</span><span id="__span-0-2266"><a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-2267"><a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
</span><span id="__span-0-2268"><a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-2269"><a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> M365 Team</span><span class="si">%s</span><span class="s2"> with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; </span><span class="si">%s</span><span class="s2"> been deleted.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2270"><a id="__codelineno-0-2270" name="__codelineno-0-2270"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">),</span>
</span><span id="__span-0-2271"><a id="__codelineno-0-2271" name="__codelineno-0-2271"></a>                <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2272"><a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>                <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2273"><a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>                <span class="s2">&quot;have&quot;</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;has&quot;</span><span class="p">,</span>
</span><span id="__span-0-2274"><a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>            <span class="p">)</span>
</span><span id="__span-0-2275"><a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-2276"><a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2277"><a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No M365 Team with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; found.&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2278"><a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2279"><a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2280"><a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to retrieve M365 Teams with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2281"><a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>        <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.delete_teams_app_from_channel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_teams_app_from_channel</span><span class="p">(</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">tab_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete an existing tab for Extended ECM app from an M365 Team channel.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 Team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the channel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tab_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tab.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True = success, False = Error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3454">3454</a></span>
<span class="normal"><a href="#__codelineno-0-3455">3455</a></span>
<span class="normal"><a href="#__codelineno-0-3456">3456</a></span>
<span class="normal"><a href="#__codelineno-0-3457">3457</a></span>
<span class="normal"><a href="#__codelineno-0-3458">3458</a></span>
<span class="normal"><a href="#__codelineno-0-3459">3459</a></span>
<span class="normal"><a href="#__codelineno-0-3460">3460</a></span>
<span class="normal"><a href="#__codelineno-0-3461">3461</a></span>
<span class="normal"><a href="#__codelineno-0-3462">3462</a></span>
<span class="normal"><a href="#__codelineno-0-3463">3463</a></span>
<span class="normal"><a href="#__codelineno-0-3464">3464</a></span>
<span class="normal"><a href="#__codelineno-0-3465">3465</a></span>
<span class="normal"><a href="#__codelineno-0-3466">3466</a></span>
<span class="normal"><a href="#__codelineno-0-3467">3467</a></span>
<span class="normal"><a href="#__codelineno-0-3468">3468</a></span>
<span class="normal"><a href="#__codelineno-0-3469">3469</a></span>
<span class="normal"><a href="#__codelineno-0-3470">3470</a></span>
<span class="normal"><a href="#__codelineno-0-3471">3471</a></span>
<span class="normal"><a href="#__codelineno-0-3472">3472</a></span>
<span class="normal"><a href="#__codelineno-0-3473">3473</a></span>
<span class="normal"><a href="#__codelineno-0-3474">3474</a></span>
<span class="normal"><a href="#__codelineno-0-3475">3475</a></span>
<span class="normal"><a href="#__codelineno-0-3476">3476</a></span>
<span class="normal"><a href="#__codelineno-0-3477">3477</a></span>
<span class="normal"><a href="#__codelineno-0-3478">3478</a></span>
<span class="normal"><a href="#__codelineno-0-3479">3479</a></span>
<span class="normal"><a href="#__codelineno-0-3480">3480</a></span>
<span class="normal"><a href="#__codelineno-0-3481">3481</a></span>
<span class="normal"><a href="#__codelineno-0-3482">3482</a></span>
<span class="normal"><a href="#__codelineno-0-3483">3483</a></span>
<span class="normal"><a href="#__codelineno-0-3484">3484</a></span>
<span class="normal"><a href="#__codelineno-0-3485">3485</a></span>
<span class="normal"><a href="#__codelineno-0-3486">3486</a></span>
<span class="normal"><a href="#__codelineno-0-3487">3487</a></span>
<span class="normal"><a href="#__codelineno-0-3488">3488</a></span>
<span class="normal"><a href="#__codelineno-0-3489">3489</a></span>
<span class="normal"><a href="#__codelineno-0-3490">3490</a></span>
<span class="normal"><a href="#__codelineno-0-3491">3491</a></span>
<span class="normal"><a href="#__codelineno-0-3492">3492</a></span>
<span class="normal"><a href="#__codelineno-0-3493">3493</a></span>
<span class="normal"><a href="#__codelineno-0-3494">3494</a></span>
<span class="normal"><a href="#__codelineno-0-3495">3495</a></span>
<span class="normal"><a href="#__codelineno-0-3496">3496</a></span>
<span class="normal"><a href="#__codelineno-0-3497">3497</a></span>
<span class="normal"><a href="#__codelineno-0-3498">3498</a></span>
<span class="normal"><a href="#__codelineno-0-3499">3499</a></span>
<span class="normal"><a href="#__codelineno-0-3500">3500</a></span>
<span class="normal"><a href="#__codelineno-0-3501">3501</a></span>
<span class="normal"><a href="#__codelineno-0-3502">3502</a></span>
<span class="normal"><a href="#__codelineno-0-3503">3503</a></span>
<span class="normal"><a href="#__codelineno-0-3504">3504</a></span>
<span class="normal"><a href="#__codelineno-0-3505">3505</a></span>
<span class="normal"><a href="#__codelineno-0-3506">3506</a></span>
<span class="normal"><a href="#__codelineno-0-3507">3507</a></span>
<span class="normal"><a href="#__codelineno-0-3508">3508</a></span>
<span class="normal"><a href="#__codelineno-0-3509">3509</a></span>
<span class="normal"><a href="#__codelineno-0-3510">3510</a></span>
<span class="normal"><a href="#__codelineno-0-3511">3511</a></span>
<span class="normal"><a href="#__codelineno-0-3512">3512</a></span>
<span class="normal"><a href="#__codelineno-0-3513">3513</a></span>
<span class="normal"><a href="#__codelineno-0-3514">3514</a></span>
<span class="normal"><a href="#__codelineno-0-3515">3515</a></span>
<span class="normal"><a href="#__codelineno-0-3516">3516</a></span>
<span class="normal"><a href="#__codelineno-0-3517">3517</a></span>
<span class="normal"><a href="#__codelineno-0-3518">3518</a></span>
<span class="normal"><a href="#__codelineno-0-3519">3519</a></span>
<span class="normal"><a href="#__codelineno-0-3520">3520</a></span>
<span class="normal"><a href="#__codelineno-0-3521">3521</a></span>
<span class="normal"><a href="#__codelineno-0-3522">3522</a></span>
<span class="normal"><a href="#__codelineno-0-3523">3523</a></span>
<span class="normal"><a href="#__codelineno-0-3524">3524</a></span>
<span class="normal"><a href="#__codelineno-0-3525">3525</a></span>
<span class="normal"><a href="#__codelineno-0-3526">3526</a></span>
<span class="normal"><a href="#__codelineno-0-3527">3527</a></span>
<span class="normal"><a href="#__codelineno-0-3528">3528</a></span>
<span class="normal"><a href="#__codelineno-0-3529">3529</a></span>
<span class="normal"><a href="#__codelineno-0-3530">3530</a></span>
<span class="normal"><a href="#__codelineno-0-3531">3531</a></span>
<span class="normal"><a href="#__codelineno-0-3532">3532</a></span>
<span class="normal"><a href="#__codelineno-0-3533">3533</a></span>
<span class="normal"><a href="#__codelineno-0-3534">3534</a></span>
<span class="normal"><a href="#__codelineno-0-3535">3535</a></span>
<span class="normal"><a href="#__codelineno-0-3536">3536</a></span>
<span class="normal"><a href="#__codelineno-0-3537">3537</a></span>
<span class="normal"><a href="#__codelineno-0-3538">3538</a></span>
<span class="normal"><a href="#__codelineno-0-3539">3539</a></span>
<span class="normal"><a href="#__codelineno-0-3540">3540</a></span>
<span class="normal"><a href="#__codelineno-0-3541">3541</a></span>
<span class="normal"><a href="#__codelineno-0-3542">3542</a></span>
<span class="normal"><a href="#__codelineno-0-3543">3543</a></span>
<span class="normal"><a href="#__codelineno-0-3544">3544</a></span>
<span class="normal"><a href="#__codelineno-0-3545">3545</a></span>
<span class="normal"><a href="#__codelineno-0-3546">3546</a></span>
<span class="normal"><a href="#__codelineno-0-3547">3547</a></span>
<span class="normal"><a href="#__codelineno-0-3548">3548</a></span>
<span class="normal"><a href="#__codelineno-0-3549">3549</a></span>
<span class="normal"><a href="#__codelineno-0-3550">3550</a></span>
<span class="normal"><a href="#__codelineno-0-3551">3551</a></span>
<span class="normal"><a href="#__codelineno-0-3552">3552</a></span>
<span class="normal"><a href="#__codelineno-0-3553">3553</a></span>
<span class="normal"><a href="#__codelineno-0-3554">3554</a></span>
<span class="normal"><a href="#__codelineno-0-3555">3555</a></span>
<span class="normal"><a href="#__codelineno-0-3556">3556</a></span>
<span class="normal"><a href="#__codelineno-0-3557">3557</a></span>
<span class="normal"><a href="#__codelineno-0-3558">3558</a></span>
<span class="normal"><a href="#__codelineno-0-3559">3559</a></span>
<span class="normal"><a href="#__codelineno-0-3560">3560</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3454"><a id="__codelineno-0-3454" name="__codelineno-0-3454"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_teams_app_from_channel</span><span class="p">(</span>
</span><span id="__span-0-3455"><a id="__codelineno-0-3455" name="__codelineno-0-3455"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3456"><a id="__codelineno-0-3456" name="__codelineno-0-3456"></a>    <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3457"><a id="__codelineno-0-3457" name="__codelineno-0-3457"></a>    <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3458"><a id="__codelineno-0-3458" name="__codelineno-0-3458"></a>    <span class="n">tab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3459"><a id="__codelineno-0-3459" name="__codelineno-0-3459"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-3460"><a id="__codelineno-0-3460" name="__codelineno-0-3460"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete an existing tab for Extended ECM app from an M365 Team channel.</span>
</span><span id="__span-0-3461"><a id="__codelineno-0-3461" name="__codelineno-0-3461"></a>
</span><span id="__span-0-3462"><a id="__codelineno-0-3462" name="__codelineno-0-3462"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3463"><a id="__codelineno-0-3463" name="__codelineno-0-3463"></a><span class="sd">        team_name (str):</span>
</span><span id="__span-0-3464"><a id="__codelineno-0-3464" name="__codelineno-0-3464"></a><span class="sd">            The name of the M365 Team.</span>
</span><span id="__span-0-3465"><a id="__codelineno-0-3465" name="__codelineno-0-3465"></a><span class="sd">        channel_name (str):</span>
</span><span id="__span-0-3466"><a id="__codelineno-0-3466" name="__codelineno-0-3466"></a><span class="sd">            The name of the channel.</span>
</span><span id="__span-0-3467"><a id="__codelineno-0-3467" name="__codelineno-0-3467"></a><span class="sd">        tab_name (str):</span>
</span><span id="__span-0-3468"><a id="__codelineno-0-3468" name="__codelineno-0-3468"></a><span class="sd">            The name of the tab.</span>
</span><span id="__span-0-3469"><a id="__codelineno-0-3469" name="__codelineno-0-3469"></a>
</span><span id="__span-0-3470"><a id="__codelineno-0-3470" name="__codelineno-0-3470"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3471"><a id="__codelineno-0-3471" name="__codelineno-0-3471"></a><span class="sd">        bool:</span>
</span><span id="__span-0-3472"><a id="__codelineno-0-3472" name="__codelineno-0-3472"></a><span class="sd">            True = success, False = Error.</span>
</span><span id="__span-0-3473"><a id="__codelineno-0-3473" name="__codelineno-0-3473"></a>
</span><span id="__span-0-3474"><a id="__codelineno-0-3474" name="__codelineno-0-3474"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3475"><a id="__codelineno-0-3475" name="__codelineno-0-3475"></a>
</span><span id="__span-0-3476"><a id="__codelineno-0-3476" name="__codelineno-0-3476"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3477"><a id="__codelineno-0-3477" name="__codelineno-0-3477"></a>    <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3478"><a id="__codelineno-0-3478" name="__codelineno-0-3478"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-3479"><a id="__codelineno-0-3479" name="__codelineno-0-3479"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3480"><a id="__codelineno-0-3480" name="__codelineno-0-3480"></a>
</span><span id="__span-0-3481"><a id="__codelineno-0-3481" name="__codelineno-0-3481"></a>    <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-3482"><a id="__codelineno-0-3482" name="__codelineno-0-3482"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3483"><a id="__codelineno-0-3483" name="__codelineno-0-3483"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3484"><a id="__codelineno-0-3484" name="__codelineno-0-3484"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3485"><a id="__codelineno-0-3485" name="__codelineno-0-3485"></a>
</span><span id="__span-0-3486"><a id="__codelineno-0-3486" name="__codelineno-0-3486"></a>    <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-3487"><a id="__codelineno-0-3487" name="__codelineno-0-3487"></a>    <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3488"><a id="__codelineno-0-3488" name="__codelineno-0-3488"></a>        <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-3489"><a id="__codelineno-0-3489" name="__codelineno-0-3489"></a>        <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3490"><a id="__codelineno-0-3490" name="__codelineno-0-3490"></a>    <span class="p">)</span>
</span><span id="__span-0-3491"><a id="__codelineno-0-3491" name="__codelineno-0-3491"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-3492"><a id="__codelineno-0-3492" name="__codelineno-0-3492"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3493"><a id="__codelineno-0-3493" name="__codelineno-0-3493"></a>            <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; for M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3494"><a id="__codelineno-0-3494" name="__codelineno-0-3494"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3495"><a id="__codelineno-0-3495" name="__codelineno-0-3495"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3496"><a id="__codelineno-0-3496" name="__codelineno-0-3496"></a>        <span class="p">)</span>
</span><span id="__span-0-3497"><a id="__codelineno-0-3497" name="__codelineno-0-3497"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3498"><a id="__codelineno-0-3498" name="__codelineno-0-3498"></a>    <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3499"><a id="__codelineno-0-3499" name="__codelineno-0-3499"></a>
</span><span id="__span-0-3500"><a id="__codelineno-0-3500" name="__codelineno-0-3500"></a>    <span class="c1"># Get the tabs of the M365 Team channel:</span>
</span><span id="__span-0-3501"><a id="__codelineno-0-3501" name="__codelineno-0-3501"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channel_tabs</span><span class="p">(</span><span class="n">team_name</span><span class="o">=</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="o">=</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="__span-0-3502"><a id="__codelineno-0-3502" name="__codelineno-0-3502"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3503"><a id="__codelineno-0-3503" name="__codelineno-0-3503"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3504"><a id="__codelineno-0-3504" name="__codelineno-0-3504"></a>
</span><span id="__span-0-3505"><a id="__codelineno-0-3505" name="__codelineno-0-3505"></a>    <span class="c1"># Lookup the tabs by name and then retrieve their IDs (in worst case it can</span>
</span><span id="__span-0-3506"><a id="__codelineno-0-3506" name="__codelineno-0-3506"></a>    <span class="c1"># be multiple tabs / apps with same name if former cleanups did not work):</span>
</span><span id="__span-0-3507"><a id="__codelineno-0-3507" name="__codelineno-0-3507"></a>    <span class="n">tab_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab_name</span><span class="p">]</span>
</span><span id="__span-0-3508"><a id="__codelineno-0-3508" name="__codelineno-0-3508"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tab_list</span><span class="p">:</span>
</span><span id="__span-0-3509"><a id="__codelineno-0-3509" name="__codelineno-0-3509"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3510"><a id="__codelineno-0-3510" name="__codelineno-0-3510"></a>            <span class="s2">&quot;Cannot find Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">)!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3511"><a id="__codelineno-0-3511" name="__codelineno-0-3511"></a>            <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3512"><a id="__codelineno-0-3512" name="__codelineno-0-3512"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3513"><a id="__codelineno-0-3513" name="__codelineno-0-3513"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3514"><a id="__codelineno-0-3514" name="__codelineno-0-3514"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3515"><a id="__codelineno-0-3515" name="__codelineno-0-3515"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3516"><a id="__codelineno-0-3516" name="__codelineno-0-3516"></a>        <span class="p">)</span>
</span><span id="__span-0-3517"><a id="__codelineno-0-3517" name="__codelineno-0-3517"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3518"><a id="__codelineno-0-3518" name="__codelineno-0-3518"></a>
</span><span id="__span-0-3519"><a id="__codelineno-0-3519" name="__codelineno-0-3519"></a>    <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">tab_list</span><span class="p">:</span>
</span><span id="__span-0-3520"><a id="__codelineno-0-3520" name="__codelineno-0-3520"></a>        <span class="n">tab_id</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3521"><a id="__codelineno-0-3521" name="__codelineno-0-3521"></a>
</span><span id="__span-0-3522"><a id="__codelineno-0-3522" name="__codelineno-0-3522"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3523"><a id="__codelineno-0-3523" name="__codelineno-0-3523"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tab_id</span><span class="p">)</span>
</span><span id="__span-0-3524"><a id="__codelineno-0-3524" name="__codelineno-0-3524"></a>        <span class="p">)</span>
</span><span id="__span-0-3525"><a id="__codelineno-0-3525" name="__codelineno-0-3525"></a>
</span><span id="__span-0-3526"><a id="__codelineno-0-3526" name="__codelineno-0-3526"></a>        <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3527"><a id="__codelineno-0-3527" name="__codelineno-0-3527"></a>
</span><span id="__span-0-3528"><a id="__codelineno-0-3528" name="__codelineno-0-3528"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3529"><a id="__codelineno-0-3529" name="__codelineno-0-3529"></a>            <span class="s2">&quot;Delete Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) from Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of Microsoft 365 Teams -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3530"><a id="__codelineno-0-3530" name="__codelineno-0-3530"></a>            <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3531"><a id="__codelineno-0-3531" name="__codelineno-0-3531"></a>            <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3532"><a id="__codelineno-0-3532" name="__codelineno-0-3532"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3533"><a id="__codelineno-0-3533" name="__codelineno-0-3533"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3534"><a id="__codelineno-0-3534" name="__codelineno-0-3534"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3535"><a id="__codelineno-0-3535" name="__codelineno-0-3535"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3536"><a id="__codelineno-0-3536" name="__codelineno-0-3536"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3537"><a id="__codelineno-0-3537" name="__codelineno-0-3537"></a>        <span class="p">)</span>
</span><span id="__span-0-3538"><a id="__codelineno-0-3538" name="__codelineno-0-3538"></a>
</span><span id="__span-0-3539"><a id="__codelineno-0-3539" name="__codelineno-0-3539"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3540"><a id="__codelineno-0-3540" name="__codelineno-0-3540"></a>            <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3541"><a id="__codelineno-0-3541" name="__codelineno-0-3541"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-3542"><a id="__codelineno-0-3542" name="__codelineno-0-3542"></a>            <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3543"><a id="__codelineno-0-3543" name="__codelineno-0-3543"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3544"><a id="__codelineno-0-3544" name="__codelineno-0-3544"></a>            <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to delete Tab -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3545"><a id="__codelineno-0-3545" name="__codelineno-0-3545"></a>                <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3546"><a id="__codelineno-0-3546" name="__codelineno-0-3546"></a>                <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3547"><a id="__codelineno-0-3547" name="__codelineno-0-3547"></a>                <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3548"><a id="__codelineno-0-3548" name="__codelineno-0-3548"></a>                <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3549"><a id="__codelineno-0-3549" name="__codelineno-0-3549"></a>                <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3550"><a id="__codelineno-0-3550" name="__codelineno-0-3550"></a>                <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3551"><a id="__codelineno-0-3551" name="__codelineno-0-3551"></a>            <span class="p">),</span>
</span><span id="__span-0-3552"><a id="__codelineno-0-3552" name="__codelineno-0-3552"></a>            <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3553"><a id="__codelineno-0-3553" name="__codelineno-0-3553"></a>        <span class="p">)</span>
</span><span id="__span-0-3554"><a id="__codelineno-0-3554" name="__codelineno-0-3554"></a>
</span><span id="__span-0-3555"><a id="__codelineno-0-3555" name="__codelineno-0-3555"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-3556"><a id="__codelineno-0-3556" name="__codelineno-0-3556"></a>            <span class="k">break</span>
</span><span id="__span-0-3557"><a id="__codelineno-0-3557" name="__codelineno-0-3557"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-3558"><a id="__codelineno-0-3558" name="__codelineno-0-3558"></a>    <span class="c1"># end for tab in tab_list</span>
</span><span id="__span-0-3559"><a id="__codelineno-0-3559" name="__codelineno-0-3559"></a>
</span><span id="__span-0-3560"><a id="__codelineno-0-3560" name="__codelineno-0-3560"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.do_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">do_request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_warning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warning_message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">failure_message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">success_message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="n">REQUEST_MAX_RETRIES</span><span class="p">,</span> <span class="n">retry_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Call an M365 Graph API in a safe way.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL to send the request to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>HTTP method (GET, POST, etc.). Defaults to "GET".</p>
              </div>
            </td>
            <td>
                  <code>&#39;GET&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>headers</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Request Headers. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Request payload. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>json_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Request payload for the JSON parameter. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>files</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of {"name": file-tuple} for multipart encoding upload.
file-tuple can be a 2-tuple ("filename", fileobj) or a 3-tuple ("filename", fileobj, "content_type")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Add key-value pairs to the query string of the URL.
When you use the params parameter, requests automatically appends
the key-value pairs to the URL as part of the query string</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timeout for the request in seconds. Defaults to REQUEST_TIMEOUT.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyxecm_customizer.m365.REQUEST_TIMEOUT">REQUEST_TIMEOUT</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be logged in case of a failed REST call.
If False, then only a warning is logged. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_warning</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an warning should be logged in case of a
failed REST call.
If False, then only a warning is logged. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>warning_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific warning message. Defaults to "". If not given the error_message will be used.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failure_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific error message. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>success_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific success message. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_retries</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How many retries on Connection errors? Default is REQUEST_MAX_RETRIES.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyxecm_customizer.m365.REQUEST_MAX_RETRIES">REQUEST_MAX_RETRIES</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>retry_forever</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Eventually wait forever - without timeout. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parse_request_response</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defines whether the response.text should be interpreted as json and loaded into a dictionary.
True is the default.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stream</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This parameter is used to control whether the response content should be immediately
downloaded or streamed incrementally.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of M365 Graph REST API or None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_request</span><span class="p">(</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">json_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">show_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">warning_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="n">failure_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="n">success_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">REQUEST_MAX_RETRIES</span><span class="p">,</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">retry_forever</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">parse_request_response</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">stream</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Call an M365 Graph API in a safe way.</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    Args:</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        url (str):</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            URL to send the request to.</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        method (str, optional):</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            HTTP method (GET, POST, etc.). Defaults to &quot;GET&quot;.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        headers (dict | None, optional):</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            Request Headers. Defaults to None.</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        data (dict | None, optional):</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            Request payload. Defaults to None.</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        json_data (dict | None, optional):</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            Request payload for the JSON parameter. Defaults to None.</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        files (dict | None, optional):</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            Dictionary of {&quot;name&quot;: file-tuple} for multipart encoding upload.</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            file-tuple can be a 2-tuple (&quot;filename&quot;, fileobj) or a 3-tuple (&quot;filename&quot;, fileobj, &quot;content_type&quot;)</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        params (dict | None, optional):</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            Add key-value pairs to the query string of the URL.</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            When you use the params parameter, requests automatically appends</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            the key-value pairs to the URL as part of the query string</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        timeout (float | None, optional):</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            Timeout for the request in seconds. Defaults to REQUEST_TIMEOUT.</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            Whether or not an error should be logged in case of a failed REST call.</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            If False, then only a warning is logged. Defaults to True.</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        show_warning (bool, optional):</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            Whether or not an warning should be logged in case of a</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            failed REST call.</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            If False, then only a warning is logged. Defaults to True.</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        warning_message (str, optional):</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            Specific warning message. Defaults to &quot;&quot;. If not given the error_message will be used.</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        failure_message (str, optional):</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            Specific error message. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        success_message (str, optional):</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            Specific success message. Defaults to &quot;&quot;.</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        max_retries (int, optional):</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            How many retries on Connection errors? Default is REQUEST_MAX_RETRIES.</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        retry_forever (bool, optional):</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            Eventually wait forever - without timeout. Defaults to False.</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        parse_request_response (bool, optional):</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            Defines whether the response.text should be interpreted as json and loaded into a dictionary.</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            True is the default.</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        stream (bool, optional):</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            This parameter is used to control whether the response content should be immediately</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            downloaded or streamed incrementally.</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            Response of M365 Graph REST API or None in case of an error.</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">if</span> <span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="s2">&quot;Missing request header. Cannot send request to Microsoft M365 Graph API!&quot;</span><span class="p">,</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="p">)</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="c1"># In case of an expired session we reauthenticate and</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="c1"># try 1 more time. Session expiration should not happen</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="c1"># twice in a row:</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>                <span class="n">json</span><span class="o">=</span><span class="n">json_data</span><span class="p">,</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>                <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="p">)</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="k">if</span> <span class="n">success_message</span><span class="p">:</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">success_message</span><span class="p">)</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="k">if</span> <span class="n">parse_request_response</span><span class="p">:</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>                    <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="c1"># Check if Session has expired - then re-authenticate and try once more</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Session has expired - try to re-authenticate...&quot;</span><span class="p">)</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">revalidate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">]</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">REQUEST_MAX_RETRIES</span><span class="p">:</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>                    <span class="s2">&quot;M365 Graph API delivered server side error -&gt; </span><span class="si">%s</span><span class="s2">; retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>                    <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>                    <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="p">)</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">((</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">404</span><span class="p">,</span> <span class="mi">429</span><span class="p">]</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">REQUEST_MAX_RETRIES</span><span class="p">:</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>                    <span class="s2">&quot;M365 Graph API is too slow or throtteling calls -&gt; </span><span class="si">%s</span><span class="s2">; retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>                    <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a>                    <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="p">)</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">((</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>                <span class="c1"># Handle plain HTML responses to not pollute the logs</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>                <span class="n">content_type</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content-type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="n">response_text</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>                    <span class="s2">&quot;HTML content (only printed in debug log)&quot;</span> <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;text/html&quot;</span> <span class="k">else</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="p">)</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="k">if</span> <span class="n">show_error</span><span class="p">:</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; status -&gt; </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">; error -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>                        <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>                        <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>                        <span class="n">HTTPStatus</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span><span class="o">.</span><span class="n">phrase</span><span class="p">,</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>                        <span class="n">response_text</span><span class="p">,</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>                    <span class="p">)</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="k">elif</span> <span class="n">show_warning</span><span class="p">:</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; status -&gt; </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">; warning -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>                        <span class="n">warning_message</span> <span class="k">if</span> <span class="n">warning_message</span> <span class="k">else</span> <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>                        <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>                        <span class="n">HTTPStatus</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span><span class="o">.</span><span class="n">phrase</span><span class="p">,</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>                        <span class="n">response_text</span><span class="p">,</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>                    <span class="p">)</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>                <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;text/html&quot;</span><span class="p">:</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; status -&gt; </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">; warning -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>                        <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>                        <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>                        <span class="n">HTTPStatus</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span><span class="o">.</span><span class="n">phrase</span><span class="p">,</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>                        <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>                    <span class="p">)</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;=</span> <span class="n">max_retries</span><span class="p">:</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a>                    <span class="s2">&quot;Request timed out. Retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>                    <span class="nb">str</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">),</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="p">)</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">)</span>  <span class="c1"># Add a delay before retrying</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; timeout error!&quot;</span><span class="p">,</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a>                    <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="p">)</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="k">if</span> <span class="n">retry_forever</span><span class="p">:</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>                    <span class="c1"># If it fails after REQUEST_MAX_RETRIES retries we let it wait forever</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Turn timeouts off and wait forever...&quot;</span><span class="p">)</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a>                    <span class="n">timeout</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;=</span> <span class="n">max_retries</span><span class="p">:</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a>                    <span class="s2">&quot;Connection error. Retrying in </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>                    <span class="nb">str</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">),</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="p">)</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">)</span>  <span class="c1"># Add a delay before retrying</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; connection error!&quot;</span><span class="p">,</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a>                    <span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="p">)</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="k">if</span> <span class="n">retry_forever</span><span class="p">:</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a>                    <span class="c1"># If it fails after REQUEST_MAX_RETRIES retries we let it wait forever</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Turn timeouts off and wait forever...&quot;</span><span class="p">)</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>                    <span class="n">timeout</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">REQUEST_RETRY_DELAY</span><span class="p">)</span>  <span class="c1"># Add a delay before retrying</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="c1"># end try</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="s2">&quot;Retrying REST API </span><span class="si">%s</span><span class="s2"> call -&gt; </span><span class="si">%s</span><span class="s2">... (retry = </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a>            <span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">retries</span><span class="p">),</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.download_user_photo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_user_photo</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Download the M365 user photo and save it to the local file system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>photo_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory where the photo should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the photo file in the file system (with full path) or None if
the call of the REST API fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="k">def</span><span class="w"> </span><span class="nf">download_user_photo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Download the M365 user photo and save it to the local file system.</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">        photo_path (str):</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">            The directory where the photo should be saved.</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">        str:</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">            The name of the photo file in the file system (with full path) or None if</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">            the call of the REST API fails.</span>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/photo/$value&quot;</span>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">(</span><span class="s2">&quot;application/json&quot;</span><span class="p">)</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>        <span class="s2">&quot;Downloading photo for M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>    <span class="p">)</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to download photo for M365 user with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>        <span class="p">),</span>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>        <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>    <span class="p">)</span>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="n">content_type</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;image/png&quot;</span><span class="p">)</span>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;image/jpeg&quot;</span><span class="p">:</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>            <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;jpg&quot;</span>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>        <span class="k">elif</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s2">&quot;image/png&quot;</span><span class="p">:</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>            <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>            <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;img&quot;</span>  <span class="c1"># Default extension if type is unknown</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>            <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">file_extension</span><span class="p">),</span>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="p">)</span>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>                <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">))</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>                <span class="s2">&quot;Error saving photo for user with ID -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>            <span class="p">)</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>                <span class="s2">&quot;Photo for M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2"> saved to -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>                <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>                <span class="n">file_path</span><span class="p">,</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>            <span class="p">)</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>            <span class="k">return</span> <span class="n">file_path</span>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.email_verification" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">email_verification</span><span class="p">(</span><span class="n">user_email</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">url_search_pattern</span><span class="p">,</span> <span class="n">line_end_marker</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">multi_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">multi_line_end_marker</span><span class="o">=</span><span class="s1">&#39;%3D&#39;</span><span class="p">,</span> <span class="n">replacements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">use_browser_automation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">password_field_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">password_confirmation_field_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">password_submit_xpath</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">terms_of_service_xpath</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Process email verification.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_email</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Email address of user recieving the verification mail.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sender</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Email sender (address)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subject</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Email subject to look for (can be substring)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>url_search_pattern</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String the URL needs to contain to identify it.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>line_end_marker</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The character that marks line ends in the mail.</p>
              </div>
            </td>
            <td>
                  <code>&#39;=&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multi_line</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this is a multi-line mail.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multi_line_end_marker</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the URL spans multiple lines this is the "end" marker for the last line.</p>
              </div>
            </td>
            <td>
                  <code>&#39;%3D&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>replacements</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the URL needs some treatment these replacements can be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_retries</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of retries in case of an error.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_browser_automation</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If Selenium-based browser automation should be used or not. Default = False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In case a password is required for browser automation. Default = "",</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password_field_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The password field name in the HTML page of a confirmation dialog. Default = "",</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password_confirmation_field_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The password confirmation field name in the HTML page of a confirmation dialog.
Default = "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password_submit_xpath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default = "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>terms_of_service_xpath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default = "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True = Success, False = Failure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4139">4139</a></span>
<span class="normal"><a href="#__codelineno-0-4140">4140</a></span>
<span class="normal"><a href="#__codelineno-0-4141">4141</a></span>
<span class="normal"><a href="#__codelineno-0-4142">4142</a></span>
<span class="normal"><a href="#__codelineno-0-4143">4143</a></span>
<span class="normal"><a href="#__codelineno-0-4144">4144</a></span>
<span class="normal"><a href="#__codelineno-0-4145">4145</a></span>
<span class="normal"><a href="#__codelineno-0-4146">4146</a></span>
<span class="normal"><a href="#__codelineno-0-4147">4147</a></span>
<span class="normal"><a href="#__codelineno-0-4148">4148</a></span>
<span class="normal"><a href="#__codelineno-0-4149">4149</a></span>
<span class="normal"><a href="#__codelineno-0-4150">4150</a></span>
<span class="normal"><a href="#__codelineno-0-4151">4151</a></span>
<span class="normal"><a href="#__codelineno-0-4152">4152</a></span>
<span class="normal"><a href="#__codelineno-0-4153">4153</a></span>
<span class="normal"><a href="#__codelineno-0-4154">4154</a></span>
<span class="normal"><a href="#__codelineno-0-4155">4155</a></span>
<span class="normal"><a href="#__codelineno-0-4156">4156</a></span>
<span class="normal"><a href="#__codelineno-0-4157">4157</a></span>
<span class="normal"><a href="#__codelineno-0-4158">4158</a></span>
<span class="normal"><a href="#__codelineno-0-4159">4159</a></span>
<span class="normal"><a href="#__codelineno-0-4160">4160</a></span>
<span class="normal"><a href="#__codelineno-0-4161">4161</a></span>
<span class="normal"><a href="#__codelineno-0-4162">4162</a></span>
<span class="normal"><a href="#__codelineno-0-4163">4163</a></span>
<span class="normal"><a href="#__codelineno-0-4164">4164</a></span>
<span class="normal"><a href="#__codelineno-0-4165">4165</a></span>
<span class="normal"><a href="#__codelineno-0-4166">4166</a></span>
<span class="normal"><a href="#__codelineno-0-4167">4167</a></span>
<span class="normal"><a href="#__codelineno-0-4168">4168</a></span>
<span class="normal"><a href="#__codelineno-0-4169">4169</a></span>
<span class="normal"><a href="#__codelineno-0-4170">4170</a></span>
<span class="normal"><a href="#__codelineno-0-4171">4171</a></span>
<span class="normal"><a href="#__codelineno-0-4172">4172</a></span>
<span class="normal"><a href="#__codelineno-0-4173">4173</a></span>
<span class="normal"><a href="#__codelineno-0-4174">4174</a></span>
<span class="normal"><a href="#__codelineno-0-4175">4175</a></span>
<span class="normal"><a href="#__codelineno-0-4176">4176</a></span>
<span class="normal"><a href="#__codelineno-0-4177">4177</a></span>
<span class="normal"><a href="#__codelineno-0-4178">4178</a></span>
<span class="normal"><a href="#__codelineno-0-4179">4179</a></span>
<span class="normal"><a href="#__codelineno-0-4180">4180</a></span>
<span class="normal"><a href="#__codelineno-0-4181">4181</a></span>
<span class="normal"><a href="#__codelineno-0-4182">4182</a></span>
<span class="normal"><a href="#__codelineno-0-4183">4183</a></span>
<span class="normal"><a href="#__codelineno-0-4184">4184</a></span>
<span class="normal"><a href="#__codelineno-0-4185">4185</a></span>
<span class="normal"><a href="#__codelineno-0-4186">4186</a></span>
<span class="normal"><a href="#__codelineno-0-4187">4187</a></span>
<span class="normal"><a href="#__codelineno-0-4188">4188</a></span>
<span class="normal"><a href="#__codelineno-0-4189">4189</a></span>
<span class="normal"><a href="#__codelineno-0-4190">4190</a></span>
<span class="normal"><a href="#__codelineno-0-4191">4191</a></span>
<span class="normal"><a href="#__codelineno-0-4192">4192</a></span>
<span class="normal"><a href="#__codelineno-0-4193">4193</a></span>
<span class="normal"><a href="#__codelineno-0-4194">4194</a></span>
<span class="normal"><a href="#__codelineno-0-4195">4195</a></span>
<span class="normal"><a href="#__codelineno-0-4196">4196</a></span>
<span class="normal"><a href="#__codelineno-0-4197">4197</a></span>
<span class="normal"><a href="#__codelineno-0-4198">4198</a></span>
<span class="normal"><a href="#__codelineno-0-4199">4199</a></span>
<span class="normal"><a href="#__codelineno-0-4200">4200</a></span>
<span class="normal"><a href="#__codelineno-0-4201">4201</a></span>
<span class="normal"><a href="#__codelineno-0-4202">4202</a></span>
<span class="normal"><a href="#__codelineno-0-4203">4203</a></span>
<span class="normal"><a href="#__codelineno-0-4204">4204</a></span>
<span class="normal"><a href="#__codelineno-0-4205">4205</a></span>
<span class="normal"><a href="#__codelineno-0-4206">4206</a></span>
<span class="normal"><a href="#__codelineno-0-4207">4207</a></span>
<span class="normal"><a href="#__codelineno-0-4208">4208</a></span>
<span class="normal"><a href="#__codelineno-0-4209">4209</a></span>
<span class="normal"><a href="#__codelineno-0-4210">4210</a></span>
<span class="normal"><a href="#__codelineno-0-4211">4211</a></span>
<span class="normal"><a href="#__codelineno-0-4212">4212</a></span>
<span class="normal"><a href="#__codelineno-0-4213">4213</a></span>
<span class="normal"><a href="#__codelineno-0-4214">4214</a></span>
<span class="normal"><a href="#__codelineno-0-4215">4215</a></span>
<span class="normal"><a href="#__codelineno-0-4216">4216</a></span>
<span class="normal"><a href="#__codelineno-0-4217">4217</a></span>
<span class="normal"><a href="#__codelineno-0-4218">4218</a></span>
<span class="normal"><a href="#__codelineno-0-4219">4219</a></span>
<span class="normal"><a href="#__codelineno-0-4220">4220</a></span>
<span class="normal"><a href="#__codelineno-0-4221">4221</a></span>
<span class="normal"><a href="#__codelineno-0-4222">4222</a></span>
<span class="normal"><a href="#__codelineno-0-4223">4223</a></span>
<span class="normal"><a href="#__codelineno-0-4224">4224</a></span>
<span class="normal"><a href="#__codelineno-0-4225">4225</a></span>
<span class="normal"><a href="#__codelineno-0-4226">4226</a></span>
<span class="normal"><a href="#__codelineno-0-4227">4227</a></span>
<span class="normal"><a href="#__codelineno-0-4228">4228</a></span>
<span class="normal"><a href="#__codelineno-0-4229">4229</a></span>
<span class="normal"><a href="#__codelineno-0-4230">4230</a></span>
<span class="normal"><a href="#__codelineno-0-4231">4231</a></span>
<span class="normal"><a href="#__codelineno-0-4232">4232</a></span>
<span class="normal"><a href="#__codelineno-0-4233">4233</a></span>
<span class="normal"><a href="#__codelineno-0-4234">4234</a></span>
<span class="normal"><a href="#__codelineno-0-4235">4235</a></span>
<span class="normal"><a href="#__codelineno-0-4236">4236</a></span>
<span class="normal"><a href="#__codelineno-0-4237">4237</a></span>
<span class="normal"><a href="#__codelineno-0-4238">4238</a></span>
<span class="normal"><a href="#__codelineno-0-4239">4239</a></span>
<span class="normal"><a href="#__codelineno-0-4240">4240</a></span>
<span class="normal"><a href="#__codelineno-0-4241">4241</a></span>
<span class="normal"><a href="#__codelineno-0-4242">4242</a></span>
<span class="normal"><a href="#__codelineno-0-4243">4243</a></span>
<span class="normal"><a href="#__codelineno-0-4244">4244</a></span>
<span class="normal"><a href="#__codelineno-0-4245">4245</a></span>
<span class="normal"><a href="#__codelineno-0-4246">4246</a></span>
<span class="normal"><a href="#__codelineno-0-4247">4247</a></span>
<span class="normal"><a href="#__codelineno-0-4248">4248</a></span>
<span class="normal"><a href="#__codelineno-0-4249">4249</a></span>
<span class="normal"><a href="#__codelineno-0-4250">4250</a></span>
<span class="normal"><a href="#__codelineno-0-4251">4251</a></span>
<span class="normal"><a href="#__codelineno-0-4252">4252</a></span>
<span class="normal"><a href="#__codelineno-0-4253">4253</a></span>
<span class="normal"><a href="#__codelineno-0-4254">4254</a></span>
<span class="normal"><a href="#__codelineno-0-4255">4255</a></span>
<span class="normal"><a href="#__codelineno-0-4256">4256</a></span>
<span class="normal"><a href="#__codelineno-0-4257">4257</a></span>
<span class="normal"><a href="#__codelineno-0-4258">4258</a></span>
<span class="normal"><a href="#__codelineno-0-4259">4259</a></span>
<span class="normal"><a href="#__codelineno-0-4260">4260</a></span>
<span class="normal"><a href="#__codelineno-0-4261">4261</a></span>
<span class="normal"><a href="#__codelineno-0-4262">4262</a></span>
<span class="normal"><a href="#__codelineno-0-4263">4263</a></span>
<span class="normal"><a href="#__codelineno-0-4264">4264</a></span>
<span class="normal"><a href="#__codelineno-0-4265">4265</a></span>
<span class="normal"><a href="#__codelineno-0-4266">4266</a></span>
<span class="normal"><a href="#__codelineno-0-4267">4267</a></span>
<span class="normal"><a href="#__codelineno-0-4268">4268</a></span>
<span class="normal"><a href="#__codelineno-0-4269">4269</a></span>
<span class="normal"><a href="#__codelineno-0-4270">4270</a></span>
<span class="normal"><a href="#__codelineno-0-4271">4271</a></span>
<span class="normal"><a href="#__codelineno-0-4272">4272</a></span>
<span class="normal"><a href="#__codelineno-0-4273">4273</a></span>
<span class="normal"><a href="#__codelineno-0-4274">4274</a></span>
<span class="normal"><a href="#__codelineno-0-4275">4275</a></span>
<span class="normal"><a href="#__codelineno-0-4276">4276</a></span>
<span class="normal"><a href="#__codelineno-0-4277">4277</a></span>
<span class="normal"><a href="#__codelineno-0-4278">4278</a></span>
<span class="normal"><a href="#__codelineno-0-4279">4279</a></span>
<span class="normal"><a href="#__codelineno-0-4280">4280</a></span>
<span class="normal"><a href="#__codelineno-0-4281">4281</a></span>
<span class="normal"><a href="#__codelineno-0-4282">4282</a></span>
<span class="normal"><a href="#__codelineno-0-4283">4283</a></span>
<span class="normal"><a href="#__codelineno-0-4284">4284</a></span>
<span class="normal"><a href="#__codelineno-0-4285">4285</a></span>
<span class="normal"><a href="#__codelineno-0-4286">4286</a></span>
<span class="normal"><a href="#__codelineno-0-4287">4287</a></span>
<span class="normal"><a href="#__codelineno-0-4288">4288</a></span>
<span class="normal"><a href="#__codelineno-0-4289">4289</a></span>
<span class="normal"><a href="#__codelineno-0-4290">4290</a></span>
<span class="normal"><a href="#__codelineno-0-4291">4291</a></span>
<span class="normal"><a href="#__codelineno-0-4292">4292</a></span>
<span class="normal"><a href="#__codelineno-0-4293">4293</a></span>
<span class="normal"><a href="#__codelineno-0-4294">4294</a></span>
<span class="normal"><a href="#__codelineno-0-4295">4295</a></span>
<span class="normal"><a href="#__codelineno-0-4296">4296</a></span>
<span class="normal"><a href="#__codelineno-0-4297">4297</a></span>
<span class="normal"><a href="#__codelineno-0-4298">4298</a></span>
<span class="normal"><a href="#__codelineno-0-4299">4299</a></span>
<span class="normal"><a href="#__codelineno-0-4300">4300</a></span>
<span class="normal"><a href="#__codelineno-0-4301">4301</a></span>
<span class="normal"><a href="#__codelineno-0-4302">4302</a></span>
<span class="normal"><a href="#__codelineno-0-4303">4303</a></span>
<span class="normal"><a href="#__codelineno-0-4304">4304</a></span>
<span class="normal"><a href="#__codelineno-0-4305">4305</a></span>
<span class="normal"><a href="#__codelineno-0-4306">4306</a></span>
<span class="normal"><a href="#__codelineno-0-4307">4307</a></span>
<span class="normal"><a href="#__codelineno-0-4308">4308</a></span>
<span class="normal"><a href="#__codelineno-0-4309">4309</a></span>
<span class="normal"><a href="#__codelineno-0-4310">4310</a></span>
<span class="normal"><a href="#__codelineno-0-4311">4311</a></span>
<span class="normal"><a href="#__codelineno-0-4312">4312</a></span>
<span class="normal"><a href="#__codelineno-0-4313">4313</a></span>
<span class="normal"><a href="#__codelineno-0-4314">4314</a></span>
<span class="normal"><a href="#__codelineno-0-4315">4315</a></span>
<span class="normal"><a href="#__codelineno-0-4316">4316</a></span>
<span class="normal"><a href="#__codelineno-0-4317">4317</a></span>
<span class="normal"><a href="#__codelineno-0-4318">4318</a></span>
<span class="normal"><a href="#__codelineno-0-4319">4319</a></span>
<span class="normal"><a href="#__codelineno-0-4320">4320</a></span>
<span class="normal"><a href="#__codelineno-0-4321">4321</a></span>
<span class="normal"><a href="#__codelineno-0-4322">4322</a></span>
<span class="normal"><a href="#__codelineno-0-4323">4323</a></span>
<span class="normal"><a href="#__codelineno-0-4324">4324</a></span>
<span class="normal"><a href="#__codelineno-0-4325">4325</a></span>
<span class="normal"><a href="#__codelineno-0-4326">4326</a></span>
<span class="normal"><a href="#__codelineno-0-4327">4327</a></span>
<span class="normal"><a href="#__codelineno-0-4328">4328</a></span>
<span class="normal"><a href="#__codelineno-0-4329">4329</a></span>
<span class="normal"><a href="#__codelineno-0-4330">4330</a></span>
<span class="normal"><a href="#__codelineno-0-4331">4331</a></span>
<span class="normal"><a href="#__codelineno-0-4332">4332</a></span>
<span class="normal"><a href="#__codelineno-0-4333">4333</a></span>
<span class="normal"><a href="#__codelineno-0-4334">4334</a></span>
<span class="normal"><a href="#__codelineno-0-4335">4335</a></span>
<span class="normal"><a href="#__codelineno-0-4336">4336</a></span>
<span class="normal"><a href="#__codelineno-0-4337">4337</a></span>
<span class="normal"><a href="#__codelineno-0-4338">4338</a></span>
<span class="normal"><a href="#__codelineno-0-4339">4339</a></span>
<span class="normal"><a href="#__codelineno-0-4340">4340</a></span>
<span class="normal"><a href="#__codelineno-0-4341">4341</a></span>
<span class="normal"><a href="#__codelineno-0-4342">4342</a></span>
<span class="normal"><a href="#__codelineno-0-4343">4343</a></span>
<span class="normal"><a href="#__codelineno-0-4344">4344</a></span>
<span class="normal"><a href="#__codelineno-0-4345">4345</a></span>
<span class="normal"><a href="#__codelineno-0-4346">4346</a></span>
<span class="normal"><a href="#__codelineno-0-4347">4347</a></span>
<span class="normal"><a href="#__codelineno-0-4348">4348</a></span>
<span class="normal"><a href="#__codelineno-0-4349">4349</a></span>
<span class="normal"><a href="#__codelineno-0-4350">4350</a></span>
<span class="normal"><a href="#__codelineno-0-4351">4351</a></span>
<span class="normal"><a href="#__codelineno-0-4352">4352</a></span>
<span class="normal"><a href="#__codelineno-0-4353">4353</a></span>
<span class="normal"><a href="#__codelineno-0-4354">4354</a></span>
<span class="normal"><a href="#__codelineno-0-4355">4355</a></span>
<span class="normal"><a href="#__codelineno-0-4356">4356</a></span>
<span class="normal"><a href="#__codelineno-0-4357">4357</a></span>
<span class="normal"><a href="#__codelineno-0-4358">4358</a></span>
<span class="normal"><a href="#__codelineno-0-4359">4359</a></span>
<span class="normal"><a href="#__codelineno-0-4360">4360</a></span>
<span class="normal"><a href="#__codelineno-0-4361">4361</a></span>
<span class="normal"><a href="#__codelineno-0-4362">4362</a></span>
<span class="normal"><a href="#__codelineno-0-4363">4363</a></span>
<span class="normal"><a href="#__codelineno-0-4364">4364</a></span>
<span class="normal"><a href="#__codelineno-0-4365">4365</a></span>
<span class="normal"><a href="#__codelineno-0-4366">4366</a></span>
<span class="normal"><a href="#__codelineno-0-4367">4367</a></span>
<span class="normal"><a href="#__codelineno-0-4368">4368</a></span>
<span class="normal"><a href="#__codelineno-0-4369">4369</a></span>
<span class="normal"><a href="#__codelineno-0-4370">4370</a></span>
<span class="normal"><a href="#__codelineno-0-4371">4371</a></span>
<span class="normal"><a href="#__codelineno-0-4372">4372</a></span>
<span class="normal"><a href="#__codelineno-0-4373">4373</a></span>
<span class="normal"><a href="#__codelineno-0-4374">4374</a></span>
<span class="normal"><a href="#__codelineno-0-4375">4375</a></span>
<span class="normal"><a href="#__codelineno-0-4376">4376</a></span>
<span class="normal"><a href="#__codelineno-0-4377">4377</a></span>
<span class="normal"><a href="#__codelineno-0-4378">4378</a></span>
<span class="normal"><a href="#__codelineno-0-4379">4379</a></span>
<span class="normal"><a href="#__codelineno-0-4380">4380</a></span>
<span class="normal"><a href="#__codelineno-0-4381">4381</a></span>
<span class="normal"><a href="#__codelineno-0-4382">4382</a></span>
<span class="normal"><a href="#__codelineno-0-4383">4383</a></span>
<span class="normal"><a href="#__codelineno-0-4384">4384</a></span>
<span class="normal"><a href="#__codelineno-0-4385">4385</a></span>
<span class="normal"><a href="#__codelineno-0-4386">4386</a></span>
<span class="normal"><a href="#__codelineno-0-4387">4387</a></span>
<span class="normal"><a href="#__codelineno-0-4388">4388</a></span>
<span class="normal"><a href="#__codelineno-0-4389">4389</a></span>
<span class="normal"><a href="#__codelineno-0-4390">4390</a></span>
<span class="normal"><a href="#__codelineno-0-4391">4391</a></span>
<span class="normal"><a href="#__codelineno-0-4392">4392</a></span>
<span class="normal"><a href="#__codelineno-0-4393">4393</a></span>
<span class="normal"><a href="#__codelineno-0-4394">4394</a></span>
<span class="normal"><a href="#__codelineno-0-4395">4395</a></span>
<span class="normal"><a href="#__codelineno-0-4396">4396</a></span>
<span class="normal"><a href="#__codelineno-0-4397">4397</a></span>
<span class="normal"><a href="#__codelineno-0-4398">4398</a></span>
<span class="normal"><a href="#__codelineno-0-4399">4399</a></span>
<span class="normal"><a href="#__codelineno-0-4400">4400</a></span>
<span class="normal"><a href="#__codelineno-0-4401">4401</a></span>
<span class="normal"><a href="#__codelineno-0-4402">4402</a></span>
<span class="normal"><a href="#__codelineno-0-4403">4403</a></span>
<span class="normal"><a href="#__codelineno-0-4404">4404</a></span>
<span class="normal"><a href="#__codelineno-0-4405">4405</a></span>
<span class="normal"><a href="#__codelineno-0-4406">4406</a></span>
<span class="normal"><a href="#__codelineno-0-4407">4407</a></span>
<span class="normal"><a href="#__codelineno-0-4408">4408</a></span>
<span class="normal"><a href="#__codelineno-0-4409">4409</a></span>
<span class="normal"><a href="#__codelineno-0-4410">4410</a></span>
<span class="normal"><a href="#__codelineno-0-4411">4411</a></span>
<span class="normal"><a href="#__codelineno-0-4412">4412</a></span>
<span class="normal"><a href="#__codelineno-0-4413">4413</a></span>
<span class="normal"><a href="#__codelineno-0-4414">4414</a></span>
<span class="normal"><a href="#__codelineno-0-4415">4415</a></span>
<span class="normal"><a href="#__codelineno-0-4416">4416</a></span>
<span class="normal"><a href="#__codelineno-0-4417">4417</a></span>
<span class="normal"><a href="#__codelineno-0-4418">4418</a></span>
<span class="normal"><a href="#__codelineno-0-4419">4419</a></span>
<span class="normal"><a href="#__codelineno-0-4420">4420</a></span>
<span class="normal"><a href="#__codelineno-0-4421">4421</a></span>
<span class="normal"><a href="#__codelineno-0-4422">4422</a></span>
<span class="normal"><a href="#__codelineno-0-4423">4423</a></span>
<span class="normal"><a href="#__codelineno-0-4424">4424</a></span>
<span class="normal"><a href="#__codelineno-0-4425">4425</a></span>
<span class="normal"><a href="#__codelineno-0-4426">4426</a></span>
<span class="normal"><a href="#__codelineno-0-4427">4427</a></span>
<span class="normal"><a href="#__codelineno-0-4428">4428</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4139"><a id="__codelineno-0-4139" name="__codelineno-0-4139"></a><span class="k">def</span><span class="w"> </span><span class="nf">email_verification</span><span class="p">(</span>
</span><span id="__span-0-4140"><a id="__codelineno-0-4140" name="__codelineno-0-4140"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4141"><a id="__codelineno-0-4141" name="__codelineno-0-4141"></a>    <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4142"><a id="__codelineno-0-4142" name="__codelineno-0-4142"></a>    <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4143"><a id="__codelineno-0-4143" name="__codelineno-0-4143"></a>    <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4144"><a id="__codelineno-0-4144" name="__codelineno-0-4144"></a>    <span class="n">url_search_pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4145"><a id="__codelineno-0-4145" name="__codelineno-0-4145"></a>    <span class="n">line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span>
</span><span id="__span-0-4146"><a id="__codelineno-0-4146" name="__codelineno-0-4146"></a>    <span class="n">multi_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4147"><a id="__codelineno-0-4147" name="__codelineno-0-4147"></a>    <span class="n">multi_line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;%3D&quot;</span><span class="p">,</span>
</span><span id="__span-0-4148"><a id="__codelineno-0-4148" name="__codelineno-0-4148"></a>    <span class="n">replacements</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4149"><a id="__codelineno-0-4149" name="__codelineno-0-4149"></a>    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
</span><span id="__span-0-4150"><a id="__codelineno-0-4150" name="__codelineno-0-4150"></a>    <span class="n">use_browser_automation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4151"><a id="__codelineno-0-4151" name="__codelineno-0-4151"></a>    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4152"><a id="__codelineno-0-4152" name="__codelineno-0-4152"></a>    <span class="n">password_field_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4153"><a id="__codelineno-0-4153" name="__codelineno-0-4153"></a>    <span class="n">password_confirmation_field_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4154"><a id="__codelineno-0-4154" name="__codelineno-0-4154"></a>    <span class="n">password_submit_xpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4155"><a id="__codelineno-0-4155" name="__codelineno-0-4155"></a>    <span class="n">terms_of_service_xpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-4156"><a id="__codelineno-0-4156" name="__codelineno-0-4156"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-4157"><a id="__codelineno-0-4157" name="__codelineno-0-4157"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Process email verification.</span>
</span><span id="__span-0-4158"><a id="__codelineno-0-4158" name="__codelineno-0-4158"></a>
</span><span id="__span-0-4159"><a id="__codelineno-0-4159" name="__codelineno-0-4159"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4160"><a id="__codelineno-0-4160" name="__codelineno-0-4160"></a><span class="sd">        user_email (str):</span>
</span><span id="__span-0-4161"><a id="__codelineno-0-4161" name="__codelineno-0-4161"></a><span class="sd">            Email address of user recieving the verification mail.</span>
</span><span id="__span-0-4162"><a id="__codelineno-0-4162" name="__codelineno-0-4162"></a><span class="sd">        sender (str):</span>
</span><span id="__span-0-4163"><a id="__codelineno-0-4163" name="__codelineno-0-4163"></a><span class="sd">            Email sender (address)</span>
</span><span id="__span-0-4164"><a id="__codelineno-0-4164" name="__codelineno-0-4164"></a><span class="sd">        subject (str):</span>
</span><span id="__span-0-4165"><a id="__codelineno-0-4165" name="__codelineno-0-4165"></a><span class="sd">            Email subject to look for (can be substring)</span>
</span><span id="__span-0-4166"><a id="__codelineno-0-4166" name="__codelineno-0-4166"></a><span class="sd">        url_search_pattern (str):</span>
</span><span id="__span-0-4167"><a id="__codelineno-0-4167" name="__codelineno-0-4167"></a><span class="sd">            String the URL needs to contain to identify it.</span>
</span><span id="__span-0-4168"><a id="__codelineno-0-4168" name="__codelineno-0-4168"></a><span class="sd">        line_end_marker (str, optional):</span>
</span><span id="__span-0-4169"><a id="__codelineno-0-4169" name="__codelineno-0-4169"></a><span class="sd">            The character that marks line ends in the mail.</span>
</span><span id="__span-0-4170"><a id="__codelineno-0-4170" name="__codelineno-0-4170"></a><span class="sd">        multi_line (bool, optional):</span>
</span><span id="__span-0-4171"><a id="__codelineno-0-4171" name="__codelineno-0-4171"></a><span class="sd">            Whether or not this is a multi-line mail.</span>
</span><span id="__span-0-4172"><a id="__codelineno-0-4172" name="__codelineno-0-4172"></a><span class="sd">        multi_line_end_marker (str, optional):</span>
</span><span id="__span-0-4173"><a id="__codelineno-0-4173" name="__codelineno-0-4173"></a><span class="sd">            If the URL spans multiple lines this is the &quot;end&quot; marker for the last line.</span>
</span><span id="__span-0-4174"><a id="__codelineno-0-4174" name="__codelineno-0-4174"></a><span class="sd">        replacements (list, optional):</span>
</span><span id="__span-0-4175"><a id="__codelineno-0-4175" name="__codelineno-0-4175"></a><span class="sd">            If the URL needs some treatment these replacements can be applied.</span>
</span><span id="__span-0-4176"><a id="__codelineno-0-4176" name="__codelineno-0-4176"></a><span class="sd">        max_retries (int, optional):</span>
</span><span id="__span-0-4177"><a id="__codelineno-0-4177" name="__codelineno-0-4177"></a><span class="sd">            The number of retries in case of an error.</span>
</span><span id="__span-0-4178"><a id="__codelineno-0-4178" name="__codelineno-0-4178"></a><span class="sd">        use_browser_automation (bool, optional):</span>
</span><span id="__span-0-4179"><a id="__codelineno-0-4179" name="__codelineno-0-4179"></a><span class="sd">            If Selenium-based browser automation should be used or not. Default = False.</span>
</span><span id="__span-0-4180"><a id="__codelineno-0-4180" name="__codelineno-0-4180"></a><span class="sd">        password (str, optional):</span>
</span><span id="__span-0-4181"><a id="__codelineno-0-4181" name="__codelineno-0-4181"></a><span class="sd">            In case a password is required for browser automation. Default = &quot;&quot;,</span>
</span><span id="__span-0-4182"><a id="__codelineno-0-4182" name="__codelineno-0-4182"></a><span class="sd">        password_field_id (str, optional):</span>
</span><span id="__span-0-4183"><a id="__codelineno-0-4183" name="__codelineno-0-4183"></a><span class="sd">            The password field name in the HTML page of a confirmation dialog. Default = &quot;&quot;,</span>
</span><span id="__span-0-4184"><a id="__codelineno-0-4184" name="__codelineno-0-4184"></a><span class="sd">        password_confirmation_field_id (str, optional):</span>
</span><span id="__span-0-4185"><a id="__codelineno-0-4185" name="__codelineno-0-4185"></a><span class="sd">            The password confirmation field name in the HTML page of a confirmation dialog.</span>
</span><span id="__span-0-4186"><a id="__codelineno-0-4186" name="__codelineno-0-4186"></a><span class="sd">            Default = &quot;&quot;.</span>
</span><span id="__span-0-4187"><a id="__codelineno-0-4187" name="__codelineno-0-4187"></a><span class="sd">        password_submit_xpath (str, optional):</span>
</span><span id="__span-0-4188"><a id="__codelineno-0-4188" name="__codelineno-0-4188"></a><span class="sd">            Default = &quot;&quot;.</span>
</span><span id="__span-0-4189"><a id="__codelineno-0-4189" name="__codelineno-0-4189"></a><span class="sd">        terms_of_service_xpath (str, optional):</span>
</span><span id="__span-0-4190"><a id="__codelineno-0-4190" name="__codelineno-0-4190"></a><span class="sd">            Default = &quot;&quot;.</span>
</span><span id="__span-0-4191"><a id="__codelineno-0-4191" name="__codelineno-0-4191"></a>
</span><span id="__span-0-4192"><a id="__codelineno-0-4192" name="__codelineno-0-4192"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4193"><a id="__codelineno-0-4193" name="__codelineno-0-4193"></a><span class="sd">        bool:</span>
</span><span id="__span-0-4194"><a id="__codelineno-0-4194" name="__codelineno-0-4194"></a><span class="sd">            True = Success, False = Failure.</span>
</span><span id="__span-0-4195"><a id="__codelineno-0-4195" name="__codelineno-0-4195"></a>
</span><span id="__span-0-4196"><a id="__codelineno-0-4196" name="__codelineno-0-4196"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4197"><a id="__codelineno-0-4197" name="__codelineno-0-4197"></a>
</span><span id="__span-0-4198"><a id="__codelineno-0-4198" name="__codelineno-0-4198"></a>    <span class="c1"># Determine the M365 user for the current user by</span>
</span><span id="__span-0-4199"><a id="__codelineno-0-4199" name="__codelineno-0-4199"></a>    <span class="c1"># the email address:</span>
</span><span id="__span-0-4200"><a id="__codelineno-0-4200" name="__codelineno-0-4200"></a>    <span class="n">m365_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_email</span><span class="o">=</span><span class="n">user_email</span><span class="p">)</span>
</span><span id="__span-0-4201"><a id="__codelineno-0-4201" name="__codelineno-0-4201"></a>    <span class="n">m365_user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">m365_user</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-4202"><a id="__codelineno-0-4202" name="__codelineno-0-4202"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">m365_user_id</span><span class="p">:</span>
</span><span id="__span-0-4203"><a id="__codelineno-0-4203" name="__codelineno-0-4203"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot find M365 user -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">user_email</span><span class="p">)</span>
</span><span id="__span-0-4204"><a id="__codelineno-0-4204" name="__codelineno-0-4204"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4205"><a id="__codelineno-0-4205" name="__codelineno-0-4205"></a>
</span><span id="__span-0-4206"><a id="__codelineno-0-4206" name="__codelineno-0-4206"></a>    <span class="k">if</span> <span class="n">replacements</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4207"><a id="__codelineno-0-4207" name="__codelineno-0-4207"></a>        <span class="n">replacements</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;=3D&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span><span class="p">}]</span>
</span><span id="__span-0-4208"><a id="__codelineno-0-4208" name="__codelineno-0-4208"></a>
</span><span id="__span-0-4209"><a id="__codelineno-0-4209" name="__codelineno-0-4209"></a>    <span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-4210"><a id="__codelineno-0-4210" name="__codelineno-0-4210"></a>    <span class="k">while</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">max_retries</span><span class="p">:</span>
</span><span id="__span-0-4211"><a id="__codelineno-0-4211" name="__codelineno-0-4211"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mail</span><span class="p">(</span>
</span><span id="__span-0-4212"><a id="__codelineno-0-4212" name="__codelineno-0-4212"></a>            <span class="n">user_id</span><span class="o">=</span><span class="n">m365_user_id</span><span class="p">,</span>
</span><span id="__span-0-4213"><a id="__codelineno-0-4213" name="__codelineno-0-4213"></a>            <span class="n">sender</span><span class="o">=</span><span class="n">sender</span><span class="p">,</span>
</span><span id="__span-0-4214"><a id="__codelineno-0-4214" name="__codelineno-0-4214"></a>            <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span>
</span><span id="__span-0-4215"><a id="__codelineno-0-4215" name="__codelineno-0-4215"></a>            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4216"><a id="__codelineno-0-4216" name="__codelineno-0-4216"></a>        <span class="p">)</span>
</span><span id="__span-0-4217"><a id="__codelineno-0-4217" name="__codelineno-0-4217"></a>        <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]:</span>
</span><span id="__span-0-4218"><a id="__codelineno-0-4218" name="__codelineno-0-4218"></a>            <span class="n">emails</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-4219"><a id="__codelineno-0-4219" name="__codelineno-0-4219"></a>            <span class="c1"># potentially there may be multiple matching emails,</span>
</span><span id="__span-0-4220"><a id="__codelineno-0-4220" name="__codelineno-0-4220"></a>            <span class="c1"># we want the most recent one (from today):</span>
</span><span id="__span-0-4221"><a id="__codelineno-0-4221" name="__codelineno-0-4221"></a>            <span class="n">latest_email</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">emails</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;receivedDateTime&quot;</span><span class="p">])</span>
</span><span id="__span-0-4222"><a id="__codelineno-0-4222" name="__codelineno-0-4222"></a>            <span class="c1"># Extract just the date:</span>
</span><span id="__span-0-4223"><a id="__codelineno-0-4223" name="__codelineno-0-4223"></a>            <span class="n">latest_email_date</span> <span class="o">=</span> <span class="n">latest_email</span><span class="p">[</span><span class="s2">&quot;receivedDateTime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-4224"><a id="__codelineno-0-4224" name="__codelineno-0-4224"></a>            <span class="c1"># Get the current date (today):</span>
</span><span id="__span-0-4225"><a id="__codelineno-0-4225" name="__codelineno-0-4225"></a>            <span class="n">today_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-4226"><a id="__codelineno-0-4226" name="__codelineno-0-4226"></a>            <span class="c1"># We do a sanity check here: the verification mail should be from today,</span>
</span><span id="__span-0-4227"><a id="__codelineno-0-4227" name="__codelineno-0-4227"></a>            <span class="c1"># otherwise we assume it is an old mail and we need to wait for the</span>
</span><span id="__span-0-4228"><a id="__codelineno-0-4228" name="__codelineno-0-4228"></a>            <span class="c1"># new verification mail to yet arrive:</span>
</span><span id="__span-0-4229"><a id="__codelineno-0-4229" name="__codelineno-0-4229"></a>            <span class="k">if</span> <span class="n">latest_email_date</span> <span class="o">!=</span> <span class="n">today_date</span><span class="p">:</span>
</span><span id="__span-0-4230"><a id="__codelineno-0-4230" name="__codelineno-0-4230"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4231"><a id="__codelineno-0-4231" name="__codelineno-0-4231"></a>                    <span class="s2">&quot;Verification email not yet received (latest mail from -&gt; </span><span class="si">%s</span><span class="s2">). Waiting </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4232"><a id="__codelineno-0-4232" name="__codelineno-0-4232"></a>                    <span class="n">latest_email_date</span><span class="p">,</span>
</span><span id="__span-0-4233"><a id="__codelineno-0-4233" name="__codelineno-0-4233"></a>                    <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-0-4234"><a id="__codelineno-0-4234" name="__codelineno-0-4234"></a>                <span class="p">)</span>
</span><span id="__span-0-4235"><a id="__codelineno-0-4235" name="__codelineno-0-4235"></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-4236"><a id="__codelineno-0-4236" name="__codelineno-0-4236"></a>                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-4237"><a id="__codelineno-0-4237" name="__codelineno-0-4237"></a>                <span class="k">continue</span>
</span><span id="__span-0-4238"><a id="__codelineno-0-4238" name="__codelineno-0-4238"></a>            <span class="n">email_id</span> <span class="o">=</span> <span class="n">latest_email</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-4239"><a id="__codelineno-0-4239" name="__codelineno-0-4239"></a>            <span class="c1"># The full email body needs to be loaded with a separate REST call:</span>
</span><span id="__span-0-4240"><a id="__codelineno-0-4240" name="__codelineno-0-4240"></a>            <span class="n">body_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mail_body</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">m365_user_id</span><span class="p">,</span> <span class="n">email_id</span><span class="o">=</span><span class="n">email_id</span><span class="p">)</span>
</span><span id="__span-0-4241"><a id="__codelineno-0-4241" name="__codelineno-0-4241"></a>            <span class="c1"># Extract the verification URL.</span>
</span><span id="__span-0-4242"><a id="__codelineno-0-4242" name="__codelineno-0-4242"></a>            <span class="k">if</span> <span class="n">body_text</span><span class="p">:</span>
</span><span id="__span-0-4243"><a id="__codelineno-0-4243" name="__codelineno-0-4243"></a>                <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_url_from_message_body</span><span class="p">(</span>
</span><span id="__span-0-4244"><a id="__codelineno-0-4244" name="__codelineno-0-4244"></a>                    <span class="n">message_body</span><span class="o">=</span><span class="n">body_text</span><span class="p">,</span>
</span><span id="__span-0-4245"><a id="__codelineno-0-4245" name="__codelineno-0-4245"></a>                    <span class="n">search_pattern</span><span class="o">=</span><span class="n">url_search_pattern</span><span class="p">,</span>
</span><span id="__span-0-4246"><a id="__codelineno-0-4246" name="__codelineno-0-4246"></a>                    <span class="n">line_end_marker</span><span class="o">=</span><span class="n">line_end_marker</span><span class="p">,</span>
</span><span id="__span-0-4247"><a id="__codelineno-0-4247" name="__codelineno-0-4247"></a>                    <span class="n">multi_line</span><span class="o">=</span><span class="n">multi_line</span><span class="p">,</span>
</span><span id="__span-0-4248"><a id="__codelineno-0-4248" name="__codelineno-0-4248"></a>                    <span class="n">multi_line_end_marker</span><span class="o">=</span><span class="n">multi_line_end_marker</span><span class="p">,</span>
</span><span id="__span-0-4249"><a id="__codelineno-0-4249" name="__codelineno-0-4249"></a>                    <span class="n">replacements</span><span class="o">=</span><span class="n">replacements</span><span class="p">,</span>
</span><span id="__span-0-4250"><a id="__codelineno-0-4250" name="__codelineno-0-4250"></a>                <span class="p">)</span>
</span><span id="__span-0-4251"><a id="__codelineno-0-4251" name="__codelineno-0-4251"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4252"><a id="__codelineno-0-4252" name="__codelineno-0-4252"></a>                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-4253"><a id="__codelineno-0-4253" name="__codelineno-0-4253"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
</span><span id="__span-0-4254"><a id="__codelineno-0-4254" name="__codelineno-0-4254"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-4255"><a id="__codelineno-0-4255" name="__codelineno-0-4255"></a>                    <span class="s2">&quot;Cannot find verification link in the email body!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4256"><a id="__codelineno-0-4256" name="__codelineno-0-4256"></a>                <span class="p">)</span>
</span><span id="__span-0-4257"><a id="__codelineno-0-4257" name="__codelineno-0-4257"></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4258"><a id="__codelineno-0-4258" name="__codelineno-0-4258"></a>            <span class="c1"># Simulate a &quot;click&quot; on this URL:</span>
</span><span id="__span-0-4259"><a id="__codelineno-0-4259" name="__codelineno-0-4259"></a>            <span class="k">if</span> <span class="n">use_browser_automation</span><span class="p">:</span>
</span><span id="__span-0-4260"><a id="__codelineno-0-4260" name="__codelineno-0-4260"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using browser automation for email verification...&quot;</span><span class="p">)</span>
</span><span id="__span-0-4261"><a id="__codelineno-0-4261" name="__codelineno-0-4261"></a>                <span class="c1"># Core Share needs a full browser:</span>
</span><span id="__span-0-4262"><a id="__codelineno-0-4262" name="__codelineno-0-4262"></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-4263"><a id="__codelineno-0-4263" name="__codelineno-0-4263"></a>                    <span class="n">browser_automation_object</span> <span class="o">=</span> <span class="n">BrowserAutomation</span><span class="p">(</span>
</span><span id="__span-0-4264"><a id="__codelineno-0-4264" name="__codelineno-0-4264"></a>                        <span class="n">take_screenshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4265"><a id="__codelineno-0-4265" name="__codelineno-0-4265"></a>                        <span class="n">automation_name</span><span class="o">=</span><span class="s2">&quot;email-verification&quot;</span><span class="p">,</span>
</span><span id="__span-0-4266"><a id="__codelineno-0-4266" name="__codelineno-0-4266"></a>                        <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">,</span>
</span><span id="__span-0-4267"><a id="__codelineno-0-4267" name="__codelineno-0-4267"></a>                    <span class="p">)</span>
</span><span id="__span-0-4268"><a id="__codelineno-0-4268" name="__codelineno-0-4268"></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="__span-0-4269"><a id="__codelineno-0-4269" name="__codelineno-0-4269"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create browser automation object. Bailing out...&quot;</span><span class="p">)</span>
</span><span id="__span-0-4270"><a id="__codelineno-0-4270" name="__codelineno-0-4270"></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4271"><a id="__codelineno-0-4271" name="__codelineno-0-4271"></a>
</span><span id="__span-0-4272"><a id="__codelineno-0-4272" name="__codelineno-0-4272"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4273"><a id="__codelineno-0-4273" name="__codelineno-0-4273"></a>                    <span class="s2">&quot;Open URL -&gt; </span><span class="si">%s</span><span class="s2"> to verify account or email change...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4274"><a id="__codelineno-0-4274" name="__codelineno-0-4274"></a>                    <span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-4275"><a id="__codelineno-0-4275" name="__codelineno-0-4275"></a>                <span class="p">)</span>
</span><span id="__span-0-4276"><a id="__codelineno-0-4276" name="__codelineno-0-4276"></a>                <span class="n">success</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">get_page</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</span><span id="__span-0-4277"><a id="__codelineno-0-4277" name="__codelineno-0-4277"></a>                <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="__span-0-4278"><a id="__codelineno-0-4278" name="__codelineno-0-4278"></a>                    <span class="n">user_interaction_required</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4279"><a id="__codelineno-0-4279" name="__codelineno-0-4279"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4280"><a id="__codelineno-0-4280" name="__codelineno-0-4280"></a>                        <span class="s2">&quot;Successfully opened URL. Browser title is -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4281"><a id="__codelineno-0-4281" name="__codelineno-0-4281"></a>                        <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span>
</span><span id="__span-0-4282"><a id="__codelineno-0-4282" name="__codelineno-0-4282"></a>                    <span class="p">)</span>
</span><span id="__span-0-4283"><a id="__codelineno-0-4283" name="__codelineno-0-4283"></a>                    <span class="k">if</span> <span class="n">password_field_id</span><span class="p">:</span>
</span><span id="__span-0-4284"><a id="__codelineno-0-4284" name="__codelineno-0-4284"></a>                        <span class="n">password_field</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4285"><a id="__codelineno-0-4285" name="__codelineno-0-4285"></a>                            <span class="n">selector</span><span class="o">=</span><span class="n">password_field_id</span><span class="p">,</span>
</span><span id="__span-0-4286"><a id="__codelineno-0-4286" name="__codelineno-0-4286"></a>                            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4287"><a id="__codelineno-0-4287" name="__codelineno-0-4287"></a>                        <span class="p">)</span>
</span><span id="__span-0-4288"><a id="__codelineno-0-4288" name="__codelineno-0-4288"></a>                        <span class="k">if</span> <span class="n">password_field</span><span class="p">:</span>
</span><span id="__span-0-4289"><a id="__codelineno-0-4289" name="__codelineno-0-4289"></a>                            <span class="c1"># The subsequent processing is only required if</span>
</span><span id="__span-0-4290"><a id="__codelineno-0-4290" name="__codelineno-0-4290"></a>                            <span class="c1"># the returned page requests a password change:</span>
</span><span id="__span-0-4291"><a id="__codelineno-0-4291" name="__codelineno-0-4291"></a>                            <span class="n">user_interaction_required</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-4292"><a id="__codelineno-0-4292" name="__codelineno-0-4292"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4293"><a id="__codelineno-0-4293" name="__codelineno-0-4293"></a>                                <span class="s2">&quot;Found password field on returned page - it seems email verification requests password entry!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4294"><a id="__codelineno-0-4294" name="__codelineno-0-4294"></a>                            <span class="p">)</span>
</span><span id="__span-0-4295"><a id="__codelineno-0-4295" name="__codelineno-0-4295"></a>                            <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_set</span><span class="p">(</span>
</span><span id="__span-0-4296"><a id="__codelineno-0-4296" name="__codelineno-0-4296"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">password_field_id</span><span class="p">,</span>
</span><span id="__span-0-4297"><a id="__codelineno-0-4297" name="__codelineno-0-4297"></a>                                <span class="n">value</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-4298"><a id="__codelineno-0-4298" name="__codelineno-0-4298"></a>                                <span class="n">is_sensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4299"><a id="__codelineno-0-4299" name="__codelineno-0-4299"></a>                            <span class="p">)</span>
</span><span id="__span-0-4300"><a id="__codelineno-0-4300" name="__codelineno-0-4300"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4301"><a id="__codelineno-0-4301" name="__codelineno-0-4301"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4302"><a id="__codelineno-0-4302" name="__codelineno-0-4302"></a>                                    <span class="s2">&quot;Failed to enter password in field -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4303"><a id="__codelineno-0-4303" name="__codelineno-0-4303"></a>                                    <span class="n">password_field_id</span><span class="p">,</span>
</span><span id="__span-0-4304"><a id="__codelineno-0-4304" name="__codelineno-0-4304"></a>                                <span class="p">)</span>
</span><span id="__span-0-4305"><a id="__codelineno-0-4305" name="__codelineno-0-4305"></a>                                <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4306"><a id="__codelineno-0-4306" name="__codelineno-0-4306"></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4307"><a id="__codelineno-0-4307" name="__codelineno-0-4307"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4308"><a id="__codelineno-0-4308" name="__codelineno-0-4308"></a>                                <span class="s2">&quot;No user interaction required (no password change or terms of service acceptance).&quot;</span><span class="p">,</span>
</span><span id="__span-0-4309"><a id="__codelineno-0-4309" name="__codelineno-0-4309"></a>                            <span class="p">)</span>
</span><span id="__span-0-4310"><a id="__codelineno-0-4310" name="__codelineno-0-4310"></a>                    <span class="k">if</span> <span class="n">user_interaction_required</span> <span class="ow">and</span> <span class="n">password_confirmation_field_id</span><span class="p">:</span>
</span><span id="__span-0-4311"><a id="__codelineno-0-4311" name="__codelineno-0-4311"></a>                        <span class="n">password_confirm_field</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4312"><a id="__codelineno-0-4312" name="__codelineno-0-4312"></a>                            <span class="n">selector</span><span class="o">=</span><span class="n">password_confirmation_field_id</span><span class="p">,</span>
</span><span id="__span-0-4313"><a id="__codelineno-0-4313" name="__codelineno-0-4313"></a>                            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4314"><a id="__codelineno-0-4314" name="__codelineno-0-4314"></a>                        <span class="p">)</span>
</span><span id="__span-0-4315"><a id="__codelineno-0-4315" name="__codelineno-0-4315"></a>                        <span class="k">if</span> <span class="n">password_confirm_field</span><span class="p">:</span>
</span><span id="__span-0-4316"><a id="__codelineno-0-4316" name="__codelineno-0-4316"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4317"><a id="__codelineno-0-4317" name="__codelineno-0-4317"></a>                                <span class="s2">&quot;Found password confirmation field on returned page - it seems email verification requests consecutive password.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4318"><a id="__codelineno-0-4318" name="__codelineno-0-4318"></a>                            <span class="p">)</span>
</span><span id="__span-0-4319"><a id="__codelineno-0-4319" name="__codelineno-0-4319"></a>                            <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_set</span><span class="p">(</span>
</span><span id="__span-0-4320"><a id="__codelineno-0-4320" name="__codelineno-0-4320"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">password_confirmation_field_id</span><span class="p">,</span>
</span><span id="__span-0-4321"><a id="__codelineno-0-4321" name="__codelineno-0-4321"></a>                                <span class="n">value</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
</span><span id="__span-0-4322"><a id="__codelineno-0-4322" name="__codelineno-0-4322"></a>                                <span class="n">is_sensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4323"><a id="__codelineno-0-4323" name="__codelineno-0-4323"></a>                            <span class="p">)</span>
</span><span id="__span-0-4324"><a id="__codelineno-0-4324" name="__codelineno-0-4324"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4325"><a id="__codelineno-0-4325" name="__codelineno-0-4325"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4326"><a id="__codelineno-0-4326" name="__codelineno-0-4326"></a>                                    <span class="s2">&quot;Failed to enter password in field -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4327"><a id="__codelineno-0-4327" name="__codelineno-0-4327"></a>                                    <span class="n">password_confirmation_field_id</span><span class="p">,</span>
</span><span id="__span-0-4328"><a id="__codelineno-0-4328" name="__codelineno-0-4328"></a>                                <span class="p">)</span>
</span><span id="__span-0-4329"><a id="__codelineno-0-4329" name="__codelineno-0-4329"></a>                                <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4330"><a id="__codelineno-0-4330" name="__codelineno-0-4330"></a>                    <span class="k">if</span> <span class="n">user_interaction_required</span> <span class="ow">and</span> <span class="n">password_submit_xpath</span><span class="p">:</span>
</span><span id="__span-0-4331"><a id="__codelineno-0-4331" name="__codelineno-0-4331"></a>                        <span class="n">password_submit_button</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4332"><a id="__codelineno-0-4332" name="__codelineno-0-4332"></a>                            <span class="n">selector</span><span class="o">=</span><span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4333"><a id="__codelineno-0-4333" name="__codelineno-0-4333"></a>                            <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4334"><a id="__codelineno-0-4334" name="__codelineno-0-4334"></a>                            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4335"><a id="__codelineno-0-4335" name="__codelineno-0-4335"></a>                        <span class="p">)</span>
</span><span id="__span-0-4336"><a id="__codelineno-0-4336" name="__codelineno-0-4336"></a>                        <span class="k">if</span> <span class="n">password_submit_button</span><span class="p">:</span>
</span><span id="__span-0-4337"><a id="__codelineno-0-4337" name="__codelineno-0-4337"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4338"><a id="__codelineno-0-4338" name="__codelineno-0-4338"></a>                                <span class="s2">&quot;Submit password change dialog with button -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (found with XPath -&gt; </span><span class="si">%s</span><span class="s2">).&quot;</span><span class="p">,</span>
</span><span id="__span-0-4339"><a id="__codelineno-0-4339" name="__codelineno-0-4339"></a>                                <span class="n">password_submit_button</span><span class="o">.</span><span class="n">inner_text</span><span class="p">(),</span>
</span><span id="__span-0-4340"><a id="__codelineno-0-4340" name="__codelineno-0-4340"></a>                                <span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4341"><a id="__codelineno-0-4341" name="__codelineno-0-4341"></a>                            <span class="p">)</span>
</span><span id="__span-0-4342"><a id="__codelineno-0-4342" name="__codelineno-0-4342"></a>                            <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_click</span><span class="p">(</span>
</span><span id="__span-0-4343"><a id="__codelineno-0-4343" name="__codelineno-0-4343"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4344"><a id="__codelineno-0-4344" name="__codelineno-0-4344"></a>                                <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4345"><a id="__codelineno-0-4345" name="__codelineno-0-4345"></a>                            <span class="p">)</span>
</span><span id="__span-0-4346"><a id="__codelineno-0-4346" name="__codelineno-0-4346"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4347"><a id="__codelineno-0-4347" name="__codelineno-0-4347"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4348"><a id="__codelineno-0-4348" name="__codelineno-0-4348"></a>                                    <span class="s2">&quot;Failed to press submit button -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-4349"><a id="__codelineno-0-4349" name="__codelineno-0-4349"></a>                                    <span class="n">password_submit_xpath</span><span class="p">,</span>
</span><span id="__span-0-4350"><a id="__codelineno-0-4350" name="__codelineno-0-4350"></a>                                <span class="p">)</span>
</span><span id="__span-0-4351"><a id="__codelineno-0-4351" name="__codelineno-0-4351"></a>                                <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4352"><a id="__codelineno-0-4352" name="__codelineno-0-4352"></a>                        <span class="c1"># The Terms of service dialog has some weird animation</span>
</span><span id="__span-0-4353"><a id="__codelineno-0-4353" name="__codelineno-0-4353"></a>                        <span class="c1"># which require a short wait time. It seems it is required!</span>
</span><span id="__span-0-4354"><a id="__codelineno-0-4354" name="__codelineno-0-4354"></a>                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-4355"><a id="__codelineno-0-4355" name="__codelineno-0-4355"></a>                        <span class="n">terms_accept_button</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem</span><span class="p">(</span>
</span><span id="__span-0-4356"><a id="__codelineno-0-4356" name="__codelineno-0-4356"></a>                            <span class="n">selector</span><span class="o">=</span><span class="n">terms_of_service_xpath</span><span class="p">,</span>
</span><span id="__span-0-4357"><a id="__codelineno-0-4357" name="__codelineno-0-4357"></a>                            <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4358"><a id="__codelineno-0-4358" name="__codelineno-0-4358"></a>                            <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4359"><a id="__codelineno-0-4359" name="__codelineno-0-4359"></a>                        <span class="p">)</span>
</span><span id="__span-0-4360"><a id="__codelineno-0-4360" name="__codelineno-0-4360"></a>                        <span class="k">if</span> <span class="n">terms_accept_button</span><span class="p">:</span>
</span><span id="__span-0-4361"><a id="__codelineno-0-4361" name="__codelineno-0-4361"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4362"><a id="__codelineno-0-4362" name="__codelineno-0-4362"></a>                                <span class="s2">&quot;Accept terms of service with button -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (found with XPath -&gt; </span><span class="si">%s</span><span class="s2">).&quot;</span><span class="p">,</span>
</span><span id="__span-0-4363"><a id="__codelineno-0-4363" name="__codelineno-0-4363"></a>                                <span class="n">terms_accept_button</span><span class="o">.</span><span class="n">inner_text</span><span class="p">(),</span>
</span><span id="__span-0-4364"><a id="__codelineno-0-4364" name="__codelineno-0-4364"></a>                                <span class="n">terms_of_service_xpath</span><span class="p">,</span>
</span><span id="__span-0-4365"><a id="__codelineno-0-4365" name="__codelineno-0-4365"></a>                            <span class="p">)</span>
</span><span id="__span-0-4366"><a id="__codelineno-0-4366" name="__codelineno-0-4366"></a>                            <span class="n">result</span> <span class="o">=</span> <span class="n">browser_automation_object</span><span class="o">.</span><span class="n">find_elem_and_click</span><span class="p">(</span>
</span><span id="__span-0-4367"><a id="__codelineno-0-4367" name="__codelineno-0-4367"></a>                                <span class="n">selector</span><span class="o">=</span><span class="n">terms_of_service_xpath</span><span class="p">,</span>
</span><span id="__span-0-4368"><a id="__codelineno-0-4368" name="__codelineno-0-4368"></a>                                <span class="n">selector_type</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span>
</span><span id="__span-0-4369"><a id="__codelineno-0-4369" name="__codelineno-0-4369"></a>                            <span class="p">)</span>
</span><span id="__span-0-4370"><a id="__codelineno-0-4370" name="__codelineno-0-4370"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-4371"><a id="__codelineno-0-4371" name="__codelineno-0-4371"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4372"><a id="__codelineno-0-4372" name="__codelineno-0-4372"></a>                                    <span class="s2">&quot;Failed to accept terms of service with button -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4373"><a id="__codelineno-0-4373" name="__codelineno-0-4373"></a>                                    <span class="n">terms_accept_button</span><span class="o">.</span><span class="n">inner_text</span><span class="p">(),</span>
</span><span id="__span-0-4374"><a id="__codelineno-0-4374" name="__codelineno-0-4374"></a>                                <span class="p">)</span>
</span><span id="__span-0-4375"><a id="__codelineno-0-4375" name="__codelineno-0-4375"></a>                                <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4376"><a id="__codelineno-0-4376" name="__codelineno-0-4376"></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4377"><a id="__codelineno-0-4377" name="__codelineno-0-4377"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4378"><a id="__codelineno-0-4378" name="__codelineno-0-4378"></a>                                <span class="s2">&quot;No Terms of Service acceptance required.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4379"><a id="__codelineno-0-4379" name="__codelineno-0-4379"></a>                            <span class="p">)</span>
</span><span id="__span-0-4380"><a id="__codelineno-0-4380" name="__codelineno-0-4380"></a>                    <span class="c1"># end if user_interaction_required and password_submit_xpath:</span>
</span><span id="__span-0-4381"><a id="__codelineno-0-4381" name="__codelineno-0-4381"></a>                <span class="c1"># end if success:</span>
</span><span id="__span-0-4382"><a id="__codelineno-0-4382" name="__codelineno-0-4382"></a>            <span class="c1"># end if use_browser_automation</span>
</span><span id="__span-0-4383"><a id="__codelineno-0-4383" name="__codelineno-0-4383"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4384"><a id="__codelineno-0-4384" name="__codelineno-0-4384"></a>                <span class="c1"># Salesforce (other than Core Share) is OK with the simple HTTP GET request:</span>
</span><span id="__span-0-4385"><a id="__codelineno-0-4385" name="__codelineno-0-4385"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4386"><a id="__codelineno-0-4386" name="__codelineno-0-4386"></a>                    <span class="s2">&quot;Open URL -&gt; </span><span class="si">%s</span><span class="s2"> to verify account or email change...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4387"><a id="__codelineno-0-4387" name="__codelineno-0-4387"></a>                    <span class="n">url</span><span class="p">,</span>
</span><span id="__span-0-4388"><a id="__codelineno-0-4388" name="__codelineno-0-4388"></a>                <span class="p">)</span>
</span><span id="__span-0-4389"><a id="__codelineno-0-4389" name="__codelineno-0-4389"></a>                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_object</span><span class="o">.</span><span class="n">http_request</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">)</span>
</span><span id="__span-0-4390"><a id="__codelineno-0-4390" name="__codelineno-0-4390"></a>                <span class="n">success</span> <span class="o">=</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span>
</span><span id="__span-0-4391"><a id="__codelineno-0-4391" name="__codelineno-0-4391"></a>
</span><span id="__span-0-4392"><a id="__codelineno-0-4392" name="__codelineno-0-4392"></a>            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span id="__span-0-4393"><a id="__codelineno-0-4393" name="__codelineno-0-4393"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4394"><a id="__codelineno-0-4394" name="__codelineno-0-4394"></a>                    <span class="s2">&quot;Remove email from inbox of user -&gt; </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4395"><a id="__codelineno-0-4395" name="__codelineno-0-4395"></a>                    <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4396"><a id="__codelineno-0-4396" name="__codelineno-0-4396"></a>                <span class="p">)</span>
</span><span id="__span-0-4397"><a id="__codelineno-0-4397" name="__codelineno-0-4397"></a>                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_mail</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">m365_user_id</span><span class="p">,</span> <span class="n">email_id</span><span class="o">=</span><span class="n">email_id</span><span class="p">)</span>
</span><span id="__span-0-4398"><a id="__codelineno-0-4398" name="__codelineno-0-4398"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-4399"><a id="__codelineno-0-4399" name="__codelineno-0-4399"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-4400"><a id="__codelineno-0-4400" name="__codelineno-0-4400"></a>                        <span class="s2">&quot;Couldn&#39;t remove the mail from the inbox of user -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4401"><a id="__codelineno-0-4401" name="__codelineno-0-4401"></a>                        <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4402"><a id="__codelineno-0-4402" name="__codelineno-0-4402"></a>                    <span class="p">)</span>
</span><span id="__span-0-4403"><a id="__codelineno-0-4403" name="__codelineno-0-4403"></a>                <span class="c1"># We have success now and can break from the while loop</span>
</span><span id="__span-0-4404"><a id="__codelineno-0-4404" name="__codelineno-0-4404"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-4405"><a id="__codelineno-0-4405" name="__codelineno-0-4405"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4406"><a id="__codelineno-0-4406" name="__codelineno-0-4406"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-4407"><a id="__codelineno-0-4407" name="__codelineno-0-4407"></a>                    <span class="s2">&quot;Failed to process e-mail verification for user -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-4408"><a id="__codelineno-0-4408" name="__codelineno-0-4408"></a>                    <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4409"><a id="__codelineno-0-4409" name="__codelineno-0-4409"></a>                <span class="p">)</span>
</span><span id="__span-0-4410"><a id="__codelineno-0-4410" name="__codelineno-0-4410"></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-4411"><a id="__codelineno-0-4411" name="__codelineno-0-4411"></a>        <span class="c1"># end if response and response[&quot;value&quot;]</span>
</span><span id="__span-0-4412"><a id="__codelineno-0-4412" name="__codelineno-0-4412"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4413"><a id="__codelineno-0-4413" name="__codelineno-0-4413"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-4414"><a id="__codelineno-0-4414" name="__codelineno-0-4414"></a>                <span class="s2">&quot;Verification email not yet received (no mails with sender -&gt; </span><span class="si">%s</span><span class="s2"> and subject -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; found). Waiting </span><span class="si">%s</span><span class="s2"> seconds...&quot;</span><span class="p">,</span>
</span><span id="__span-0-4415"><a id="__codelineno-0-4415" name="__codelineno-0-4415"></a>                <span class="n">sender</span><span class="p">,</span>
</span><span id="__span-0-4416"><a id="__codelineno-0-4416" name="__codelineno-0-4416"></a>                <span class="n">subject</span><span class="p">,</span>
</span><span id="__span-0-4417"><a id="__codelineno-0-4417" name="__codelineno-0-4417"></a>                <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-0-4418"><a id="__codelineno-0-4418" name="__codelineno-0-4418"></a>            <span class="p">)</span>
</span><span id="__span-0-4419"><a id="__codelineno-0-4419" name="__codelineno-0-4419"></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-4420"><a id="__codelineno-0-4420" name="__codelineno-0-4420"></a>            <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-4421"><a id="__codelineno-0-4421" name="__codelineno-0-4421"></a>    <span class="c1"># end while</span>
</span><span id="__span-0-4422"><a id="__codelineno-0-4422" name="__codelineno-0-4422"></a>
</span><span id="__span-0-4423"><a id="__codelineno-0-4423" name="__codelineno-0-4423"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="__span-0-4424"><a id="__codelineno-0-4424" name="__codelineno-0-4424"></a>        <span class="s2">&quot;Verification mail for user -&gt; </span><span class="si">%s</span><span class="s2"> has not arrived in time.&quot;</span><span class="p">,</span>
</span><span id="__span-0-4425"><a id="__codelineno-0-4425" name="__codelineno-0-4425"></a>        <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-4426"><a id="__codelineno-0-4426" name="__codelineno-0-4426"></a>    <span class="p">)</span>
</span><span id="__span-0-4427"><a id="__codelineno-0-4427" name="__codelineno-0-4427"></a>
</span><span id="__span-0-4428"><a id="__codelineno-0-4428" name="__codelineno-0-4428"></a>    <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.exist_result_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exist_result_item</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">sub_dict_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check existence of key / value pair in the response properties of an MS Graph API call.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>REST response from an MS Graph REST Call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The property name (key).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to find in the item with the matching key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_dict_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Some MS Graph API calls include nested dict structures that can be requested
with an "expand" query parameter. In such a case we use the sub_dict_name to
access it.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the value was found, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="k">def</span><span class="w"> </span><span class="nf">exist_result_item</span><span class="p">(</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">response</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="n">sub_dict_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check existence of key / value pair in the response properties of an MS Graph API call.</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    Args:</span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        response (dict | None):</span>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            REST response from an MS Graph REST Call.</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        key (str):</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            The property name (key).</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        value (str):</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            The value to find in the item with the matching key</span>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        sub_dict_name (str, optional):</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            Some MS Graph API calls include nested dict structures that can be requested</span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            with an &quot;expand&quot; query parameter. In such a case we use the sub_dict_name to</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            access it.</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        bool:</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            True if the value was found, False otherwise</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="k">if</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="n">values</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict_name</span><span class="p">:</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">][</span><span class="n">key</span><span class="p">]:</span>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.extract_url_from_message_body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_url_from_message_body</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="n">search_pattern</span><span class="p">,</span> <span class="n">multi_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multi_line_end_marker</span><span class="o">=</span><span class="s1">&#39;%3D&#39;</span><span class="p">,</span> <span class="n">line_end_marker</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">replacements</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse the email body to extract (a potentially multi-line) URL from the body.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message_body</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text of the Email body.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>search_pattern</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pattern that needs to be in first line of the URL. This
makes sure it is the right URL we are looking for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multi_line</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is the URL spread over multiple lines?. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multi_line_end_marker</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If it is a multi-line URL, what marks the end
of the URL in the last line? Defaults to "%3D".</p>
              </div>
            </td>
            <td>
                  <code>&#39;%3D&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>line_end_marker</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What marks the end of lines 1-(n-1)? Defaults to "=".</p>
              </div>
            </td>
            <td>
                  <code>&#39;=&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>replacements</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of replacements.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
The URL text that has been extracted. None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4026">4026</a></span>
<span class="normal"><a href="#__codelineno-0-4027">4027</a></span>
<span class="normal"><a href="#__codelineno-0-4028">4028</a></span>
<span class="normal"><a href="#__codelineno-0-4029">4029</a></span>
<span class="normal"><a href="#__codelineno-0-4030">4030</a></span>
<span class="normal"><a href="#__codelineno-0-4031">4031</a></span>
<span class="normal"><a href="#__codelineno-0-4032">4032</a></span>
<span class="normal"><a href="#__codelineno-0-4033">4033</a></span>
<span class="normal"><a href="#__codelineno-0-4034">4034</a></span>
<span class="normal"><a href="#__codelineno-0-4035">4035</a></span>
<span class="normal"><a href="#__codelineno-0-4036">4036</a></span>
<span class="normal"><a href="#__codelineno-0-4037">4037</a></span>
<span class="normal"><a href="#__codelineno-0-4038">4038</a></span>
<span class="normal"><a href="#__codelineno-0-4039">4039</a></span>
<span class="normal"><a href="#__codelineno-0-4040">4040</a></span>
<span class="normal"><a href="#__codelineno-0-4041">4041</a></span>
<span class="normal"><a href="#__codelineno-0-4042">4042</a></span>
<span class="normal"><a href="#__codelineno-0-4043">4043</a></span>
<span class="normal"><a href="#__codelineno-0-4044">4044</a></span>
<span class="normal"><a href="#__codelineno-0-4045">4045</a></span>
<span class="normal"><a href="#__codelineno-0-4046">4046</a></span>
<span class="normal"><a href="#__codelineno-0-4047">4047</a></span>
<span class="normal"><a href="#__codelineno-0-4048">4048</a></span>
<span class="normal"><a href="#__codelineno-0-4049">4049</a></span>
<span class="normal"><a href="#__codelineno-0-4050">4050</a></span>
<span class="normal"><a href="#__codelineno-0-4051">4051</a></span>
<span class="normal"><a href="#__codelineno-0-4052">4052</a></span>
<span class="normal"><a href="#__codelineno-0-4053">4053</a></span>
<span class="normal"><a href="#__codelineno-0-4054">4054</a></span>
<span class="normal"><a href="#__codelineno-0-4055">4055</a></span>
<span class="normal"><a href="#__codelineno-0-4056">4056</a></span>
<span class="normal"><a href="#__codelineno-0-4057">4057</a></span>
<span class="normal"><a href="#__codelineno-0-4058">4058</a></span>
<span class="normal"><a href="#__codelineno-0-4059">4059</a></span>
<span class="normal"><a href="#__codelineno-0-4060">4060</a></span>
<span class="normal"><a href="#__codelineno-0-4061">4061</a></span>
<span class="normal"><a href="#__codelineno-0-4062">4062</a></span>
<span class="normal"><a href="#__codelineno-0-4063">4063</a></span>
<span class="normal"><a href="#__codelineno-0-4064">4064</a></span>
<span class="normal"><a href="#__codelineno-0-4065">4065</a></span>
<span class="normal"><a href="#__codelineno-0-4066">4066</a></span>
<span class="normal"><a href="#__codelineno-0-4067">4067</a></span>
<span class="normal"><a href="#__codelineno-0-4068">4068</a></span>
<span class="normal"><a href="#__codelineno-0-4069">4069</a></span>
<span class="normal"><a href="#__codelineno-0-4070">4070</a></span>
<span class="normal"><a href="#__codelineno-0-4071">4071</a></span>
<span class="normal"><a href="#__codelineno-0-4072">4072</a></span>
<span class="normal"><a href="#__codelineno-0-4073">4073</a></span>
<span class="normal"><a href="#__codelineno-0-4074">4074</a></span>
<span class="normal"><a href="#__codelineno-0-4075">4075</a></span>
<span class="normal"><a href="#__codelineno-0-4076">4076</a></span>
<span class="normal"><a href="#__codelineno-0-4077">4077</a></span>
<span class="normal"><a href="#__codelineno-0-4078">4078</a></span>
<span class="normal"><a href="#__codelineno-0-4079">4079</a></span>
<span class="normal"><a href="#__codelineno-0-4080">4080</a></span>
<span class="normal"><a href="#__codelineno-0-4081">4081</a></span>
<span class="normal"><a href="#__codelineno-0-4082">4082</a></span>
<span class="normal"><a href="#__codelineno-0-4083">4083</a></span>
<span class="normal"><a href="#__codelineno-0-4084">4084</a></span>
<span class="normal"><a href="#__codelineno-0-4085">4085</a></span>
<span class="normal"><a href="#__codelineno-0-4086">4086</a></span>
<span class="normal"><a href="#__codelineno-0-4087">4087</a></span>
<span class="normal"><a href="#__codelineno-0-4088">4088</a></span>
<span class="normal"><a href="#__codelineno-0-4089">4089</a></span>
<span class="normal"><a href="#__codelineno-0-4090">4090</a></span>
<span class="normal"><a href="#__codelineno-0-4091">4091</a></span>
<span class="normal"><a href="#__codelineno-0-4092">4092</a></span>
<span class="normal"><a href="#__codelineno-0-4093">4093</a></span>
<span class="normal"><a href="#__codelineno-0-4094">4094</a></span>
<span class="normal"><a href="#__codelineno-0-4095">4095</a></span>
<span class="normal"><a href="#__codelineno-0-4096">4096</a></span>
<span class="normal"><a href="#__codelineno-0-4097">4097</a></span>
<span class="normal"><a href="#__codelineno-0-4098">4098</a></span>
<span class="normal"><a href="#__codelineno-0-4099">4099</a></span>
<span class="normal"><a href="#__codelineno-0-4100">4100</a></span>
<span class="normal"><a href="#__codelineno-0-4101">4101</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4026"><a id="__codelineno-0-4026" name="__codelineno-0-4026"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_url_from_message_body</span><span class="p">(</span>
</span><span id="__span-0-4027"><a id="__codelineno-0-4027" name="__codelineno-0-4027"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4028"><a id="__codelineno-0-4028" name="__codelineno-0-4028"></a>    <span class="n">message_body</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4029"><a id="__codelineno-0-4029" name="__codelineno-0-4029"></a>    <span class="n">search_pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4030"><a id="__codelineno-0-4030" name="__codelineno-0-4030"></a>    <span class="n">multi_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4031"><a id="__codelineno-0-4031" name="__codelineno-0-4031"></a>    <span class="n">multi_line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;%3D&quot;</span><span class="p">,</span>
</span><span id="__span-0-4032"><a id="__codelineno-0-4032" name="__codelineno-0-4032"></a>    <span class="n">line_end_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span>
</span><span id="__span-0-4033"><a id="__codelineno-0-4033" name="__codelineno-0-4033"></a>    <span class="n">replacements</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4034"><a id="__codelineno-0-4034" name="__codelineno-0-4034"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4035"><a id="__codelineno-0-4035" name="__codelineno-0-4035"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse the email body to extract (a potentially multi-line) URL from the body.</span>
</span><span id="__span-0-4036"><a id="__codelineno-0-4036" name="__codelineno-0-4036"></a>
</span><span id="__span-0-4037"><a id="__codelineno-0-4037" name="__codelineno-0-4037"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4038"><a id="__codelineno-0-4038" name="__codelineno-0-4038"></a><span class="sd">        message_body (str):</span>
</span><span id="__span-0-4039"><a id="__codelineno-0-4039" name="__codelineno-0-4039"></a><span class="sd">            Text of the Email body.</span>
</span><span id="__span-0-4040"><a id="__codelineno-0-4040" name="__codelineno-0-4040"></a><span class="sd">        search_pattern (str):</span>
</span><span id="__span-0-4041"><a id="__codelineno-0-4041" name="__codelineno-0-4041"></a><span class="sd">            Pattern that needs to be in first line of the URL. This</span>
</span><span id="__span-0-4042"><a id="__codelineno-0-4042" name="__codelineno-0-4042"></a><span class="sd">            makes sure it is the right URL we are looking for.</span>
</span><span id="__span-0-4043"><a id="__codelineno-0-4043" name="__codelineno-0-4043"></a><span class="sd">        multi_line (bool, optional):</span>
</span><span id="__span-0-4044"><a id="__codelineno-0-4044" name="__codelineno-0-4044"></a><span class="sd">            Is the URL spread over multiple lines?. Defaults to False.</span>
</span><span id="__span-0-4045"><a id="__codelineno-0-4045" name="__codelineno-0-4045"></a><span class="sd">        multi_line_end_marker (str, optional):</span>
</span><span id="__span-0-4046"><a id="__codelineno-0-4046" name="__codelineno-0-4046"></a><span class="sd">            If it is a multi-line URL, what marks the end</span>
</span><span id="__span-0-4047"><a id="__codelineno-0-4047" name="__codelineno-0-4047"></a><span class="sd">            of the URL in the last line? Defaults to &quot;%3D&quot;.</span>
</span><span id="__span-0-4048"><a id="__codelineno-0-4048" name="__codelineno-0-4048"></a><span class="sd">        line_end_marker (str, optional):</span>
</span><span id="__span-0-4049"><a id="__codelineno-0-4049" name="__codelineno-0-4049"></a><span class="sd">            What marks the end of lines 1-(n-1)? Defaults to &quot;=&quot;.</span>
</span><span id="__span-0-4050"><a id="__codelineno-0-4050" name="__codelineno-0-4050"></a><span class="sd">        replacements (list, optional):</span>
</span><span id="__span-0-4051"><a id="__codelineno-0-4051" name="__codelineno-0-4051"></a><span class="sd">            A list of replacements.</span>
</span><span id="__span-0-4052"><a id="__codelineno-0-4052" name="__codelineno-0-4052"></a>
</span><span id="__span-0-4053"><a id="__codelineno-0-4053" name="__codelineno-0-4053"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4054"><a id="__codelineno-0-4054" name="__codelineno-0-4054"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-4055"><a id="__codelineno-0-4055" name="__codelineno-0-4055"></a><span class="sd">            The URL text that has been extracted. None in case of an error.</span>
</span><span id="__span-0-4056"><a id="__codelineno-0-4056" name="__codelineno-0-4056"></a>
</span><span id="__span-0-4057"><a id="__codelineno-0-4057" name="__codelineno-0-4057"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4058"><a id="__codelineno-0-4058" name="__codelineno-0-4058"></a>
</span><span id="__span-0-4059"><a id="__codelineno-0-4059" name="__codelineno-0-4059"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">message_body</span><span class="p">:</span>
</span><span id="__span-0-4060"><a id="__codelineno-0-4060" name="__codelineno-0-4060"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-4061"><a id="__codelineno-0-4061" name="__codelineno-0-4061"></a>
</span><span id="__span-0-4062"><a id="__codelineno-0-4062" name="__codelineno-0-4062"></a>    <span class="c1"># Split all the lines after a CRLF:</span>
</span><span id="__span-0-4063"><a id="__codelineno-0-4063" name="__codelineno-0-4063"></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">message_body</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="__span-0-4064"><a id="__codelineno-0-4064" name="__codelineno-0-4064"></a>
</span><span id="__span-0-4065"><a id="__codelineno-0-4065" name="__codelineno-0-4065"></a>    <span class="c1"># Filter out the complete URL from the extracted URLs</span>
</span><span id="__span-0-4066"><a id="__codelineno-0-4066" name="__codelineno-0-4066"></a>    <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-4067"><a id="__codelineno-0-4067" name="__codelineno-0-4067"></a>
</span><span id="__span-0-4068"><a id="__codelineno-0-4068" name="__codelineno-0-4068"></a>    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-4069"><a id="__codelineno-0-4069" name="__codelineno-0-4069"></a>
</span><span id="__span-0-4070"><a id="__codelineno-0-4070" name="__codelineno-0-4070"></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="__span-0-4071"><a id="__codelineno-0-4071" name="__codelineno-0-4071"></a>        <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
</span><span id="__span-0-4072"><a id="__codelineno-0-4072" name="__codelineno-0-4072"></a>            <span class="c1"># Remove line end marker - many times a &quot;=&quot;</span>
</span><span id="__span-0-4073"><a id="__codelineno-0-4073" name="__codelineno-0-4073"></a>            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">line_end_marker</span><span class="p">):</span>
</span><span id="__span-0-4074"><a id="__codelineno-0-4074" name="__codelineno-0-4074"></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-4075"><a id="__codelineno-0-4075" name="__codelineno-0-4075"></a>            <span class="k">for</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
</span><span id="__span-0-4076"><a id="__codelineno-0-4076" name="__codelineno-0-4076"></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">],</span> <span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">])</span>
</span><span id="__span-0-4077"><a id="__codelineno-0-4077" name="__codelineno-0-4077"></a>            <span class="c1"># We consider an empty line after we found the URL to indicate the end of the URL:</span>
</span><span id="__span-0-4078"><a id="__codelineno-0-4078" name="__codelineno-0-4078"></a>            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="__span-0-4079"><a id="__codelineno-0-4079" name="__codelineno-0-4079"></a>                <span class="k">break</span>
</span><span id="__span-0-4080"><a id="__codelineno-0-4080" name="__codelineno-0-4080"></a>            <span class="n">url</span> <span class="o">+=</span> <span class="n">line</span>
</span><span id="__span-0-4081"><a id="__codelineno-0-4081" name="__codelineno-0-4081"></a>        <span class="k">if</span> <span class="n">multi_line</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">multi_line_end_marker</span><span class="p">):</span>
</span><span id="__span-0-4082"><a id="__codelineno-0-4082" name="__codelineno-0-4082"></a>            <span class="k">break</span>
</span><span id="__span-0-4083"><a id="__codelineno-0-4083" name="__codelineno-0-4083"></a>        <span class="k">if</span> <span class="n">search_pattern</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="__span-0-4084"><a id="__codelineno-0-4084" name="__codelineno-0-4084"></a>            <span class="k">continue</span>
</span><span id="__span-0-4085"><a id="__codelineno-0-4085" name="__codelineno-0-4085"></a>        <span class="c1"># Fine https:// in the current line:</span>
</span><span id="__span-0-4086"><a id="__codelineno-0-4086" name="__codelineno-0-4086"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">)</span>
</span><span id="__span-0-4087"><a id="__codelineno-0-4087" name="__codelineno-0-4087"></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-4088"><a id="__codelineno-0-4088" name="__codelineno-0-4088"></a>            <span class="k">continue</span>
</span><span id="__span-0-4089"><a id="__codelineno-0-4089" name="__codelineno-0-4089"></a>        <span class="c1"># If there&#39;s any text in front of https in that line cut it:</span>
</span><span id="__span-0-4090"><a id="__codelineno-0-4090" name="__codelineno-0-4090"></a>        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">index</span><span class="p">:]</span>
</span><span id="__span-0-4091"><a id="__codelineno-0-4091" name="__codelineno-0-4091"></a>        <span class="c1"># Remove line end marker - many times a &quot;=&quot;</span>
</span><span id="__span-0-4092"><a id="__codelineno-0-4092" name="__codelineno-0-4092"></a>        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">line_end_marker</span><span class="p">):</span>
</span><span id="__span-0-4093"><a id="__codelineno-0-4093" name="__codelineno-0-4093"></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-4094"><a id="__codelineno-0-4094" name="__codelineno-0-4094"></a>        <span class="k">for</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
</span><span id="__span-0-4095"><a id="__codelineno-0-4095" name="__codelineno-0-4095"></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">],</span> <span class="n">replacement</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">])</span>
</span><span id="__span-0-4096"><a id="__codelineno-0-4096" name="__codelineno-0-4096"></a>        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-4097"><a id="__codelineno-0-4097" name="__codelineno-0-4097"></a>        <span class="n">url</span> <span class="o">+=</span> <span class="n">line</span>
</span><span id="__span-0-4098"><a id="__codelineno-0-4098" name="__codelineno-0-4098"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">multi_line</span><span class="p">:</span>
</span><span id="__span-0-4099"><a id="__codelineno-0-4099" name="__codelineno-0-4099"></a>            <span class="k">break</span>
</span><span id="__span-0-4100"><a id="__codelineno-0-4100" name="__codelineno-0-4100"></a>
</span><span id="__span-0-4101"><a id="__codelineno-0-4101" name="__codelineno-0-4101"></a>    <span class="k">return</span> <span class="n">url</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.extract_version_from_app_manifest" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_version_from_app_manifest</span><span class="p">(</span><span class="n">app_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract the version number from the MS Teams app manifest file.</p>
<p>This can be used to check if the app package includes a newer
app version then the already installed one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path (with directory) to the app package to extract
the version from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
The version number or None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span>
<span class="normal"><a href="#__codelineno-0-2744">2744</a></span>
<span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span>
<span class="normal"><a href="#__codelineno-0-2752">2752</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2730"><a id="__codelineno-0-2730" name="__codelineno-0-2730"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_version_from_app_manifest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2731"><a id="__codelineno-0-2731" name="__codelineno-0-2731"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the version number from the MS Teams app manifest file.</span>
</span><span id="__span-0-2732"><a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>
</span><span id="__span-0-2733"><a id="__codelineno-0-2733" name="__codelineno-0-2733"></a><span class="sd">    This can be used to check if the app package includes a newer</span>
</span><span id="__span-0-2734"><a id="__codelineno-0-2734" name="__codelineno-0-2734"></a><span class="sd">    app version then the already installed one.</span>
</span><span id="__span-0-2735"><a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>
</span><span id="__span-0-2736"><a id="__codelineno-0-2736" name="__codelineno-0-2736"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2737"><a id="__codelineno-0-2737" name="__codelineno-0-2737"></a><span class="sd">        app_path (str):</span>
</span><span id="__span-0-2738"><a id="__codelineno-0-2738" name="__codelineno-0-2738"></a><span class="sd">            The file path (with directory) to the app package to extract</span>
</span><span id="__span-0-2739"><a id="__codelineno-0-2739" name="__codelineno-0-2739"></a><span class="sd">            the version from.</span>
</span><span id="__span-0-2740"><a id="__codelineno-0-2740" name="__codelineno-0-2740"></a>
</span><span id="__span-0-2741"><a id="__codelineno-0-2741" name="__codelineno-0-2741"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2742"><a id="__codelineno-0-2742" name="__codelineno-0-2742"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-2743"><a id="__codelineno-0-2743" name="__codelineno-0-2743"></a><span class="sd">            The version number or None in case of an error.</span>
</span><span id="__span-0-2744"><a id="__codelineno-0-2744" name="__codelineno-0-2744"></a>
</span><span id="__span-0-2745"><a id="__codelineno-0-2745" name="__codelineno-0-2745"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2746"><a id="__codelineno-0-2746" name="__codelineno-0-2746"></a>
</span><span id="__span-0-2747"><a id="__codelineno-0-2747" name="__codelineno-0-2747"></a>    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
</span><span id="__span-0-2748"><a id="__codelineno-0-2748" name="__codelineno-0-2748"></a>        <span class="n">manifest_data</span> <span class="o">=</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;manifest.json&quot;</span><span class="p">)</span>
</span><span id="__span-0-2749"><a id="__codelineno-0-2749" name="__codelineno-0-2749"></a>        <span class="n">manifest_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">manifest_data</span><span class="p">)</span>
</span><span id="__span-0-2750"><a id="__codelineno-0-2750" name="__codelineno-0-2750"></a>        <span class="n">version</span> <span class="o">=</span> <span class="n">manifest_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
</span><span id="__span-0-2751"><a id="__codelineno-0-2751" name="__codelineno-0-2751"></a>
</span><span id="__span-0-2752"><a id="__codelineno-0-2752" name="__codelineno-0-2752"></a>        <span class="k">return</span> <span class="n">version</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.follow_sharepoint_site" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">follow_sharepoint_site</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Let a user follow a particular SharePoint site.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>username</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The login name of the user. Only relevant if the user ID
is not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user ID. If it is not provied it will be derived from
the username.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Graph API response or None in case an error occured..</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#sites',
    'value': [
        {
            'id': 'ideateqa.sharepoint.com,c605327f-8531-47da-8c85-9bb63845dda6,34b48533-af41-4743-8b41-185a21f0b80f',
            'webUrl': 'https://ideateqa.sharepoint.com/sites/Procurement',
            'displayName': 'Procurement',
            'sharepointIds': {
                'siteId': 'c605327f-8531-47da-8c85-9bb63845dda6',
                'siteUrl': 'https://ideateqa.sharepoint.com/sites/Procurement',
                'webId': '34b48533-af41-4743-8b41-185a21f0b80f'
            },
            'siteCollection': {
                'hostname': 'ideateqa.sharepoint.com'
            }
        }
    ]
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5765">5765</a></span>
<span class="normal"><a href="#__codelineno-0-5766">5766</a></span>
<span class="normal"><a href="#__codelineno-0-5767">5767</a></span>
<span class="normal"><a href="#__codelineno-0-5768">5768</a></span>
<span class="normal"><a href="#__codelineno-0-5769">5769</a></span>
<span class="normal"><a href="#__codelineno-0-5770">5770</a></span>
<span class="normal"><a href="#__codelineno-0-5771">5771</a></span>
<span class="normal"><a href="#__codelineno-0-5772">5772</a></span>
<span class="normal"><a href="#__codelineno-0-5773">5773</a></span>
<span class="normal"><a href="#__codelineno-0-5774">5774</a></span>
<span class="normal"><a href="#__codelineno-0-5775">5775</a></span>
<span class="normal"><a href="#__codelineno-0-5776">5776</a></span>
<span class="normal"><a href="#__codelineno-0-5777">5777</a></span>
<span class="normal"><a href="#__codelineno-0-5778">5778</a></span>
<span class="normal"><a href="#__codelineno-0-5779">5779</a></span>
<span class="normal"><a href="#__codelineno-0-5780">5780</a></span>
<span class="normal"><a href="#__codelineno-0-5781">5781</a></span>
<span class="normal"><a href="#__codelineno-0-5782">5782</a></span>
<span class="normal"><a href="#__codelineno-0-5783">5783</a></span>
<span class="normal"><a href="#__codelineno-0-5784">5784</a></span>
<span class="normal"><a href="#__codelineno-0-5785">5785</a></span>
<span class="normal"><a href="#__codelineno-0-5786">5786</a></span>
<span class="normal"><a href="#__codelineno-0-5787">5787</a></span>
<span class="normal"><a href="#__codelineno-0-5788">5788</a></span>
<span class="normal"><a href="#__codelineno-0-5789">5789</a></span>
<span class="normal"><a href="#__codelineno-0-5790">5790</a></span>
<span class="normal"><a href="#__codelineno-0-5791">5791</a></span>
<span class="normal"><a href="#__codelineno-0-5792">5792</a></span>
<span class="normal"><a href="#__codelineno-0-5793">5793</a></span>
<span class="normal"><a href="#__codelineno-0-5794">5794</a></span>
<span class="normal"><a href="#__codelineno-0-5795">5795</a></span>
<span class="normal"><a href="#__codelineno-0-5796">5796</a></span>
<span class="normal"><a href="#__codelineno-0-5797">5797</a></span>
<span class="normal"><a href="#__codelineno-0-5798">5798</a></span>
<span class="normal"><a href="#__codelineno-0-5799">5799</a></span>
<span class="normal"><a href="#__codelineno-0-5800">5800</a></span>
<span class="normal"><a href="#__codelineno-0-5801">5801</a></span>
<span class="normal"><a href="#__codelineno-0-5802">5802</a></span>
<span class="normal"><a href="#__codelineno-0-5803">5803</a></span>
<span class="normal"><a href="#__codelineno-0-5804">5804</a></span>
<span class="normal"><a href="#__codelineno-0-5805">5805</a></span>
<span class="normal"><a href="#__codelineno-0-5806">5806</a></span>
<span class="normal"><a href="#__codelineno-0-5807">5807</a></span>
<span class="normal"><a href="#__codelineno-0-5808">5808</a></span>
<span class="normal"><a href="#__codelineno-0-5809">5809</a></span>
<span class="normal"><a href="#__codelineno-0-5810">5810</a></span>
<span class="normal"><a href="#__codelineno-0-5811">5811</a></span>
<span class="normal"><a href="#__codelineno-0-5812">5812</a></span>
<span class="normal"><a href="#__codelineno-0-5813">5813</a></span>
<span class="normal"><a href="#__codelineno-0-5814">5814</a></span>
<span class="normal"><a href="#__codelineno-0-5815">5815</a></span>
<span class="normal"><a href="#__codelineno-0-5816">5816</a></span>
<span class="normal"><a href="#__codelineno-0-5817">5817</a></span>
<span class="normal"><a href="#__codelineno-0-5818">5818</a></span>
<span class="normal"><a href="#__codelineno-0-5819">5819</a></span>
<span class="normal"><a href="#__codelineno-0-5820">5820</a></span>
<span class="normal"><a href="#__codelineno-0-5821">5821</a></span>
<span class="normal"><a href="#__codelineno-0-5822">5822</a></span>
<span class="normal"><a href="#__codelineno-0-5823">5823</a></span>
<span class="normal"><a href="#__codelineno-0-5824">5824</a></span>
<span class="normal"><a href="#__codelineno-0-5825">5825</a></span>
<span class="normal"><a href="#__codelineno-0-5826">5826</a></span>
<span class="normal"><a href="#__codelineno-0-5827">5827</a></span>
<span class="normal"><a href="#__codelineno-0-5828">5828</a></span>
<span class="normal"><a href="#__codelineno-0-5829">5829</a></span>
<span class="normal"><a href="#__codelineno-0-5830">5830</a></span>
<span class="normal"><a href="#__codelineno-0-5831">5831</a></span>
<span class="normal"><a href="#__codelineno-0-5832">5832</a></span>
<span class="normal"><a href="#__codelineno-0-5833">5833</a></span>
<span class="normal"><a href="#__codelineno-0-5834">5834</a></span>
<span class="normal"><a href="#__codelineno-0-5835">5835</a></span>
<span class="normal"><a href="#__codelineno-0-5836">5836</a></span>
<span class="normal"><a href="#__codelineno-0-5837">5837</a></span>
<span class="normal"><a href="#__codelineno-0-5838">5838</a></span>
<span class="normal"><a href="#__codelineno-0-5839">5839</a></span>
<span class="normal"><a href="#__codelineno-0-5840">5840</a></span>
<span class="normal"><a href="#__codelineno-0-5841">5841</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5765"><a id="__codelineno-0-5765" name="__codelineno-0-5765"></a><span class="k">def</span><span class="w"> </span><span class="nf">follow_sharepoint_site</span><span class="p">(</span>
</span><span id="__span-0-5766"><a id="__codelineno-0-5766" name="__codelineno-0-5766"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5767"><a id="__codelineno-0-5767" name="__codelineno-0-5767"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5768"><a id="__codelineno-0-5768" name="__codelineno-0-5768"></a>    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5769"><a id="__codelineno-0-5769" name="__codelineno-0-5769"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5770"><a id="__codelineno-0-5770" name="__codelineno-0-5770"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5771"><a id="__codelineno-0-5771" name="__codelineno-0-5771"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a user follow a particular SharePoint site.</span>
</span><span id="__span-0-5772"><a id="__codelineno-0-5772" name="__codelineno-0-5772"></a>
</span><span id="__span-0-5773"><a id="__codelineno-0-5773" name="__codelineno-0-5773"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5774"><a id="__codelineno-0-5774" name="__codelineno-0-5774"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5775"><a id="__codelineno-0-5775" name="__codelineno-0-5775"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5776"><a id="__codelineno-0-5776" name="__codelineno-0-5776"></a><span class="sd">        username (str):</span>
</span><span id="__span-0-5777"><a id="__codelineno-0-5777" name="__codelineno-0-5777"></a><span class="sd">            The login name of the user. Only relevant if the user ID</span>
</span><span id="__span-0-5778"><a id="__codelineno-0-5778" name="__codelineno-0-5778"></a><span class="sd">            is not provided.</span>
</span><span id="__span-0-5779"><a id="__codelineno-0-5779" name="__codelineno-0-5779"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-5780"><a id="__codelineno-0-5780" name="__codelineno-0-5780"></a><span class="sd">            The user ID. If it is not provied it will be derived from</span>
</span><span id="__span-0-5781"><a id="__codelineno-0-5781" name="__codelineno-0-5781"></a><span class="sd">            the username.</span>
</span><span id="__span-0-5782"><a id="__codelineno-0-5782" name="__codelineno-0-5782"></a>
</span><span id="__span-0-5783"><a id="__codelineno-0-5783" name="__codelineno-0-5783"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5784"><a id="__codelineno-0-5784" name="__codelineno-0-5784"></a><span class="sd">        dict:</span>
</span><span id="__span-0-5785"><a id="__codelineno-0-5785" name="__codelineno-0-5785"></a><span class="sd">            The Graph API response or None in case an error occured..</span>
</span><span id="__span-0-5786"><a id="__codelineno-0-5786" name="__codelineno-0-5786"></a>
</span><span id="__span-0-5787"><a id="__codelineno-0-5787" name="__codelineno-0-5787"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5788"><a id="__codelineno-0-5788" name="__codelineno-0-5788"></a><span class="sd">    {</span>
</span><span id="__span-0-5789"><a id="__codelineno-0-5789" name="__codelineno-0-5789"></a><span class="sd">        &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#sites&#39;,</span>
</span><span id="__span-0-5790"><a id="__codelineno-0-5790" name="__codelineno-0-5790"></a><span class="sd">        &#39;value&#39;: [</span>
</span><span id="__span-0-5791"><a id="__codelineno-0-5791" name="__codelineno-0-5791"></a><span class="sd">            {</span>
</span><span id="__span-0-5792"><a id="__codelineno-0-5792" name="__codelineno-0-5792"></a><span class="sd">                &#39;id&#39;: &#39;ideateqa.sharepoint.com,c605327f-8531-47da-8c85-9bb63845dda6,34b48533-af41-4743-8b41-185a21f0b80f&#39;,</span>
</span><span id="__span-0-5793"><a id="__codelineno-0-5793" name="__codelineno-0-5793"></a><span class="sd">                &#39;webUrl&#39;: &#39;https://ideateqa.sharepoint.com/sites/Procurement&#39;,</span>
</span><span id="__span-0-5794"><a id="__codelineno-0-5794" name="__codelineno-0-5794"></a><span class="sd">                &#39;displayName&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-5795"><a id="__codelineno-0-5795" name="__codelineno-0-5795"></a><span class="sd">                &#39;sharepointIds&#39;: {</span>
</span><span id="__span-0-5796"><a id="__codelineno-0-5796" name="__codelineno-0-5796"></a><span class="sd">                    &#39;siteId&#39;: &#39;c605327f-8531-47da-8c85-9bb63845dda6&#39;,</span>
</span><span id="__span-0-5797"><a id="__codelineno-0-5797" name="__codelineno-0-5797"></a><span class="sd">                    &#39;siteUrl&#39;: &#39;https://ideateqa.sharepoint.com/sites/Procurement&#39;,</span>
</span><span id="__span-0-5798"><a id="__codelineno-0-5798" name="__codelineno-0-5798"></a><span class="sd">                    &#39;webId&#39;: &#39;34b48533-af41-4743-8b41-185a21f0b80f&#39;</span>
</span><span id="__span-0-5799"><a id="__codelineno-0-5799" name="__codelineno-0-5799"></a><span class="sd">                },</span>
</span><span id="__span-0-5800"><a id="__codelineno-0-5800" name="__codelineno-0-5800"></a><span class="sd">                &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-5801"><a id="__codelineno-0-5801" name="__codelineno-0-5801"></a><span class="sd">                    &#39;hostname&#39;: &#39;ideateqa.sharepoint.com&#39;</span>
</span><span id="__span-0-5802"><a id="__codelineno-0-5802" name="__codelineno-0-5802"></a><span class="sd">                }</span>
</span><span id="__span-0-5803"><a id="__codelineno-0-5803" name="__codelineno-0-5803"></a><span class="sd">            }</span>
</span><span id="__span-0-5804"><a id="__codelineno-0-5804" name="__codelineno-0-5804"></a><span class="sd">        ]</span>
</span><span id="__span-0-5805"><a id="__codelineno-0-5805" name="__codelineno-0-5805"></a><span class="sd">    }</span>
</span><span id="__span-0-5806"><a id="__codelineno-0-5806" name="__codelineno-0-5806"></a>
</span><span id="__span-0-5807"><a id="__codelineno-0-5807" name="__codelineno-0-5807"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5808"><a id="__codelineno-0-5808" name="__codelineno-0-5808"></a>
</span><span id="__span-0-5809"><a id="__codelineno-0-5809" name="__codelineno-0-5809"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">username</span><span class="p">:</span>
</span><span id="__span-0-5810"><a id="__codelineno-0-5810" name="__codelineno-0-5810"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No user given to follow SharePoint site. Provide the user ID or its email address!&quot;</span><span class="p">)</span>
</span><span id="__span-0-5811"><a id="__codelineno-0-5811" name="__codelineno-0-5811"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-5812"><a id="__codelineno-0-5812" name="__codelineno-0-5812"></a>
</span><span id="__span-0-5813"><a id="__codelineno-0-5813" name="__codelineno-0-5813"></a>    <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_email</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>
</span><span id="__span-0-5814"><a id="__codelineno-0-5814" name="__codelineno-0-5814"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span><span class="p">:</span>
</span><span id="__span-0-5815"><a id="__codelineno-0-5815" name="__codelineno-0-5815"></a>        <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-5816"><a id="__codelineno-0-5816" name="__codelineno-0-5816"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="p">:</span>
</span><span id="__span-0-5817"><a id="__codelineno-0-5817" name="__codelineno-0-5817"></a>        <span class="n">username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">)</span>
</span><span id="__span-0-5818"><a id="__codelineno-0-5818" name="__codelineno-0-5818"></a>
</span><span id="__span-0-5819"><a id="__codelineno-0-5819" name="__codelineno-0-5819"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/followedSites/add&quot;</span>
</span><span id="__span-0-5820"><a id="__codelineno-0-5820" name="__codelineno-0-5820"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5821"><a id="__codelineno-0-5821" name="__codelineno-0-5821"></a>
</span><span id="__span-0-5822"><a id="__codelineno-0-5822" name="__codelineno-0-5822"></a>    <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5823"><a id="__codelineno-0-5823" name="__codelineno-0-5823"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5824"><a id="__codelineno-0-5824" name="__codelineno-0-5824"></a>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">site_id</span><span class="p">}],</span>
</span><span id="__span-0-5825"><a id="__codelineno-0-5825" name="__codelineno-0-5825"></a>    <span class="p">}</span>
</span><span id="__span-0-5826"><a id="__codelineno-0-5826" name="__codelineno-0-5826"></a>
</span><span id="__span-0-5827"><a id="__codelineno-0-5827" name="__codelineno-0-5827"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5828"><a id="__codelineno-0-5828" name="__codelineno-0-5828"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5829"><a id="__codelineno-0-5829" name="__codelineno-0-5829"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-5830"><a id="__codelineno-0-5830" name="__codelineno-0-5830"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5831"><a id="__codelineno-0-5831" name="__codelineno-0-5831"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5832"><a id="__codelineno-0-5832" name="__codelineno-0-5832"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5833"><a id="__codelineno-0-5833" name="__codelineno-0-5833"></a>        <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;Failed to follow SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; as user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5834"><a id="__codelineno-0-5834" name="__codelineno-0-5834"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5835"><a id="__codelineno-0-5835" name="__codelineno-0-5835"></a>            <span class="n">username</span> <span class="k">if</span> <span class="n">username</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-5836"><a id="__codelineno-0-5836" name="__codelineno-0-5836"></a>        <span class="p">),</span>
</span><span id="__span-0-5837"><a id="__codelineno-0-5837" name="__codelineno-0-5837"></a>        <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-5838"><a id="__codelineno-0-5838" name="__codelineno-0-5838"></a>        <span class="n">show_warning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5839"><a id="__codelineno-0-5839" name="__codelineno-0-5839"></a>    <span class="p">)</span>
</span><span id="__span-0-5840"><a id="__codelineno-0-5840" name="__codelineno-0-5840"></a>
</span><span id="__span-0-5841"><a id="__codelineno-0-5841" name="__codelineno-0-5841"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_app_registration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_app_registration</span><span class="p">(</span><span class="n">app_registration_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find an Azure App Registration based on its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_registration_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the App Registration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
App Registration data or None of the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3724">3724</a></span>
<span class="normal"><a href="#__codelineno-0-3725">3725</a></span>
<span class="normal"><a href="#__codelineno-0-3726">3726</a></span>
<span class="normal"><a href="#__codelineno-0-3727">3727</a></span>
<span class="normal"><a href="#__codelineno-0-3728">3728</a></span>
<span class="normal"><a href="#__codelineno-0-3729">3729</a></span>
<span class="normal"><a href="#__codelineno-0-3730">3730</a></span>
<span class="normal"><a href="#__codelineno-0-3731">3731</a></span>
<span class="normal"><a href="#__codelineno-0-3732">3732</a></span>
<span class="normal"><a href="#__codelineno-0-3733">3733</a></span>
<span class="normal"><a href="#__codelineno-0-3734">3734</a></span>
<span class="normal"><a href="#__codelineno-0-3735">3735</a></span>
<span class="normal"><a href="#__codelineno-0-3736">3736</a></span>
<span class="normal"><a href="#__codelineno-0-3737">3737</a></span>
<span class="normal"><a href="#__codelineno-0-3738">3738</a></span>
<span class="normal"><a href="#__codelineno-0-3739">3739</a></span>
<span class="normal"><a href="#__codelineno-0-3740">3740</a></span>
<span class="normal"><a href="#__codelineno-0-3741">3741</a></span>
<span class="normal"><a href="#__codelineno-0-3742">3742</a></span>
<span class="normal"><a href="#__codelineno-0-3743">3743</a></span>
<span class="normal"><a href="#__codelineno-0-3744">3744</a></span>
<span class="normal"><a href="#__codelineno-0-3745">3745</a></span>
<span class="normal"><a href="#__codelineno-0-3746">3746</a></span>
<span class="normal"><a href="#__codelineno-0-3747">3747</a></span>
<span class="normal"><a href="#__codelineno-0-3748">3748</a></span>
<span class="normal"><a href="#__codelineno-0-3749">3749</a></span>
<span class="normal"><a href="#__codelineno-0-3750">3750</a></span>
<span class="normal"><a href="#__codelineno-0-3751">3751</a></span>
<span class="normal"><a href="#__codelineno-0-3752">3752</a></span>
<span class="normal"><a href="#__codelineno-0-3753">3753</a></span>
<span class="normal"><a href="#__codelineno-0-3754">3754</a></span>
<span class="normal"><a href="#__codelineno-0-3755">3755</a></span>
<span class="normal"><a href="#__codelineno-0-3756">3756</a></span>
<span class="normal"><a href="#__codelineno-0-3757">3757</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3724"><a id="__codelineno-0-3724" name="__codelineno-0-3724"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_app_registration</span><span class="p">(</span>
</span><span id="__span-0-3725"><a id="__codelineno-0-3725" name="__codelineno-0-3725"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3726"><a id="__codelineno-0-3726" name="__codelineno-0-3726"></a>    <span class="n">app_registration_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3727"><a id="__codelineno-0-3727" name="__codelineno-0-3727"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3728"><a id="__codelineno-0-3728" name="__codelineno-0-3728"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find an Azure App Registration based on its name.</span>
</span><span id="__span-0-3729"><a id="__codelineno-0-3729" name="__codelineno-0-3729"></a>
</span><span id="__span-0-3730"><a id="__codelineno-0-3730" name="__codelineno-0-3730"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3731"><a id="__codelineno-0-3731" name="__codelineno-0-3731"></a><span class="sd">        app_registration_name (str):</span>
</span><span id="__span-0-3732"><a id="__codelineno-0-3732" name="__codelineno-0-3732"></a><span class="sd">            Name of the App Registration.</span>
</span><span id="__span-0-3733"><a id="__codelineno-0-3733" name="__codelineno-0-3733"></a>
</span><span id="__span-0-3734"><a id="__codelineno-0-3734" name="__codelineno-0-3734"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3735"><a id="__codelineno-0-3735" name="__codelineno-0-3735"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-3736"><a id="__codelineno-0-3736" name="__codelineno-0-3736"></a><span class="sd">            App Registration data or None of the request fails.</span>
</span><span id="__span-0-3737"><a id="__codelineno-0-3737" name="__codelineno-0-3737"></a>
</span><span id="__span-0-3738"><a id="__codelineno-0-3738" name="__codelineno-0-3738"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3739"><a id="__codelineno-0-3739" name="__codelineno-0-3739"></a>
</span><span id="__span-0-3740"><a id="__codelineno-0-3740" name="__codelineno-0-3740"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?$filter=displayName eq &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_registration_name</span><span class="p">)</span>
</span><span id="__span-0-3741"><a id="__codelineno-0-3741" name="__codelineno-0-3741"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3742"><a id="__codelineno-0-3742" name="__codelineno-0-3742"></a>
</span><span id="__span-0-3743"><a id="__codelineno-0-3743" name="__codelineno-0-3743"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3744"><a id="__codelineno-0-3744" name="__codelineno-0-3744"></a>        <span class="s2">&quot;Get Azure App Registration -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3745"><a id="__codelineno-0-3745" name="__codelineno-0-3745"></a>        <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3746"><a id="__codelineno-0-3746" name="__codelineno-0-3746"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3747"><a id="__codelineno-0-3747" name="__codelineno-0-3747"></a>    <span class="p">)</span>
</span><span id="__span-0-3748"><a id="__codelineno-0-3748" name="__codelineno-0-3748"></a>
</span><span id="__span-0-3749"><a id="__codelineno-0-3749" name="__codelineno-0-3749"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3750"><a id="__codelineno-0-3750" name="__codelineno-0-3750"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3751"><a id="__codelineno-0-3751" name="__codelineno-0-3751"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-3752"><a id="__codelineno-0-3752" name="__codelineno-0-3752"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3753"><a id="__codelineno-0-3753" name="__codelineno-0-3753"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3754"><a id="__codelineno-0-3754" name="__codelineno-0-3754"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot find Azure App Registration -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3755"><a id="__codelineno-0-3755" name="__codelineno-0-3755"></a>            <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3756"><a id="__codelineno-0-3756" name="__codelineno-0-3756"></a>        <span class="p">),</span>
</span><span id="__span-0-3757"><a id="__codelineno-0-3757" name="__codelineno-0-3757"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a M365 Group based on its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 Group name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should an error be logged if group is not found.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Group information or None if the group doesn't exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#groups',
    'value': [
        {
            'id': 'b65f7dba-3ed1-49df-91bf-2bf99affcc8d',
            'deletedDateTime': None,
            'classification': None,
            'createdDateTime': '2023-04-01T13:46:26Z',
            'creationOptions': [],
            'description': 'Engineering &amp; Construction',
            'displayName': 'Engineering &amp; Construction',
            'expirationDateTime': None,
            'groupTypes': ['Unified'],
            'isAssignableToRole': None,
            'mail': 'Engineering&amp;Construction@M365x61936377.onmicrosoft.com',
            'mailEnabled': True,
            'mailNickname': 'Engineering&amp;Construction',
            'membershipRule': None,
            'membershipRuleProcessingState': None,
            'onPremisesDomainName': None,
            'onPremisesLastSyncDateTime': None,
            'onPremisesNetBiosName': None,
            'onPremisesSamAccountName': None,
            'onPremisesSecurityIdentifier': None,
            'onPremisesSyncEnabled': None,
            'preferredDataLocation': None,
            'preferredLanguage': None,
            'proxyAddresses': ['SPO:SPO_d9deb3e7-c72f-4e8d-80fb-5d9411ca1458@SPO_604f34f0-ba72-4321-ab6b-e36ae8bd00ec', ...],
            'renewedDateTime': '2023-04-01T13:46:26Z',
            'resourceBehaviorOptions': [],
            'resourceProvisioningOptions': [],
            'securityEnabled': False,
            'securityIdentifier': 'S-1-12-1-3059711418-1239367377-4180393873-2379022234',
            'theme': None,
            'visibility': 'Public',
            'onPremisesProvisioningErrors': []
        },
        {
            'id': '61359860-302e-4016-b5cc-abff2293dff1',
            ...
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1534"><a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1535"><a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a M365 Group based on its name.</span>
</span><span id="__span-0-1536"><a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>
</span><span id="__span-0-1537"><a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1538"><a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">        group_name (str):</span>
</span><span id="__span-0-1539"><a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">            The M365 Group name.</span>
</span><span id="__span-0-1540"><a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">        show_error (bool):</span>
</span><span id="__span-0-1541"><a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><span class="sd">            Should an error be logged if group is not found.</span>
</span><span id="__span-0-1542"><a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>
</span><span id="__span-0-1543"><a id="__codelineno-0-1543" name="__codelineno-0-1543"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1544"><a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">        dict:</span>
</span><span id="__span-0-1545"><a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">            Group information or None if the group doesn&#39;t exist.</span>
</span><span id="__span-0-1546"><a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>
</span><span id="__span-0-1547"><a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1548"><a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">        {</span>
</span><span id="__span-0-1549"><a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#groups&#39;,</span>
</span><span id="__span-0-1550"><a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-1551"><a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">                {</span>
</span><span id="__span-0-1552"><a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">                    &#39;id&#39;: &#39;b65f7dba-3ed1-49df-91bf-2bf99affcc8d&#39;,</span>
</span><span id="__span-0-1553"><a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">                    &#39;deletedDateTime&#39;: None,</span>
</span><span id="__span-0-1554"><a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">                    &#39;classification&#39;: None,</span>
</span><span id="__span-0-1555"><a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">                    &#39;createdDateTime&#39;: &#39;2023-04-01T13:46:26Z&#39;,</span>
</span><span id="__span-0-1556"><a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">                    &#39;creationOptions&#39;: [],</span>
</span><span id="__span-0-1557"><a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">                    &#39;description&#39;: &#39;Engineering &amp; Construction&#39;,</span>
</span><span id="__span-0-1558"><a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">                    &#39;displayName&#39;: &#39;Engineering &amp; Construction&#39;,</span>
</span><span id="__span-0-1559"><a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">                    &#39;expirationDateTime&#39;: None,</span>
</span><span id="__span-0-1560"><a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">                    &#39;groupTypes&#39;: [&#39;Unified&#39;],</span>
</span><span id="__span-0-1561"><a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">                    &#39;isAssignableToRole&#39;: None,</span>
</span><span id="__span-0-1562"><a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">                    &#39;mail&#39;: &#39;Engineering&amp;Construction@M365x61936377.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-1563"><a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">                    &#39;mailEnabled&#39;: True,</span>
</span><span id="__span-0-1564"><a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">                    &#39;mailNickname&#39;: &#39;Engineering&amp;Construction&#39;,</span>
</span><span id="__span-0-1565"><a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">                    &#39;membershipRule&#39;: None,</span>
</span><span id="__span-0-1566"><a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">                    &#39;membershipRuleProcessingState&#39;: None,</span>
</span><span id="__span-0-1567"><a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">                    &#39;onPremisesDomainName&#39;: None,</span>
</span><span id="__span-0-1568"><a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">                    &#39;onPremisesLastSyncDateTime&#39;: None,</span>
</span><span id="__span-0-1569"><a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">                    &#39;onPremisesNetBiosName&#39;: None,</span>
</span><span id="__span-0-1570"><a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">                    &#39;onPremisesSamAccountName&#39;: None,</span>
</span><span id="__span-0-1571"><a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">                    &#39;onPremisesSecurityIdentifier&#39;: None,</span>
</span><span id="__span-0-1572"><a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">                    &#39;onPremisesSyncEnabled&#39;: None,</span>
</span><span id="__span-0-1573"><a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">                    &#39;preferredDataLocation&#39;: None,</span>
</span><span id="__span-0-1574"><a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">                    &#39;preferredLanguage&#39;: None,</span>
</span><span id="__span-0-1575"><a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">                    &#39;proxyAddresses&#39;: [&#39;SPO:SPO_d9deb3e7-c72f-4e8d-80fb-5d9411ca1458@SPO_604f34f0-ba72-4321-ab6b-e36ae8bd00ec&#39;, ...],</span>
</span><span id="__span-0-1576"><a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">                    &#39;renewedDateTime&#39;: &#39;2023-04-01T13:46:26Z&#39;,</span>
</span><span id="__span-0-1577"><a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">                    &#39;resourceBehaviorOptions&#39;: [],</span>
</span><span id="__span-0-1578"><a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">                    &#39;resourceProvisioningOptions&#39;: [],</span>
</span><span id="__span-0-1579"><a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">                    &#39;securityEnabled&#39;: False,</span>
</span><span id="__span-0-1580"><a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">                    &#39;securityIdentifier&#39;: &#39;S-1-12-1-3059711418-1239367377-4180393873-2379022234&#39;,</span>
</span><span id="__span-0-1581"><a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><span class="sd">                    &#39;theme&#39;: None,</span>
</span><span id="__span-0-1582"><a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">                    &#39;visibility&#39;: &#39;Public&#39;,</span>
</span><span id="__span-0-1583"><a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">                    &#39;onPremisesProvisioningErrors&#39;: []</span>
</span><span id="__span-0-1584"><a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">                },</span>
</span><span id="__span-0-1585"><a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">                {</span>
</span><span id="__span-0-1586"><a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">                    &#39;id&#39;: &#39;61359860-302e-4016-b5cc-abff2293dff1&#39;,</span>
</span><span id="__span-0-1587"><a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">                    ...</span>
</span><span id="__span-0-1588"><a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="sd">                }</span>
</span><span id="__span-0-1589"><a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">            ]</span>
</span><span id="__span-0-1590"><a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><span class="sd">        }</span>
</span><span id="__span-0-1591"><a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>
</span><span id="__span-0-1592"><a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1593"><a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>
</span><span id="__span-0-1594"><a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$filter&quot;</span><span class="p">:</span> <span class="s2">&quot;displayName eq &#39;&quot;</span> <span class="o">+</span> <span class="n">group_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
</span><span id="__span-0-1595"><a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1596"><a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
</span><span id="__span-0-1597"><a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-1598"><a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1599"><a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>
</span><span id="__span-0-1600"><a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1601"><a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>        <span class="s2">&quot;Get M365 group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1602"><a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>        <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1603"><a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1604"><a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>    <span class="p">)</span>
</span><span id="__span-0-1605"><a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>
</span><span id="__span-0-1606"><a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1607"><a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1608"><a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1609"><a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1610"><a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1611"><a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group_name</span><span class="p">),</span>
</span><span id="__span-0-1612"><a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-1613"><a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_group_members" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_group_members</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get members (users and groups) of the specified group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of Graph REST API or None if the REST call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1701"><a id="__codelineno-0-1701" name="__codelineno-0-1701"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_group_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1702"><a id="__codelineno-0-1702" name="__codelineno-0-1702"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get members (users and groups) of the specified group.</span>
</span><span id="__span-0-1703"><a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>
</span><span id="__span-0-1704"><a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1705"><a id="__codelineno-0-1705" name="__codelineno-0-1705"></a><span class="sd">        group_name (str):</span>
</span><span id="__span-0-1706"><a id="__codelineno-0-1706" name="__codelineno-0-1706"></a><span class="sd">            The name of the group.</span>
</span><span id="__span-0-1707"><a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>
</span><span id="__span-0-1708"><a id="__codelineno-0-1708" name="__codelineno-0-1708"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1709"><a id="__codelineno-0-1709" name="__codelineno-0-1709"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1710"><a id="__codelineno-0-1710" name="__codelineno-0-1710"></a><span class="sd">            Response of Graph REST API or None if the REST call fails.</span>
</span><span id="__span-0-1711"><a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>
</span><span id="__span-0-1712"><a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1713"><a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>
</span><span id="__span-0-1714"><a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-1715"><a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>    <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1716"><a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-1717"><a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1718"><a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>            <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; does not exist! Cannot retrieve group members.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1719"><a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1720"><a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>        <span class="p">)</span>
</span><span id="__span-0-1721"><a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1722"><a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>
</span><span id="__span-0-1723"><a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$select&quot;</span><span class="p">:</span> <span class="s2">&quot;id,displayName,mail,userPrincipalName&quot;</span><span class="p">}</span>
</span><span id="__span-0-1724"><a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1725"><a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>
</span><span id="__span-0-1726"><a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/members?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-1727"><a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1728"><a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>
</span><span id="__span-0-1729"><a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1730"><a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>        <span class="s2">&quot;Get members of M365 group -&gt; </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1731"><a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>        <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1732"><a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>        <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1733"><a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1734"><a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>    <span class="p">)</span>
</span><span id="__span-0-1735"><a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>
</span><span id="__span-0-1736"><a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1737"><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1738"><a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1739"><a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1740"><a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1741"><a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get members of M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1742"><a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1743"><a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1744"><a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>        <span class="p">),</span>
</span><span id="__span-0-1745"><a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_group_owners" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_group_owners</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get owners (users) of the specified group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of Graph REST API or None if the REST call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1837"><a id="__codelineno-0-1837" name="__codelineno-0-1837"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_group_owners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1838"><a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get owners (users) of the specified group.</span>
</span><span id="__span-0-1839"><a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>
</span><span id="__span-0-1840"><a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1841"><a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><span class="sd">        group_name (str):</span>
</span><span id="__span-0-1842"><a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><span class="sd">            The name of the group.</span>
</span><span id="__span-0-1843"><a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>
</span><span id="__span-0-1844"><a id="__codelineno-0-1844" name="__codelineno-0-1844"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1845"><a id="__codelineno-0-1845" name="__codelineno-0-1845"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1846"><a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><span class="sd">            Response of Graph REST API or None if the REST call fails.</span>
</span><span id="__span-0-1847"><a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>
</span><span id="__span-0-1848"><a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1849"><a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>
</span><span id="__span-0-1850"><a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-1851"><a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>    <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1852"><a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-1853"><a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1854"><a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>            <span class="s2">&quot;M365 Group -&gt; </span><span class="si">%s</span><span class="s2"> does not exist! Cannot retrieve group owners.&quot;</span><span class="p">,</span>
</span><span id="__span-0-1855"><a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1856"><a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>        <span class="p">)</span>
</span><span id="__span-0-1857"><a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1858"><a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>
</span><span id="__span-0-1859"><a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$select&quot;</span><span class="p">:</span> <span class="s2">&quot;id,displayName,mail,userPrincipalName&quot;</span><span class="p">}</span>
</span><span id="__span-0-1860"><a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1861"><a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>
</span><span id="__span-0-1862"><a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/owners?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-1863"><a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1864"><a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>
</span><span id="__span-0-1865"><a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1866"><a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>        <span class="s2">&quot;Get owners of M365 group -&gt; </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1867"><a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>        <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1868"><a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>        <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1869"><a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1870"><a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>    <span class="p">)</span>
</span><span id="__span-0-1871"><a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>
</span><span id="__span-0-1872"><a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1873"><a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1874"><a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1875"><a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1876"><a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1877"><a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get owners of M365 group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1878"><a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-1879"><a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1880"><a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>        <span class="p">),</span>
</span><span id="__span-0-1881"><a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_groups" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_groups</span><span class="p">(</span><span class="n">max_number</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">next_page_url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get list all all groups in M365 tenant.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>max_number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum result values (limit).</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>next_page_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MS Graph URL to retrieve the next page of M365 groups (pagination).
This is used for the iterator get_groups_iterator() below.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of all groups or None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_groups</span><span class="p">(</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1447"><a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>    <span class="n">max_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
</span><span id="__span-0-1448"><a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>    <span class="n">next_page_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1449"><a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1450"><a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get list all all groups in M365 tenant.</span>
</span><span id="__span-0-1451"><a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>
</span><span id="__span-0-1452"><a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1453"><a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">        max_number (int, optional):</span>
</span><span id="__span-0-1454"><a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">            The maximum result values (limit).</span>
</span><span id="__span-0-1455"><a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        next_page_url (str, optional):</span>
</span><span id="__span-0-1456"><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="sd">            The MS Graph URL to retrieve the next page of M365 groups (pagination).</span>
</span><span id="__span-0-1457"><a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">            This is used for the iterator get_groups_iterator() below.</span>
</span><span id="__span-0-1458"><a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>
</span><span id="__span-0-1459"><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="sd">        dict:</span>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">            A dictionary of all groups or None in case of an error.</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="n">next_page_url</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1467"><a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
</span><span id="__span-0-1468"><a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1469"><a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>        <span class="s2">&quot;Get list of all M365 groups</span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1470"><a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>        <span class="s2">&quot; (paged)&quot;</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-1471"><a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1472"><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>    <span class="p">)</span>
</span><span id="__span-0-1473"><a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>
</span><span id="__span-0-1474"><a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1475"><a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1476"><a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1477"><a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1478"><a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;$top&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_number</span><span class="p">)}</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1479"><a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1480"><a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 groups&quot;</span><span class="p">,</span>
</span><span id="__span-0-1481"><a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>    <span class="p">)</span>
</span><span id="__span-0-1482"><a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>
</span><span id="__span-0-1483"><a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_groups_iterator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_groups_iterator</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get an iterator object that can be used to traverse all M365 groups.</p>
<p>Returning a generator avoids loading a large number of nodes into memory at once. Instead you
can iterate over the potential large list of groups.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>groups = m365_object.get_groups_iterator()
for group in groups:
    logger.info("Traversing M365 group -&gt; '%s'...", group.get("displayName", "<undefined name>"))</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>iter</code></td>            <td>
                  <code><span title="iter">iter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A generator yielding one M365 group per iteration.
If the REST API fails, returns no value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1487"><a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_groups_iterator</span><span class="p">(</span>
</span><span id="__span-0-1488"><a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1489"><a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">iter</span><span class="p">:</span>
</span><span id="__span-0-1490"><a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an iterator object that can be used to traverse all M365 groups.</span>
</span><span id="__span-0-1491"><a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>
</span><span id="__span-0-1492"><a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">    Returning a generator avoids loading a large number of nodes into memory at once. Instead you</span>
</span><span id="__span-0-1493"><a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">    can iterate over the potential large list of groups.</span>
</span><span id="__span-0-1494"><a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>
</span><span id="__span-0-1495"><a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">    Example usage:</span>
</span><span id="__span-0-1496"><a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">        groups = m365_object.get_groups_iterator()</span>
</span><span id="__span-0-1497"><a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">        for group in groups:</span>
</span><span id="__span-0-1498"><a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><span class="sd">            logger.info(&quot;Traversing M365 group -&gt; &#39;%s&#39;...&quot;, group.get(&quot;displayName&quot;, &quot;&lt;undefined name&gt;&quot;))</span>
</span><span id="__span-0-1499"><a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>
</span><span id="__span-0-1500"><a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1501"><a id="__codelineno-0-1501" name="__codelineno-0-1501"></a><span class="sd">        iter:</span>
</span><span id="__span-0-1502"><a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><span class="sd">            A generator yielding one M365 group per iteration.</span>
</span><span id="__span-0-1503"><a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><span class="sd">            If the REST API fails, returns no value.</span>
</span><span id="__span-0-1504"><a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>
</span><span id="__span-0-1505"><a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1506"><a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>
</span><span id="__span-0-1507"><a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>    <span class="n">next_page_url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-1508"><a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>
</span><span id="__span-0-1509"><a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-1510"><a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_groups</span><span class="p">(</span>
</span><span id="__span-0-1511"><a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>            <span class="n">next_page_url</span><span class="o">=</span><span class="n">next_page_url</span><span class="p">,</span>
</span><span id="__span-0-1512"><a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>        <span class="p">)</span>
</span><span id="__span-0-1513"><a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-1514"><a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>            <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-1515"><a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>            <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-1516"><a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>            <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-1517"><a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>            <span class="k">return</span>
</span><span id="__span-0-1518"><a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>
</span><span id="__span-0-1519"><a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>        <span class="c1"># Yield users one at a time:</span>
</span><span id="__span-0-1520"><a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>        <span class="k">yield from</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-1521"><a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>
</span><span id="__span-0-1522"><a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>        <span class="c1"># See if we have an additional result page.</span>
</span><span id="__span-0-1523"><a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>        <span class="c1"># If not terminate the iterator and return</span>
</span><span id="__span-0-1524"><a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>        <span class="c1"># no value.</span>
</span><span id="__span-0-1525"><a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>        <span class="n">next_page_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.nextLink&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-1526"><a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-1527"><a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>            <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-1528"><a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>            <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-1529"><a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>            <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-1530"><a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>            <span class="k">return</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_mail" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_mail</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">num_emails</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get email from inbox of a given user and a given sender (from).</p>
<p>This requires Mail.Read Application permissions for the Azure App being used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 ID of the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sender</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sender email address to filter for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subject</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The subject to filter for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_emails</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of matching emails to retrieve.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be displayed if the
user is not found.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Email or None of the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3905">3905</a></span>
<span class="normal"><a href="#__codelineno-0-3906">3906</a></span>
<span class="normal"><a href="#__codelineno-0-3907">3907</a></span>
<span class="normal"><a href="#__codelineno-0-3908">3908</a></span>
<span class="normal"><a href="#__codelineno-0-3909">3909</a></span>
<span class="normal"><a href="#__codelineno-0-3910">3910</a></span>
<span class="normal"><a href="#__codelineno-0-3911">3911</a></span>
<span class="normal"><a href="#__codelineno-0-3912">3912</a></span>
<span class="normal"><a href="#__codelineno-0-3913">3913</a></span>
<span class="normal"><a href="#__codelineno-0-3914">3914</a></span>
<span class="normal"><a href="#__codelineno-0-3915">3915</a></span>
<span class="normal"><a href="#__codelineno-0-3916">3916</a></span>
<span class="normal"><a href="#__codelineno-0-3917">3917</a></span>
<span class="normal"><a href="#__codelineno-0-3918">3918</a></span>
<span class="normal"><a href="#__codelineno-0-3919">3919</a></span>
<span class="normal"><a href="#__codelineno-0-3920">3920</a></span>
<span class="normal"><a href="#__codelineno-0-3921">3921</a></span>
<span class="normal"><a href="#__codelineno-0-3922">3922</a></span>
<span class="normal"><a href="#__codelineno-0-3923">3923</a></span>
<span class="normal"><a href="#__codelineno-0-3924">3924</a></span>
<span class="normal"><a href="#__codelineno-0-3925">3925</a></span>
<span class="normal"><a href="#__codelineno-0-3926">3926</a></span>
<span class="normal"><a href="#__codelineno-0-3927">3927</a></span>
<span class="normal"><a href="#__codelineno-0-3928">3928</a></span>
<span class="normal"><a href="#__codelineno-0-3929">3929</a></span>
<span class="normal"><a href="#__codelineno-0-3930">3930</a></span>
<span class="normal"><a href="#__codelineno-0-3931">3931</a></span>
<span class="normal"><a href="#__codelineno-0-3932">3932</a></span>
<span class="normal"><a href="#__codelineno-0-3933">3933</a></span>
<span class="normal"><a href="#__codelineno-0-3934">3934</a></span>
<span class="normal"><a href="#__codelineno-0-3935">3935</a></span>
<span class="normal"><a href="#__codelineno-0-3936">3936</a></span>
<span class="normal"><a href="#__codelineno-0-3937">3937</a></span>
<span class="normal"><a href="#__codelineno-0-3938">3938</a></span>
<span class="normal"><a href="#__codelineno-0-3939">3939</a></span>
<span class="normal"><a href="#__codelineno-0-3940">3940</a></span>
<span class="normal"><a href="#__codelineno-0-3941">3941</a></span>
<span class="normal"><a href="#__codelineno-0-3942">3942</a></span>
<span class="normal"><a href="#__codelineno-0-3943">3943</a></span>
<span class="normal"><a href="#__codelineno-0-3944">3944</a></span>
<span class="normal"><a href="#__codelineno-0-3945">3945</a></span>
<span class="normal"><a href="#__codelineno-0-3946">3946</a></span>
<span class="normal"><a href="#__codelineno-0-3947">3947</a></span>
<span class="normal"><a href="#__codelineno-0-3948">3948</a></span>
<span class="normal"><a href="#__codelineno-0-3949">3949</a></span>
<span class="normal"><a href="#__codelineno-0-3950">3950</a></span>
<span class="normal"><a href="#__codelineno-0-3951">3951</a></span>
<span class="normal"><a href="#__codelineno-0-3952">3952</a></span>
<span class="normal"><a href="#__codelineno-0-3953">3953</a></span>
<span class="normal"><a href="#__codelineno-0-3954">3954</a></span>
<span class="normal"><a href="#__codelineno-0-3955">3955</a></span>
<span class="normal"><a href="#__codelineno-0-3956">3956</a></span>
<span class="normal"><a href="#__codelineno-0-3957">3957</a></span>
<span class="normal"><a href="#__codelineno-0-3958">3958</a></span>
<span class="normal"><a href="#__codelineno-0-3959">3959</a></span>
<span class="normal"><a href="#__codelineno-0-3960">3960</a></span>
<span class="normal"><a href="#__codelineno-0-3961">3961</a></span>
<span class="normal"><a href="#__codelineno-0-3962">3962</a></span>
<span class="normal"><a href="#__codelineno-0-3963">3963</a></span>
<span class="normal"><a href="#__codelineno-0-3964">3964</a></span>
<span class="normal"><a href="#__codelineno-0-3965">3965</a></span>
<span class="normal"><a href="#__codelineno-0-3966">3966</a></span>
<span class="normal"><a href="#__codelineno-0-3967">3967</a></span>
<span class="normal"><a href="#__codelineno-0-3968">3968</a></span>
<span class="normal"><a href="#__codelineno-0-3969">3969</a></span>
<span class="normal"><a href="#__codelineno-0-3970">3970</a></span>
<span class="normal"><a href="#__codelineno-0-3971">3971</a></span>
<span class="normal"><a href="#__codelineno-0-3972">3972</a></span>
<span class="normal"><a href="#__codelineno-0-3973">3973</a></span>
<span class="normal"><a href="#__codelineno-0-3974">3974</a></span>
<span class="normal"><a href="#__codelineno-0-3975">3975</a></span>
<span class="normal"><a href="#__codelineno-0-3976">3976</a></span>
<span class="normal"><a href="#__codelineno-0-3977">3977</a></span>
<span class="normal"><a href="#__codelineno-0-3978">3978</a></span>
<span class="normal"><a href="#__codelineno-0-3979">3979</a></span>
<span class="normal"><a href="#__codelineno-0-3980">3980</a></span>
<span class="normal"><a href="#__codelineno-0-3981">3981</a></span>
<span class="normal"><a href="#__codelineno-0-3982">3982</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3905"><a id="__codelineno-0-3905" name="__codelineno-0-3905"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_mail</span><span class="p">(</span>
</span><span id="__span-0-3906"><a id="__codelineno-0-3906" name="__codelineno-0-3906"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3907"><a id="__codelineno-0-3907" name="__codelineno-0-3907"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3908"><a id="__codelineno-0-3908" name="__codelineno-0-3908"></a>    <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3909"><a id="__codelineno-0-3909" name="__codelineno-0-3909"></a>    <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3910"><a id="__codelineno-0-3910" name="__codelineno-0-3910"></a>    <span class="n">num_emails</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3911"><a id="__codelineno-0-3911" name="__codelineno-0-3911"></a>    <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-3912"><a id="__codelineno-0-3912" name="__codelineno-0-3912"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3913"><a id="__codelineno-0-3913" name="__codelineno-0-3913"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get email from inbox of a given user and a given sender (from).</span>
</span><span id="__span-0-3914"><a id="__codelineno-0-3914" name="__codelineno-0-3914"></a>
</span><span id="__span-0-3915"><a id="__codelineno-0-3915" name="__codelineno-0-3915"></a><span class="sd">    This requires Mail.Read Application permissions for the Azure App being used.</span>
</span><span id="__span-0-3916"><a id="__codelineno-0-3916" name="__codelineno-0-3916"></a>
</span><span id="__span-0-3917"><a id="__codelineno-0-3917" name="__codelineno-0-3917"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3918"><a id="__codelineno-0-3918" name="__codelineno-0-3918"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-3919"><a id="__codelineno-0-3919" name="__codelineno-0-3919"></a><span class="sd">            The M365 ID of the user.</span>
</span><span id="__span-0-3920"><a id="__codelineno-0-3920" name="__codelineno-0-3920"></a><span class="sd">        sender (str):</span>
</span><span id="__span-0-3921"><a id="__codelineno-0-3921" name="__codelineno-0-3921"></a><span class="sd">            The sender email address to filter for.</span>
</span><span id="__span-0-3922"><a id="__codelineno-0-3922" name="__codelineno-0-3922"></a><span class="sd">        subject (str):</span>
</span><span id="__span-0-3923"><a id="__codelineno-0-3923" name="__codelineno-0-3923"></a><span class="sd">            The subject to filter for.</span>
</span><span id="__span-0-3924"><a id="__codelineno-0-3924" name="__codelineno-0-3924"></a><span class="sd">        num_emails (int, optional):</span>
</span><span id="__span-0-3925"><a id="__codelineno-0-3925" name="__codelineno-0-3925"></a><span class="sd">            The number of matching emails to retrieve.</span>
</span><span id="__span-0-3926"><a id="__codelineno-0-3926" name="__codelineno-0-3926"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-3927"><a id="__codelineno-0-3927" name="__codelineno-0-3927"></a><span class="sd">            Whether or not an error should be displayed if the</span>
</span><span id="__span-0-3928"><a id="__codelineno-0-3928" name="__codelineno-0-3928"></a><span class="sd">            user is not found.</span>
</span><span id="__span-0-3929"><a id="__codelineno-0-3929" name="__codelineno-0-3929"></a>
</span><span id="__span-0-3930"><a id="__codelineno-0-3930" name="__codelineno-0-3930"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3931"><a id="__codelineno-0-3931" name="__codelineno-0-3931"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3932"><a id="__codelineno-0-3932" name="__codelineno-0-3932"></a><span class="sd">            Email or None of the request fails.</span>
</span><span id="__span-0-3933"><a id="__codelineno-0-3933" name="__codelineno-0-3933"></a>
</span><span id="__span-0-3934"><a id="__codelineno-0-3934" name="__codelineno-0-3934"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3935"><a id="__codelineno-0-3935" name="__codelineno-0-3935"></a>
</span><span id="__span-0-3936"><a id="__codelineno-0-3936" name="__codelineno-0-3936"></a>    <span class="c1"># Attention: you  can easily run in limitation of the MS Graph API. If selection + filtering</span>
</span><span id="__span-0-3937"><a id="__codelineno-0-3937" name="__codelineno-0-3937"></a>    <span class="c1"># is too complex you can get this error: &quot;The restriction or sort order is too complex for this operation.&quot;</span>
</span><span id="__span-0-3938"><a id="__codelineno-0-3938" name="__codelineno-0-3938"></a>    <span class="c1"># that&#39;s why we first just do the ordering and then do the filtering on sender and subject</span>
</span><span id="__span-0-3939"><a id="__codelineno-0-3939" name="__codelineno-0-3939"></a>    <span class="c1"># separately</span>
</span><span id="__span-0-3940"><a id="__codelineno-0-3940" name="__codelineno-0-3940"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3941"><a id="__codelineno-0-3941" name="__codelineno-0-3941"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-3942"><a id="__codelineno-0-3942" name="__codelineno-0-3942"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-3943"><a id="__codelineno-0-3943" name="__codelineno-0-3943"></a>        <span class="o">+</span> <span class="n">user_id</span>
</span><span id="__span-0-3944"><a id="__codelineno-0-3944" name="__codelineno-0-3944"></a>        <span class="c1">#            + &quot;/messages?$filter=from/emailAddress/address eq &#39;{}&#39; and contains(subject, &#39;{}&#39;)&amp;$orderby=receivedDateTime desc&quot;.format(</span>
</span><span id="__span-0-3945"><a id="__codelineno-0-3945" name="__codelineno-0-3945"></a>        <span class="o">+</span> <span class="s2">&quot;/messages?$orderby=receivedDateTime desc&quot;</span>
</span><span id="__span-0-3946"><a id="__codelineno-0-3946" name="__codelineno-0-3946"></a>    <span class="p">)</span>
</span><span id="__span-0-3947"><a id="__codelineno-0-3947" name="__codelineno-0-3947"></a>    <span class="k">if</span> <span class="n">num_emails</span><span class="p">:</span>
</span><span id="__span-0-3948"><a id="__codelineno-0-3948" name="__codelineno-0-3948"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;&amp;$top=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_emails</span><span class="p">)</span>
</span><span id="__span-0-3949"><a id="__codelineno-0-3949" name="__codelineno-0-3949"></a>
</span><span id="__span-0-3950"><a id="__codelineno-0-3950" name="__codelineno-0-3950"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3951"><a id="__codelineno-0-3951" name="__codelineno-0-3951"></a>
</span><span id="__span-0-3952"><a id="__codelineno-0-3952" name="__codelineno-0-3952"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3953"><a id="__codelineno-0-3953" name="__codelineno-0-3953"></a>        <span class="s2">&quot;Get mails for user -&gt; </span><span class="si">%s</span><span class="s2"> from -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; with subject -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3954"><a id="__codelineno-0-3954" name="__codelineno-0-3954"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3955"><a id="__codelineno-0-3955" name="__codelineno-0-3955"></a>        <span class="n">sender</span><span class="p">,</span>
</span><span id="__span-0-3956"><a id="__codelineno-0-3956" name="__codelineno-0-3956"></a>        <span class="n">subject</span><span class="p">,</span>
</span><span id="__span-0-3957"><a id="__codelineno-0-3957" name="__codelineno-0-3957"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3958"><a id="__codelineno-0-3958" name="__codelineno-0-3958"></a>    <span class="p">)</span>
</span><span id="__span-0-3959"><a id="__codelineno-0-3959" name="__codelineno-0-3959"></a>
</span><span id="__span-0-3960"><a id="__codelineno-0-3960" name="__codelineno-0-3960"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3961"><a id="__codelineno-0-3961" name="__codelineno-0-3961"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3962"><a id="__codelineno-0-3962" name="__codelineno-0-3962"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-3963"><a id="__codelineno-0-3963" name="__codelineno-0-3963"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3964"><a id="__codelineno-0-3964" name="__codelineno-0-3964"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3965"><a id="__codelineno-0-3965" name="__codelineno-0-3965"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot retrieve emails for M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-3966"><a id="__codelineno-0-3966" name="__codelineno-0-3966"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-3967"><a id="__codelineno-0-3967" name="__codelineno-0-3967"></a>    <span class="p">)</span>
</span><span id="__span-0-3968"><a id="__codelineno-0-3968" name="__codelineno-0-3968"></a>
</span><span id="__span-0-3969"><a id="__codelineno-0-3969" name="__codelineno-0-3969"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="s2">&quot;value&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-3970"><a id="__codelineno-0-3970" name="__codelineno-0-3970"></a>        <span class="n">messages</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-3971"><a id="__codelineno-0-3971" name="__codelineno-0-3971"></a>
</span><span id="__span-0-3972"><a id="__codelineno-0-3972" name="__codelineno-0-3972"></a>        <span class="c1"># Filter the messages by sender and subject in code</span>
</span><span id="__span-0-3973"><a id="__codelineno-0-3973" name="__codelineno-0-3973"></a>        <span class="n">filtered_messages</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-3974"><a id="__codelineno-0-3974" name="__codelineno-0-3974"></a>            <span class="n">msg</span>
</span><span id="__span-0-3975"><a id="__codelineno-0-3975" name="__codelineno-0-3975"></a>            <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span>
</span><span id="__span-0-3976"><a id="__codelineno-0-3976" name="__codelineno-0-3976"></a>            <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;emailAddress&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">sender</span>
</span><span id="__span-0-3977"><a id="__codelineno-0-3977" name="__codelineno-0-3977"></a>            <span class="ow">and</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-3978"><a id="__codelineno-0-3978" name="__codelineno-0-3978"></a>        <span class="p">]</span>
</span><span id="__span-0-3979"><a id="__codelineno-0-3979" name="__codelineno-0-3979"></a>        <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_messages</span>
</span><span id="__span-0-3980"><a id="__codelineno-0-3980" name="__codelineno-0-3980"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-3981"><a id="__codelineno-0-3981" name="__codelineno-0-3981"></a>
</span><span id="__span-0-3982"><a id="__codelineno-0-3982" name="__codelineno-0-3982"></a>    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_mail_body" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_mail_body</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">email_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get full email body for a given email ID.</p>
<p>This requires Mail.Read Application permissions for the Azure App being used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 ID of the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>email_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 ID of the email.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
Email body or None of the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3986">3986</a></span>
<span class="normal"><a href="#__codelineno-0-3987">3987</a></span>
<span class="normal"><a href="#__codelineno-0-3988">3988</a></span>
<span class="normal"><a href="#__codelineno-0-3989">3989</a></span>
<span class="normal"><a href="#__codelineno-0-3990">3990</a></span>
<span class="normal"><a href="#__codelineno-0-3991">3991</a></span>
<span class="normal"><a href="#__codelineno-0-3992">3992</a></span>
<span class="normal"><a href="#__codelineno-0-3993">3993</a></span>
<span class="normal"><a href="#__codelineno-0-3994">3994</a></span>
<span class="normal"><a href="#__codelineno-0-3995">3995</a></span>
<span class="normal"><a href="#__codelineno-0-3996">3996</a></span>
<span class="normal"><a href="#__codelineno-0-3997">3997</a></span>
<span class="normal"><a href="#__codelineno-0-3998">3998</a></span>
<span class="normal"><a href="#__codelineno-0-3999">3999</a></span>
<span class="normal"><a href="#__codelineno-0-4000">4000</a></span>
<span class="normal"><a href="#__codelineno-0-4001">4001</a></span>
<span class="normal"><a href="#__codelineno-0-4002">4002</a></span>
<span class="normal"><a href="#__codelineno-0-4003">4003</a></span>
<span class="normal"><a href="#__codelineno-0-4004">4004</a></span>
<span class="normal"><a href="#__codelineno-0-4005">4005</a></span>
<span class="normal"><a href="#__codelineno-0-4006">4006</a></span>
<span class="normal"><a href="#__codelineno-0-4007">4007</a></span>
<span class="normal"><a href="#__codelineno-0-4008">4008</a></span>
<span class="normal"><a href="#__codelineno-0-4009">4009</a></span>
<span class="normal"><a href="#__codelineno-0-4010">4010</a></span>
<span class="normal"><a href="#__codelineno-0-4011">4011</a></span>
<span class="normal"><a href="#__codelineno-0-4012">4012</a></span>
<span class="normal"><a href="#__codelineno-0-4013">4013</a></span>
<span class="normal"><a href="#__codelineno-0-4014">4014</a></span>
<span class="normal"><a href="#__codelineno-0-4015">4015</a></span>
<span class="normal"><a href="#__codelineno-0-4016">4016</a></span>
<span class="normal"><a href="#__codelineno-0-4017">4017</a></span>
<span class="normal"><a href="#__codelineno-0-4018">4018</a></span>
<span class="normal"><a href="#__codelineno-0-4019">4019</a></span>
<span class="normal"><a href="#__codelineno-0-4020">4020</a></span>
<span class="normal"><a href="#__codelineno-0-4021">4021</a></span>
<span class="normal"><a href="#__codelineno-0-4022">4022</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3986"><a id="__codelineno-0-3986" name="__codelineno-0-3986"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_mail_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3987"><a id="__codelineno-0-3987" name="__codelineno-0-3987"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get full email body for a given email ID.</span>
</span><span id="__span-0-3988"><a id="__codelineno-0-3988" name="__codelineno-0-3988"></a>
</span><span id="__span-0-3989"><a id="__codelineno-0-3989" name="__codelineno-0-3989"></a><span class="sd">    This requires Mail.Read Application permissions for the Azure App being used.</span>
</span><span id="__span-0-3990"><a id="__codelineno-0-3990" name="__codelineno-0-3990"></a>
</span><span id="__span-0-3991"><a id="__codelineno-0-3991" name="__codelineno-0-3991"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3992"><a id="__codelineno-0-3992" name="__codelineno-0-3992"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-3993"><a id="__codelineno-0-3993" name="__codelineno-0-3993"></a><span class="sd">            The M365 ID of the user.</span>
</span><span id="__span-0-3994"><a id="__codelineno-0-3994" name="__codelineno-0-3994"></a><span class="sd">        email_id (str):</span>
</span><span id="__span-0-3995"><a id="__codelineno-0-3995" name="__codelineno-0-3995"></a><span class="sd">            The M365 ID of the email.</span>
</span><span id="__span-0-3996"><a id="__codelineno-0-3996" name="__codelineno-0-3996"></a>
</span><span id="__span-0-3997"><a id="__codelineno-0-3997" name="__codelineno-0-3997"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3998"><a id="__codelineno-0-3998" name="__codelineno-0-3998"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-3999"><a id="__codelineno-0-3999" name="__codelineno-0-3999"></a><span class="sd">            Email body or None of the request fails.</span>
</span><span id="__span-0-4000"><a id="__codelineno-0-4000" name="__codelineno-0-4000"></a>
</span><span id="__span-0-4001"><a id="__codelineno-0-4001" name="__codelineno-0-4001"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4002"><a id="__codelineno-0-4002" name="__codelineno-0-4002"></a>
</span><span id="__span-0-4003"><a id="__codelineno-0-4003" name="__codelineno-0-4003"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/messages/&quot;</span> <span class="o">+</span> <span class="n">email_id</span> <span class="o">+</span> <span class="s2">&quot;/$value&quot;</span>
</span><span id="__span-0-4004"><a id="__codelineno-0-4004" name="__codelineno-0-4004"></a>
</span><span id="__span-0-4005"><a id="__codelineno-0-4005" name="__codelineno-0-4005"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4006"><a id="__codelineno-0-4006" name="__codelineno-0-4006"></a>
</span><span id="__span-0-4007"><a id="__codelineno-0-4007" name="__codelineno-0-4007"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4008"><a id="__codelineno-0-4008" name="__codelineno-0-4008"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4009"><a id="__codelineno-0-4009" name="__codelineno-0-4009"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4010"><a id="__codelineno-0-4010" name="__codelineno-0-4010"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4011"><a id="__codelineno-0-4011" name="__codelineno-0-4011"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4012"><a id="__codelineno-0-4012" name="__codelineno-0-4012"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get email body for M365 user -&gt; </span><span class="si">{}</span><span class="s2"> and email with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4013"><a id="__codelineno-0-4013" name="__codelineno-0-4013"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-4014"><a id="__codelineno-0-4014" name="__codelineno-0-4014"></a>            <span class="n">email_id</span><span class="p">,</span>
</span><span id="__span-0-4015"><a id="__codelineno-0-4015" name="__codelineno-0-4015"></a>        <span class="p">),</span>
</span><span id="__span-0-4016"><a id="__codelineno-0-4016" name="__codelineno-0-4016"></a>        <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4017"><a id="__codelineno-0-4017" name="__codelineno-0-4017"></a>    <span class="p">)</span>
</span><span id="__span-0-4018"><a id="__codelineno-0-4018" name="__codelineno-0-4018"></a>
</span><span id="__span-0-4019"><a id="__codelineno-0-4019" name="__codelineno-0-4019"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span><span id="__span-0-4020"><a id="__codelineno-0-4020" name="__codelineno-0-4020"></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="__span-0-4021"><a id="__codelineno-0-4021" name="__codelineno-0-4021"></a>
</span><span id="__span-0-4022"><a id="__codelineno-0-4022" name="__codelineno-0-4022"></a>    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_result_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sub_dict_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get value of a result property with a given key of an MS Graph API call.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>REST response from an MS Graph REST Call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The property name (key).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index to use (1st element has index 0).
Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_dict_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Some MS Graph API calls include nested dict structures that can
be requested with an "expand" query parameter. In such
a case we use the sub_dict_name to access it.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
The value for the key, None otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_result_value</span><span class="p">(</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="n">response</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="n">sub_dict_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get value of a result property with a given key of an MS Graph API call.</span>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    Args:</span>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        response (dict | None):</span>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">            REST response from an MS Graph REST Call.</span>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        key (str):</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">            The property name (key).</span>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        index (int, optional):</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">            Index to use (1st element has index 0).</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            Defaults to 0.</span>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        sub_dict_name (str):</span>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            Some MS Graph API calls include nested dict structures that can</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            be requested with an &quot;expand&quot; query parameter. In such</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">            a case we use the sub_dict_name to access it.</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            The value for the key, None otherwise.</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="k">if</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>  <span class="c1"># If Graph APIs are called with specific IDs (and not name lookups)</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="c1"># they may not return a list of dicts calles &quot;values&quot; but a single dict directly</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">and</span> <span class="n">sub_dict_name</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>            <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="c1"># also the substructure could be a list</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_structure</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>                <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">sub_structure</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="k">return</span> <span class="n">sub_structure</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="n">values</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">index</span><span class="p">:</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_dict_name</span><span class="p">:</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_structure</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>            <span class="c1"># here we assume it is the first element of the</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="c1"># substructure. If really required for specific</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>            <span class="c1"># use cases we may introduce a second index in</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="c1"># the future.</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">sub_structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="k">return</span> <span class="n">sub_structure</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a page of a SharePoint site accessible to the authenticated user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site the page should be get for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the page to be retrieved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
A SharePoint site page.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C9b203cbe-27ca-45b2-944a-663cc99e5e8f%2Ca1462b54-26f9-4a24-9660-2bc7859ce9af')/pages/$entity",
    '@odata.type': '#microsoft.graph.sitePage',
    '@odata.etag': '"{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4"',
    'createdDateTime': '2025-01-26T00:03:24Z',
    'eTag': '"{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4"',
    'id': 'a546ce61-21e6-431d-b2cd-67d1f722be5f',
    'lastModifiedDateTime': '2025-01-26T00:03:24Z',
    'name': 'Home.aspx',
    'webUrl': 'https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795/SitePages/Home.aspx',
    'title': 'Home',
    'pageLayout': 'home',
    'promotionKind': 'page',
    'showComments': False,
    'showRecommendedPages': False,
    'contentType': {
        'id': '0x0101009D1CB255DA76424F860D91F20E6C4118003CD261A156017A45BA0F28B5923AE8F6',
        'name': 'Site Page'
    },
    'createdBy': {
        'user': {...}
    },
    'lastModifiedBy': {
        'user': {...}
    },
    'parentReference': {
        'siteId': '9b203cbe-27ca-45b2-944a-663cc99e5e8f'
    },
    'publishingState': {
        'level': 'published',
        'versionId': '1.0'
    },
    'reactions': {}
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4815">4815</a></span>
<span class="normal"><a href="#__codelineno-0-4816">4816</a></span>
<span class="normal"><a href="#__codelineno-0-4817">4817</a></span>
<span class="normal"><a href="#__codelineno-0-4818">4818</a></span>
<span class="normal"><a href="#__codelineno-0-4819">4819</a></span>
<span class="normal"><a href="#__codelineno-0-4820">4820</a></span>
<span class="normal"><a href="#__codelineno-0-4821">4821</a></span>
<span class="normal"><a href="#__codelineno-0-4822">4822</a></span>
<span class="normal"><a href="#__codelineno-0-4823">4823</a></span>
<span class="normal"><a href="#__codelineno-0-4824">4824</a></span>
<span class="normal"><a href="#__codelineno-0-4825">4825</a></span>
<span class="normal"><a href="#__codelineno-0-4826">4826</a></span>
<span class="normal"><a href="#__codelineno-0-4827">4827</a></span>
<span class="normal"><a href="#__codelineno-0-4828">4828</a></span>
<span class="normal"><a href="#__codelineno-0-4829">4829</a></span>
<span class="normal"><a href="#__codelineno-0-4830">4830</a></span>
<span class="normal"><a href="#__codelineno-0-4831">4831</a></span>
<span class="normal"><a href="#__codelineno-0-4832">4832</a></span>
<span class="normal"><a href="#__codelineno-0-4833">4833</a></span>
<span class="normal"><a href="#__codelineno-0-4834">4834</a></span>
<span class="normal"><a href="#__codelineno-0-4835">4835</a></span>
<span class="normal"><a href="#__codelineno-0-4836">4836</a></span>
<span class="normal"><a href="#__codelineno-0-4837">4837</a></span>
<span class="normal"><a href="#__codelineno-0-4838">4838</a></span>
<span class="normal"><a href="#__codelineno-0-4839">4839</a></span>
<span class="normal"><a href="#__codelineno-0-4840">4840</a></span>
<span class="normal"><a href="#__codelineno-0-4841">4841</a></span>
<span class="normal"><a href="#__codelineno-0-4842">4842</a></span>
<span class="normal"><a href="#__codelineno-0-4843">4843</a></span>
<span class="normal"><a href="#__codelineno-0-4844">4844</a></span>
<span class="normal"><a href="#__codelineno-0-4845">4845</a></span>
<span class="normal"><a href="#__codelineno-0-4846">4846</a></span>
<span class="normal"><a href="#__codelineno-0-4847">4847</a></span>
<span class="normal"><a href="#__codelineno-0-4848">4848</a></span>
<span class="normal"><a href="#__codelineno-0-4849">4849</a></span>
<span class="normal"><a href="#__codelineno-0-4850">4850</a></span>
<span class="normal"><a href="#__codelineno-0-4851">4851</a></span>
<span class="normal"><a href="#__codelineno-0-4852">4852</a></span>
<span class="normal"><a href="#__codelineno-0-4853">4853</a></span>
<span class="normal"><a href="#__codelineno-0-4854">4854</a></span>
<span class="normal"><a href="#__codelineno-0-4855">4855</a></span>
<span class="normal"><a href="#__codelineno-0-4856">4856</a></span>
<span class="normal"><a href="#__codelineno-0-4857">4857</a></span>
<span class="normal"><a href="#__codelineno-0-4858">4858</a></span>
<span class="normal"><a href="#__codelineno-0-4859">4859</a></span>
<span class="normal"><a href="#__codelineno-0-4860">4860</a></span>
<span class="normal"><a href="#__codelineno-0-4861">4861</a></span>
<span class="normal"><a href="#__codelineno-0-4862">4862</a></span>
<span class="normal"><a href="#__codelineno-0-4863">4863</a></span>
<span class="normal"><a href="#__codelineno-0-4864">4864</a></span>
<span class="normal"><a href="#__codelineno-0-4865">4865</a></span>
<span class="normal"><a href="#__codelineno-0-4866">4866</a></span>
<span class="normal"><a href="#__codelineno-0-4867">4867</a></span>
<span class="normal"><a href="#__codelineno-0-4868">4868</a></span>
<span class="normal"><a href="#__codelineno-0-4869">4869</a></span>
<span class="normal"><a href="#__codelineno-0-4870">4870</a></span>
<span class="normal"><a href="#__codelineno-0-4871">4871</a></span>
<span class="normal"><a href="#__codelineno-0-4872">4872</a></span>
<span class="normal"><a href="#__codelineno-0-4873">4873</a></span>
<span class="normal"><a href="#__codelineno-0-4874">4874</a></span>
<span class="normal"><a href="#__codelineno-0-4875">4875</a></span>
<span class="normal"><a href="#__codelineno-0-4876">4876</a></span>
<span class="normal"><a href="#__codelineno-0-4877">4877</a></span>
<span class="normal"><a href="#__codelineno-0-4878">4878</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4815"><a id="__codelineno-0-4815" name="__codelineno-0-4815"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4816"><a id="__codelineno-0-4816" name="__codelineno-0-4816"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a page of a SharePoint site accessible to the authenticated user.</span>
</span><span id="__span-0-4817"><a id="__codelineno-0-4817" name="__codelineno-0-4817"></a>
</span><span id="__span-0-4818"><a id="__codelineno-0-4818" name="__codelineno-0-4818"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4819"><a id="__codelineno-0-4819" name="__codelineno-0-4819"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-4820"><a id="__codelineno-0-4820" name="__codelineno-0-4820"></a><span class="sd">            The ID of the SharePoint site the page should be get for.</span>
</span><span id="__span-0-4821"><a id="__codelineno-0-4821" name="__codelineno-0-4821"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-4822"><a id="__codelineno-0-4822" name="__codelineno-0-4822"></a><span class="sd">            The ID of the page to be retrieved.</span>
</span><span id="__span-0-4823"><a id="__codelineno-0-4823" name="__codelineno-0-4823"></a>
</span><span id="__span-0-4824"><a id="__codelineno-0-4824" name="__codelineno-0-4824"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4825"><a id="__codelineno-0-4825" name="__codelineno-0-4825"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-4826"><a id="__codelineno-0-4826" name="__codelineno-0-4826"></a><span class="sd">            A SharePoint site page.</span>
</span><span id="__span-0-4827"><a id="__codelineno-0-4827" name="__codelineno-0-4827"></a>
</span><span id="__span-0-4828"><a id="__codelineno-0-4828" name="__codelineno-0-4828"></a><span class="sd">    Example:</span>
</span><span id="__span-0-4829"><a id="__codelineno-0-4829" name="__codelineno-0-4829"></a><span class="sd">    {</span>
</span><span id="__span-0-4830"><a id="__codelineno-0-4830" name="__codelineno-0-4830"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C9b203cbe-27ca-45b2-944a-663cc99e5e8f%2Ca1462b54-26f9-4a24-9660-2bc7859ce9af&#39;)/pages/$entity&quot;,</span>
</span><span id="__span-0-4831"><a id="__codelineno-0-4831" name="__codelineno-0-4831"></a><span class="sd">        &#39;@odata.type&#39;: &#39;#microsoft.graph.sitePage&#39;,</span>
</span><span id="__span-0-4832"><a id="__codelineno-0-4832" name="__codelineno-0-4832"></a><span class="sd">        &#39;@odata.etag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4833"><a id="__codelineno-0-4833" name="__codelineno-0-4833"></a><span class="sd">        &#39;createdDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4834"><a id="__codelineno-0-4834" name="__codelineno-0-4834"></a><span class="sd">        &#39;eTag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4835"><a id="__codelineno-0-4835" name="__codelineno-0-4835"></a><span class="sd">        &#39;id&#39;: &#39;a546ce61-21e6-431d-b2cd-67d1f722be5f&#39;,</span>
</span><span id="__span-0-4836"><a id="__codelineno-0-4836" name="__codelineno-0-4836"></a><span class="sd">        &#39;lastModifiedDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4837"><a id="__codelineno-0-4837" name="__codelineno-0-4837"></a><span class="sd">        &#39;name&#39;: &#39;Home.aspx&#39;,</span>
</span><span id="__span-0-4838"><a id="__codelineno-0-4838" name="__codelineno-0-4838"></a><span class="sd">        &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795/SitePages/Home.aspx&#39;,</span>
</span><span id="__span-0-4839"><a id="__codelineno-0-4839" name="__codelineno-0-4839"></a><span class="sd">        &#39;title&#39;: &#39;Home&#39;,</span>
</span><span id="__span-0-4840"><a id="__codelineno-0-4840" name="__codelineno-0-4840"></a><span class="sd">        &#39;pageLayout&#39;: &#39;home&#39;,</span>
</span><span id="__span-0-4841"><a id="__codelineno-0-4841" name="__codelineno-0-4841"></a><span class="sd">        &#39;promotionKind&#39;: &#39;page&#39;,</span>
</span><span id="__span-0-4842"><a id="__codelineno-0-4842" name="__codelineno-0-4842"></a><span class="sd">        &#39;showComments&#39;: False,</span>
</span><span id="__span-0-4843"><a id="__codelineno-0-4843" name="__codelineno-0-4843"></a><span class="sd">        &#39;showRecommendedPages&#39;: False,</span>
</span><span id="__span-0-4844"><a id="__codelineno-0-4844" name="__codelineno-0-4844"></a><span class="sd">        &#39;contentType&#39;: {</span>
</span><span id="__span-0-4845"><a id="__codelineno-0-4845" name="__codelineno-0-4845"></a><span class="sd">            &#39;id&#39;: &#39;0x0101009D1CB255DA76424F860D91F20E6C4118003CD261A156017A45BA0F28B5923AE8F6&#39;,</span>
</span><span id="__span-0-4846"><a id="__codelineno-0-4846" name="__codelineno-0-4846"></a><span class="sd">            &#39;name&#39;: &#39;Site Page&#39;</span>
</span><span id="__span-0-4847"><a id="__codelineno-0-4847" name="__codelineno-0-4847"></a><span class="sd">        },</span>
</span><span id="__span-0-4848"><a id="__codelineno-0-4848" name="__codelineno-0-4848"></a><span class="sd">        &#39;createdBy&#39;: {</span>
</span><span id="__span-0-4849"><a id="__codelineno-0-4849" name="__codelineno-0-4849"></a><span class="sd">            &#39;user&#39;: {...}</span>
</span><span id="__span-0-4850"><a id="__codelineno-0-4850" name="__codelineno-0-4850"></a><span class="sd">        },</span>
</span><span id="__span-0-4851"><a id="__codelineno-0-4851" name="__codelineno-0-4851"></a><span class="sd">        &#39;lastModifiedBy&#39;: {</span>
</span><span id="__span-0-4852"><a id="__codelineno-0-4852" name="__codelineno-0-4852"></a><span class="sd">            &#39;user&#39;: {...}</span>
</span><span id="__span-0-4853"><a id="__codelineno-0-4853" name="__codelineno-0-4853"></a><span class="sd">        },</span>
</span><span id="__span-0-4854"><a id="__codelineno-0-4854" name="__codelineno-0-4854"></a><span class="sd">        &#39;parentReference&#39;: {</span>
</span><span id="__span-0-4855"><a id="__codelineno-0-4855" name="__codelineno-0-4855"></a><span class="sd">            &#39;siteId&#39;: &#39;9b203cbe-27ca-45b2-944a-663cc99e5e8f&#39;</span>
</span><span id="__span-0-4856"><a id="__codelineno-0-4856" name="__codelineno-0-4856"></a><span class="sd">        },</span>
</span><span id="__span-0-4857"><a id="__codelineno-0-4857" name="__codelineno-0-4857"></a><span class="sd">        &#39;publishingState&#39;: {</span>
</span><span id="__span-0-4858"><a id="__codelineno-0-4858" name="__codelineno-0-4858"></a><span class="sd">            &#39;level&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-4859"><a id="__codelineno-0-4859" name="__codelineno-0-4859"></a><span class="sd">            &#39;versionId&#39;: &#39;1.0&#39;</span>
</span><span id="__span-0-4860"><a id="__codelineno-0-4860" name="__codelineno-0-4860"></a><span class="sd">        },</span>
</span><span id="__span-0-4861"><a id="__codelineno-0-4861" name="__codelineno-0-4861"></a><span class="sd">        &#39;reactions&#39;: {}</span>
</span><span id="__span-0-4862"><a id="__codelineno-0-4862" name="__codelineno-0-4862"></a><span class="sd">    }</span>
</span><span id="__span-0-4863"><a id="__codelineno-0-4863" name="__codelineno-0-4863"></a>
</span><span id="__span-0-4864"><a id="__codelineno-0-4864" name="__codelineno-0-4864"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4865"><a id="__codelineno-0-4865" name="__codelineno-0-4865"></a>
</span><span id="__span-0-4866"><a id="__codelineno-0-4866" name="__codelineno-0-4866"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span> <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-4867"><a id="__codelineno-0-4867" name="__codelineno-0-4867"></a>
</span><span id="__span-0-4868"><a id="__codelineno-0-4868" name="__codelineno-0-4868"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4869"><a id="__codelineno-0-4869" name="__codelineno-0-4869"></a>
</span><span id="__span-0-4870"><a id="__codelineno-0-4870" name="__codelineno-0-4870"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4871"><a id="__codelineno-0-4871" name="__codelineno-0-4871"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4872"><a id="__codelineno-0-4872" name="__codelineno-0-4872"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4873"><a id="__codelineno-0-4873" name="__codelineno-0-4873"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4874"><a id="__codelineno-0-4874" name="__codelineno-0-4874"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4875"><a id="__codelineno-0-4875" name="__codelineno-0-4875"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; for site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">page_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">),</span>
</span><span id="__span-0-4876"><a id="__codelineno-0-4876" name="__codelineno-0-4876"></a>    <span class="p">)</span>
</span><span id="__span-0-4877"><a id="__codelineno-0-4877" name="__codelineno-0-4877"></a>
</span><span id="__span-0-4878"><a id="__codelineno-0-4878" name="__codelineno-0-4878"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_pages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_pages</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a list of SharePoint site pages accessible to the authenticated user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site the pages should be retrieved for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary including the list of SharePoint pages for a given page.
The actual list is included inside the "value" key of the dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26')/pages",
    'value': [
        {
            '@odata.type': '#microsoft.graph.sitePage',
            '@odata.etag': '"{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4"',
            'createdDateTime': '2025-01-26T00:03:24Z',
            'eTag': '"{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4"',
            'id': 'a546ce61-21e6-431d-b2cd-67d1f722be5f',
            'lastModifiedDateTime': '2025-01-26T00:03:24Z',
            'name': 'Home.aspx',
            'webUrl': 'https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795/SitePages/Home.aspx',
            'title': 'Home',
            'pageLayout': 'home',
            'promotionKind': 'page',
            'showComments': False,
            'showRecommendedPages': False,
            'contentType': {
                'id': '0x0101009D1CB255DA76424F860D91F20E6C411800813863BBF9FE6A408AE59965D98FE3DA',
                'name': 'Site Page'
            },
            'createdBy': {'user': {'displayName': 'System Account'}},
            'lastModifiedBy': {'user': {'displayName': 'Terrarium Admin', 'email': 'admin@dev.idea-te.eimdemo.com'}},
            'parentReference': {'siteId': '61c0f9cb-39d3-4c04-b60c-31576954a2ab'},
            'publishingState': {'level': 'published', 'versionId': '4.0'},
            'reactions': {}
        },
        ...
    ]
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4753">4753</a></span>
<span class="normal"><a href="#__codelineno-0-4754">4754</a></span>
<span class="normal"><a href="#__codelineno-0-4755">4755</a></span>
<span class="normal"><a href="#__codelineno-0-4756">4756</a></span>
<span class="normal"><a href="#__codelineno-0-4757">4757</a></span>
<span class="normal"><a href="#__codelineno-0-4758">4758</a></span>
<span class="normal"><a href="#__codelineno-0-4759">4759</a></span>
<span class="normal"><a href="#__codelineno-0-4760">4760</a></span>
<span class="normal"><a href="#__codelineno-0-4761">4761</a></span>
<span class="normal"><a href="#__codelineno-0-4762">4762</a></span>
<span class="normal"><a href="#__codelineno-0-4763">4763</a></span>
<span class="normal"><a href="#__codelineno-0-4764">4764</a></span>
<span class="normal"><a href="#__codelineno-0-4765">4765</a></span>
<span class="normal"><a href="#__codelineno-0-4766">4766</a></span>
<span class="normal"><a href="#__codelineno-0-4767">4767</a></span>
<span class="normal"><a href="#__codelineno-0-4768">4768</a></span>
<span class="normal"><a href="#__codelineno-0-4769">4769</a></span>
<span class="normal"><a href="#__codelineno-0-4770">4770</a></span>
<span class="normal"><a href="#__codelineno-0-4771">4771</a></span>
<span class="normal"><a href="#__codelineno-0-4772">4772</a></span>
<span class="normal"><a href="#__codelineno-0-4773">4773</a></span>
<span class="normal"><a href="#__codelineno-0-4774">4774</a></span>
<span class="normal"><a href="#__codelineno-0-4775">4775</a></span>
<span class="normal"><a href="#__codelineno-0-4776">4776</a></span>
<span class="normal"><a href="#__codelineno-0-4777">4777</a></span>
<span class="normal"><a href="#__codelineno-0-4778">4778</a></span>
<span class="normal"><a href="#__codelineno-0-4779">4779</a></span>
<span class="normal"><a href="#__codelineno-0-4780">4780</a></span>
<span class="normal"><a href="#__codelineno-0-4781">4781</a></span>
<span class="normal"><a href="#__codelineno-0-4782">4782</a></span>
<span class="normal"><a href="#__codelineno-0-4783">4783</a></span>
<span class="normal"><a href="#__codelineno-0-4784">4784</a></span>
<span class="normal"><a href="#__codelineno-0-4785">4785</a></span>
<span class="normal"><a href="#__codelineno-0-4786">4786</a></span>
<span class="normal"><a href="#__codelineno-0-4787">4787</a></span>
<span class="normal"><a href="#__codelineno-0-4788">4788</a></span>
<span class="normal"><a href="#__codelineno-0-4789">4789</a></span>
<span class="normal"><a href="#__codelineno-0-4790">4790</a></span>
<span class="normal"><a href="#__codelineno-0-4791">4791</a></span>
<span class="normal"><a href="#__codelineno-0-4792">4792</a></span>
<span class="normal"><a href="#__codelineno-0-4793">4793</a></span>
<span class="normal"><a href="#__codelineno-0-4794">4794</a></span>
<span class="normal"><a href="#__codelineno-0-4795">4795</a></span>
<span class="normal"><a href="#__codelineno-0-4796">4796</a></span>
<span class="normal"><a href="#__codelineno-0-4797">4797</a></span>
<span class="normal"><a href="#__codelineno-0-4798">4798</a></span>
<span class="normal"><a href="#__codelineno-0-4799">4799</a></span>
<span class="normal"><a href="#__codelineno-0-4800">4800</a></span>
<span class="normal"><a href="#__codelineno-0-4801">4801</a></span>
<span class="normal"><a href="#__codelineno-0-4802">4802</a></span>
<span class="normal"><a href="#__codelineno-0-4803">4803</a></span>
<span class="normal"><a href="#__codelineno-0-4804">4804</a></span>
<span class="normal"><a href="#__codelineno-0-4805">4805</a></span>
<span class="normal"><a href="#__codelineno-0-4806">4806</a></span>
<span class="normal"><a href="#__codelineno-0-4807">4807</a></span>
<span class="normal"><a href="#__codelineno-0-4808">4808</a></span>
<span class="normal"><a href="#__codelineno-0-4809">4809</a></span>
<span class="normal"><a href="#__codelineno-0-4810">4810</a></span>
<span class="normal"><a href="#__codelineno-0-4811">4811</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4753"><a id="__codelineno-0-4753" name="__codelineno-0-4753"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4754"><a id="__codelineno-0-4754" name="__codelineno-0-4754"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a list of SharePoint site pages accessible to the authenticated user.</span>
</span><span id="__span-0-4755"><a id="__codelineno-0-4755" name="__codelineno-0-4755"></a>
</span><span id="__span-0-4756"><a id="__codelineno-0-4756" name="__codelineno-0-4756"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4757"><a id="__codelineno-0-4757" name="__codelineno-0-4757"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-4758"><a id="__codelineno-0-4758" name="__codelineno-0-4758"></a><span class="sd">            The ID of the SharePoint site the pages should be retrieved for.</span>
</span><span id="__span-0-4759"><a id="__codelineno-0-4759" name="__codelineno-0-4759"></a>
</span><span id="__span-0-4760"><a id="__codelineno-0-4760" name="__codelineno-0-4760"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4761"><a id="__codelineno-0-4761" name="__codelineno-0-4761"></a><span class="sd">        dict:</span>
</span><span id="__span-0-4762"><a id="__codelineno-0-4762" name="__codelineno-0-4762"></a><span class="sd">            A dictionary including the list of SharePoint pages for a given page.</span>
</span><span id="__span-0-4763"><a id="__codelineno-0-4763" name="__codelineno-0-4763"></a><span class="sd">            The actual list is included inside the &quot;value&quot; key of the dictionary.</span>
</span><span id="__span-0-4764"><a id="__codelineno-0-4764" name="__codelineno-0-4764"></a>
</span><span id="__span-0-4765"><a id="__codelineno-0-4765" name="__codelineno-0-4765"></a><span class="sd">    Example:</span>
</span><span id="__span-0-4766"><a id="__codelineno-0-4766" name="__codelineno-0-4766"></a><span class="sd">    {</span>
</span><span id="__span-0-4767"><a id="__codelineno-0-4767" name="__codelineno-0-4767"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages&quot;,</span>
</span><span id="__span-0-4768"><a id="__codelineno-0-4768" name="__codelineno-0-4768"></a><span class="sd">        &#39;value&#39;: [</span>
</span><span id="__span-0-4769"><a id="__codelineno-0-4769" name="__codelineno-0-4769"></a><span class="sd">            {</span>
</span><span id="__span-0-4770"><a id="__codelineno-0-4770" name="__codelineno-0-4770"></a><span class="sd">                &#39;@odata.type&#39;: &#39;#microsoft.graph.sitePage&#39;,</span>
</span><span id="__span-0-4771"><a id="__codelineno-0-4771" name="__codelineno-0-4771"></a><span class="sd">                &#39;@odata.etag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4772"><a id="__codelineno-0-4772" name="__codelineno-0-4772"></a><span class="sd">                &#39;createdDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4773"><a id="__codelineno-0-4773" name="__codelineno-0-4773"></a><span class="sd">                &#39;eTag&#39;: &#39;&quot;{A546CE61-21E6-431D-B2CD-67D1F722BE5F},4&quot;&#39;,</span>
</span><span id="__span-0-4774"><a id="__codelineno-0-4774" name="__codelineno-0-4774"></a><span class="sd">                &#39;id&#39;: &#39;a546ce61-21e6-431d-b2cd-67d1f722be5f&#39;,</span>
</span><span id="__span-0-4775"><a id="__codelineno-0-4775" name="__codelineno-0-4775"></a><span class="sd">                &#39;lastModifiedDateTime&#39;: &#39;2025-01-26T00:03:24Z&#39;,</span>
</span><span id="__span-0-4776"><a id="__codelineno-0-4776" name="__codelineno-0-4776"></a><span class="sd">                &#39;name&#39;: &#39;Home.aspx&#39;,</span>
</span><span id="__span-0-4777"><a id="__codelineno-0-4777" name="__codelineno-0-4777"></a><span class="sd">                &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795/SitePages/Home.aspx&#39;,</span>
</span><span id="__span-0-4778"><a id="__codelineno-0-4778" name="__codelineno-0-4778"></a><span class="sd">                &#39;title&#39;: &#39;Home&#39;,</span>
</span><span id="__span-0-4779"><a id="__codelineno-0-4779" name="__codelineno-0-4779"></a><span class="sd">                &#39;pageLayout&#39;: &#39;home&#39;,</span>
</span><span id="__span-0-4780"><a id="__codelineno-0-4780" name="__codelineno-0-4780"></a><span class="sd">                &#39;promotionKind&#39;: &#39;page&#39;,</span>
</span><span id="__span-0-4781"><a id="__codelineno-0-4781" name="__codelineno-0-4781"></a><span class="sd">                &#39;showComments&#39;: False,</span>
</span><span id="__span-0-4782"><a id="__codelineno-0-4782" name="__codelineno-0-4782"></a><span class="sd">                &#39;showRecommendedPages&#39;: False,</span>
</span><span id="__span-0-4783"><a id="__codelineno-0-4783" name="__codelineno-0-4783"></a><span class="sd">                &#39;contentType&#39;: {</span>
</span><span id="__span-0-4784"><a id="__codelineno-0-4784" name="__codelineno-0-4784"></a><span class="sd">                    &#39;id&#39;: &#39;0x0101009D1CB255DA76424F860D91F20E6C411800813863BBF9FE6A408AE59965D98FE3DA&#39;,</span>
</span><span id="__span-0-4785"><a id="__codelineno-0-4785" name="__codelineno-0-4785"></a><span class="sd">                    &#39;name&#39;: &#39;Site Page&#39;</span>
</span><span id="__span-0-4786"><a id="__codelineno-0-4786" name="__codelineno-0-4786"></a><span class="sd">                },</span>
</span><span id="__span-0-4787"><a id="__codelineno-0-4787" name="__codelineno-0-4787"></a><span class="sd">                &#39;createdBy&#39;: {&#39;user&#39;: {&#39;displayName&#39;: &#39;System Account&#39;}},</span>
</span><span id="__span-0-4788"><a id="__codelineno-0-4788" name="__codelineno-0-4788"></a><span class="sd">                &#39;lastModifiedBy&#39;: {&#39;user&#39;: {&#39;displayName&#39;: &#39;Terrarium Admin&#39;, &#39;email&#39;: &#39;admin@dev.idea-te.eimdemo.com&#39;}},</span>
</span><span id="__span-0-4789"><a id="__codelineno-0-4789" name="__codelineno-0-4789"></a><span class="sd">                &#39;parentReference&#39;: {&#39;siteId&#39;: &#39;61c0f9cb-39d3-4c04-b60c-31576954a2ab&#39;},</span>
</span><span id="__span-0-4790"><a id="__codelineno-0-4790" name="__codelineno-0-4790"></a><span class="sd">                &#39;publishingState&#39;: {&#39;level&#39;: &#39;published&#39;, &#39;versionId&#39;: &#39;4.0&#39;},</span>
</span><span id="__span-0-4791"><a id="__codelineno-0-4791" name="__codelineno-0-4791"></a><span class="sd">                &#39;reactions&#39;: {}</span>
</span><span id="__span-0-4792"><a id="__codelineno-0-4792" name="__codelineno-0-4792"></a><span class="sd">            },</span>
</span><span id="__span-0-4793"><a id="__codelineno-0-4793" name="__codelineno-0-4793"></a><span class="sd">            ...</span>
</span><span id="__span-0-4794"><a id="__codelineno-0-4794" name="__codelineno-0-4794"></a><span class="sd">        ]</span>
</span><span id="__span-0-4795"><a id="__codelineno-0-4795" name="__codelineno-0-4795"></a><span class="sd">    }</span>
</span><span id="__span-0-4796"><a id="__codelineno-0-4796" name="__codelineno-0-4796"></a>
</span><span id="__span-0-4797"><a id="__codelineno-0-4797" name="__codelineno-0-4797"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4798"><a id="__codelineno-0-4798" name="__codelineno-0-4798"></a>
</span><span id="__span-0-4799"><a id="__codelineno-0-4799" name="__codelineno-0-4799"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/pages&quot;</span>
</span><span id="__span-0-4800"><a id="__codelineno-0-4800" name="__codelineno-0-4800"></a>
</span><span id="__span-0-4801"><a id="__codelineno-0-4801" name="__codelineno-0-4801"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4802"><a id="__codelineno-0-4802" name="__codelineno-0-4802"></a>
</span><span id="__span-0-4803"><a id="__codelineno-0-4803" name="__codelineno-0-4803"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4804"><a id="__codelineno-0-4804" name="__codelineno-0-4804"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4805"><a id="__codelineno-0-4805" name="__codelineno-0-4805"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4806"><a id="__codelineno-0-4806" name="__codelineno-0-4806"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4807"><a id="__codelineno-0-4807" name="__codelineno-0-4807"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4808"><a id="__codelineno-0-4808" name="__codelineno-0-4808"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get pages of SharePoint site with ID -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_id</span><span class="p">),</span>
</span><span id="__span-0-4809"><a id="__codelineno-0-4809" name="__codelineno-0-4809"></a>    <span class="p">)</span>
</span><span id="__span-0-4810"><a id="__codelineno-0-4810" name="__codelineno-0-4810"></a>
</span><span id="__span-0-4811"><a id="__codelineno-0-4811" name="__codelineno-0-4811"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_root_sites" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_root_sites</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get all SharePoint root sites.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Dictionary that includes a list of root sites in the "value" key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4525">4525</a></span>
<span class="normal"><a href="#__codelineno-0-4526">4526</a></span>
<span class="normal"><a href="#__codelineno-0-4527">4527</a></span>
<span class="normal"><a href="#__codelineno-0-4528">4528</a></span>
<span class="normal"><a href="#__codelineno-0-4529">4529</a></span>
<span class="normal"><a href="#__codelineno-0-4530">4530</a></span>
<span class="normal"><a href="#__codelineno-0-4531">4531</a></span>
<span class="normal"><a href="#__codelineno-0-4532">4532</a></span>
<span class="normal"><a href="#__codelineno-0-4533">4533</a></span>
<span class="normal"><a href="#__codelineno-0-4534">4534</a></span>
<span class="normal"><a href="#__codelineno-0-4535">4535</a></span>
<span class="normal"><a href="#__codelineno-0-4536">4536</a></span>
<span class="normal"><a href="#__codelineno-0-4537">4537</a></span>
<span class="normal"><a href="#__codelineno-0-4538">4538</a></span>
<span class="normal"><a href="#__codelineno-0-4539">4539</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4525"><a id="__codelineno-0-4525" name="__codelineno-0-4525"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_root_sites</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4526"><a id="__codelineno-0-4526" name="__codelineno-0-4526"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all SharePoint root sites.</span>
</span><span id="__span-0-4527"><a id="__codelineno-0-4527" name="__codelineno-0-4527"></a>
</span><span id="__span-0-4528"><a id="__codelineno-0-4528" name="__codelineno-0-4528"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4529"><a id="__codelineno-0-4529" name="__codelineno-0-4529"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-4530"><a id="__codelineno-0-4530" name="__codelineno-0-4530"></a><span class="sd">            Dictionary that includes a list of root sites in the &quot;value&quot; key.</span>
</span><span id="__span-0-4531"><a id="__codelineno-0-4531" name="__codelineno-0-4531"></a>
</span><span id="__span-0-4532"><a id="__codelineno-0-4532" name="__codelineno-0-4532"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4533"><a id="__codelineno-0-4533" name="__codelineno-0-4533"></a>
</span><span id="__span-0-4534"><a id="__codelineno-0-4534" name="__codelineno-0-4534"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_sites</span><span class="p">(</span>
</span><span id="__span-0-4535"><a id="__codelineno-0-4535" name="__codelineno-0-4535"></a>        <span class="n">select</span><span class="o">=</span><span class="s2">&quot;siteCollection,webUrl&quot;</span><span class="p">,</span>
</span><span id="__span-0-4536"><a id="__codelineno-0-4536" name="__codelineno-0-4536"></a>        <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;siteCollection/root ne null&quot;</span><span class="p">,</span>
</span><span id="__span-0-4537"><a id="__codelineno-0-4537" name="__codelineno-0-4537"></a>    <span class="p">)</span>
</span><span id="__span-0-4538"><a id="__codelineno-0-4538" name="__codelineno-0-4538"></a>
</span><span id="__span-0-4539"><a id="__codelineno-0-4539" name="__codelineno-0-4539"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_section</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">section_type</span><span class="o">=</span><span class="s1">&#39;horizontalSections&#39;</span><span class="p">,</span> <span class="n">section_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a section of a SharePoint site page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the section.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"horizontalSections" (note the plural!)
"verticalSection" (note the singular!)</p>
              </div>
            </td>
            <td>
                  <code>&#39;horizontalSections&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_id</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the section. Only relevant for horizontal sections.
Simple values like 1,2,3...</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be displayed if the
section is not found.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A SharePoint site page section.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26')/pages('ac7675ee-8891-43b9-b1b2-2d2ced8eb17e')/microsoft.graph.sitePage/canvasLayout/horizontalSections/$entity",
    'layout': 'fullWidth',
    'id': '1',
    'emphasis': 'none'
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5057">5057</a></span>
<span class="normal"><a href="#__codelineno-0-5058">5058</a></span>
<span class="normal"><a href="#__codelineno-0-5059">5059</a></span>
<span class="normal"><a href="#__codelineno-0-5060">5060</a></span>
<span class="normal"><a href="#__codelineno-0-5061">5061</a></span>
<span class="normal"><a href="#__codelineno-0-5062">5062</a></span>
<span class="normal"><a href="#__codelineno-0-5063">5063</a></span>
<span class="normal"><a href="#__codelineno-0-5064">5064</a></span>
<span class="normal"><a href="#__codelineno-0-5065">5065</a></span>
<span class="normal"><a href="#__codelineno-0-5066">5066</a></span>
<span class="normal"><a href="#__codelineno-0-5067">5067</a></span>
<span class="normal"><a href="#__codelineno-0-5068">5068</a></span>
<span class="normal"><a href="#__codelineno-0-5069">5069</a></span>
<span class="normal"><a href="#__codelineno-0-5070">5070</a></span>
<span class="normal"><a href="#__codelineno-0-5071">5071</a></span>
<span class="normal"><a href="#__codelineno-0-5072">5072</a></span>
<span class="normal"><a href="#__codelineno-0-5073">5073</a></span>
<span class="normal"><a href="#__codelineno-0-5074">5074</a></span>
<span class="normal"><a href="#__codelineno-0-5075">5075</a></span>
<span class="normal"><a href="#__codelineno-0-5076">5076</a></span>
<span class="normal"><a href="#__codelineno-0-5077">5077</a></span>
<span class="normal"><a href="#__codelineno-0-5078">5078</a></span>
<span class="normal"><a href="#__codelineno-0-5079">5079</a></span>
<span class="normal"><a href="#__codelineno-0-5080">5080</a></span>
<span class="normal"><a href="#__codelineno-0-5081">5081</a></span>
<span class="normal"><a href="#__codelineno-0-5082">5082</a></span>
<span class="normal"><a href="#__codelineno-0-5083">5083</a></span>
<span class="normal"><a href="#__codelineno-0-5084">5084</a></span>
<span class="normal"><a href="#__codelineno-0-5085">5085</a></span>
<span class="normal"><a href="#__codelineno-0-5086">5086</a></span>
<span class="normal"><a href="#__codelineno-0-5087">5087</a></span>
<span class="normal"><a href="#__codelineno-0-5088">5088</a></span>
<span class="normal"><a href="#__codelineno-0-5089">5089</a></span>
<span class="normal"><a href="#__codelineno-0-5090">5090</a></span>
<span class="normal"><a href="#__codelineno-0-5091">5091</a></span>
<span class="normal"><a href="#__codelineno-0-5092">5092</a></span>
<span class="normal"><a href="#__codelineno-0-5093">5093</a></span>
<span class="normal"><a href="#__codelineno-0-5094">5094</a></span>
<span class="normal"><a href="#__codelineno-0-5095">5095</a></span>
<span class="normal"><a href="#__codelineno-0-5096">5096</a></span>
<span class="normal"><a href="#__codelineno-0-5097">5097</a></span>
<span class="normal"><a href="#__codelineno-0-5098">5098</a></span>
<span class="normal"><a href="#__codelineno-0-5099">5099</a></span>
<span class="normal"><a href="#__codelineno-0-5100">5100</a></span>
<span class="normal"><a href="#__codelineno-0-5101">5101</a></span>
<span class="normal"><a href="#__codelineno-0-5102">5102</a></span>
<span class="normal"><a href="#__codelineno-0-5103">5103</a></span>
<span class="normal"><a href="#__codelineno-0-5104">5104</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5057"><a id="__codelineno-0-5057" name="__codelineno-0-5057"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_section</span><span class="p">(</span>
</span><span id="__span-0-5058"><a id="__codelineno-0-5058" name="__codelineno-0-5058"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5059"><a id="__codelineno-0-5059" name="__codelineno-0-5059"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5060"><a id="__codelineno-0-5060" name="__codelineno-0-5060"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5061"><a id="__codelineno-0-5061" name="__codelineno-0-5061"></a>    <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-5062"><a id="__codelineno-0-5062" name="__codelineno-0-5062"></a>    <span class="n">section_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5063"><a id="__codelineno-0-5063" name="__codelineno-0-5063"></a>    <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5064"><a id="__codelineno-0-5064" name="__codelineno-0-5064"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-5065"><a id="__codelineno-0-5065" name="__codelineno-0-5065"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a section of a SharePoint site page.</span>
</span><span id="__span-0-5066"><a id="__codelineno-0-5066" name="__codelineno-0-5066"></a>
</span><span id="__span-0-5067"><a id="__codelineno-0-5067" name="__codelineno-0-5067"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5068"><a id="__codelineno-0-5068" name="__codelineno-0-5068"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5069"><a id="__codelineno-0-5069" name="__codelineno-0-5069"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5070"><a id="__codelineno-0-5070" name="__codelineno-0-5070"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5071"><a id="__codelineno-0-5071" name="__codelineno-0-5071"></a><span class="sd">            The ID of the SharePoint page containing the section.</span>
</span><span id="__span-0-5072"><a id="__codelineno-0-5072" name="__codelineno-0-5072"></a><span class="sd">        section_type (str, optional):</span>
</span><span id="__span-0-5073"><a id="__codelineno-0-5073" name="__codelineno-0-5073"></a><span class="sd">            &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5074"><a id="__codelineno-0-5074" name="__codelineno-0-5074"></a><span class="sd">            &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5075"><a id="__codelineno-0-5075" name="__codelineno-0-5075"></a><span class="sd">        section_id (int | str):</span>
</span><span id="__span-0-5076"><a id="__codelineno-0-5076" name="__codelineno-0-5076"></a><span class="sd">            The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5077"><a id="__codelineno-0-5077" name="__codelineno-0-5077"></a><span class="sd">            Simple values like 1,2,3...</span>
</span><span id="__span-0-5078"><a id="__codelineno-0-5078" name="__codelineno-0-5078"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-5079"><a id="__codelineno-0-5079" name="__codelineno-0-5079"></a><span class="sd">            Whether or not an error should be displayed if the</span>
</span><span id="__span-0-5080"><a id="__codelineno-0-5080" name="__codelineno-0-5080"></a><span class="sd">            section is not found.</span>
</span><span id="__span-0-5081"><a id="__codelineno-0-5081" name="__codelineno-0-5081"></a>
</span><span id="__span-0-5082"><a id="__codelineno-0-5082" name="__codelineno-0-5082"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5083"><a id="__codelineno-0-5083" name="__codelineno-0-5083"></a><span class="sd">        dict:</span>
</span><span id="__span-0-5084"><a id="__codelineno-0-5084" name="__codelineno-0-5084"></a><span class="sd">            A SharePoint site page section.</span>
</span><span id="__span-0-5085"><a id="__codelineno-0-5085" name="__codelineno-0-5085"></a>
</span><span id="__span-0-5086"><a id="__codelineno-0-5086" name="__codelineno-0-5086"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5087"><a id="__codelineno-0-5087" name="__codelineno-0-5087"></a><span class="sd">    {</span>
</span><span id="__span-0-5088"><a id="__codelineno-0-5088" name="__codelineno-0-5088"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections/$entity&quot;,</span>
</span><span id="__span-0-5089"><a id="__codelineno-0-5089" name="__codelineno-0-5089"></a><span class="sd">        &#39;layout&#39;: &#39;fullWidth&#39;,</span>
</span><span id="__span-0-5090"><a id="__codelineno-0-5090" name="__codelineno-0-5090"></a><span class="sd">        &#39;id&#39;: &#39;1&#39;,</span>
</span><span id="__span-0-5091"><a id="__codelineno-0-5091" name="__codelineno-0-5091"></a><span class="sd">        &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5092"><a id="__codelineno-0-5092" name="__codelineno-0-5092"></a><span class="sd">    }</span>
</span><span id="__span-0-5093"><a id="__codelineno-0-5093" name="__codelineno-0-5093"></a>
</span><span id="__span-0-5094"><a id="__codelineno-0-5094" name="__codelineno-0-5094"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5095"><a id="__codelineno-0-5095" name="__codelineno-0-5095"></a>
</span><span id="__span-0-5096"><a id="__codelineno-0-5096" name="__codelineno-0-5096"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_sections</span><span class="p">(</span>
</span><span id="__span-0-5097"><a id="__codelineno-0-5097" name="__codelineno-0-5097"></a>        <span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5098"><a id="__codelineno-0-5098" name="__codelineno-0-5098"></a>        <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5099"><a id="__codelineno-0-5099" name="__codelineno-0-5099"></a>        <span class="n">section_type</span><span class="o">=</span><span class="n">section_type</span><span class="p">,</span>
</span><span id="__span-0-5100"><a id="__codelineno-0-5100" name="__codelineno-0-5100"></a>        <span class="n">section_id</span><span class="o">=</span><span class="n">section_id</span><span class="p">,</span>
</span><span id="__span-0-5101"><a id="__codelineno-0-5101" name="__codelineno-0-5101"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-5102"><a id="__codelineno-0-5102" name="__codelineno-0-5102"></a>    <span class="p">)</span>
</span><span id="__span-0-5103"><a id="__codelineno-0-5103" name="__codelineno-0-5103"></a>
</span><span id="__span-0-5104"><a id="__codelineno-0-5104" name="__codelineno-0-5104"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_sections" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_sections</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">section_type</span><span class="o">=</span><span class="s1">&#39;horizontalSections&#39;</span><span class="p">,</span> <span class="n">section_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve all sections SharePoint site page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the sections.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"horizontalSections" (note the plural!)
"verticalSection" (note the singular!)</p>
              </div>
            </td>
            <td>
                  <code>&#39;horizontalSections&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the section. Only relevant for horizontal sections.
Simple values like 1,2,3...
Should be None for vertical section.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be displayed if the
section is not found.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary including the list of SharePoint sections for a given page.
The actual list is included inside the "value" key of the dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26')/pages('ac7675ee-8891-43b9-b1b2-2d2ced8eb17e')/microsoft.graph.sitePage/canvasLayout/horizontalSections",
    'value': [
        {
            'layout': 'fullWidth',
            'id': '1',
            'emphasis': 'none'
        },
        {
            'layout': 'twoColumns',
            'id': '2',
            'emphasis': 'none'
        }
    ]
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4970">4970</a></span>
<span class="normal"><a href="#__codelineno-0-4971">4971</a></span>
<span class="normal"><a href="#__codelineno-0-4972">4972</a></span>
<span class="normal"><a href="#__codelineno-0-4973">4973</a></span>
<span class="normal"><a href="#__codelineno-0-4974">4974</a></span>
<span class="normal"><a href="#__codelineno-0-4975">4975</a></span>
<span class="normal"><a href="#__codelineno-0-4976">4976</a></span>
<span class="normal"><a href="#__codelineno-0-4977">4977</a></span>
<span class="normal"><a href="#__codelineno-0-4978">4978</a></span>
<span class="normal"><a href="#__codelineno-0-4979">4979</a></span>
<span class="normal"><a href="#__codelineno-0-4980">4980</a></span>
<span class="normal"><a href="#__codelineno-0-4981">4981</a></span>
<span class="normal"><a href="#__codelineno-0-4982">4982</a></span>
<span class="normal"><a href="#__codelineno-0-4983">4983</a></span>
<span class="normal"><a href="#__codelineno-0-4984">4984</a></span>
<span class="normal"><a href="#__codelineno-0-4985">4985</a></span>
<span class="normal"><a href="#__codelineno-0-4986">4986</a></span>
<span class="normal"><a href="#__codelineno-0-4987">4987</a></span>
<span class="normal"><a href="#__codelineno-0-4988">4988</a></span>
<span class="normal"><a href="#__codelineno-0-4989">4989</a></span>
<span class="normal"><a href="#__codelineno-0-4990">4990</a></span>
<span class="normal"><a href="#__codelineno-0-4991">4991</a></span>
<span class="normal"><a href="#__codelineno-0-4992">4992</a></span>
<span class="normal"><a href="#__codelineno-0-4993">4993</a></span>
<span class="normal"><a href="#__codelineno-0-4994">4994</a></span>
<span class="normal"><a href="#__codelineno-0-4995">4995</a></span>
<span class="normal"><a href="#__codelineno-0-4996">4996</a></span>
<span class="normal"><a href="#__codelineno-0-4997">4997</a></span>
<span class="normal"><a href="#__codelineno-0-4998">4998</a></span>
<span class="normal"><a href="#__codelineno-0-4999">4999</a></span>
<span class="normal"><a href="#__codelineno-0-5000">5000</a></span>
<span class="normal"><a href="#__codelineno-0-5001">5001</a></span>
<span class="normal"><a href="#__codelineno-0-5002">5002</a></span>
<span class="normal"><a href="#__codelineno-0-5003">5003</a></span>
<span class="normal"><a href="#__codelineno-0-5004">5004</a></span>
<span class="normal"><a href="#__codelineno-0-5005">5005</a></span>
<span class="normal"><a href="#__codelineno-0-5006">5006</a></span>
<span class="normal"><a href="#__codelineno-0-5007">5007</a></span>
<span class="normal"><a href="#__codelineno-0-5008">5008</a></span>
<span class="normal"><a href="#__codelineno-0-5009">5009</a></span>
<span class="normal"><a href="#__codelineno-0-5010">5010</a></span>
<span class="normal"><a href="#__codelineno-0-5011">5011</a></span>
<span class="normal"><a href="#__codelineno-0-5012">5012</a></span>
<span class="normal"><a href="#__codelineno-0-5013">5013</a></span>
<span class="normal"><a href="#__codelineno-0-5014">5014</a></span>
<span class="normal"><a href="#__codelineno-0-5015">5015</a></span>
<span class="normal"><a href="#__codelineno-0-5016">5016</a></span>
<span class="normal"><a href="#__codelineno-0-5017">5017</a></span>
<span class="normal"><a href="#__codelineno-0-5018">5018</a></span>
<span class="normal"><a href="#__codelineno-0-5019">5019</a></span>
<span class="normal"><a href="#__codelineno-0-5020">5020</a></span>
<span class="normal"><a href="#__codelineno-0-5021">5021</a></span>
<span class="normal"><a href="#__codelineno-0-5022">5022</a></span>
<span class="normal"><a href="#__codelineno-0-5023">5023</a></span>
<span class="normal"><a href="#__codelineno-0-5024">5024</a></span>
<span class="normal"><a href="#__codelineno-0-5025">5025</a></span>
<span class="normal"><a href="#__codelineno-0-5026">5026</a></span>
<span class="normal"><a href="#__codelineno-0-5027">5027</a></span>
<span class="normal"><a href="#__codelineno-0-5028">5028</a></span>
<span class="normal"><a href="#__codelineno-0-5029">5029</a></span>
<span class="normal"><a href="#__codelineno-0-5030">5030</a></span>
<span class="normal"><a href="#__codelineno-0-5031">5031</a></span>
<span class="normal"><a href="#__codelineno-0-5032">5032</a></span>
<span class="normal"><a href="#__codelineno-0-5033">5033</a></span>
<span class="normal"><a href="#__codelineno-0-5034">5034</a></span>
<span class="normal"><a href="#__codelineno-0-5035">5035</a></span>
<span class="normal"><a href="#__codelineno-0-5036">5036</a></span>
<span class="normal"><a href="#__codelineno-0-5037">5037</a></span>
<span class="normal"><a href="#__codelineno-0-5038">5038</a></span>
<span class="normal"><a href="#__codelineno-0-5039">5039</a></span>
<span class="normal"><a href="#__codelineno-0-5040">5040</a></span>
<span class="normal"><a href="#__codelineno-0-5041">5041</a></span>
<span class="normal"><a href="#__codelineno-0-5042">5042</a></span>
<span class="normal"><a href="#__codelineno-0-5043">5043</a></span>
<span class="normal"><a href="#__codelineno-0-5044">5044</a></span>
<span class="normal"><a href="#__codelineno-0-5045">5045</a></span>
<span class="normal"><a href="#__codelineno-0-5046">5046</a></span>
<span class="normal"><a href="#__codelineno-0-5047">5047</a></span>
<span class="normal"><a href="#__codelineno-0-5048">5048</a></span>
<span class="normal"><a href="#__codelineno-0-5049">5049</a></span>
<span class="normal"><a href="#__codelineno-0-5050">5050</a></span>
<span class="normal"><a href="#__codelineno-0-5051">5051</a></span>
<span class="normal"><a href="#__codelineno-0-5052">5052</a></span>
<span class="normal"><a href="#__codelineno-0-5053">5053</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4970"><a id="__codelineno-0-4970" name="__codelineno-0-4970"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_sections</span><span class="p">(</span>
</span><span id="__span-0-4971"><a id="__codelineno-0-4971" name="__codelineno-0-4971"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4972"><a id="__codelineno-0-4972" name="__codelineno-0-4972"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4973"><a id="__codelineno-0-4973" name="__codelineno-0-4973"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4974"><a id="__codelineno-0-4974" name="__codelineno-0-4974"></a>    <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">,</span>
</span><span id="__span-0-4975"><a id="__codelineno-0-4975" name="__codelineno-0-4975"></a>    <span class="n">section_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4976"><a id="__codelineno-0-4976" name="__codelineno-0-4976"></a>    <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4977"><a id="__codelineno-0-4977" name="__codelineno-0-4977"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4978"><a id="__codelineno-0-4978" name="__codelineno-0-4978"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve all sections SharePoint site page.</span>
</span><span id="__span-0-4979"><a id="__codelineno-0-4979" name="__codelineno-0-4979"></a>
</span><span id="__span-0-4980"><a id="__codelineno-0-4980" name="__codelineno-0-4980"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4981"><a id="__codelineno-0-4981" name="__codelineno-0-4981"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-4982"><a id="__codelineno-0-4982" name="__codelineno-0-4982"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-4983"><a id="__codelineno-0-4983" name="__codelineno-0-4983"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-4984"><a id="__codelineno-0-4984" name="__codelineno-0-4984"></a><span class="sd">            The ID of the SharePoint page containing the sections.</span>
</span><span id="__span-0-4985"><a id="__codelineno-0-4985" name="__codelineno-0-4985"></a><span class="sd">        section_type (str, optional):</span>
</span><span id="__span-0-4986"><a id="__codelineno-0-4986" name="__codelineno-0-4986"></a><span class="sd">            &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-4987"><a id="__codelineno-0-4987" name="__codelineno-0-4987"></a><span class="sd">            &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-4988"><a id="__codelineno-0-4988" name="__codelineno-0-4988"></a><span class="sd">        section_id (str | int | None):</span>
</span><span id="__span-0-4989"><a id="__codelineno-0-4989" name="__codelineno-0-4989"></a><span class="sd">            The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-4990"><a id="__codelineno-0-4990" name="__codelineno-0-4990"></a><span class="sd">            Simple values like 1,2,3...</span>
</span><span id="__span-0-4991"><a id="__codelineno-0-4991" name="__codelineno-0-4991"></a><span class="sd">            Should be None for vertical section.</span>
</span><span id="__span-0-4992"><a id="__codelineno-0-4992" name="__codelineno-0-4992"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-4993"><a id="__codelineno-0-4993" name="__codelineno-0-4993"></a><span class="sd">            Whether or not an error should be displayed if the</span>
</span><span id="__span-0-4994"><a id="__codelineno-0-4994" name="__codelineno-0-4994"></a><span class="sd">            section is not found.</span>
</span><span id="__span-0-4995"><a id="__codelineno-0-4995" name="__codelineno-0-4995"></a>
</span><span id="__span-0-4996"><a id="__codelineno-0-4996" name="__codelineno-0-4996"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4997"><a id="__codelineno-0-4997" name="__codelineno-0-4997"></a><span class="sd">        dict:</span>
</span><span id="__span-0-4998"><a id="__codelineno-0-4998" name="__codelineno-0-4998"></a><span class="sd">            A dictionary including the list of SharePoint sections for a given page.</span>
</span><span id="__span-0-4999"><a id="__codelineno-0-4999" name="__codelineno-0-4999"></a><span class="sd">            The actual list is included inside the &quot;value&quot; key of the dictionary.</span>
</span><span id="__span-0-5000"><a id="__codelineno-0-5000" name="__codelineno-0-5000"></a>
</span><span id="__span-0-5001"><a id="__codelineno-0-5001" name="__codelineno-0-5001"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5002"><a id="__codelineno-0-5002" name="__codelineno-0-5002"></a><span class="sd">    {</span>
</span><span id="__span-0-5003"><a id="__codelineno-0-5003" name="__codelineno-0-5003"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;ac7675ee-8891-43b9-b1b2-2d2ced8eb17e&#39;)/microsoft.graph.sitePage/canvasLayout/horizontalSections&quot;,</span>
</span><span id="__span-0-5004"><a id="__codelineno-0-5004" name="__codelineno-0-5004"></a><span class="sd">        &#39;value&#39;: [</span>
</span><span id="__span-0-5005"><a id="__codelineno-0-5005" name="__codelineno-0-5005"></a><span class="sd">            {</span>
</span><span id="__span-0-5006"><a id="__codelineno-0-5006" name="__codelineno-0-5006"></a><span class="sd">                &#39;layout&#39;: &#39;fullWidth&#39;,</span>
</span><span id="__span-0-5007"><a id="__codelineno-0-5007" name="__codelineno-0-5007"></a><span class="sd">                &#39;id&#39;: &#39;1&#39;,</span>
</span><span id="__span-0-5008"><a id="__codelineno-0-5008" name="__codelineno-0-5008"></a><span class="sd">                &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5009"><a id="__codelineno-0-5009" name="__codelineno-0-5009"></a><span class="sd">            },</span>
</span><span id="__span-0-5010"><a id="__codelineno-0-5010" name="__codelineno-0-5010"></a><span class="sd">            {</span>
</span><span id="__span-0-5011"><a id="__codelineno-0-5011" name="__codelineno-0-5011"></a><span class="sd">                &#39;layout&#39;: &#39;twoColumns&#39;,</span>
</span><span id="__span-0-5012"><a id="__codelineno-0-5012" name="__codelineno-0-5012"></a><span class="sd">                &#39;id&#39;: &#39;2&#39;,</span>
</span><span id="__span-0-5013"><a id="__codelineno-0-5013" name="__codelineno-0-5013"></a><span class="sd">                &#39;emphasis&#39;: &#39;none&#39;</span>
</span><span id="__span-0-5014"><a id="__codelineno-0-5014" name="__codelineno-0-5014"></a><span class="sd">            }</span>
</span><span id="__span-0-5015"><a id="__codelineno-0-5015" name="__codelineno-0-5015"></a><span class="sd">        ]</span>
</span><span id="__span-0-5016"><a id="__codelineno-0-5016" name="__codelineno-0-5016"></a><span class="sd">    }</span>
</span><span id="__span-0-5017"><a id="__codelineno-0-5017" name="__codelineno-0-5017"></a>
</span><span id="__span-0-5018"><a id="__codelineno-0-5018" name="__codelineno-0-5018"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5019"><a id="__codelineno-0-5019" name="__codelineno-0-5019"></a>
</span><span id="__span-0-5020"><a id="__codelineno-0-5020" name="__codelineno-0-5020"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5021"><a id="__codelineno-0-5021" name="__codelineno-0-5021"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5022"><a id="__codelineno-0-5022" name="__codelineno-0-5022"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5023"><a id="__codelineno-0-5023" name="__codelineno-0-5023"></a>        <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5024"><a id="__codelineno-0-5024" name="__codelineno-0-5024"></a>        <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5025"><a id="__codelineno-0-5025" name="__codelineno-0-5025"></a>        <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5026"><a id="__codelineno-0-5026" name="__codelineno-0-5026"></a>        <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/canvasLayout/&quot;</span>
</span><span id="__span-0-5027"><a id="__codelineno-0-5027" name="__codelineno-0-5027"></a>        <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5028"><a id="__codelineno-0-5028" name="__codelineno-0-5028"></a>    <span class="p">)</span>
</span><span id="__span-0-5029"><a id="__codelineno-0-5029" name="__codelineno-0-5029"></a>
</span><span id="__span-0-5030"><a id="__codelineno-0-5030" name="__codelineno-0-5030"></a>    <span class="k">if</span> <span class="n">section_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5031"><a id="__codelineno-0-5031" name="__codelineno-0-5031"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5032"><a id="__codelineno-0-5032" name="__codelineno-0-5032"></a>
</span><span id="__span-0-5033"><a id="__codelineno-0-5033" name="__codelineno-0-5033"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5034"><a id="__codelineno-0-5034" name="__codelineno-0-5034"></a>
</span><span id="__span-0-5035"><a id="__codelineno-0-5035" name="__codelineno-0-5035"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5036"><a id="__codelineno-0-5036" name="__codelineno-0-5036"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5037"><a id="__codelineno-0-5037" name="__codelineno-0-5037"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-5038"><a id="__codelineno-0-5038" name="__codelineno-0-5038"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5039"><a id="__codelineno-0-5039" name="__codelineno-0-5039"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5040"><a id="__codelineno-0-5040" name="__codelineno-0-5040"></a>        <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;Cannot find section</span><span class="si">{}</span><span class="s2"> for SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; of SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5041"><a id="__codelineno-0-5041" name="__codelineno-0-5041"></a>            <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">section_id</span> <span class="k">else</span> <span class="s2">&quot; -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section_id</span><span class="p">),</span>
</span><span id="__span-0-5042"><a id="__codelineno-0-5042" name="__codelineno-0-5042"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5043"><a id="__codelineno-0-5043" name="__codelineno-0-5043"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5044"><a id="__codelineno-0-5044" name="__codelineno-0-5044"></a>        <span class="p">),</span>
</span><span id="__span-0-5045"><a id="__codelineno-0-5045" name="__codelineno-0-5045"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get section</span><span class="si">{}</span><span class="s2"> for SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; of SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5046"><a id="__codelineno-0-5046" name="__codelineno-0-5046"></a>            <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">section_id</span> <span class="k">else</span> <span class="s2">&quot; -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section_id</span><span class="p">),</span>
</span><span id="__span-0-5047"><a id="__codelineno-0-5047" name="__codelineno-0-5047"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5048"><a id="__codelineno-0-5048" name="__codelineno-0-5048"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5049"><a id="__codelineno-0-5049" name="__codelineno-0-5049"></a>        <span class="p">),</span>
</span><span id="__span-0-5050"><a id="__codelineno-0-5050" name="__codelineno-0-5050"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-5051"><a id="__codelineno-0-5051" name="__codelineno-0-5051"></a>    <span class="p">)</span>
</span><span id="__span-0-5052"><a id="__codelineno-0-5052" name="__codelineno-0-5052"></a>
</span><span id="__span-0-5053"><a id="__codelineno-0-5053" name="__codelineno-0-5053"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_site" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_site</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a SharePoint site by its ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site the to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
The data of the SharePoint site.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': 'https://graph.microsoft.com/beta/$metadata#sites/$entity',
    'createdDateTime': '2025-02-06T07:41:53.41Z',
    'description': '',
    'id': 'ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af',
    'lastModifiedDateTime': '2025-02-10T20:37:11Z',
    'name': 'TG11-Trad.Good11PDReg.Trading795',
    'webUrl': 'https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795',
    'displayName': 'TG11 - Trad.Good 11,PD,Reg.Trading',
    'root': {},
    'siteCollection': {
        'hostname': 'ideatedev.sharepoint.com'
    }
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4610">4610</a></span>
<span class="normal"><a href="#__codelineno-0-4611">4611</a></span>
<span class="normal"><a href="#__codelineno-0-4612">4612</a></span>
<span class="normal"><a href="#__codelineno-0-4613">4613</a></span>
<span class="normal"><a href="#__codelineno-0-4614">4614</a></span>
<span class="normal"><a href="#__codelineno-0-4615">4615</a></span>
<span class="normal"><a href="#__codelineno-0-4616">4616</a></span>
<span class="normal"><a href="#__codelineno-0-4617">4617</a></span>
<span class="normal"><a href="#__codelineno-0-4618">4618</a></span>
<span class="normal"><a href="#__codelineno-0-4619">4619</a></span>
<span class="normal"><a href="#__codelineno-0-4620">4620</a></span>
<span class="normal"><a href="#__codelineno-0-4621">4621</a></span>
<span class="normal"><a href="#__codelineno-0-4622">4622</a></span>
<span class="normal"><a href="#__codelineno-0-4623">4623</a></span>
<span class="normal"><a href="#__codelineno-0-4624">4624</a></span>
<span class="normal"><a href="#__codelineno-0-4625">4625</a></span>
<span class="normal"><a href="#__codelineno-0-4626">4626</a></span>
<span class="normal"><a href="#__codelineno-0-4627">4627</a></span>
<span class="normal"><a href="#__codelineno-0-4628">4628</a></span>
<span class="normal"><a href="#__codelineno-0-4629">4629</a></span>
<span class="normal"><a href="#__codelineno-0-4630">4630</a></span>
<span class="normal"><a href="#__codelineno-0-4631">4631</a></span>
<span class="normal"><a href="#__codelineno-0-4632">4632</a></span>
<span class="normal"><a href="#__codelineno-0-4633">4633</a></span>
<span class="normal"><a href="#__codelineno-0-4634">4634</a></span>
<span class="normal"><a href="#__codelineno-0-4635">4635</a></span>
<span class="normal"><a href="#__codelineno-0-4636">4636</a></span>
<span class="normal"><a href="#__codelineno-0-4637">4637</a></span>
<span class="normal"><a href="#__codelineno-0-4638">4638</a></span>
<span class="normal"><a href="#__codelineno-0-4639">4639</a></span>
<span class="normal"><a href="#__codelineno-0-4640">4640</a></span>
<span class="normal"><a href="#__codelineno-0-4641">4641</a></span>
<span class="normal"><a href="#__codelineno-0-4642">4642</a></span>
<span class="normal"><a href="#__codelineno-0-4643">4643</a></span>
<span class="normal"><a href="#__codelineno-0-4644">4644</a></span>
<span class="normal"><a href="#__codelineno-0-4645">4645</a></span>
<span class="normal"><a href="#__codelineno-0-4646">4646</a></span>
<span class="normal"><a href="#__codelineno-0-4647">4647</a></span>
<span class="normal"><a href="#__codelineno-0-4648">4648</a></span>
<span class="normal"><a href="#__codelineno-0-4649">4649</a></span>
<span class="normal"><a href="#__codelineno-0-4650">4650</a></span>
<span class="normal"><a href="#__codelineno-0-4651">4651</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4610"><a id="__codelineno-0-4610" name="__codelineno-0-4610"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4611"><a id="__codelineno-0-4611" name="__codelineno-0-4611"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a SharePoint site by its ID.</span>
</span><span id="__span-0-4612"><a id="__codelineno-0-4612" name="__codelineno-0-4612"></a>
</span><span id="__span-0-4613"><a id="__codelineno-0-4613" name="__codelineno-0-4613"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4614"><a id="__codelineno-0-4614" name="__codelineno-0-4614"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-4615"><a id="__codelineno-0-4615" name="__codelineno-0-4615"></a><span class="sd">            The ID of the SharePoint site the to retrieve.</span>
</span><span id="__span-0-4616"><a id="__codelineno-0-4616" name="__codelineno-0-4616"></a>
</span><span id="__span-0-4617"><a id="__codelineno-0-4617" name="__codelineno-0-4617"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4618"><a id="__codelineno-0-4618" name="__codelineno-0-4618"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-4619"><a id="__codelineno-0-4619" name="__codelineno-0-4619"></a><span class="sd">            The data of the SharePoint site.</span>
</span><span id="__span-0-4620"><a id="__codelineno-0-4620" name="__codelineno-0-4620"></a>
</span><span id="__span-0-4621"><a id="__codelineno-0-4621" name="__codelineno-0-4621"></a><span class="sd">    Example:</span>
</span><span id="__span-0-4622"><a id="__codelineno-0-4622" name="__codelineno-0-4622"></a><span class="sd">    {</span>
</span><span id="__span-0-4623"><a id="__codelineno-0-4623" name="__codelineno-0-4623"></a><span class="sd">        &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites/$entity&#39;,</span>
</span><span id="__span-0-4624"><a id="__codelineno-0-4624" name="__codelineno-0-4624"></a><span class="sd">        &#39;createdDateTime&#39;: &#39;2025-02-06T07:41:53.41Z&#39;,</span>
</span><span id="__span-0-4625"><a id="__codelineno-0-4625" name="__codelineno-0-4625"></a><span class="sd">        &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-4626"><a id="__codelineno-0-4626" name="__codelineno-0-4626"></a><span class="sd">        &#39;id&#39;: &#39;ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4627"><a id="__codelineno-0-4627" name="__codelineno-0-4627"></a><span class="sd">        &#39;lastModifiedDateTime&#39;: &#39;2025-02-10T20:37:11Z&#39;,</span>
</span><span id="__span-0-4628"><a id="__codelineno-0-4628" name="__codelineno-0-4628"></a><span class="sd">        &#39;name&#39;: &#39;TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4629"><a id="__codelineno-0-4629" name="__codelineno-0-4629"></a><span class="sd">        &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4630"><a id="__codelineno-0-4630" name="__codelineno-0-4630"></a><span class="sd">        &#39;displayName&#39;: &#39;TG11 - Trad.Good 11,PD,Reg.Trading&#39;,</span>
</span><span id="__span-0-4631"><a id="__codelineno-0-4631" name="__codelineno-0-4631"></a><span class="sd">        &#39;root&#39;: {},</span>
</span><span id="__span-0-4632"><a id="__codelineno-0-4632" name="__codelineno-0-4632"></a><span class="sd">        &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4633"><a id="__codelineno-0-4633" name="__codelineno-0-4633"></a><span class="sd">            &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4634"><a id="__codelineno-0-4634" name="__codelineno-0-4634"></a><span class="sd">        }</span>
</span><span id="__span-0-4635"><a id="__codelineno-0-4635" name="__codelineno-0-4635"></a><span class="sd">    }</span>
</span><span id="__span-0-4636"><a id="__codelineno-0-4636" name="__codelineno-0-4636"></a>
</span><span id="__span-0-4637"><a id="__codelineno-0-4637" name="__codelineno-0-4637"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4638"><a id="__codelineno-0-4638" name="__codelineno-0-4638"></a>
</span><span id="__span-0-4639"><a id="__codelineno-0-4639" name="__codelineno-0-4639"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-4640"><a id="__codelineno-0-4640" name="__codelineno-0-4640"></a>
</span><span id="__span-0-4641"><a id="__codelineno-0-4641" name="__codelineno-0-4641"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4642"><a id="__codelineno-0-4642" name="__codelineno-0-4642"></a>
</span><span id="__span-0-4643"><a id="__codelineno-0-4643" name="__codelineno-0-4643"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4644"><a id="__codelineno-0-4644" name="__codelineno-0-4644"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4645"><a id="__codelineno-0-4645" name="__codelineno-0-4645"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4646"><a id="__codelineno-0-4646" name="__codelineno-0-4646"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4647"><a id="__codelineno-0-4647" name="__codelineno-0-4647"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4648"><a id="__codelineno-0-4648" name="__codelineno-0-4648"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint site with ID -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_id</span><span class="p">),</span>
</span><span id="__span-0-4649"><a id="__codelineno-0-4649" name="__codelineno-0-4649"></a>    <span class="p">)</span>
</span><span id="__span-0-4650"><a id="__codelineno-0-4650" name="__codelineno-0-4650"></a>
</span><span id="__span-0-4651"><a id="__codelineno-0-4651" name="__codelineno-0-4651"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_site_by_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_site_by_name</span><span class="p">(</span><span class="n">site_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a SharePoint site by its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the SharePoint site to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
The data of the SharePoint site.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': 'https://graph.microsoft.com/beta/$metadata#sites/$entity',
    'createdDateTime': '2025-02-06T07:41:53.41Z',
    'description': '',
    'id': 'ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af',
    'lastModifiedDateTime': '2025-02-10T20:37:11Z',
    'name': 'TG11-Trad.Good11PDReg.Trading795',
    'webUrl': 'https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795',
    'displayName': 'TG11 - Trad.Good 11,PD,Reg.Trading',
    'root': {},
    'siteCollection': {
        'hostname': 'ideatedev.sharepoint.com'
    }
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4655">4655</a></span>
<span class="normal"><a href="#__codelineno-0-4656">4656</a></span>
<span class="normal"><a href="#__codelineno-0-4657">4657</a></span>
<span class="normal"><a href="#__codelineno-0-4658">4658</a></span>
<span class="normal"><a href="#__codelineno-0-4659">4659</a></span>
<span class="normal"><a href="#__codelineno-0-4660">4660</a></span>
<span class="normal"><a href="#__codelineno-0-4661">4661</a></span>
<span class="normal"><a href="#__codelineno-0-4662">4662</a></span>
<span class="normal"><a href="#__codelineno-0-4663">4663</a></span>
<span class="normal"><a href="#__codelineno-0-4664">4664</a></span>
<span class="normal"><a href="#__codelineno-0-4665">4665</a></span>
<span class="normal"><a href="#__codelineno-0-4666">4666</a></span>
<span class="normal"><a href="#__codelineno-0-4667">4667</a></span>
<span class="normal"><a href="#__codelineno-0-4668">4668</a></span>
<span class="normal"><a href="#__codelineno-0-4669">4669</a></span>
<span class="normal"><a href="#__codelineno-0-4670">4670</a></span>
<span class="normal"><a href="#__codelineno-0-4671">4671</a></span>
<span class="normal"><a href="#__codelineno-0-4672">4672</a></span>
<span class="normal"><a href="#__codelineno-0-4673">4673</a></span>
<span class="normal"><a href="#__codelineno-0-4674">4674</a></span>
<span class="normal"><a href="#__codelineno-0-4675">4675</a></span>
<span class="normal"><a href="#__codelineno-0-4676">4676</a></span>
<span class="normal"><a href="#__codelineno-0-4677">4677</a></span>
<span class="normal"><a href="#__codelineno-0-4678">4678</a></span>
<span class="normal"><a href="#__codelineno-0-4679">4679</a></span>
<span class="normal"><a href="#__codelineno-0-4680">4680</a></span>
<span class="normal"><a href="#__codelineno-0-4681">4681</a></span>
<span class="normal"><a href="#__codelineno-0-4682">4682</a></span>
<span class="normal"><a href="#__codelineno-0-4683">4683</a></span>
<span class="normal"><a href="#__codelineno-0-4684">4684</a></span>
<span class="normal"><a href="#__codelineno-0-4685">4685</a></span>
<span class="normal"><a href="#__codelineno-0-4686">4686</a></span>
<span class="normal"><a href="#__codelineno-0-4687">4687</a></span>
<span class="normal"><a href="#__codelineno-0-4688">4688</a></span>
<span class="normal"><a href="#__codelineno-0-4689">4689</a></span>
<span class="normal"><a href="#__codelineno-0-4690">4690</a></span>
<span class="normal"><a href="#__codelineno-0-4691">4691</a></span>
<span class="normal"><a href="#__codelineno-0-4692">4692</a></span>
<span class="normal"><a href="#__codelineno-0-4693">4693</a></span>
<span class="normal"><a href="#__codelineno-0-4694">4694</a></span>
<span class="normal"><a href="#__codelineno-0-4695">4695</a></span>
<span class="normal"><a href="#__codelineno-0-4696">4696</a></span>
<span class="normal"><a href="#__codelineno-0-4697">4697</a></span>
<span class="normal"><a href="#__codelineno-0-4698">4698</a></span>
<span class="normal"><a href="#__codelineno-0-4699">4699</a></span>
<span class="normal"><a href="#__codelineno-0-4700">4700</a></span>
<span class="normal"><a href="#__codelineno-0-4701">4701</a></span>
<span class="normal"><a href="#__codelineno-0-4702">4702</a></span>
<span class="normal"><a href="#__codelineno-0-4703">4703</a></span>
<span class="normal"><a href="#__codelineno-0-4704">4704</a></span>
<span class="normal"><a href="#__codelineno-0-4705">4705</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4655"><a id="__codelineno-0-4655" name="__codelineno-0-4655"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_site_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4656"><a id="__codelineno-0-4656" name="__codelineno-0-4656"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a SharePoint site by its name.</span>
</span><span id="__span-0-4657"><a id="__codelineno-0-4657" name="__codelineno-0-4657"></a>
</span><span id="__span-0-4658"><a id="__codelineno-0-4658" name="__codelineno-0-4658"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4659"><a id="__codelineno-0-4659" name="__codelineno-0-4659"></a><span class="sd">        site_name (str):</span>
</span><span id="__span-0-4660"><a id="__codelineno-0-4660" name="__codelineno-0-4660"></a><span class="sd">            The name of the SharePoint site to retrieve.</span>
</span><span id="__span-0-4661"><a id="__codelineno-0-4661" name="__codelineno-0-4661"></a>
</span><span id="__span-0-4662"><a id="__codelineno-0-4662" name="__codelineno-0-4662"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4663"><a id="__codelineno-0-4663" name="__codelineno-0-4663"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-4664"><a id="__codelineno-0-4664" name="__codelineno-0-4664"></a><span class="sd">            The data of the SharePoint site.</span>
</span><span id="__span-0-4665"><a id="__codelineno-0-4665" name="__codelineno-0-4665"></a>
</span><span id="__span-0-4666"><a id="__codelineno-0-4666" name="__codelineno-0-4666"></a><span class="sd">    Example:</span>
</span><span id="__span-0-4667"><a id="__codelineno-0-4667" name="__codelineno-0-4667"></a><span class="sd">    {</span>
</span><span id="__span-0-4668"><a id="__codelineno-0-4668" name="__codelineno-0-4668"></a><span class="sd">        &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites/$entity&#39;,</span>
</span><span id="__span-0-4669"><a id="__codelineno-0-4669" name="__codelineno-0-4669"></a><span class="sd">        &#39;createdDateTime&#39;: &#39;2025-02-06T07:41:53.41Z&#39;,</span>
</span><span id="__span-0-4670"><a id="__codelineno-0-4670" name="__codelineno-0-4670"></a><span class="sd">        &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-4671"><a id="__codelineno-0-4671" name="__codelineno-0-4671"></a><span class="sd">        &#39;id&#39;: &#39;ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4672"><a id="__codelineno-0-4672" name="__codelineno-0-4672"></a><span class="sd">        &#39;lastModifiedDateTime&#39;: &#39;2025-02-10T20:37:11Z&#39;,</span>
</span><span id="__span-0-4673"><a id="__codelineno-0-4673" name="__codelineno-0-4673"></a><span class="sd">        &#39;name&#39;: &#39;TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4674"><a id="__codelineno-0-4674" name="__codelineno-0-4674"></a><span class="sd">        &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4675"><a id="__codelineno-0-4675" name="__codelineno-0-4675"></a><span class="sd">        &#39;displayName&#39;: &#39;TG11 - Trad.Good 11,PD,Reg.Trading&#39;,</span>
</span><span id="__span-0-4676"><a id="__codelineno-0-4676" name="__codelineno-0-4676"></a><span class="sd">        &#39;root&#39;: {},</span>
</span><span id="__span-0-4677"><a id="__codelineno-0-4677" name="__codelineno-0-4677"></a><span class="sd">        &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4678"><a id="__codelineno-0-4678" name="__codelineno-0-4678"></a><span class="sd">            &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4679"><a id="__codelineno-0-4679" name="__codelineno-0-4679"></a><span class="sd">        }</span>
</span><span id="__span-0-4680"><a id="__codelineno-0-4680" name="__codelineno-0-4680"></a><span class="sd">    }</span>
</span><span id="__span-0-4681"><a id="__codelineno-0-4681" name="__codelineno-0-4681"></a>
</span><span id="__span-0-4682"><a id="__codelineno-0-4682" name="__codelineno-0-4682"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4683"><a id="__codelineno-0-4683" name="__codelineno-0-4683"></a>
</span><span id="__span-0-4684"><a id="__codelineno-0-4684" name="__codelineno-0-4684"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?search=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_name</span><span class="p">)</span>
</span><span id="__span-0-4685"><a id="__codelineno-0-4685" name="__codelineno-0-4685"></a>
</span><span id="__span-0-4686"><a id="__codelineno-0-4686" name="__codelineno-0-4686"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4687"><a id="__codelineno-0-4687" name="__codelineno-0-4687"></a>
</span><span id="__span-0-4688"><a id="__codelineno-0-4688" name="__codelineno-0-4688"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4689"><a id="__codelineno-0-4689" name="__codelineno-0-4689"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4690"><a id="__codelineno-0-4690" name="__codelineno-0-4690"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4691"><a id="__codelineno-0-4691" name="__codelineno-0-4691"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4692"><a id="__codelineno-0-4692" name="__codelineno-0-4692"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4693"><a id="__codelineno-0-4693" name="__codelineno-0-4693"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site_name</span><span class="p">),</span>
</span><span id="__span-0-4694"><a id="__codelineno-0-4694" name="__codelineno-0-4694"></a>    <span class="p">)</span>
</span><span id="__span-0-4695"><a id="__codelineno-0-4695" name="__codelineno-0-4695"></a>
</span><span id="__span-0-4696"><a id="__codelineno-0-4696" name="__codelineno-0-4696"></a>    <span class="c1"># As we lookup the site by search we could have multiple results.</span>
</span><span id="__span-0-4697"><a id="__codelineno-0-4697" name="__codelineno-0-4697"></a>    <span class="c1"># The Graph API does not do an exact match. So we check the results</span>
</span><span id="__span-0-4698"><a id="__codelineno-0-4698" name="__codelineno-0-4698"></a>    <span class="c1"># for an exact match:</span>
</span><span id="__span-0-4699"><a id="__codelineno-0-4699" name="__codelineno-0-4699"></a>    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-4700"><a id="__codelineno-0-4700" name="__codelineno-0-4700"></a>        <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-0-4701"><a id="__codelineno-0-4701" name="__codelineno-0-4701"></a>        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-4702"><a id="__codelineno-0-4702" name="__codelineno-0-4702"></a>            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">site_name</span><span class="p">:</span>
</span><span id="__span-0-4703"><a id="__codelineno-0-4703" name="__codelineno-0-4703"></a>                <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-0-4704"><a id="__codelineno-0-4704" name="__codelineno-0-4704"></a>
</span><span id="__span-0-4705"><a id="__codelineno-0-4705" name="__codelineno-0-4705"></a>    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_site_for_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_site_for_group</span><span class="p">(</span><span class="n">group_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a SharePoint site for a M365 group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the M365 group the site should be retrieved for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data of the SharePoint site.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': 'https://graph.microsoft.com/beta/$metadata#sites/$entity',
    'createdDateTime': '2025-02-06T07:41:53.41Z',
    'description': '',
    'id': 'ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af',
    'lastModifiedDateTime': '2025-02-10T20:37:11Z',
    'name': 'TG11-Trad.Good11PDReg.Trading795',
    'webUrl': 'https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795',
    'displayName': 'TG11 - Trad.Good 11,PD,Reg.Trading',
    'root': {},
    'siteCollection': {
        'hostname': 'ideatedev.sharepoint.com'
    }
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4709">4709</a></span>
<span class="normal"><a href="#__codelineno-0-4710">4710</a></span>
<span class="normal"><a href="#__codelineno-0-4711">4711</a></span>
<span class="normal"><a href="#__codelineno-0-4712">4712</a></span>
<span class="normal"><a href="#__codelineno-0-4713">4713</a></span>
<span class="normal"><a href="#__codelineno-0-4714">4714</a></span>
<span class="normal"><a href="#__codelineno-0-4715">4715</a></span>
<span class="normal"><a href="#__codelineno-0-4716">4716</a></span>
<span class="normal"><a href="#__codelineno-0-4717">4717</a></span>
<span class="normal"><a href="#__codelineno-0-4718">4718</a></span>
<span class="normal"><a href="#__codelineno-0-4719">4719</a></span>
<span class="normal"><a href="#__codelineno-0-4720">4720</a></span>
<span class="normal"><a href="#__codelineno-0-4721">4721</a></span>
<span class="normal"><a href="#__codelineno-0-4722">4722</a></span>
<span class="normal"><a href="#__codelineno-0-4723">4723</a></span>
<span class="normal"><a href="#__codelineno-0-4724">4724</a></span>
<span class="normal"><a href="#__codelineno-0-4725">4725</a></span>
<span class="normal"><a href="#__codelineno-0-4726">4726</a></span>
<span class="normal"><a href="#__codelineno-0-4727">4727</a></span>
<span class="normal"><a href="#__codelineno-0-4728">4728</a></span>
<span class="normal"><a href="#__codelineno-0-4729">4729</a></span>
<span class="normal"><a href="#__codelineno-0-4730">4730</a></span>
<span class="normal"><a href="#__codelineno-0-4731">4731</a></span>
<span class="normal"><a href="#__codelineno-0-4732">4732</a></span>
<span class="normal"><a href="#__codelineno-0-4733">4733</a></span>
<span class="normal"><a href="#__codelineno-0-4734">4734</a></span>
<span class="normal"><a href="#__codelineno-0-4735">4735</a></span>
<span class="normal"><a href="#__codelineno-0-4736">4736</a></span>
<span class="normal"><a href="#__codelineno-0-4737">4737</a></span>
<span class="normal"><a href="#__codelineno-0-4738">4738</a></span>
<span class="normal"><a href="#__codelineno-0-4739">4739</a></span>
<span class="normal"><a href="#__codelineno-0-4740">4740</a></span>
<span class="normal"><a href="#__codelineno-0-4741">4741</a></span>
<span class="normal"><a href="#__codelineno-0-4742">4742</a></span>
<span class="normal"><a href="#__codelineno-0-4743">4743</a></span>
<span class="normal"><a href="#__codelineno-0-4744">4744</a></span>
<span class="normal"><a href="#__codelineno-0-4745">4745</a></span>
<span class="normal"><a href="#__codelineno-0-4746">4746</a></span>
<span class="normal"><a href="#__codelineno-0-4747">4747</a></span>
<span class="normal"><a href="#__codelineno-0-4748">4748</a></span>
<span class="normal"><a href="#__codelineno-0-4749">4749</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4709"><a id="__codelineno-0-4709" name="__codelineno-0-4709"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_site_for_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-4710"><a id="__codelineno-0-4710" name="__codelineno-0-4710"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a SharePoint site for a M365 group.</span>
</span><span id="__span-0-4711"><a id="__codelineno-0-4711" name="__codelineno-0-4711"></a>
</span><span id="__span-0-4712"><a id="__codelineno-0-4712" name="__codelineno-0-4712"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4713"><a id="__codelineno-0-4713" name="__codelineno-0-4713"></a><span class="sd">        group_id (str):</span>
</span><span id="__span-0-4714"><a id="__codelineno-0-4714" name="__codelineno-0-4714"></a><span class="sd">            The ID of the M365 group the site should be retrieved for.</span>
</span><span id="__span-0-4715"><a id="__codelineno-0-4715" name="__codelineno-0-4715"></a>
</span><span id="__span-0-4716"><a id="__codelineno-0-4716" name="__codelineno-0-4716"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4717"><a id="__codelineno-0-4717" name="__codelineno-0-4717"></a><span class="sd">        dict:</span>
</span><span id="__span-0-4718"><a id="__codelineno-0-4718" name="__codelineno-0-4718"></a><span class="sd">            The data of the SharePoint site.</span>
</span><span id="__span-0-4719"><a id="__codelineno-0-4719" name="__codelineno-0-4719"></a>
</span><span id="__span-0-4720"><a id="__codelineno-0-4720" name="__codelineno-0-4720"></a><span class="sd">    Example:</span>
</span><span id="__span-0-4721"><a id="__codelineno-0-4721" name="__codelineno-0-4721"></a><span class="sd">    {</span>
</span><span id="__span-0-4722"><a id="__codelineno-0-4722" name="__codelineno-0-4722"></a><span class="sd">        &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites/$entity&#39;,</span>
</span><span id="__span-0-4723"><a id="__codelineno-0-4723" name="__codelineno-0-4723"></a><span class="sd">        &#39;createdDateTime&#39;: &#39;2025-02-06T07:41:53.41Z&#39;,</span>
</span><span id="__span-0-4724"><a id="__codelineno-0-4724" name="__codelineno-0-4724"></a><span class="sd">        &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-4725"><a id="__codelineno-0-4725" name="__codelineno-0-4725"></a><span class="sd">        &#39;id&#39;: &#39;ideatedev.sharepoint.com,9b203cbe-27ca-45b2-944a-663cc99e5e8f,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4726"><a id="__codelineno-0-4726" name="__codelineno-0-4726"></a><span class="sd">        &#39;lastModifiedDateTime&#39;: &#39;2025-02-10T20:37:11Z&#39;,</span>
</span><span id="__span-0-4727"><a id="__codelineno-0-4727" name="__codelineno-0-4727"></a><span class="sd">        &#39;name&#39;: &#39;TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4728"><a id="__codelineno-0-4728" name="__codelineno-0-4728"></a><span class="sd">        &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/TG11-Trad.Good11PDReg.Trading795&#39;,</span>
</span><span id="__span-0-4729"><a id="__codelineno-0-4729" name="__codelineno-0-4729"></a><span class="sd">        &#39;displayName&#39;: &#39;TG11 - Trad.Good 11,PD,Reg.Trading&#39;,</span>
</span><span id="__span-0-4730"><a id="__codelineno-0-4730" name="__codelineno-0-4730"></a><span class="sd">        &#39;root&#39;: {},</span>
</span><span id="__span-0-4731"><a id="__codelineno-0-4731" name="__codelineno-0-4731"></a><span class="sd">        &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4732"><a id="__codelineno-0-4732" name="__codelineno-0-4732"></a><span class="sd">            &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4733"><a id="__codelineno-0-4733" name="__codelineno-0-4733"></a><span class="sd">        }</span>
</span><span id="__span-0-4734"><a id="__codelineno-0-4734" name="__codelineno-0-4734"></a><span class="sd">    }</span>
</span><span id="__span-0-4735"><a id="__codelineno-0-4735" name="__codelineno-0-4735"></a>
</span><span id="__span-0-4736"><a id="__codelineno-0-4736" name="__codelineno-0-4736"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4737"><a id="__codelineno-0-4737" name="__codelineno-0-4737"></a>
</span><span id="__span-0-4738"><a id="__codelineno-0-4738" name="__codelineno-0-4738"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/sites/root&quot;</span>
</span><span id="__span-0-4739"><a id="__codelineno-0-4739" name="__codelineno-0-4739"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4740"><a id="__codelineno-0-4740" name="__codelineno-0-4740"></a>
</span><span id="__span-0-4741"><a id="__codelineno-0-4741" name="__codelineno-0-4741"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4742"><a id="__codelineno-0-4742" name="__codelineno-0-4742"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4743"><a id="__codelineno-0-4743" name="__codelineno-0-4743"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4744"><a id="__codelineno-0-4744" name="__codelineno-0-4744"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4745"><a id="__codelineno-0-4745" name="__codelineno-0-4745"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4746"><a id="__codelineno-0-4746" name="__codelineno-0-4746"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint site for group with ID -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group_id</span><span class="p">),</span>
</span><span id="__span-0-4747"><a id="__codelineno-0-4747" name="__codelineno-0-4747"></a>    <span class="p">)</span>
</span><span id="__span-0-4748"><a id="__codelineno-0-4748" name="__codelineno-0-4748"></a>
</span><span id="__span-0-4749"><a id="__codelineno-0-4749" name="__codelineno-0-4749"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_sites" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_sites</span><span class="p">(</span><span class="n">search</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filter_expression</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">next_page_url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a list of SharePoint sites.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>search</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string to search for to filter the results. Default is None = no filtering.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_expression</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter string to filter the results. Default is None = no filtering.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>select</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fields to select. Make sure that all fields are selected that are used in filters.
Otherwise you will get no results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of sites to return in one call.
Default is set to 50.</p>
              </div>
            </td>
            <td>
                  <code>50</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>next_page_url</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MS Graph URL to retrieve the next page of SharePoint sites (pagination).
This is used for the iterator get_sharepoint_sites_iterator() below.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
A list of SharePoint sites embedded in a "value" key in the dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example response:
{
    '@odata.context': 'https://graph.microsoft.com/beta/$metadata#sites',
    '@odata.nextLink': 'https://graph.microsoft.com/beta/sites?$top=50&amp;$skiptoken=UGFnZWQ9VFJVRSZwX1RpbWVEZWxldGVkPSZwX0lEPTE5MDM4',
    'value': [
        {
            'createdDateTime': '2025-02-11T12:11:49Z',
            'id': 'ideatedev-my.sharepoint.com,eeed2961-91ba-46c1-abc2-159f0277130f,5aa8a98d-659d-4a52-8701-6b9a728092d8',
            'name': 'Diane Conner',
            'webUrl': 'https://ideatedev-my.sharepoint.com/personal/dconner_dev_idea-te_eimdemo_com',
            'displayName': 'Diane Conner',
            'isPersonalSite': True,
            'siteCollection': {
                'hostname': 'ideatedev-my.sharepoint.com'
            },
            'root': {}
        },
        {
            'createdDateTime': '2025-02-06T07:44:44Z',
            'id': 'ideatedev.sharepoint.com,570e67bc-1e69-4a62-89ea-994be9642b93,a1462b54-26f9-4a24-9660-2bc7859ce9af',
            'name': 'SG325B - SEMI325B,ECM,PD,ExternalProcurement',
            'webUrl': 'https://ideatedev.sharepoint.com/sites/SG325B-SEMI325BECMPDExternalProcurement698',
            'displayName': 'SG325B - SEMI325B,ECM,PD,ExternalProcurement',
            'isPersonalSite': False,
            'siteCollection': {
                'hostname': 'ideatedev.sharepoint.com'
            },
            'root': {}
        },
        ...
    ]
]</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4432">4432</a></span>
<span class="normal"><a href="#__codelineno-0-4433">4433</a></span>
<span class="normal"><a href="#__codelineno-0-4434">4434</a></span>
<span class="normal"><a href="#__codelineno-0-4435">4435</a></span>
<span class="normal"><a href="#__codelineno-0-4436">4436</a></span>
<span class="normal"><a href="#__codelineno-0-4437">4437</a></span>
<span class="normal"><a href="#__codelineno-0-4438">4438</a></span>
<span class="normal"><a href="#__codelineno-0-4439">4439</a></span>
<span class="normal"><a href="#__codelineno-0-4440">4440</a></span>
<span class="normal"><a href="#__codelineno-0-4441">4441</a></span>
<span class="normal"><a href="#__codelineno-0-4442">4442</a></span>
<span class="normal"><a href="#__codelineno-0-4443">4443</a></span>
<span class="normal"><a href="#__codelineno-0-4444">4444</a></span>
<span class="normal"><a href="#__codelineno-0-4445">4445</a></span>
<span class="normal"><a href="#__codelineno-0-4446">4446</a></span>
<span class="normal"><a href="#__codelineno-0-4447">4447</a></span>
<span class="normal"><a href="#__codelineno-0-4448">4448</a></span>
<span class="normal"><a href="#__codelineno-0-4449">4449</a></span>
<span class="normal"><a href="#__codelineno-0-4450">4450</a></span>
<span class="normal"><a href="#__codelineno-0-4451">4451</a></span>
<span class="normal"><a href="#__codelineno-0-4452">4452</a></span>
<span class="normal"><a href="#__codelineno-0-4453">4453</a></span>
<span class="normal"><a href="#__codelineno-0-4454">4454</a></span>
<span class="normal"><a href="#__codelineno-0-4455">4455</a></span>
<span class="normal"><a href="#__codelineno-0-4456">4456</a></span>
<span class="normal"><a href="#__codelineno-0-4457">4457</a></span>
<span class="normal"><a href="#__codelineno-0-4458">4458</a></span>
<span class="normal"><a href="#__codelineno-0-4459">4459</a></span>
<span class="normal"><a href="#__codelineno-0-4460">4460</a></span>
<span class="normal"><a href="#__codelineno-0-4461">4461</a></span>
<span class="normal"><a href="#__codelineno-0-4462">4462</a></span>
<span class="normal"><a href="#__codelineno-0-4463">4463</a></span>
<span class="normal"><a href="#__codelineno-0-4464">4464</a></span>
<span class="normal"><a href="#__codelineno-0-4465">4465</a></span>
<span class="normal"><a href="#__codelineno-0-4466">4466</a></span>
<span class="normal"><a href="#__codelineno-0-4467">4467</a></span>
<span class="normal"><a href="#__codelineno-0-4468">4468</a></span>
<span class="normal"><a href="#__codelineno-0-4469">4469</a></span>
<span class="normal"><a href="#__codelineno-0-4470">4470</a></span>
<span class="normal"><a href="#__codelineno-0-4471">4471</a></span>
<span class="normal"><a href="#__codelineno-0-4472">4472</a></span>
<span class="normal"><a href="#__codelineno-0-4473">4473</a></span>
<span class="normal"><a href="#__codelineno-0-4474">4474</a></span>
<span class="normal"><a href="#__codelineno-0-4475">4475</a></span>
<span class="normal"><a href="#__codelineno-0-4476">4476</a></span>
<span class="normal"><a href="#__codelineno-0-4477">4477</a></span>
<span class="normal"><a href="#__codelineno-0-4478">4478</a></span>
<span class="normal"><a href="#__codelineno-0-4479">4479</a></span>
<span class="normal"><a href="#__codelineno-0-4480">4480</a></span>
<span class="normal"><a href="#__codelineno-0-4481">4481</a></span>
<span class="normal"><a href="#__codelineno-0-4482">4482</a></span>
<span class="normal"><a href="#__codelineno-0-4483">4483</a></span>
<span class="normal"><a href="#__codelineno-0-4484">4484</a></span>
<span class="normal"><a href="#__codelineno-0-4485">4485</a></span>
<span class="normal"><a href="#__codelineno-0-4486">4486</a></span>
<span class="normal"><a href="#__codelineno-0-4487">4487</a></span>
<span class="normal"><a href="#__codelineno-0-4488">4488</a></span>
<span class="normal"><a href="#__codelineno-0-4489">4489</a></span>
<span class="normal"><a href="#__codelineno-0-4490">4490</a></span>
<span class="normal"><a href="#__codelineno-0-4491">4491</a></span>
<span class="normal"><a href="#__codelineno-0-4492">4492</a></span>
<span class="normal"><a href="#__codelineno-0-4493">4493</a></span>
<span class="normal"><a href="#__codelineno-0-4494">4494</a></span>
<span class="normal"><a href="#__codelineno-0-4495">4495</a></span>
<span class="normal"><a href="#__codelineno-0-4496">4496</a></span>
<span class="normal"><a href="#__codelineno-0-4497">4497</a></span>
<span class="normal"><a href="#__codelineno-0-4498">4498</a></span>
<span class="normal"><a href="#__codelineno-0-4499">4499</a></span>
<span class="normal"><a href="#__codelineno-0-4500">4500</a></span>
<span class="normal"><a href="#__codelineno-0-4501">4501</a></span>
<span class="normal"><a href="#__codelineno-0-4502">4502</a></span>
<span class="normal"><a href="#__codelineno-0-4503">4503</a></span>
<span class="normal"><a href="#__codelineno-0-4504">4504</a></span>
<span class="normal"><a href="#__codelineno-0-4505">4505</a></span>
<span class="normal"><a href="#__codelineno-0-4506">4506</a></span>
<span class="normal"><a href="#__codelineno-0-4507">4507</a></span>
<span class="normal"><a href="#__codelineno-0-4508">4508</a></span>
<span class="normal"><a href="#__codelineno-0-4509">4509</a></span>
<span class="normal"><a href="#__codelineno-0-4510">4510</a></span>
<span class="normal"><a href="#__codelineno-0-4511">4511</a></span>
<span class="normal"><a href="#__codelineno-0-4512">4512</a></span>
<span class="normal"><a href="#__codelineno-0-4513">4513</a></span>
<span class="normal"><a href="#__codelineno-0-4514">4514</a></span>
<span class="normal"><a href="#__codelineno-0-4515">4515</a></span>
<span class="normal"><a href="#__codelineno-0-4516">4516</a></span>
<span class="normal"><a href="#__codelineno-0-4517">4517</a></span>
<span class="normal"><a href="#__codelineno-0-4518">4518</a></span>
<span class="normal"><a href="#__codelineno-0-4519">4519</a></span>
<span class="normal"><a href="#__codelineno-0-4520">4520</a></span>
<span class="normal"><a href="#__codelineno-0-4521">4521</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4432"><a id="__codelineno-0-4432" name="__codelineno-0-4432"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_sites</span><span class="p">(</span>
</span><span id="__span-0-4433"><a id="__codelineno-0-4433" name="__codelineno-0-4433"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4434"><a id="__codelineno-0-4434" name="__codelineno-0-4434"></a>    <span class="n">search</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4435"><a id="__codelineno-0-4435" name="__codelineno-0-4435"></a>    <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4436"><a id="__codelineno-0-4436" name="__codelineno-0-4436"></a>    <span class="n">select</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4437"><a id="__codelineno-0-4437" name="__codelineno-0-4437"></a>    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
</span><span id="__span-0-4438"><a id="__codelineno-0-4438" name="__codelineno-0-4438"></a>    <span class="n">next_page_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4439"><a id="__codelineno-0-4439" name="__codelineno-0-4439"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-4440"><a id="__codelineno-0-4440" name="__codelineno-0-4440"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a list of SharePoint sites.</span>
</span><span id="__span-0-4441"><a id="__codelineno-0-4441" name="__codelineno-0-4441"></a>
</span><span id="__span-0-4442"><a id="__codelineno-0-4442" name="__codelineno-0-4442"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4443"><a id="__codelineno-0-4443" name="__codelineno-0-4443"></a><span class="sd">        search (str, optional):</span>
</span><span id="__span-0-4444"><a id="__codelineno-0-4444" name="__codelineno-0-4444"></a><span class="sd">            A string to search for to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4445"><a id="__codelineno-0-4445" name="__codelineno-0-4445"></a><span class="sd">        filter_expression (str | None, optional):</span>
</span><span id="__span-0-4446"><a id="__codelineno-0-4446" name="__codelineno-0-4446"></a><span class="sd">            Filter string to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4447"><a id="__codelineno-0-4447" name="__codelineno-0-4447"></a><span class="sd">        select (str | None, optional):</span>
</span><span id="__span-0-4448"><a id="__codelineno-0-4448" name="__codelineno-0-4448"></a><span class="sd">            Fields to select. Make sure that all fields are selected that are used in filters.</span>
</span><span id="__span-0-4449"><a id="__codelineno-0-4449" name="__codelineno-0-4449"></a><span class="sd">            Otherwise you will get no results.</span>
</span><span id="__span-0-4450"><a id="__codelineno-0-4450" name="__codelineno-0-4450"></a><span class="sd">        limit (int, optional):</span>
</span><span id="__span-0-4451"><a id="__codelineno-0-4451" name="__codelineno-0-4451"></a><span class="sd">            The maximum number of sites to return in one call.</span>
</span><span id="__span-0-4452"><a id="__codelineno-0-4452" name="__codelineno-0-4452"></a><span class="sd">            Default is set to 50.</span>
</span><span id="__span-0-4453"><a id="__codelineno-0-4453" name="__codelineno-0-4453"></a><span class="sd">        next_page_url (str | None, optional):</span>
</span><span id="__span-0-4454"><a id="__codelineno-0-4454" name="__codelineno-0-4454"></a><span class="sd">            The MS Graph URL to retrieve the next page of SharePoint sites (pagination).</span>
</span><span id="__span-0-4455"><a id="__codelineno-0-4455" name="__codelineno-0-4455"></a><span class="sd">            This is used for the iterator get_sharepoint_sites_iterator() below.</span>
</span><span id="__span-0-4456"><a id="__codelineno-0-4456" name="__codelineno-0-4456"></a>
</span><span id="__span-0-4457"><a id="__codelineno-0-4457" name="__codelineno-0-4457"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4458"><a id="__codelineno-0-4458" name="__codelineno-0-4458"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-4459"><a id="__codelineno-0-4459" name="__codelineno-0-4459"></a><span class="sd">            A list of SharePoint sites embedded in a &quot;value&quot; key in the dictionary.</span>
</span><span id="__span-0-4460"><a id="__codelineno-0-4460" name="__codelineno-0-4460"></a>
</span><span id="__span-0-4461"><a id="__codelineno-0-4461" name="__codelineno-0-4461"></a><span class="sd">    Example response:</span>
</span><span id="__span-0-4462"><a id="__codelineno-0-4462" name="__codelineno-0-4462"></a><span class="sd">    {</span>
</span><span id="__span-0-4463"><a id="__codelineno-0-4463" name="__codelineno-0-4463"></a><span class="sd">        &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/beta/$metadata#sites&#39;,</span>
</span><span id="__span-0-4464"><a id="__codelineno-0-4464" name="__codelineno-0-4464"></a><span class="sd">        &#39;@odata.nextLink&#39;: &#39;https://graph.microsoft.com/beta/sites?$top=50&amp;$skiptoken=UGFnZWQ9VFJVRSZwX1RpbWVEZWxldGVkPSZwX0lEPTE5MDM4&#39;,</span>
</span><span id="__span-0-4465"><a id="__codelineno-0-4465" name="__codelineno-0-4465"></a><span class="sd">        &#39;value&#39;: [</span>
</span><span id="__span-0-4466"><a id="__codelineno-0-4466" name="__codelineno-0-4466"></a><span class="sd">            {</span>
</span><span id="__span-0-4467"><a id="__codelineno-0-4467" name="__codelineno-0-4467"></a><span class="sd">                &#39;createdDateTime&#39;: &#39;2025-02-11T12:11:49Z&#39;,</span>
</span><span id="__span-0-4468"><a id="__codelineno-0-4468" name="__codelineno-0-4468"></a><span class="sd">                &#39;id&#39;: &#39;ideatedev-my.sharepoint.com,eeed2961-91ba-46c1-abc2-159f0277130f,5aa8a98d-659d-4a52-8701-6b9a728092d8&#39;,</span>
</span><span id="__span-0-4469"><a id="__codelineno-0-4469" name="__codelineno-0-4469"></a><span class="sd">                &#39;name&#39;: &#39;Diane Conner&#39;,</span>
</span><span id="__span-0-4470"><a id="__codelineno-0-4470" name="__codelineno-0-4470"></a><span class="sd">                &#39;webUrl&#39;: &#39;https://ideatedev-my.sharepoint.com/personal/dconner_dev_idea-te_eimdemo_com&#39;,</span>
</span><span id="__span-0-4471"><a id="__codelineno-0-4471" name="__codelineno-0-4471"></a><span class="sd">                &#39;displayName&#39;: &#39;Diane Conner&#39;,</span>
</span><span id="__span-0-4472"><a id="__codelineno-0-4472" name="__codelineno-0-4472"></a><span class="sd">                &#39;isPersonalSite&#39;: True,</span>
</span><span id="__span-0-4473"><a id="__codelineno-0-4473" name="__codelineno-0-4473"></a><span class="sd">                &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4474"><a id="__codelineno-0-4474" name="__codelineno-0-4474"></a><span class="sd">                    &#39;hostname&#39;: &#39;ideatedev-my.sharepoint.com&#39;</span>
</span><span id="__span-0-4475"><a id="__codelineno-0-4475" name="__codelineno-0-4475"></a><span class="sd">                },</span>
</span><span id="__span-0-4476"><a id="__codelineno-0-4476" name="__codelineno-0-4476"></a><span class="sd">                &#39;root&#39;: {}</span>
</span><span id="__span-0-4477"><a id="__codelineno-0-4477" name="__codelineno-0-4477"></a><span class="sd">            },</span>
</span><span id="__span-0-4478"><a id="__codelineno-0-4478" name="__codelineno-0-4478"></a><span class="sd">            {</span>
</span><span id="__span-0-4479"><a id="__codelineno-0-4479" name="__codelineno-0-4479"></a><span class="sd">                &#39;createdDateTime&#39;: &#39;2025-02-06T07:44:44Z&#39;,</span>
</span><span id="__span-0-4480"><a id="__codelineno-0-4480" name="__codelineno-0-4480"></a><span class="sd">                &#39;id&#39;: &#39;ideatedev.sharepoint.com,570e67bc-1e69-4a62-89ea-994be9642b93,a1462b54-26f9-4a24-9660-2bc7859ce9af&#39;,</span>
</span><span id="__span-0-4481"><a id="__codelineno-0-4481" name="__codelineno-0-4481"></a><span class="sd">                &#39;name&#39;: &#39;SG325B - SEMI325B,ECM,PD,ExternalProcurement&#39;,</span>
</span><span id="__span-0-4482"><a id="__codelineno-0-4482" name="__codelineno-0-4482"></a><span class="sd">                &#39;webUrl&#39;: &#39;https://ideatedev.sharepoint.com/sites/SG325B-SEMI325BECMPDExternalProcurement698&#39;,</span>
</span><span id="__span-0-4483"><a id="__codelineno-0-4483" name="__codelineno-0-4483"></a><span class="sd">                &#39;displayName&#39;: &#39;SG325B - SEMI325B,ECM,PD,ExternalProcurement&#39;,</span>
</span><span id="__span-0-4484"><a id="__codelineno-0-4484" name="__codelineno-0-4484"></a><span class="sd">                &#39;isPersonalSite&#39;: False,</span>
</span><span id="__span-0-4485"><a id="__codelineno-0-4485" name="__codelineno-0-4485"></a><span class="sd">                &#39;siteCollection&#39;: {</span>
</span><span id="__span-0-4486"><a id="__codelineno-0-4486" name="__codelineno-0-4486"></a><span class="sd">                    &#39;hostname&#39;: &#39;ideatedev.sharepoint.com&#39;</span>
</span><span id="__span-0-4487"><a id="__codelineno-0-4487" name="__codelineno-0-4487"></a><span class="sd">                },</span>
</span><span id="__span-0-4488"><a id="__codelineno-0-4488" name="__codelineno-0-4488"></a><span class="sd">                &#39;root&#39;: {}</span>
</span><span id="__span-0-4489"><a id="__codelineno-0-4489" name="__codelineno-0-4489"></a><span class="sd">            },</span>
</span><span id="__span-0-4490"><a id="__codelineno-0-4490" name="__codelineno-0-4490"></a><span class="sd">            ...</span>
</span><span id="__span-0-4491"><a id="__codelineno-0-4491" name="__codelineno-0-4491"></a><span class="sd">        ]</span>
</span><span id="__span-0-4492"><a id="__codelineno-0-4492" name="__codelineno-0-4492"></a><span class="sd">    ]</span>
</span><span id="__span-0-4493"><a id="__codelineno-0-4493" name="__codelineno-0-4493"></a>
</span><span id="__span-0-4494"><a id="__codelineno-0-4494" name="__codelineno-0-4494"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4495"><a id="__codelineno-0-4495" name="__codelineno-0-4495"></a>
</span><span id="__span-0-4496"><a id="__codelineno-0-4496" name="__codelineno-0-4496"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-4497"><a id="__codelineno-0-4497" name="__codelineno-0-4497"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-4498"><a id="__codelineno-0-4498" name="__codelineno-0-4498"></a>        <span class="k">if</span> <span class="n">select</span><span class="p">:</span>
</span><span id="__span-0-4499"><a id="__codelineno-0-4499" name="__codelineno-0-4499"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$select&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">select</span>
</span><span id="__span-0-4500"><a id="__codelineno-0-4500" name="__codelineno-0-4500"></a>        <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-4501"><a id="__codelineno-0-4501" name="__codelineno-0-4501"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-4502"><a id="__codelineno-0-4502" name="__codelineno-0-4502"></a>        <span class="k">if</span> <span class="n">search</span><span class="p">:</span>
</span><span id="__span-0-4503"><a id="__codelineno-0-4503" name="__codelineno-0-4503"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search</span>
</span><span id="__span-0-4504"><a id="__codelineno-0-4504" name="__codelineno-0-4504"></a>        <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
</span><span id="__span-0-4505"><a id="__codelineno-0-4505" name="__codelineno-0-4505"></a>            <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span>
</span><span id="__span-0-4506"><a id="__codelineno-0-4506" name="__codelineno-0-4506"></a>
</span><span id="__span-0-4507"><a id="__codelineno-0-4507" name="__codelineno-0-4507"></a>        <span class="n">encoded_query</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">query</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-4508"><a id="__codelineno-0-4508" name="__codelineno-0-4508"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-4509"><a id="__codelineno-0-4509" name="__codelineno-0-4509"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-4510"><a id="__codelineno-0-4510" name="__codelineno-0-4510"></a>        <span class="n">request_url</span> <span class="o">=</span> <span class="n">next_page_url</span>
</span><span id="__span-0-4511"><a id="__codelineno-0-4511" name="__codelineno-0-4511"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4512"><a id="__codelineno-0-4512" name="__codelineno-0-4512"></a>
</span><span id="__span-0-4513"><a id="__codelineno-0-4513" name="__codelineno-0-4513"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4514"><a id="__codelineno-0-4514" name="__codelineno-0-4514"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4515"><a id="__codelineno-0-4515" name="__codelineno-0-4515"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-4516"><a id="__codelineno-0-4516" name="__codelineno-0-4516"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4517"><a id="__codelineno-0-4517" name="__codelineno-0-4517"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4518"><a id="__codelineno-0-4518" name="__codelineno-0-4518"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint sites&quot;</span><span class="p">,</span>
</span><span id="__span-0-4519"><a id="__codelineno-0-4519" name="__codelineno-0-4519"></a>    <span class="p">)</span>
</span><span id="__span-0-4520"><a id="__codelineno-0-4520" name="__codelineno-0-4520"></a>
</span><span id="__span-0-4521"><a id="__codelineno-0-4521" name="__codelineno-0-4521"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_sites_iterator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_sites_iterator</span><span class="p">(</span><span class="n">search</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filter_expression</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get an iterator object that can be used to traverse all SharePoint sites matching the filter.</p>
<p>Returning a generator avoids loading a large number of nodes into memory at once. Instead you
can iterate over the potential large list of SharePoint sites.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>sites = m365_object.get_sharepoint_sites_iterator(limit=10)
for site in sites:
    logger.info("Traversing SharePoint site -&gt; '%s'...", site.get("name", "<undefined name>"))</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>search</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string to search for to filter the results. Default is None = no filtering.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_expression</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter string to filter the results. Default is None = no filtering.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>select</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fields to select. Make sure that all fields are selected that are used in filters.
Otherwise you will get no results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of sites to return in one call.
Default is set to 50.</p>
              </div>
            </td>
            <td>
                  <code>50</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>iter</code></td>            <td>
                  <code><span title="iter">iter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A generator yielding one SharePoint site per iteration.
If the REST API fails, returns no value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4543">4543</a></span>
<span class="normal"><a href="#__codelineno-0-4544">4544</a></span>
<span class="normal"><a href="#__codelineno-0-4545">4545</a></span>
<span class="normal"><a href="#__codelineno-0-4546">4546</a></span>
<span class="normal"><a href="#__codelineno-0-4547">4547</a></span>
<span class="normal"><a href="#__codelineno-0-4548">4548</a></span>
<span class="normal"><a href="#__codelineno-0-4549">4549</a></span>
<span class="normal"><a href="#__codelineno-0-4550">4550</a></span>
<span class="normal"><a href="#__codelineno-0-4551">4551</a></span>
<span class="normal"><a href="#__codelineno-0-4552">4552</a></span>
<span class="normal"><a href="#__codelineno-0-4553">4553</a></span>
<span class="normal"><a href="#__codelineno-0-4554">4554</a></span>
<span class="normal"><a href="#__codelineno-0-4555">4555</a></span>
<span class="normal"><a href="#__codelineno-0-4556">4556</a></span>
<span class="normal"><a href="#__codelineno-0-4557">4557</a></span>
<span class="normal"><a href="#__codelineno-0-4558">4558</a></span>
<span class="normal"><a href="#__codelineno-0-4559">4559</a></span>
<span class="normal"><a href="#__codelineno-0-4560">4560</a></span>
<span class="normal"><a href="#__codelineno-0-4561">4561</a></span>
<span class="normal"><a href="#__codelineno-0-4562">4562</a></span>
<span class="normal"><a href="#__codelineno-0-4563">4563</a></span>
<span class="normal"><a href="#__codelineno-0-4564">4564</a></span>
<span class="normal"><a href="#__codelineno-0-4565">4565</a></span>
<span class="normal"><a href="#__codelineno-0-4566">4566</a></span>
<span class="normal"><a href="#__codelineno-0-4567">4567</a></span>
<span class="normal"><a href="#__codelineno-0-4568">4568</a></span>
<span class="normal"><a href="#__codelineno-0-4569">4569</a></span>
<span class="normal"><a href="#__codelineno-0-4570">4570</a></span>
<span class="normal"><a href="#__codelineno-0-4571">4571</a></span>
<span class="normal"><a href="#__codelineno-0-4572">4572</a></span>
<span class="normal"><a href="#__codelineno-0-4573">4573</a></span>
<span class="normal"><a href="#__codelineno-0-4574">4574</a></span>
<span class="normal"><a href="#__codelineno-0-4575">4575</a></span>
<span class="normal"><a href="#__codelineno-0-4576">4576</a></span>
<span class="normal"><a href="#__codelineno-0-4577">4577</a></span>
<span class="normal"><a href="#__codelineno-0-4578">4578</a></span>
<span class="normal"><a href="#__codelineno-0-4579">4579</a></span>
<span class="normal"><a href="#__codelineno-0-4580">4580</a></span>
<span class="normal"><a href="#__codelineno-0-4581">4581</a></span>
<span class="normal"><a href="#__codelineno-0-4582">4582</a></span>
<span class="normal"><a href="#__codelineno-0-4583">4583</a></span>
<span class="normal"><a href="#__codelineno-0-4584">4584</a></span>
<span class="normal"><a href="#__codelineno-0-4585">4585</a></span>
<span class="normal"><a href="#__codelineno-0-4586">4586</a></span>
<span class="normal"><a href="#__codelineno-0-4587">4587</a></span>
<span class="normal"><a href="#__codelineno-0-4588">4588</a></span>
<span class="normal"><a href="#__codelineno-0-4589">4589</a></span>
<span class="normal"><a href="#__codelineno-0-4590">4590</a></span>
<span class="normal"><a href="#__codelineno-0-4591">4591</a></span>
<span class="normal"><a href="#__codelineno-0-4592">4592</a></span>
<span class="normal"><a href="#__codelineno-0-4593">4593</a></span>
<span class="normal"><a href="#__codelineno-0-4594">4594</a></span>
<span class="normal"><a href="#__codelineno-0-4595">4595</a></span>
<span class="normal"><a href="#__codelineno-0-4596">4596</a></span>
<span class="normal"><a href="#__codelineno-0-4597">4597</a></span>
<span class="normal"><a href="#__codelineno-0-4598">4598</a></span>
<span class="normal"><a href="#__codelineno-0-4599">4599</a></span>
<span class="normal"><a href="#__codelineno-0-4600">4600</a></span>
<span class="normal"><a href="#__codelineno-0-4601">4601</a></span>
<span class="normal"><a href="#__codelineno-0-4602">4602</a></span>
<span class="normal"><a href="#__codelineno-0-4603">4603</a></span>
<span class="normal"><a href="#__codelineno-0-4604">4604</a></span>
<span class="normal"><a href="#__codelineno-0-4605">4605</a></span>
<span class="normal"><a href="#__codelineno-0-4606">4606</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4543"><a id="__codelineno-0-4543" name="__codelineno-0-4543"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_sites_iterator</span><span class="p">(</span>
</span><span id="__span-0-4544"><a id="__codelineno-0-4544" name="__codelineno-0-4544"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-4545"><a id="__codelineno-0-4545" name="__codelineno-0-4545"></a>    <span class="n">search</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4546"><a id="__codelineno-0-4546" name="__codelineno-0-4546"></a>    <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4547"><a id="__codelineno-0-4547" name="__codelineno-0-4547"></a>    <span class="n">select</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4548"><a id="__codelineno-0-4548" name="__codelineno-0-4548"></a>    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
</span><span id="__span-0-4549"><a id="__codelineno-0-4549" name="__codelineno-0-4549"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">iter</span><span class="p">:</span>
</span><span id="__span-0-4550"><a id="__codelineno-0-4550" name="__codelineno-0-4550"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an iterator object that can be used to traverse all SharePoint sites matching the filter.</span>
</span><span id="__span-0-4551"><a id="__codelineno-0-4551" name="__codelineno-0-4551"></a>
</span><span id="__span-0-4552"><a id="__codelineno-0-4552" name="__codelineno-0-4552"></a><span class="sd">    Returning a generator avoids loading a large number of nodes into memory at once. Instead you</span>
</span><span id="__span-0-4553"><a id="__codelineno-0-4553" name="__codelineno-0-4553"></a><span class="sd">    can iterate over the potential large list of SharePoint sites.</span>
</span><span id="__span-0-4554"><a id="__codelineno-0-4554" name="__codelineno-0-4554"></a>
</span><span id="__span-0-4555"><a id="__codelineno-0-4555" name="__codelineno-0-4555"></a><span class="sd">    Example usage:</span>
</span><span id="__span-0-4556"><a id="__codelineno-0-4556" name="__codelineno-0-4556"></a><span class="sd">        sites = m365_object.get_sharepoint_sites_iterator(limit=10)</span>
</span><span id="__span-0-4557"><a id="__codelineno-0-4557" name="__codelineno-0-4557"></a><span class="sd">        for site in sites:</span>
</span><span id="__span-0-4558"><a id="__codelineno-0-4558" name="__codelineno-0-4558"></a><span class="sd">            logger.info(&quot;Traversing SharePoint site -&gt; &#39;%s&#39;...&quot;, site.get(&quot;name&quot;, &quot;&lt;undefined name&gt;&quot;))</span>
</span><span id="__span-0-4559"><a id="__codelineno-0-4559" name="__codelineno-0-4559"></a>
</span><span id="__span-0-4560"><a id="__codelineno-0-4560" name="__codelineno-0-4560"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4561"><a id="__codelineno-0-4561" name="__codelineno-0-4561"></a><span class="sd">        search (str | None, optional):</span>
</span><span id="__span-0-4562"><a id="__codelineno-0-4562" name="__codelineno-0-4562"></a><span class="sd">            A string to search for to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4563"><a id="__codelineno-0-4563" name="__codelineno-0-4563"></a><span class="sd">        filter_expression (str | None, optional):</span>
</span><span id="__span-0-4564"><a id="__codelineno-0-4564" name="__codelineno-0-4564"></a><span class="sd">            Filter string to filter the results. Default is None = no filtering.</span>
</span><span id="__span-0-4565"><a id="__codelineno-0-4565" name="__codelineno-0-4565"></a><span class="sd">        select (str | None, optional):</span>
</span><span id="__span-0-4566"><a id="__codelineno-0-4566" name="__codelineno-0-4566"></a><span class="sd">            Fields to select. Make sure that all fields are selected that are used in filters.</span>
</span><span id="__span-0-4567"><a id="__codelineno-0-4567" name="__codelineno-0-4567"></a><span class="sd">            Otherwise you will get no results.</span>
</span><span id="__span-0-4568"><a id="__codelineno-0-4568" name="__codelineno-0-4568"></a><span class="sd">        limit (int, optional):</span>
</span><span id="__span-0-4569"><a id="__codelineno-0-4569" name="__codelineno-0-4569"></a><span class="sd">            The maximum number of sites to return in one call.</span>
</span><span id="__span-0-4570"><a id="__codelineno-0-4570" name="__codelineno-0-4570"></a><span class="sd">            Default is set to 50.</span>
</span><span id="__span-0-4571"><a id="__codelineno-0-4571" name="__codelineno-0-4571"></a>
</span><span id="__span-0-4572"><a id="__codelineno-0-4572" name="__codelineno-0-4572"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4573"><a id="__codelineno-0-4573" name="__codelineno-0-4573"></a><span class="sd">        iter:</span>
</span><span id="__span-0-4574"><a id="__codelineno-0-4574" name="__codelineno-0-4574"></a><span class="sd">            A generator yielding one SharePoint site per iteration.</span>
</span><span id="__span-0-4575"><a id="__codelineno-0-4575" name="__codelineno-0-4575"></a><span class="sd">            If the REST API fails, returns no value.</span>
</span><span id="__span-0-4576"><a id="__codelineno-0-4576" name="__codelineno-0-4576"></a>
</span><span id="__span-0-4577"><a id="__codelineno-0-4577" name="__codelineno-0-4577"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4578"><a id="__codelineno-0-4578" name="__codelineno-0-4578"></a>
</span><span id="__span-0-4579"><a id="__codelineno-0-4579" name="__codelineno-0-4579"></a>    <span class="n">next_page_url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-4580"><a id="__codelineno-0-4580" name="__codelineno-0-4580"></a>
</span><span id="__span-0-4581"><a id="__codelineno-0-4581" name="__codelineno-0-4581"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-4582"><a id="__codelineno-0-4582" name="__codelineno-0-4582"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_sites</span><span class="p">(</span>
</span><span id="__span-0-4583"><a id="__codelineno-0-4583" name="__codelineno-0-4583"></a>            <span class="n">search</span><span class="o">=</span><span class="n">search</span><span class="p">,</span>
</span><span id="__span-0-4584"><a id="__codelineno-0-4584" name="__codelineno-0-4584"></a>            <span class="n">filter_expression</span><span class="o">=</span><span class="n">filter_expression</span><span class="p">,</span>
</span><span id="__span-0-4585"><a id="__codelineno-0-4585" name="__codelineno-0-4585"></a>            <span class="n">select</span><span class="o">=</span><span class="n">select</span><span class="p">,</span>
</span><span id="__span-0-4586"><a id="__codelineno-0-4586" name="__codelineno-0-4586"></a>            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
</span><span id="__span-0-4587"><a id="__codelineno-0-4587" name="__codelineno-0-4587"></a>            <span class="n">next_page_url</span><span class="o">=</span><span class="n">next_page_url</span><span class="p">,</span>
</span><span id="__span-0-4588"><a id="__codelineno-0-4588" name="__codelineno-0-4588"></a>        <span class="p">)</span>
</span><span id="__span-0-4589"><a id="__codelineno-0-4589" name="__codelineno-0-4589"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-4590"><a id="__codelineno-0-4590" name="__codelineno-0-4590"></a>            <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-4591"><a id="__codelineno-0-4591" name="__codelineno-0-4591"></a>            <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-4592"><a id="__codelineno-0-4592" name="__codelineno-0-4592"></a>            <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-4593"><a id="__codelineno-0-4593" name="__codelineno-0-4593"></a>            <span class="k">return</span>
</span><span id="__span-0-4594"><a id="__codelineno-0-4594" name="__codelineno-0-4594"></a>
</span><span id="__span-0-4595"><a id="__codelineno-0-4595" name="__codelineno-0-4595"></a>        <span class="c1"># Yield users one at a time:</span>
</span><span id="__span-0-4596"><a id="__codelineno-0-4596" name="__codelineno-0-4596"></a>        <span class="k">yield from</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-4597"><a id="__codelineno-0-4597" name="__codelineno-0-4597"></a>
</span><span id="__span-0-4598"><a id="__codelineno-0-4598" name="__codelineno-0-4598"></a>        <span class="c1"># See if we have an additional result page.</span>
</span><span id="__span-0-4599"><a id="__codelineno-0-4599" name="__codelineno-0-4599"></a>        <span class="c1"># If not terminate the iterator and return</span>
</span><span id="__span-0-4600"><a id="__codelineno-0-4600" name="__codelineno-0-4600"></a>        <span class="c1"># no value.</span>
</span><span id="__span-0-4601"><a id="__codelineno-0-4601" name="__codelineno-0-4601"></a>        <span class="n">next_page_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.nextLink&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-4602"><a id="__codelineno-0-4602" name="__codelineno-0-4602"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-4603"><a id="__codelineno-0-4603" name="__codelineno-0-4603"></a>            <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-4604"><a id="__codelineno-0-4604" name="__codelineno-0-4604"></a>            <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-4605"><a id="__codelineno-0-4605" name="__codelineno-0-4605"></a>            <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-4606"><a id="__codelineno-0-4606" name="__codelineno-0-4606"></a>            <span class="k">return</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_webpart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_webpart</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">webpart_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve a page of a SharePoint site accessible to the authenticated user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the web part.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>webpart_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint web part to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
The data of the SharePoint web part.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C9b203cbe-27ca-45b2-944a-663cc99e5e8f%2Ca1462b54-26f9-4a24-9660-2bc7859ce9af')/pages('a546ce61-21e6-431d-b2cd-67d1f722be5f')/microsoft.graph.sitePage/webParts/$entity",
    '@odata.type': '#microsoft.graph.standardWebPart',
    'id': '405b669e-3c09-45fe-822f-ff60ac7fffce',
    'webPartType': 'c4bd7b2f-7b6e-4599-8485-16504575f590',
    'data': {
        'audiences': [...],
        'dataVersion': '1.5',
        'description': 'Prominently display up to 5 pieces of content with links, images, pictures, videos, or photos in a highly visual layout.',
        'title': 'Hero',
        'properties': {
            'heroLayoutThreshold': 640,
            'carouselLayoutMaxWidth': 639,
            'layoutCategory': 1,
            'layout': 5,
            'content@odata.type': '#Collection(graph.Json)',
            'content': [
                {
                    'id': '20cb6611-c7cc-4ba7-91e1-65a6cb576025',
                    'type': 'UrlLink',
                    'color': 4,
                    'description': '',
                    'title': '',
                    'showDescription': False,
                    'showTitle': True,
                    'alternateText': '',
                    'imageDisplayOption': 1,
                    'isDefaultImage': False,
                    'showCallToAction': True,
                    'isDefaultImageLoaded': False,
                    'isCustomImageLoaded': False,
                    'showFeatureText': False,
                    'previewImage': {
                        '@odata.type': '#graph.Json',
                        'zoomRatio': 1,
                        'resolvedUrl': '',
                        'imageUrl': '',
                        'widthFactor': 0.5,
                        'minCanvasWidth': 1
                    }
                },
                {...}
            ]
        },
        'serverProcessedContent': {...}
    }
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5446">5446</a></span>
<span class="normal"><a href="#__codelineno-0-5447">5447</a></span>
<span class="normal"><a href="#__codelineno-0-5448">5448</a></span>
<span class="normal"><a href="#__codelineno-0-5449">5449</a></span>
<span class="normal"><a href="#__codelineno-0-5450">5450</a></span>
<span class="normal"><a href="#__codelineno-0-5451">5451</a></span>
<span class="normal"><a href="#__codelineno-0-5452">5452</a></span>
<span class="normal"><a href="#__codelineno-0-5453">5453</a></span>
<span class="normal"><a href="#__codelineno-0-5454">5454</a></span>
<span class="normal"><a href="#__codelineno-0-5455">5455</a></span>
<span class="normal"><a href="#__codelineno-0-5456">5456</a></span>
<span class="normal"><a href="#__codelineno-0-5457">5457</a></span>
<span class="normal"><a href="#__codelineno-0-5458">5458</a></span>
<span class="normal"><a href="#__codelineno-0-5459">5459</a></span>
<span class="normal"><a href="#__codelineno-0-5460">5460</a></span>
<span class="normal"><a href="#__codelineno-0-5461">5461</a></span>
<span class="normal"><a href="#__codelineno-0-5462">5462</a></span>
<span class="normal"><a href="#__codelineno-0-5463">5463</a></span>
<span class="normal"><a href="#__codelineno-0-5464">5464</a></span>
<span class="normal"><a href="#__codelineno-0-5465">5465</a></span>
<span class="normal"><a href="#__codelineno-0-5466">5466</a></span>
<span class="normal"><a href="#__codelineno-0-5467">5467</a></span>
<span class="normal"><a href="#__codelineno-0-5468">5468</a></span>
<span class="normal"><a href="#__codelineno-0-5469">5469</a></span>
<span class="normal"><a href="#__codelineno-0-5470">5470</a></span>
<span class="normal"><a href="#__codelineno-0-5471">5471</a></span>
<span class="normal"><a href="#__codelineno-0-5472">5472</a></span>
<span class="normal"><a href="#__codelineno-0-5473">5473</a></span>
<span class="normal"><a href="#__codelineno-0-5474">5474</a></span>
<span class="normal"><a href="#__codelineno-0-5475">5475</a></span>
<span class="normal"><a href="#__codelineno-0-5476">5476</a></span>
<span class="normal"><a href="#__codelineno-0-5477">5477</a></span>
<span class="normal"><a href="#__codelineno-0-5478">5478</a></span>
<span class="normal"><a href="#__codelineno-0-5479">5479</a></span>
<span class="normal"><a href="#__codelineno-0-5480">5480</a></span>
<span class="normal"><a href="#__codelineno-0-5481">5481</a></span>
<span class="normal"><a href="#__codelineno-0-5482">5482</a></span>
<span class="normal"><a href="#__codelineno-0-5483">5483</a></span>
<span class="normal"><a href="#__codelineno-0-5484">5484</a></span>
<span class="normal"><a href="#__codelineno-0-5485">5485</a></span>
<span class="normal"><a href="#__codelineno-0-5486">5486</a></span>
<span class="normal"><a href="#__codelineno-0-5487">5487</a></span>
<span class="normal"><a href="#__codelineno-0-5488">5488</a></span>
<span class="normal"><a href="#__codelineno-0-5489">5489</a></span>
<span class="normal"><a href="#__codelineno-0-5490">5490</a></span>
<span class="normal"><a href="#__codelineno-0-5491">5491</a></span>
<span class="normal"><a href="#__codelineno-0-5492">5492</a></span>
<span class="normal"><a href="#__codelineno-0-5493">5493</a></span>
<span class="normal"><a href="#__codelineno-0-5494">5494</a></span>
<span class="normal"><a href="#__codelineno-0-5495">5495</a></span>
<span class="normal"><a href="#__codelineno-0-5496">5496</a></span>
<span class="normal"><a href="#__codelineno-0-5497">5497</a></span>
<span class="normal"><a href="#__codelineno-0-5498">5498</a></span>
<span class="normal"><a href="#__codelineno-0-5499">5499</a></span>
<span class="normal"><a href="#__codelineno-0-5500">5500</a></span>
<span class="normal"><a href="#__codelineno-0-5501">5501</a></span>
<span class="normal"><a href="#__codelineno-0-5502">5502</a></span>
<span class="normal"><a href="#__codelineno-0-5503">5503</a></span>
<span class="normal"><a href="#__codelineno-0-5504">5504</a></span>
<span class="normal"><a href="#__codelineno-0-5505">5505</a></span>
<span class="normal"><a href="#__codelineno-0-5506">5506</a></span>
<span class="normal"><a href="#__codelineno-0-5507">5507</a></span>
<span class="normal"><a href="#__codelineno-0-5508">5508</a></span>
<span class="normal"><a href="#__codelineno-0-5509">5509</a></span>
<span class="normal"><a href="#__codelineno-0-5510">5510</a></span>
<span class="normal"><a href="#__codelineno-0-5511">5511</a></span>
<span class="normal"><a href="#__codelineno-0-5512">5512</a></span>
<span class="normal"><a href="#__codelineno-0-5513">5513</a></span>
<span class="normal"><a href="#__codelineno-0-5514">5514</a></span>
<span class="normal"><a href="#__codelineno-0-5515">5515</a></span>
<span class="normal"><a href="#__codelineno-0-5516">5516</a></span>
<span class="normal"><a href="#__codelineno-0-5517">5517</a></span>
<span class="normal"><a href="#__codelineno-0-5518">5518</a></span>
<span class="normal"><a href="#__codelineno-0-5519">5519</a></span>
<span class="normal"><a href="#__codelineno-0-5520">5520</a></span>
<span class="normal"><a href="#__codelineno-0-5521">5521</a></span>
<span class="normal"><a href="#__codelineno-0-5522">5522</a></span>
<span class="normal"><a href="#__codelineno-0-5523">5523</a></span>
<span class="normal"><a href="#__codelineno-0-5524">5524</a></span>
<span class="normal"><a href="#__codelineno-0-5525">5525</a></span>
<span class="normal"><a href="#__codelineno-0-5526">5526</a></span>
<span class="normal"><a href="#__codelineno-0-5527">5527</a></span>
<span class="normal"><a href="#__codelineno-0-5528">5528</a></span>
<span class="normal"><a href="#__codelineno-0-5529">5529</a></span>
<span class="normal"><a href="#__codelineno-0-5530">5530</a></span>
<span class="normal"><a href="#__codelineno-0-5531">5531</a></span>
<span class="normal"><a href="#__codelineno-0-5532">5532</a></span>
<span class="normal"><a href="#__codelineno-0-5533">5533</a></span>
<span class="normal"><a href="#__codelineno-0-5534">5534</a></span>
<span class="normal"><a href="#__codelineno-0-5535">5535</a></span>
<span class="normal"><a href="#__codelineno-0-5536">5536</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5446"><a id="__codelineno-0-5446" name="__codelineno-0-5446"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_webpart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">webpart_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5447"><a id="__codelineno-0-5447" name="__codelineno-0-5447"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a page of a SharePoint site accessible to the authenticated user.</span>
</span><span id="__span-0-5448"><a id="__codelineno-0-5448" name="__codelineno-0-5448"></a>
</span><span id="__span-0-5449"><a id="__codelineno-0-5449" name="__codelineno-0-5449"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5450"><a id="__codelineno-0-5450" name="__codelineno-0-5450"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5451"><a id="__codelineno-0-5451" name="__codelineno-0-5451"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5452"><a id="__codelineno-0-5452" name="__codelineno-0-5452"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5453"><a id="__codelineno-0-5453" name="__codelineno-0-5453"></a><span class="sd">            The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5454"><a id="__codelineno-0-5454" name="__codelineno-0-5454"></a><span class="sd">        webpart_id (str):</span>
</span><span id="__span-0-5455"><a id="__codelineno-0-5455" name="__codelineno-0-5455"></a><span class="sd">            The ID of the SharePoint web part to retrieve.</span>
</span><span id="__span-0-5456"><a id="__codelineno-0-5456" name="__codelineno-0-5456"></a>
</span><span id="__span-0-5457"><a id="__codelineno-0-5457" name="__codelineno-0-5457"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5458"><a id="__codelineno-0-5458" name="__codelineno-0-5458"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-5459"><a id="__codelineno-0-5459" name="__codelineno-0-5459"></a><span class="sd">            The data of the SharePoint web part.</span>
</span><span id="__span-0-5460"><a id="__codelineno-0-5460" name="__codelineno-0-5460"></a>
</span><span id="__span-0-5461"><a id="__codelineno-0-5461" name="__codelineno-0-5461"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5462"><a id="__codelineno-0-5462" name="__codelineno-0-5462"></a><span class="sd">    {</span>
</span><span id="__span-0-5463"><a id="__codelineno-0-5463" name="__codelineno-0-5463"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C9b203cbe-27ca-45b2-944a-663cc99e5e8f%2Ca1462b54-26f9-4a24-9660-2bc7859ce9af&#39;)/pages(&#39;a546ce61-21e6-431d-b2cd-67d1f722be5f&#39;)/microsoft.graph.sitePage/webParts/$entity&quot;,</span>
</span><span id="__span-0-5464"><a id="__codelineno-0-5464" name="__codelineno-0-5464"></a><span class="sd">        &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5465"><a id="__codelineno-0-5465" name="__codelineno-0-5465"></a><span class="sd">        &#39;id&#39;: &#39;405b669e-3c09-45fe-822f-ff60ac7fffce&#39;,</span>
</span><span id="__span-0-5466"><a id="__codelineno-0-5466" name="__codelineno-0-5466"></a><span class="sd">        &#39;webPartType&#39;: &#39;c4bd7b2f-7b6e-4599-8485-16504575f590&#39;,</span>
</span><span id="__span-0-5467"><a id="__codelineno-0-5467" name="__codelineno-0-5467"></a><span class="sd">        &#39;data&#39;: {</span>
</span><span id="__span-0-5468"><a id="__codelineno-0-5468" name="__codelineno-0-5468"></a><span class="sd">            &#39;audiences&#39;: [...],</span>
</span><span id="__span-0-5469"><a id="__codelineno-0-5469" name="__codelineno-0-5469"></a><span class="sd">            &#39;dataVersion&#39;: &#39;1.5&#39;,</span>
</span><span id="__span-0-5470"><a id="__codelineno-0-5470" name="__codelineno-0-5470"></a><span class="sd">            &#39;description&#39;: &#39;Prominently display up to 5 pieces of content with links, images, pictures, videos, or photos in a highly visual layout.&#39;,</span>
</span><span id="__span-0-5471"><a id="__codelineno-0-5471" name="__codelineno-0-5471"></a><span class="sd">            &#39;title&#39;: &#39;Hero&#39;,</span>
</span><span id="__span-0-5472"><a id="__codelineno-0-5472" name="__codelineno-0-5472"></a><span class="sd">            &#39;properties&#39;: {</span>
</span><span id="__span-0-5473"><a id="__codelineno-0-5473" name="__codelineno-0-5473"></a><span class="sd">                &#39;heroLayoutThreshold&#39;: 640,</span>
</span><span id="__span-0-5474"><a id="__codelineno-0-5474" name="__codelineno-0-5474"></a><span class="sd">                &#39;carouselLayoutMaxWidth&#39;: 639,</span>
</span><span id="__span-0-5475"><a id="__codelineno-0-5475" name="__codelineno-0-5475"></a><span class="sd">                &#39;layoutCategory&#39;: 1,</span>
</span><span id="__span-0-5476"><a id="__codelineno-0-5476" name="__codelineno-0-5476"></a><span class="sd">                &#39;layout&#39;: 5,</span>
</span><span id="__span-0-5477"><a id="__codelineno-0-5477" name="__codelineno-0-5477"></a><span class="sd">                &#39;content@odata.type&#39;: &#39;#Collection(graph.Json)&#39;,</span>
</span><span id="__span-0-5478"><a id="__codelineno-0-5478" name="__codelineno-0-5478"></a><span class="sd">                &#39;content&#39;: [</span>
</span><span id="__span-0-5479"><a id="__codelineno-0-5479" name="__codelineno-0-5479"></a><span class="sd">                    {</span>
</span><span id="__span-0-5480"><a id="__codelineno-0-5480" name="__codelineno-0-5480"></a><span class="sd">                        &#39;id&#39;: &#39;20cb6611-c7cc-4ba7-91e1-65a6cb576025&#39;,</span>
</span><span id="__span-0-5481"><a id="__codelineno-0-5481" name="__codelineno-0-5481"></a><span class="sd">                        &#39;type&#39;: &#39;UrlLink&#39;,</span>
</span><span id="__span-0-5482"><a id="__codelineno-0-5482" name="__codelineno-0-5482"></a><span class="sd">                        &#39;color&#39;: 4,</span>
</span><span id="__span-0-5483"><a id="__codelineno-0-5483" name="__codelineno-0-5483"></a><span class="sd">                        &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5484"><a id="__codelineno-0-5484" name="__codelineno-0-5484"></a><span class="sd">                        &#39;title&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5485"><a id="__codelineno-0-5485" name="__codelineno-0-5485"></a><span class="sd">                        &#39;showDescription&#39;: False,</span>
</span><span id="__span-0-5486"><a id="__codelineno-0-5486" name="__codelineno-0-5486"></a><span class="sd">                        &#39;showTitle&#39;: True,</span>
</span><span id="__span-0-5487"><a id="__codelineno-0-5487" name="__codelineno-0-5487"></a><span class="sd">                        &#39;alternateText&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5488"><a id="__codelineno-0-5488" name="__codelineno-0-5488"></a><span class="sd">                        &#39;imageDisplayOption&#39;: 1,</span>
</span><span id="__span-0-5489"><a id="__codelineno-0-5489" name="__codelineno-0-5489"></a><span class="sd">                        &#39;isDefaultImage&#39;: False,</span>
</span><span id="__span-0-5490"><a id="__codelineno-0-5490" name="__codelineno-0-5490"></a><span class="sd">                        &#39;showCallToAction&#39;: True,</span>
</span><span id="__span-0-5491"><a id="__codelineno-0-5491" name="__codelineno-0-5491"></a><span class="sd">                        &#39;isDefaultImageLoaded&#39;: False,</span>
</span><span id="__span-0-5492"><a id="__codelineno-0-5492" name="__codelineno-0-5492"></a><span class="sd">                        &#39;isCustomImageLoaded&#39;: False,</span>
</span><span id="__span-0-5493"><a id="__codelineno-0-5493" name="__codelineno-0-5493"></a><span class="sd">                        &#39;showFeatureText&#39;: False,</span>
</span><span id="__span-0-5494"><a id="__codelineno-0-5494" name="__codelineno-0-5494"></a><span class="sd">                        &#39;previewImage&#39;: {</span>
</span><span id="__span-0-5495"><a id="__codelineno-0-5495" name="__codelineno-0-5495"></a><span class="sd">                            &#39;@odata.type&#39;: &#39;#graph.Json&#39;,</span>
</span><span id="__span-0-5496"><a id="__codelineno-0-5496" name="__codelineno-0-5496"></a><span class="sd">                            &#39;zoomRatio&#39;: 1,</span>
</span><span id="__span-0-5497"><a id="__codelineno-0-5497" name="__codelineno-0-5497"></a><span class="sd">                            &#39;resolvedUrl&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5498"><a id="__codelineno-0-5498" name="__codelineno-0-5498"></a><span class="sd">                            &#39;imageUrl&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5499"><a id="__codelineno-0-5499" name="__codelineno-0-5499"></a><span class="sd">                            &#39;widthFactor&#39;: 0.5,</span>
</span><span id="__span-0-5500"><a id="__codelineno-0-5500" name="__codelineno-0-5500"></a><span class="sd">                            &#39;minCanvasWidth&#39;: 1</span>
</span><span id="__span-0-5501"><a id="__codelineno-0-5501" name="__codelineno-0-5501"></a><span class="sd">                        }</span>
</span><span id="__span-0-5502"><a id="__codelineno-0-5502" name="__codelineno-0-5502"></a><span class="sd">                    },</span>
</span><span id="__span-0-5503"><a id="__codelineno-0-5503" name="__codelineno-0-5503"></a><span class="sd">                    {...}</span>
</span><span id="__span-0-5504"><a id="__codelineno-0-5504" name="__codelineno-0-5504"></a><span class="sd">                ]</span>
</span><span id="__span-0-5505"><a id="__codelineno-0-5505" name="__codelineno-0-5505"></a><span class="sd">            },</span>
</span><span id="__span-0-5506"><a id="__codelineno-0-5506" name="__codelineno-0-5506"></a><span class="sd">            &#39;serverProcessedContent&#39;: {...}</span>
</span><span id="__span-0-5507"><a id="__codelineno-0-5507" name="__codelineno-0-5507"></a><span class="sd">        }</span>
</span><span id="__span-0-5508"><a id="__codelineno-0-5508" name="__codelineno-0-5508"></a><span class="sd">    }</span>
</span><span id="__span-0-5509"><a id="__codelineno-0-5509" name="__codelineno-0-5509"></a>
</span><span id="__span-0-5510"><a id="__codelineno-0-5510" name="__codelineno-0-5510"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5511"><a id="__codelineno-0-5511" name="__codelineno-0-5511"></a>
</span><span id="__span-0-5512"><a id="__codelineno-0-5512" name="__codelineno-0-5512"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5513"><a id="__codelineno-0-5513" name="__codelineno-0-5513"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5514"><a id="__codelineno-0-5514" name="__codelineno-0-5514"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5515"><a id="__codelineno-0-5515" name="__codelineno-0-5515"></a>        <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5516"><a id="__codelineno-0-5516" name="__codelineno-0-5516"></a>        <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5517"><a id="__codelineno-0-5517" name="__codelineno-0-5517"></a>        <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5518"><a id="__codelineno-0-5518" name="__codelineno-0-5518"></a>        <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/webparts/&quot;</span>
</span><span id="__span-0-5519"><a id="__codelineno-0-5519" name="__codelineno-0-5519"></a>        <span class="o">+</span> <span class="n">webpart_id</span>
</span><span id="__span-0-5520"><a id="__codelineno-0-5520" name="__codelineno-0-5520"></a>    <span class="p">)</span>
</span><span id="__span-0-5521"><a id="__codelineno-0-5521" name="__codelineno-0-5521"></a>
</span><span id="__span-0-5522"><a id="__codelineno-0-5522" name="__codelineno-0-5522"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5523"><a id="__codelineno-0-5523" name="__codelineno-0-5523"></a>
</span><span id="__span-0-5524"><a id="__codelineno-0-5524" name="__codelineno-0-5524"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5525"><a id="__codelineno-0-5525" name="__codelineno-0-5525"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5526"><a id="__codelineno-0-5526" name="__codelineno-0-5526"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-5527"><a id="__codelineno-0-5527" name="__codelineno-0-5527"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5528"><a id="__codelineno-0-5528" name="__codelineno-0-5528"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5529"><a id="__codelineno-0-5529" name="__codelineno-0-5529"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get SharePoint webpart -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; in SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5530"><a id="__codelineno-0-5530" name="__codelineno-0-5530"></a>            <span class="n">webpart_id</span><span class="p">,</span>
</span><span id="__span-0-5531"><a id="__codelineno-0-5531" name="__codelineno-0-5531"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5532"><a id="__codelineno-0-5532" name="__codelineno-0-5532"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5533"><a id="__codelineno-0-5533" name="__codelineno-0-5533"></a>        <span class="p">),</span>
</span><span id="__span-0-5534"><a id="__codelineno-0-5534" name="__codelineno-0-5534"></a>    <span class="p">)</span>
</span><span id="__span-0-5535"><a id="__codelineno-0-5535" name="__codelineno-0-5535"></a>
</span><span id="__span-0-5536"><a id="__codelineno-0-5536" name="__codelineno-0-5536"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_sharepoint_webparts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sharepoint_webparts</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">section_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">section_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve the configured webparts on a SharePoint site page.</p>
<p>Can retrieve all webparts on the page or the ones in a defined
page section (like horizontal section or vertical section).</p>


<details class="opentext-webpart-type-ids" open>
  <summary>OpenText WebPart Type IDs</summary>
  <p>Content Browser: 'cecfdba4-2e82-4538-9436-dbd1c4c01a80'
Related Workspaces: 'e24d7154-4554-4db6-a44f-d306b6b3a5d4'
Team members of Workspace: '635a2800-8833-410d-b1f1-f209b28ea2ad'</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the web part.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"horizontalSections" (note the plural!)
"verticalSection" (note the singular!)
Use None if you want to retrieve all webparts on page.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the section. Only relevant for horizontal sections.
Simple values like 1,2,3...
Not relevant for vertical section or if you want to retrieve
all webparts on the page.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_id</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For horizontalSections the column ID has to be provided.
Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
A dictionary including the SharePoint webparts of a given page for a given site.
The actual list is included inside the "value" key of the dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': "https://graph.microsoft.com/beta/$metadata#sites('ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26')/pages('561c65b4-3418-4698-a4c3-7ca7f04812bb')/microsoft.graph.sitePage/webParts",
    'value': [
        {
            '@odata.type': '#microsoft.graph.standardWebPart',
            'id': '405b669e-3c09-45fe-822f-ff60ac7fffce',
            'webPartType': 'c4bd7b2f-7b6e-4599-8485-16504575f590',
            'data': {
                'audiences': [],
                'dataVersion': '1.5',
                'description': 'Prominently display up to 5 pieces of content with links, images, pictures, videos, or photos in a highly visual layout.',
                'title': 'Hero',
                'properties': {
                    'heroLayoutThreshold': 640,
                    'carouselLayoutMaxWidth': 639,
                    'layoutCategory': 1,
                    'layout': 5,
                    'content@odata.type': '#Collection(graph.Json)',
                    'content': [
                        {
                            'id': '20cb6611-c7cc-4ba7-91e1-65a6cb576025',
                            'type': 'UrlLink',
                            'color': 4,
                            'description': '',
                            'title': '',
                            'showDescription': False,
                            'showTitle': True,
                            'alternateText': '',
                            'imageDisplayOption': 1,
                            'isDefaultImage': False,
                            'showCallToAction': True,
                            'isDefaultImageLoaded': False,
                            'isCustomImageLoaded': False,
                            'showFeatureText': False,
                            'previewImage': {...}
                        },
                        {
                            'id': '83133733-960b-4139-a73f-17ce2ca5f71c',
                            'type': 'Image',
                            'color': 4,
                            'description': '',
                            'title': '',
                            'showDescription': False,
                            'showTitle': True,
                            'alternateText': '',
                            'imageDisplayOption': 0,
                            'isDefaultImage': False,
                            'showCallToAction': False,
                            'isDefaultImageLoaded': False,
                            'isCustomImageLoaded': False,
                            'showFeatureText': False
                        },
                        ...
                    ]
                },
                'serverProcessedContent': {
                    'htmlStrings': [...],
                    'searchablePlainTexts': [...],
                    'links': [...],
                    'imageSources': [...],
                    'componentDependencies': [...],
                    'customMetadata': [...]
                }
            }
        },
        {
            '@odata.type': '#microsoft.graph.standardWebPart',
            'id': 'f7bfdec9-09c5-4fb6-bc97-3ba225d35ad4',
            'webPartType': '8c88f208-6c77-4bdb-86a0-0c47b4316588',
            'data': {...}
        },
        {
            '@odata.type': '#microsoft.graph.standardWebPart',
            'id': 'f2a8650b-5ea0-4ac2-9cde-56e0fd0279b0',
            'webPartType': 'eb95c819-ab8f-4689-bd03-0c2d65d47b1f',
            'data': {...}
        },
        {
            '@odata.type': '#microsoft.graph.standardWebPart',
            'id': '418ba70b-4cf7-410a-a5fd-ea38386915ac',
            'webPartType': 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
            'data': {...}
        },
        {
            '@odata.type': '#microsoft.graph.standardWebPart',
            'id': '416a4c58-61fc-4166-aa19-1099fad50545',
            'webPartType': 'f92bf067-bc19-489e-a556-7fe95f508720',
            'data': {...}
        }
    ]
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5284">5284</a></span>
<span class="normal"><a href="#__codelineno-0-5285">5285</a></span>
<span class="normal"><a href="#__codelineno-0-5286">5286</a></span>
<span class="normal"><a href="#__codelineno-0-5287">5287</a></span>
<span class="normal"><a href="#__codelineno-0-5288">5288</a></span>
<span class="normal"><a href="#__codelineno-0-5289">5289</a></span>
<span class="normal"><a href="#__codelineno-0-5290">5290</a></span>
<span class="normal"><a href="#__codelineno-0-5291">5291</a></span>
<span class="normal"><a href="#__codelineno-0-5292">5292</a></span>
<span class="normal"><a href="#__codelineno-0-5293">5293</a></span>
<span class="normal"><a href="#__codelineno-0-5294">5294</a></span>
<span class="normal"><a href="#__codelineno-0-5295">5295</a></span>
<span class="normal"><a href="#__codelineno-0-5296">5296</a></span>
<span class="normal"><a href="#__codelineno-0-5297">5297</a></span>
<span class="normal"><a href="#__codelineno-0-5298">5298</a></span>
<span class="normal"><a href="#__codelineno-0-5299">5299</a></span>
<span class="normal"><a href="#__codelineno-0-5300">5300</a></span>
<span class="normal"><a href="#__codelineno-0-5301">5301</a></span>
<span class="normal"><a href="#__codelineno-0-5302">5302</a></span>
<span class="normal"><a href="#__codelineno-0-5303">5303</a></span>
<span class="normal"><a href="#__codelineno-0-5304">5304</a></span>
<span class="normal"><a href="#__codelineno-0-5305">5305</a></span>
<span class="normal"><a href="#__codelineno-0-5306">5306</a></span>
<span class="normal"><a href="#__codelineno-0-5307">5307</a></span>
<span class="normal"><a href="#__codelineno-0-5308">5308</a></span>
<span class="normal"><a href="#__codelineno-0-5309">5309</a></span>
<span class="normal"><a href="#__codelineno-0-5310">5310</a></span>
<span class="normal"><a href="#__codelineno-0-5311">5311</a></span>
<span class="normal"><a href="#__codelineno-0-5312">5312</a></span>
<span class="normal"><a href="#__codelineno-0-5313">5313</a></span>
<span class="normal"><a href="#__codelineno-0-5314">5314</a></span>
<span class="normal"><a href="#__codelineno-0-5315">5315</a></span>
<span class="normal"><a href="#__codelineno-0-5316">5316</a></span>
<span class="normal"><a href="#__codelineno-0-5317">5317</a></span>
<span class="normal"><a href="#__codelineno-0-5318">5318</a></span>
<span class="normal"><a href="#__codelineno-0-5319">5319</a></span>
<span class="normal"><a href="#__codelineno-0-5320">5320</a></span>
<span class="normal"><a href="#__codelineno-0-5321">5321</a></span>
<span class="normal"><a href="#__codelineno-0-5322">5322</a></span>
<span class="normal"><a href="#__codelineno-0-5323">5323</a></span>
<span class="normal"><a href="#__codelineno-0-5324">5324</a></span>
<span class="normal"><a href="#__codelineno-0-5325">5325</a></span>
<span class="normal"><a href="#__codelineno-0-5326">5326</a></span>
<span class="normal"><a href="#__codelineno-0-5327">5327</a></span>
<span class="normal"><a href="#__codelineno-0-5328">5328</a></span>
<span class="normal"><a href="#__codelineno-0-5329">5329</a></span>
<span class="normal"><a href="#__codelineno-0-5330">5330</a></span>
<span class="normal"><a href="#__codelineno-0-5331">5331</a></span>
<span class="normal"><a href="#__codelineno-0-5332">5332</a></span>
<span class="normal"><a href="#__codelineno-0-5333">5333</a></span>
<span class="normal"><a href="#__codelineno-0-5334">5334</a></span>
<span class="normal"><a href="#__codelineno-0-5335">5335</a></span>
<span class="normal"><a href="#__codelineno-0-5336">5336</a></span>
<span class="normal"><a href="#__codelineno-0-5337">5337</a></span>
<span class="normal"><a href="#__codelineno-0-5338">5338</a></span>
<span class="normal"><a href="#__codelineno-0-5339">5339</a></span>
<span class="normal"><a href="#__codelineno-0-5340">5340</a></span>
<span class="normal"><a href="#__codelineno-0-5341">5341</a></span>
<span class="normal"><a href="#__codelineno-0-5342">5342</a></span>
<span class="normal"><a href="#__codelineno-0-5343">5343</a></span>
<span class="normal"><a href="#__codelineno-0-5344">5344</a></span>
<span class="normal"><a href="#__codelineno-0-5345">5345</a></span>
<span class="normal"><a href="#__codelineno-0-5346">5346</a></span>
<span class="normal"><a href="#__codelineno-0-5347">5347</a></span>
<span class="normal"><a href="#__codelineno-0-5348">5348</a></span>
<span class="normal"><a href="#__codelineno-0-5349">5349</a></span>
<span class="normal"><a href="#__codelineno-0-5350">5350</a></span>
<span class="normal"><a href="#__codelineno-0-5351">5351</a></span>
<span class="normal"><a href="#__codelineno-0-5352">5352</a></span>
<span class="normal"><a href="#__codelineno-0-5353">5353</a></span>
<span class="normal"><a href="#__codelineno-0-5354">5354</a></span>
<span class="normal"><a href="#__codelineno-0-5355">5355</a></span>
<span class="normal"><a href="#__codelineno-0-5356">5356</a></span>
<span class="normal"><a href="#__codelineno-0-5357">5357</a></span>
<span class="normal"><a href="#__codelineno-0-5358">5358</a></span>
<span class="normal"><a href="#__codelineno-0-5359">5359</a></span>
<span class="normal"><a href="#__codelineno-0-5360">5360</a></span>
<span class="normal"><a href="#__codelineno-0-5361">5361</a></span>
<span class="normal"><a href="#__codelineno-0-5362">5362</a></span>
<span class="normal"><a href="#__codelineno-0-5363">5363</a></span>
<span class="normal"><a href="#__codelineno-0-5364">5364</a></span>
<span class="normal"><a href="#__codelineno-0-5365">5365</a></span>
<span class="normal"><a href="#__codelineno-0-5366">5366</a></span>
<span class="normal"><a href="#__codelineno-0-5367">5367</a></span>
<span class="normal"><a href="#__codelineno-0-5368">5368</a></span>
<span class="normal"><a href="#__codelineno-0-5369">5369</a></span>
<span class="normal"><a href="#__codelineno-0-5370">5370</a></span>
<span class="normal"><a href="#__codelineno-0-5371">5371</a></span>
<span class="normal"><a href="#__codelineno-0-5372">5372</a></span>
<span class="normal"><a href="#__codelineno-0-5373">5373</a></span>
<span class="normal"><a href="#__codelineno-0-5374">5374</a></span>
<span class="normal"><a href="#__codelineno-0-5375">5375</a></span>
<span class="normal"><a href="#__codelineno-0-5376">5376</a></span>
<span class="normal"><a href="#__codelineno-0-5377">5377</a></span>
<span class="normal"><a href="#__codelineno-0-5378">5378</a></span>
<span class="normal"><a href="#__codelineno-0-5379">5379</a></span>
<span class="normal"><a href="#__codelineno-0-5380">5380</a></span>
<span class="normal"><a href="#__codelineno-0-5381">5381</a></span>
<span class="normal"><a href="#__codelineno-0-5382">5382</a></span>
<span class="normal"><a href="#__codelineno-0-5383">5383</a></span>
<span class="normal"><a href="#__codelineno-0-5384">5384</a></span>
<span class="normal"><a href="#__codelineno-0-5385">5385</a></span>
<span class="normal"><a href="#__codelineno-0-5386">5386</a></span>
<span class="normal"><a href="#__codelineno-0-5387">5387</a></span>
<span class="normal"><a href="#__codelineno-0-5388">5388</a></span>
<span class="normal"><a href="#__codelineno-0-5389">5389</a></span>
<span class="normal"><a href="#__codelineno-0-5390">5390</a></span>
<span class="normal"><a href="#__codelineno-0-5391">5391</a></span>
<span class="normal"><a href="#__codelineno-0-5392">5392</a></span>
<span class="normal"><a href="#__codelineno-0-5393">5393</a></span>
<span class="normal"><a href="#__codelineno-0-5394">5394</a></span>
<span class="normal"><a href="#__codelineno-0-5395">5395</a></span>
<span class="normal"><a href="#__codelineno-0-5396">5396</a></span>
<span class="normal"><a href="#__codelineno-0-5397">5397</a></span>
<span class="normal"><a href="#__codelineno-0-5398">5398</a></span>
<span class="normal"><a href="#__codelineno-0-5399">5399</a></span>
<span class="normal"><a href="#__codelineno-0-5400">5400</a></span>
<span class="normal"><a href="#__codelineno-0-5401">5401</a></span>
<span class="normal"><a href="#__codelineno-0-5402">5402</a></span>
<span class="normal"><a href="#__codelineno-0-5403">5403</a></span>
<span class="normal"><a href="#__codelineno-0-5404">5404</a></span>
<span class="normal"><a href="#__codelineno-0-5405">5405</a></span>
<span class="normal"><a href="#__codelineno-0-5406">5406</a></span>
<span class="normal"><a href="#__codelineno-0-5407">5407</a></span>
<span class="normal"><a href="#__codelineno-0-5408">5408</a></span>
<span class="normal"><a href="#__codelineno-0-5409">5409</a></span>
<span class="normal"><a href="#__codelineno-0-5410">5410</a></span>
<span class="normal"><a href="#__codelineno-0-5411">5411</a></span>
<span class="normal"><a href="#__codelineno-0-5412">5412</a></span>
<span class="normal"><a href="#__codelineno-0-5413">5413</a></span>
<span class="normal"><a href="#__codelineno-0-5414">5414</a></span>
<span class="normal"><a href="#__codelineno-0-5415">5415</a></span>
<span class="normal"><a href="#__codelineno-0-5416">5416</a></span>
<span class="normal"><a href="#__codelineno-0-5417">5417</a></span>
<span class="normal"><a href="#__codelineno-0-5418">5418</a></span>
<span class="normal"><a href="#__codelineno-0-5419">5419</a></span>
<span class="normal"><a href="#__codelineno-0-5420">5420</a></span>
<span class="normal"><a href="#__codelineno-0-5421">5421</a></span>
<span class="normal"><a href="#__codelineno-0-5422">5422</a></span>
<span class="normal"><a href="#__codelineno-0-5423">5423</a></span>
<span class="normal"><a href="#__codelineno-0-5424">5424</a></span>
<span class="normal"><a href="#__codelineno-0-5425">5425</a></span>
<span class="normal"><a href="#__codelineno-0-5426">5426</a></span>
<span class="normal"><a href="#__codelineno-0-5427">5427</a></span>
<span class="normal"><a href="#__codelineno-0-5428">5428</a></span>
<span class="normal"><a href="#__codelineno-0-5429">5429</a></span>
<span class="normal"><a href="#__codelineno-0-5430">5430</a></span>
<span class="normal"><a href="#__codelineno-0-5431">5431</a></span>
<span class="normal"><a href="#__codelineno-0-5432">5432</a></span>
<span class="normal"><a href="#__codelineno-0-5433">5433</a></span>
<span class="normal"><a href="#__codelineno-0-5434">5434</a></span>
<span class="normal"><a href="#__codelineno-0-5435">5435</a></span>
<span class="normal"><a href="#__codelineno-0-5436">5436</a></span>
<span class="normal"><a href="#__codelineno-0-5437">5437</a></span>
<span class="normal"><a href="#__codelineno-0-5438">5438</a></span>
<span class="normal"><a href="#__codelineno-0-5439">5439</a></span>
<span class="normal"><a href="#__codelineno-0-5440">5440</a></span>
<span class="normal"><a href="#__codelineno-0-5441">5441</a></span>
<span class="normal"><a href="#__codelineno-0-5442">5442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5284"><a id="__codelineno-0-5284" name="__codelineno-0-5284"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sharepoint_webparts</span><span class="p">(</span>
</span><span id="__span-0-5285"><a id="__codelineno-0-5285" name="__codelineno-0-5285"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5286"><a id="__codelineno-0-5286" name="__codelineno-0-5286"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5287"><a id="__codelineno-0-5287" name="__codelineno-0-5287"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5288"><a id="__codelineno-0-5288" name="__codelineno-0-5288"></a>    <span class="n">section_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5289"><a id="__codelineno-0-5289" name="__codelineno-0-5289"></a>    <span class="n">section_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5290"><a id="__codelineno-0-5290" name="__codelineno-0-5290"></a>    <span class="n">column_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-5291"><a id="__codelineno-0-5291" name="__codelineno-0-5291"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5292"><a id="__codelineno-0-5292" name="__codelineno-0-5292"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the configured webparts on a SharePoint site page.</span>
</span><span id="__span-0-5293"><a id="__codelineno-0-5293" name="__codelineno-0-5293"></a>
</span><span id="__span-0-5294"><a id="__codelineno-0-5294" name="__codelineno-0-5294"></a><span class="sd">    Can retrieve all webparts on the page or the ones in a defined</span>
</span><span id="__span-0-5295"><a id="__codelineno-0-5295" name="__codelineno-0-5295"></a><span class="sd">    page section (like horizontal section or vertical section).</span>
</span><span id="__span-0-5296"><a id="__codelineno-0-5296" name="__codelineno-0-5296"></a>
</span><span id="__span-0-5297"><a id="__codelineno-0-5297" name="__codelineno-0-5297"></a><span class="sd">    OpenText WebPart Type IDs:</span>
</span><span id="__span-0-5298"><a id="__codelineno-0-5298" name="__codelineno-0-5298"></a><span class="sd">        Content Browser: &#39;cecfdba4-2e82-4538-9436-dbd1c4c01a80&#39;</span>
</span><span id="__span-0-5299"><a id="__codelineno-0-5299" name="__codelineno-0-5299"></a><span class="sd">        Related Workspaces: &#39;e24d7154-4554-4db6-a44f-d306b6b3a5d4&#39;</span>
</span><span id="__span-0-5300"><a id="__codelineno-0-5300" name="__codelineno-0-5300"></a><span class="sd">        Team members of Workspace: &#39;635a2800-8833-410d-b1f1-f209b28ea2ad&#39;</span>
</span><span id="__span-0-5301"><a id="__codelineno-0-5301" name="__codelineno-0-5301"></a>
</span><span id="__span-0-5302"><a id="__codelineno-0-5302" name="__codelineno-0-5302"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5303"><a id="__codelineno-0-5303" name="__codelineno-0-5303"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5304"><a id="__codelineno-0-5304" name="__codelineno-0-5304"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5305"><a id="__codelineno-0-5305" name="__codelineno-0-5305"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5306"><a id="__codelineno-0-5306" name="__codelineno-0-5306"></a><span class="sd">            The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5307"><a id="__codelineno-0-5307" name="__codelineno-0-5307"></a><span class="sd">        section_type (str, optional):</span>
</span><span id="__span-0-5308"><a id="__codelineno-0-5308" name="__codelineno-0-5308"></a><span class="sd">            &quot;horizontalSections&quot; (note the plural!)</span>
</span><span id="__span-0-5309"><a id="__codelineno-0-5309" name="__codelineno-0-5309"></a><span class="sd">            &quot;verticalSection&quot; (note the singular!)</span>
</span><span id="__span-0-5310"><a id="__codelineno-0-5310" name="__codelineno-0-5310"></a><span class="sd">            Use None if you want to retrieve all webparts on page.</span>
</span><span id="__span-0-5311"><a id="__codelineno-0-5311" name="__codelineno-0-5311"></a><span class="sd">        section_id (str | int | None):</span>
</span><span id="__span-0-5312"><a id="__codelineno-0-5312" name="__codelineno-0-5312"></a><span class="sd">            The ID of the section. Only relevant for horizontal sections.</span>
</span><span id="__span-0-5313"><a id="__codelineno-0-5313" name="__codelineno-0-5313"></a><span class="sd">            Simple values like 1,2,3...</span>
</span><span id="__span-0-5314"><a id="__codelineno-0-5314" name="__codelineno-0-5314"></a><span class="sd">            Not relevant for vertical section or if you want to retrieve</span>
</span><span id="__span-0-5315"><a id="__codelineno-0-5315" name="__codelineno-0-5315"></a><span class="sd">            all webparts on the page.</span>
</span><span id="__span-0-5316"><a id="__codelineno-0-5316" name="__codelineno-0-5316"></a><span class="sd">        column_id (int | str, optional):</span>
</span><span id="__span-0-5317"><a id="__codelineno-0-5317" name="__codelineno-0-5317"></a><span class="sd">            For horizontalSections the column ID has to be provided.</span>
</span><span id="__span-0-5318"><a id="__codelineno-0-5318" name="__codelineno-0-5318"></a><span class="sd">            Defaults to 1.</span>
</span><span id="__span-0-5319"><a id="__codelineno-0-5319" name="__codelineno-0-5319"></a>
</span><span id="__span-0-5320"><a id="__codelineno-0-5320" name="__codelineno-0-5320"></a>
</span><span id="__span-0-5321"><a id="__codelineno-0-5321" name="__codelineno-0-5321"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5322"><a id="__codelineno-0-5322" name="__codelineno-0-5322"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-5323"><a id="__codelineno-0-5323" name="__codelineno-0-5323"></a><span class="sd">            A dictionary including the SharePoint webparts of a given page for a given site.</span>
</span><span id="__span-0-5324"><a id="__codelineno-0-5324" name="__codelineno-0-5324"></a><span class="sd">            The actual list is included inside the &quot;value&quot; key of the dictionary.</span>
</span><span id="__span-0-5325"><a id="__codelineno-0-5325" name="__codelineno-0-5325"></a>
</span><span id="__span-0-5326"><a id="__codelineno-0-5326" name="__codelineno-0-5326"></a><span class="sd">    Example:</span>
</span><span id="__span-0-5327"><a id="__codelineno-0-5327" name="__codelineno-0-5327"></a><span class="sd">    {</span>
</span><span id="__span-0-5328"><a id="__codelineno-0-5328" name="__codelineno-0-5328"></a><span class="sd">        &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/beta/$metadata#sites(&#39;ideatedev.sharepoint.com%2C61c0f9cb-39d3-4c04-b60c-31576954a2ab%2Ca678aeab-68ac-46a1-bd95-28020c12de26&#39;)/pages(&#39;561c65b4-3418-4698-a4c3-7ca7f04812bb&#39;)/microsoft.graph.sitePage/webParts&quot;,</span>
</span><span id="__span-0-5329"><a id="__codelineno-0-5329" name="__codelineno-0-5329"></a><span class="sd">        &#39;value&#39;: [</span>
</span><span id="__span-0-5330"><a id="__codelineno-0-5330" name="__codelineno-0-5330"></a><span class="sd">            {</span>
</span><span id="__span-0-5331"><a id="__codelineno-0-5331" name="__codelineno-0-5331"></a><span class="sd">                &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5332"><a id="__codelineno-0-5332" name="__codelineno-0-5332"></a><span class="sd">                &#39;id&#39;: &#39;405b669e-3c09-45fe-822f-ff60ac7fffce&#39;,</span>
</span><span id="__span-0-5333"><a id="__codelineno-0-5333" name="__codelineno-0-5333"></a><span class="sd">                &#39;webPartType&#39;: &#39;c4bd7b2f-7b6e-4599-8485-16504575f590&#39;,</span>
</span><span id="__span-0-5334"><a id="__codelineno-0-5334" name="__codelineno-0-5334"></a><span class="sd">                &#39;data&#39;: {</span>
</span><span id="__span-0-5335"><a id="__codelineno-0-5335" name="__codelineno-0-5335"></a><span class="sd">                    &#39;audiences&#39;: [],</span>
</span><span id="__span-0-5336"><a id="__codelineno-0-5336" name="__codelineno-0-5336"></a><span class="sd">                    &#39;dataVersion&#39;: &#39;1.5&#39;,</span>
</span><span id="__span-0-5337"><a id="__codelineno-0-5337" name="__codelineno-0-5337"></a><span class="sd">                    &#39;description&#39;: &#39;Prominently display up to 5 pieces of content with links, images, pictures, videos, or photos in a highly visual layout.&#39;,</span>
</span><span id="__span-0-5338"><a id="__codelineno-0-5338" name="__codelineno-0-5338"></a><span class="sd">                    &#39;title&#39;: &#39;Hero&#39;,</span>
</span><span id="__span-0-5339"><a id="__codelineno-0-5339" name="__codelineno-0-5339"></a><span class="sd">                    &#39;properties&#39;: {</span>
</span><span id="__span-0-5340"><a id="__codelineno-0-5340" name="__codelineno-0-5340"></a><span class="sd">                        &#39;heroLayoutThreshold&#39;: 640,</span>
</span><span id="__span-0-5341"><a id="__codelineno-0-5341" name="__codelineno-0-5341"></a><span class="sd">                        &#39;carouselLayoutMaxWidth&#39;: 639,</span>
</span><span id="__span-0-5342"><a id="__codelineno-0-5342" name="__codelineno-0-5342"></a><span class="sd">                        &#39;layoutCategory&#39;: 1,</span>
</span><span id="__span-0-5343"><a id="__codelineno-0-5343" name="__codelineno-0-5343"></a><span class="sd">                        &#39;layout&#39;: 5,</span>
</span><span id="__span-0-5344"><a id="__codelineno-0-5344" name="__codelineno-0-5344"></a><span class="sd">                        &#39;content@odata.type&#39;: &#39;#Collection(graph.Json)&#39;,</span>
</span><span id="__span-0-5345"><a id="__codelineno-0-5345" name="__codelineno-0-5345"></a><span class="sd">                        &#39;content&#39;: [</span>
</span><span id="__span-0-5346"><a id="__codelineno-0-5346" name="__codelineno-0-5346"></a><span class="sd">                            {</span>
</span><span id="__span-0-5347"><a id="__codelineno-0-5347" name="__codelineno-0-5347"></a><span class="sd">                                &#39;id&#39;: &#39;20cb6611-c7cc-4ba7-91e1-65a6cb576025&#39;,</span>
</span><span id="__span-0-5348"><a id="__codelineno-0-5348" name="__codelineno-0-5348"></a><span class="sd">                                &#39;type&#39;: &#39;UrlLink&#39;,</span>
</span><span id="__span-0-5349"><a id="__codelineno-0-5349" name="__codelineno-0-5349"></a><span class="sd">                                &#39;color&#39;: 4,</span>
</span><span id="__span-0-5350"><a id="__codelineno-0-5350" name="__codelineno-0-5350"></a><span class="sd">                                &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5351"><a id="__codelineno-0-5351" name="__codelineno-0-5351"></a><span class="sd">                                &#39;title&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5352"><a id="__codelineno-0-5352" name="__codelineno-0-5352"></a><span class="sd">                                &#39;showDescription&#39;: False,</span>
</span><span id="__span-0-5353"><a id="__codelineno-0-5353" name="__codelineno-0-5353"></a><span class="sd">                                &#39;showTitle&#39;: True,</span>
</span><span id="__span-0-5354"><a id="__codelineno-0-5354" name="__codelineno-0-5354"></a><span class="sd">                                &#39;alternateText&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5355"><a id="__codelineno-0-5355" name="__codelineno-0-5355"></a><span class="sd">                                &#39;imageDisplayOption&#39;: 1,</span>
</span><span id="__span-0-5356"><a id="__codelineno-0-5356" name="__codelineno-0-5356"></a><span class="sd">                                &#39;isDefaultImage&#39;: False,</span>
</span><span id="__span-0-5357"><a id="__codelineno-0-5357" name="__codelineno-0-5357"></a><span class="sd">                                &#39;showCallToAction&#39;: True,</span>
</span><span id="__span-0-5358"><a id="__codelineno-0-5358" name="__codelineno-0-5358"></a><span class="sd">                                &#39;isDefaultImageLoaded&#39;: False,</span>
</span><span id="__span-0-5359"><a id="__codelineno-0-5359" name="__codelineno-0-5359"></a><span class="sd">                                &#39;isCustomImageLoaded&#39;: False,</span>
</span><span id="__span-0-5360"><a id="__codelineno-0-5360" name="__codelineno-0-5360"></a><span class="sd">                                &#39;showFeatureText&#39;: False,</span>
</span><span id="__span-0-5361"><a id="__codelineno-0-5361" name="__codelineno-0-5361"></a><span class="sd">                                &#39;previewImage&#39;: {...}</span>
</span><span id="__span-0-5362"><a id="__codelineno-0-5362" name="__codelineno-0-5362"></a><span class="sd">                            },</span>
</span><span id="__span-0-5363"><a id="__codelineno-0-5363" name="__codelineno-0-5363"></a><span class="sd">                            {</span>
</span><span id="__span-0-5364"><a id="__codelineno-0-5364" name="__codelineno-0-5364"></a><span class="sd">                                &#39;id&#39;: &#39;83133733-960b-4139-a73f-17ce2ca5f71c&#39;,</span>
</span><span id="__span-0-5365"><a id="__codelineno-0-5365" name="__codelineno-0-5365"></a><span class="sd">                                &#39;type&#39;: &#39;Image&#39;,</span>
</span><span id="__span-0-5366"><a id="__codelineno-0-5366" name="__codelineno-0-5366"></a><span class="sd">                                &#39;color&#39;: 4,</span>
</span><span id="__span-0-5367"><a id="__codelineno-0-5367" name="__codelineno-0-5367"></a><span class="sd">                                &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5368"><a id="__codelineno-0-5368" name="__codelineno-0-5368"></a><span class="sd">                                &#39;title&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5369"><a id="__codelineno-0-5369" name="__codelineno-0-5369"></a><span class="sd">                                &#39;showDescription&#39;: False,</span>
</span><span id="__span-0-5370"><a id="__codelineno-0-5370" name="__codelineno-0-5370"></a><span class="sd">                                &#39;showTitle&#39;: True,</span>
</span><span id="__span-0-5371"><a id="__codelineno-0-5371" name="__codelineno-0-5371"></a><span class="sd">                                &#39;alternateText&#39;: &#39;&#39;,</span>
</span><span id="__span-0-5372"><a id="__codelineno-0-5372" name="__codelineno-0-5372"></a><span class="sd">                                &#39;imageDisplayOption&#39;: 0,</span>
</span><span id="__span-0-5373"><a id="__codelineno-0-5373" name="__codelineno-0-5373"></a><span class="sd">                                &#39;isDefaultImage&#39;: False,</span>
</span><span id="__span-0-5374"><a id="__codelineno-0-5374" name="__codelineno-0-5374"></a><span class="sd">                                &#39;showCallToAction&#39;: False,</span>
</span><span id="__span-0-5375"><a id="__codelineno-0-5375" name="__codelineno-0-5375"></a><span class="sd">                                &#39;isDefaultImageLoaded&#39;: False,</span>
</span><span id="__span-0-5376"><a id="__codelineno-0-5376" name="__codelineno-0-5376"></a><span class="sd">                                &#39;isCustomImageLoaded&#39;: False,</span>
</span><span id="__span-0-5377"><a id="__codelineno-0-5377" name="__codelineno-0-5377"></a><span class="sd">                                &#39;showFeatureText&#39;: False</span>
</span><span id="__span-0-5378"><a id="__codelineno-0-5378" name="__codelineno-0-5378"></a><span class="sd">                            },</span>
</span><span id="__span-0-5379"><a id="__codelineno-0-5379" name="__codelineno-0-5379"></a><span class="sd">                            ...</span>
</span><span id="__span-0-5380"><a id="__codelineno-0-5380" name="__codelineno-0-5380"></a><span class="sd">                        ]</span>
</span><span id="__span-0-5381"><a id="__codelineno-0-5381" name="__codelineno-0-5381"></a><span class="sd">                    },</span>
</span><span id="__span-0-5382"><a id="__codelineno-0-5382" name="__codelineno-0-5382"></a><span class="sd">                    &#39;serverProcessedContent&#39;: {</span>
</span><span id="__span-0-5383"><a id="__codelineno-0-5383" name="__codelineno-0-5383"></a><span class="sd">                        &#39;htmlStrings&#39;: [...],</span>
</span><span id="__span-0-5384"><a id="__codelineno-0-5384" name="__codelineno-0-5384"></a><span class="sd">                        &#39;searchablePlainTexts&#39;: [...],</span>
</span><span id="__span-0-5385"><a id="__codelineno-0-5385" name="__codelineno-0-5385"></a><span class="sd">                        &#39;links&#39;: [...],</span>
</span><span id="__span-0-5386"><a id="__codelineno-0-5386" name="__codelineno-0-5386"></a><span class="sd">                        &#39;imageSources&#39;: [...],</span>
</span><span id="__span-0-5387"><a id="__codelineno-0-5387" name="__codelineno-0-5387"></a><span class="sd">                        &#39;componentDependencies&#39;: [...],</span>
</span><span id="__span-0-5388"><a id="__codelineno-0-5388" name="__codelineno-0-5388"></a><span class="sd">                        &#39;customMetadata&#39;: [...]</span>
</span><span id="__span-0-5389"><a id="__codelineno-0-5389" name="__codelineno-0-5389"></a><span class="sd">                    }</span>
</span><span id="__span-0-5390"><a id="__codelineno-0-5390" name="__codelineno-0-5390"></a><span class="sd">                }</span>
</span><span id="__span-0-5391"><a id="__codelineno-0-5391" name="__codelineno-0-5391"></a><span class="sd">            },</span>
</span><span id="__span-0-5392"><a id="__codelineno-0-5392" name="__codelineno-0-5392"></a><span class="sd">            {</span>
</span><span id="__span-0-5393"><a id="__codelineno-0-5393" name="__codelineno-0-5393"></a><span class="sd">                &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5394"><a id="__codelineno-0-5394" name="__codelineno-0-5394"></a><span class="sd">                &#39;id&#39;: &#39;f7bfdec9-09c5-4fb6-bc97-3ba225d35ad4&#39;,</span>
</span><span id="__span-0-5395"><a id="__codelineno-0-5395" name="__codelineno-0-5395"></a><span class="sd">                &#39;webPartType&#39;: &#39;8c88f208-6c77-4bdb-86a0-0c47b4316588&#39;,</span>
</span><span id="__span-0-5396"><a id="__codelineno-0-5396" name="__codelineno-0-5396"></a><span class="sd">                &#39;data&#39;: {...}</span>
</span><span id="__span-0-5397"><a id="__codelineno-0-5397" name="__codelineno-0-5397"></a><span class="sd">            },</span>
</span><span id="__span-0-5398"><a id="__codelineno-0-5398" name="__codelineno-0-5398"></a><span class="sd">            {</span>
</span><span id="__span-0-5399"><a id="__codelineno-0-5399" name="__codelineno-0-5399"></a><span class="sd">                &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5400"><a id="__codelineno-0-5400" name="__codelineno-0-5400"></a><span class="sd">                &#39;id&#39;: &#39;f2a8650b-5ea0-4ac2-9cde-56e0fd0279b0&#39;,</span>
</span><span id="__span-0-5401"><a id="__codelineno-0-5401" name="__codelineno-0-5401"></a><span class="sd">                &#39;webPartType&#39;: &#39;eb95c819-ab8f-4689-bd03-0c2d65d47b1f&#39;,</span>
</span><span id="__span-0-5402"><a id="__codelineno-0-5402" name="__codelineno-0-5402"></a><span class="sd">                &#39;data&#39;: {...}</span>
</span><span id="__span-0-5403"><a id="__codelineno-0-5403" name="__codelineno-0-5403"></a><span class="sd">            },</span>
</span><span id="__span-0-5404"><a id="__codelineno-0-5404" name="__codelineno-0-5404"></a><span class="sd">            {</span>
</span><span id="__span-0-5405"><a id="__codelineno-0-5405" name="__codelineno-0-5405"></a><span class="sd">                &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5406"><a id="__codelineno-0-5406" name="__codelineno-0-5406"></a><span class="sd">                &#39;id&#39;: &#39;418ba70b-4cf7-410a-a5fd-ea38386915ac&#39;,</span>
</span><span id="__span-0-5407"><a id="__codelineno-0-5407" name="__codelineno-0-5407"></a><span class="sd">                &#39;webPartType&#39;: &#39;c70391ea-0b10-4ee9-b2b4-006d3fcad0cd&#39;,</span>
</span><span id="__span-0-5408"><a id="__codelineno-0-5408" name="__codelineno-0-5408"></a><span class="sd">                &#39;data&#39;: {...}</span>
</span><span id="__span-0-5409"><a id="__codelineno-0-5409" name="__codelineno-0-5409"></a><span class="sd">            },</span>
</span><span id="__span-0-5410"><a id="__codelineno-0-5410" name="__codelineno-0-5410"></a><span class="sd">            {</span>
</span><span id="__span-0-5411"><a id="__codelineno-0-5411" name="__codelineno-0-5411"></a><span class="sd">                &#39;@odata.type&#39;: &#39;#microsoft.graph.standardWebPart&#39;,</span>
</span><span id="__span-0-5412"><a id="__codelineno-0-5412" name="__codelineno-0-5412"></a><span class="sd">                &#39;id&#39;: &#39;416a4c58-61fc-4166-aa19-1099fad50545&#39;,</span>
</span><span id="__span-0-5413"><a id="__codelineno-0-5413" name="__codelineno-0-5413"></a><span class="sd">                &#39;webPartType&#39;: &#39;f92bf067-bc19-489e-a556-7fe95f508720&#39;,</span>
</span><span id="__span-0-5414"><a id="__codelineno-0-5414" name="__codelineno-0-5414"></a><span class="sd">                &#39;data&#39;: {...}</span>
</span><span id="__span-0-5415"><a id="__codelineno-0-5415" name="__codelineno-0-5415"></a><span class="sd">            }</span>
</span><span id="__span-0-5416"><a id="__codelineno-0-5416" name="__codelineno-0-5416"></a><span class="sd">        ]</span>
</span><span id="__span-0-5417"><a id="__codelineno-0-5417" name="__codelineno-0-5417"></a><span class="sd">    }</span>
</span><span id="__span-0-5418"><a id="__codelineno-0-5418" name="__codelineno-0-5418"></a>
</span><span id="__span-0-5419"><a id="__codelineno-0-5419" name="__codelineno-0-5419"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5420"><a id="__codelineno-0-5420" name="__codelineno-0-5420"></a>
</span><span id="__span-0-5421"><a id="__codelineno-0-5421" name="__codelineno-0-5421"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span> <span class="o">+</span> <span class="n">page_id</span> <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage&quot;</span>
</span><span id="__span-0-5422"><a id="__codelineno-0-5422" name="__codelineno-0-5422"></a>    <span class="k">if</span> <span class="n">section_type</span><span class="p">:</span>
</span><span id="__span-0-5423"><a id="__codelineno-0-5423" name="__codelineno-0-5423"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/canvasLayout/&quot;</span> <span class="o">+</span> <span class="n">section_type</span>
</span><span id="__span-0-5424"><a id="__codelineno-0-5424" name="__codelineno-0-5424"></a>    <span class="k">if</span> <span class="n">section_type</span> <span class="o">==</span> <span class="s2">&quot;horizontalSections&quot;</span><span class="p">:</span>
</span><span id="__span-0-5425"><a id="__codelineno-0-5425" name="__codelineno-0-5425"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">section_id</span><span class="p">)</span>
</span><span id="__span-0-5426"><a id="__codelineno-0-5426" name="__codelineno-0-5426"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/columns/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">column_id</span><span class="p">)</span>
</span><span id="__span-0-5427"><a id="__codelineno-0-5427" name="__codelineno-0-5427"></a>    <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/webparts&quot;</span>
</span><span id="__span-0-5428"><a id="__codelineno-0-5428" name="__codelineno-0-5428"></a>
</span><span id="__span-0-5429"><a id="__codelineno-0-5429" name="__codelineno-0-5429"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5430"><a id="__codelineno-0-5430" name="__codelineno-0-5430"></a>
</span><span id="__span-0-5431"><a id="__codelineno-0-5431" name="__codelineno-0-5431"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5432"><a id="__codelineno-0-5432" name="__codelineno-0-5432"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5433"><a id="__codelineno-0-5433" name="__codelineno-0-5433"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-5434"><a id="__codelineno-0-5434" name="__codelineno-0-5434"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5435"><a id="__codelineno-0-5435" name="__codelineno-0-5435"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5436"><a id="__codelineno-0-5436" name="__codelineno-0-5436"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot get webparts for page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; of SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5437"><a id="__codelineno-0-5437" name="__codelineno-0-5437"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5438"><a id="__codelineno-0-5438" name="__codelineno-0-5438"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5439"><a id="__codelineno-0-5439" name="__codelineno-0-5439"></a>        <span class="p">),</span>
</span><span id="__span-0-5440"><a id="__codelineno-0-5440" name="__codelineno-0-5440"></a>    <span class="p">)</span>
</span><span id="__span-0-5441"><a id="__codelineno-0-5441" name="__codelineno-0-5441"></a>
</span><span id="__span-0-5442"><a id="__codelineno-0-5442" name="__codelineno-0-5442"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a M365 Team based on its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 Team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Teams data structure (dictionary) or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#teams',
    '@odata.count': 1,
    'value': [
        {
            'id': '951bd036-c6fc-4da4-bb80-1860f5472a2f',
            'createdDateTime': None,
            'displayName': 'Procurement',
            'description': 'Procurement',
            'internalId': None,
            'classification': None,
            'specialization': None,
            'visibility': 'public',
            'webUrl': None, ...}]}
            'isArchived': None,
            'isMembershipLimitedToOwners': None,
            'memberSettings': None,
            'guestSettings': None,
            'messagingSettings': None,
            ...
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2052"><a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2053"><a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a M365 Team based on its name.</span>
</span><span id="__span-0-2054"><a id="__codelineno-0-2054" name="__codelineno-0-2054"></a>
</span><span id="__span-0-2055"><a id="__codelineno-0-2055" name="__codelineno-0-2055"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2056"><a id="__codelineno-0-2056" name="__codelineno-0-2056"></a><span class="sd">        name (str):</span>
</span><span id="__span-0-2057"><a id="__codelineno-0-2057" name="__codelineno-0-2057"></a><span class="sd">            The name of the M365 Team.</span>
</span><span id="__span-0-2058"><a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>
</span><span id="__span-0-2059"><a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2060"><a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2061"><a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><span class="sd">            Teams data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-2062"><a id="__codelineno-0-2062" name="__codelineno-0-2062"></a>
</span><span id="__span-0-2063"><a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">    Example:</span>
</span><span id="__span-0-2064"><a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">        {</span>
</span><span id="__span-0-2065"><a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#teams&#39;,</span>
</span><span id="__span-0-2066"><a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">            &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2067"><a id="__codelineno-0-2067" name="__codelineno-0-2067"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-2068"><a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">                {</span>
</span><span id="__span-0-2069"><a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">                    &#39;id&#39;: &#39;951bd036-c6fc-4da4-bb80-1860f5472a2f&#39;,</span>
</span><span id="__span-0-2070"><a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><span class="sd">                    &#39;createdDateTime&#39;: None,</span>
</span><span id="__span-0-2071"><a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">                    &#39;displayName&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2072"><a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">                    &#39;description&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2073"><a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">                    &#39;internalId&#39;: None,</span>
</span><span id="__span-0-2074"><a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">                    &#39;classification&#39;: None,</span>
</span><span id="__span-0-2075"><a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">                    &#39;specialization&#39;: None,</span>
</span><span id="__span-0-2076"><a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">                    &#39;visibility&#39;: &#39;public&#39;,</span>
</span><span id="__span-0-2077"><a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">                    &#39;webUrl&#39;: None, ...}]}</span>
</span><span id="__span-0-2078"><a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">                    &#39;isArchived&#39;: None,</span>
</span><span id="__span-0-2079"><a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="sd">                    &#39;isMembershipLimitedToOwners&#39;: None,</span>
</span><span id="__span-0-2080"><a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">                    &#39;memberSettings&#39;: None,</span>
</span><span id="__span-0-2081"><a id="__codelineno-0-2081" name="__codelineno-0-2081"></a><span class="sd">                    &#39;guestSettings&#39;: None,</span>
</span><span id="__span-0-2082"><a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">                    &#39;messagingSettings&#39;: None,</span>
</span><span id="__span-0-2083"><a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">                    ...</span>
</span><span id="__span-0-2084"><a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">                }</span>
</span><span id="__span-0-2085"><a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">            ]</span>
</span><span id="__span-0-2086"><a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">        }</span>
</span><span id="__span-0-2087"><a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>
</span><span id="__span-0-2088"><a id="__codelineno-0-2088" name="__codelineno-0-2088"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2089"><a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>
</span><span id="__span-0-2090"><a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>    <span class="c1"># The M365 Teams API has an issues with ampersand characters in team names (like &quot;Engineering &amp; Construction&quot;)</span>
</span><span id="__span-0-2091"><a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>    <span class="c1"># So we do a work-around here to first get the Team ID via the Group endpoint of the Graph API and</span>
</span><span id="__span-0-2092"><a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>    <span class="c1"># then fetch the M365 Team via its ID (which is identical to the underlying M365 Group ID)</span>
</span><span id="__span-0-2093"><a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2094"><a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>    <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2095"><a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-2096"><a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2097"><a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>            <span class="s2">&quot;Failed to get the ID of the M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; via the M365 Group API!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2098"><a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2099"><a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>        <span class="p">)</span>
</span><span id="__span-0-2100"><a id="__codelineno-0-2100" name="__codelineno-0-2100"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2101"><a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>
</span><span id="__span-0-2102"><a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span>
</span><span id="__span-0-2103"><a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>
</span><span id="__span-0-2104"><a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2105"><a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>
</span><span id="__span-0-2106"><a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2107"><a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>        <span class="s2">&quot;Lookup Microsoft 365 Teams with name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2108"><a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>        <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2109"><a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2110"><a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>    <span class="p">)</span>
</span><span id="__span-0-2111"><a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>
</span><span id="__span-0-2112"><a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2113"><a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2114"><a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2115"><a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2116"><a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2117"><a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
</span><span id="__span-0-2118"><a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_team_channel_tabs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_team_channel_tabs</span><span class="p">(</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get tabs of an M365 Team channel based on the team and channel names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 Team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 Team channel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Tabs data structure (dictionary) or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': "https://graph.microsoft.com/v1.0/$metadata#teams('951bd036-c6fc-4da4-bb80-1860f5472a2f')/channels('19%3AyPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2')/tabs",
    '@odata.count': 1,
    'value': [
        {
            'id': '66f44e9a-0741-49a4-9500-ec82cc120115',
            'displayName': 'Procurement',
            'webUrl': 'https://teams.microsoft.com/l/entity/2851980b-95dc-4118-a1f5-5ae1894eaaaf/_djb2_msteams_prefix_66f44e9a-0741-49a4-9500-ec82cc120115?webUrl=https%3a%2f%2fotcs.fqdn.tld.com%2fcssupport%2fxecmoffice%2fteamsapp.html%3fnodeId%3d13178%26type%3dcontainer%26parentId%3d2000%26target%3dcontent%26csurl%3dhttps%3a%2f%2fotcs.fqdn.tld.com%2fcs%2fcs%26appId%3da168b00d-3ad9-46ac-8798-578c1961e1ed%26showBW%3dtrue%26title%3dProcurement&amp;label=Procurement&amp;context=%7b%0d%0a++%22canvasUrl%22%3a+%22https%3a%2f%2fotcs.fqdn.tld.com%2fcssupport%2fxecmoffice%2fteamsapp.html%3fnodeId%3d13178%26type%3dcontainer%26parentId%3d2000%26target%3dcontent%26csurl%3dhttps%3a%2f%2fotcs.fqdn.tld.com%2fcs%2fcs%26appId%3da168b00d-3ad9-46ac-8798-578c1961e1ed%22%2c%0d%0a++%22channelId%22%3a+%2219%3ayPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2%22%2c%0d%0a++%22subEntityId%22%3a+null%0d%0a%7d&amp;groupId=951bd036-c6fc-4da4-bb80-1860f5472a2f&amp;tenantId=417e6e3a-82e6-4aa0-9d47-a7734ca3daea',
            'configuration':
            {
                'entityId': '13178',
                'contentUrl': 'https://otcs.fqdn.tld.com/cssupport/xecmoffice/teamsapp.html?nodeId=13178&amp;type=container&amp;parentId=2000&amp;target=content&amp;csurl=https://otcs.fqdn.tld.com/cs/cs&amp;appId=a168b00d-3ad9-46ac-8798-578c1961e1ed',
                'removeUrl': None,
                'websiteUrl': 'https://otcs.fqdn.tld.com/cssupport/xecmoffice/teamsapp.html?nodeId=13178&amp;type=container&amp;parentId=2000&amp;target=content&amp;csurl=https://otcs.fqdn.tld.com/cs/cs&amp;appId=a168b00d-3ad9-46ac-8798-578c1961e1ed&amp;showBW=true&amp;title=Procurement',
                'dateAdded': '2023-08-12T08:57:35.895Z'
            }
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2407"><a id="__codelineno-0-2407" name="__codelineno-0-2407"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_team_channel_tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2408"><a id="__codelineno-0-2408" name="__codelineno-0-2408"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get tabs of an M365 Team channel based on the team and channel names.</span>
</span><span id="__span-0-2409"><a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>
</span><span id="__span-0-2410"><a id="__codelineno-0-2410" name="__codelineno-0-2410"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2411"><a id="__codelineno-0-2411" name="__codelineno-0-2411"></a><span class="sd">        team_name (str):</span>
</span><span id="__span-0-2412"><a id="__codelineno-0-2412" name="__codelineno-0-2412"></a><span class="sd">            The name of the M365 Team.</span>
</span><span id="__span-0-2413"><a id="__codelineno-0-2413" name="__codelineno-0-2413"></a><span class="sd">        channel_name (str):</span>
</span><span id="__span-0-2414"><a id="__codelineno-0-2414" name="__codelineno-0-2414"></a><span class="sd">            The name of the M365 Team channel.</span>
</span><span id="__span-0-2415"><a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>
</span><span id="__span-0-2416"><a id="__codelineno-0-2416" name="__codelineno-0-2416"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2417"><a id="__codelineno-0-2417" name="__codelineno-0-2417"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2418"><a id="__codelineno-0-2418" name="__codelineno-0-2418"></a><span class="sd">            Tabs data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-2419"><a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>
</span><span id="__span-0-2420"><a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><span class="sd">    Example:</span>
</span><span id="__span-0-2421"><a id="__codelineno-0-2421" name="__codelineno-0-2421"></a><span class="sd">        {</span>
</span><span id="__span-0-2422"><a id="__codelineno-0-2422" name="__codelineno-0-2422"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#teams(&#39;951bd036-c6fc-4da4-bb80-1860f5472a2f&#39;)/channels(&#39;19%3AyPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2&#39;)/tabs&quot;,</span>
</span><span id="__span-0-2423"><a id="__codelineno-0-2423" name="__codelineno-0-2423"></a><span class="sd">            &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2424"><a id="__codelineno-0-2424" name="__codelineno-0-2424"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-2425"><a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><span class="sd">                {</span>
</span><span id="__span-0-2426"><a id="__codelineno-0-2426" name="__codelineno-0-2426"></a><span class="sd">                    &#39;id&#39;: &#39;66f44e9a-0741-49a4-9500-ec82cc120115&#39;,</span>
</span><span id="__span-0-2427"><a id="__codelineno-0-2427" name="__codelineno-0-2427"></a><span class="sd">                    &#39;displayName&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2428"><a id="__codelineno-0-2428" name="__codelineno-0-2428"></a><span class="sd">                    &#39;webUrl&#39;: &#39;https://teams.microsoft.com/l/entity/2851980b-95dc-4118-a1f5-5ae1894eaaaf/_djb2_msteams_prefix_66f44e9a-0741-49a4-9500-ec82cc120115?webUrl=https%3a%2f%2fotcs.fqdn.tld.com%2fcssupport%2fxecmoffice%2fteamsapp.html%3fnodeId%3d13178%26type%3dcontainer%26parentId%3d2000%26target%3dcontent%26csurl%3dhttps%3a%2f%2fotcs.fqdn.tld.com%2fcs%2fcs%26appId%3da168b00d-3ad9-46ac-8798-578c1961e1ed%26showBW%3dtrue%26title%3dProcurement&amp;label=Procurement&amp;context=%7b%0d%0a++%22canvasUrl%22%3a+%22https%3a%2f%2fotcs.fqdn.tld.com%2fcssupport%2fxecmoffice%2fteamsapp.html%3fnodeId%3d13178%26type%3dcontainer%26parentId%3d2000%26target%3dcontent%26csurl%3dhttps%3a%2f%2fotcs.fqdn.tld.com%2fcs%2fcs%26appId%3da168b00d-3ad9-46ac-8798-578c1961e1ed%22%2c%0d%0a++%22channelId%22%3a+%2219%3ayPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2%22%2c%0d%0a++%22subEntityId%22%3a+null%0d%0a%7d&amp;groupId=951bd036-c6fc-4da4-bb80-1860f5472a2f&amp;tenantId=417e6e3a-82e6-4aa0-9d47-a7734ca3daea&#39;,</span>
</span><span id="__span-0-2429"><a id="__codelineno-0-2429" name="__codelineno-0-2429"></a><span class="sd">                    &#39;configuration&#39;:</span>
</span><span id="__span-0-2430"><a id="__codelineno-0-2430" name="__codelineno-0-2430"></a><span class="sd">                    {</span>
</span><span id="__span-0-2431"><a id="__codelineno-0-2431" name="__codelineno-0-2431"></a><span class="sd">                        &#39;entityId&#39;: &#39;13178&#39;,</span>
</span><span id="__span-0-2432"><a id="__codelineno-0-2432" name="__codelineno-0-2432"></a><span class="sd">                        &#39;contentUrl&#39;: &#39;https://otcs.fqdn.tld.com/cssupport/xecmoffice/teamsapp.html?nodeId=13178&amp;type=container&amp;parentId=2000&amp;target=content&amp;csurl=https://otcs.fqdn.tld.com/cs/cs&amp;appId=a168b00d-3ad9-46ac-8798-578c1961e1ed&#39;,</span>
</span><span id="__span-0-2433"><a id="__codelineno-0-2433" name="__codelineno-0-2433"></a><span class="sd">                        &#39;removeUrl&#39;: None,</span>
</span><span id="__span-0-2434"><a id="__codelineno-0-2434" name="__codelineno-0-2434"></a><span class="sd">                        &#39;websiteUrl&#39;: &#39;https://otcs.fqdn.tld.com/cssupport/xecmoffice/teamsapp.html?nodeId=13178&amp;type=container&amp;parentId=2000&amp;target=content&amp;csurl=https://otcs.fqdn.tld.com/cs/cs&amp;appId=a168b00d-3ad9-46ac-8798-578c1961e1ed&amp;showBW=true&amp;title=Procurement&#39;,</span>
</span><span id="__span-0-2435"><a id="__codelineno-0-2435" name="__codelineno-0-2435"></a><span class="sd">                        &#39;dateAdded&#39;: &#39;2023-08-12T08:57:35.895Z&#39;</span>
</span><span id="__span-0-2436"><a id="__codelineno-0-2436" name="__codelineno-0-2436"></a><span class="sd">                    }</span>
</span><span id="__span-0-2437"><a id="__codelineno-0-2437" name="__codelineno-0-2437"></a><span class="sd">                }</span>
</span><span id="__span-0-2438"><a id="__codelineno-0-2438" name="__codelineno-0-2438"></a><span class="sd">            ]</span>
</span><span id="__span-0-2439"><a id="__codelineno-0-2439" name="__codelineno-0-2439"></a><span class="sd">        }</span>
</span><span id="__span-0-2440"><a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>
</span><span id="__span-0-2441"><a id="__codelineno-0-2441" name="__codelineno-0-2441"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2442"><a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>
</span><span id="__span-0-2443"><a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-2444"><a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>    <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2445"><a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-2446"><a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2447"><a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>
</span><span id="__span-0-2448"><a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>    <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-2449"><a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-2450"><a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-2451"><a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2452"><a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>
</span><span id="__span-0-2453"><a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>    <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-2454"><a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>    <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-2455"><a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-2456"><a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>        <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-2457"><a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>    <span class="p">)</span>
</span><span id="__span-0-2458"><a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-2459"><a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2460"><a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>            <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2461"><a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-2462"><a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-2463"><a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>        <span class="p">)</span>
</span><span id="__span-0-2464"><a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2465"><a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>    <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-2466"><a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>
</span><span id="__span-0-2467"><a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs&quot;</span>
</span><span id="__span-0-2468"><a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>
</span><span id="__span-0-2469"><a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2470"><a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>
</span><span id="__span-0-2471"><a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2472"><a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>        <span class="s2">&quot;Retrieve Tabs of Microsoft 365 Teams -&gt; </span><span class="si">%s</span><span class="s2"> and Channel -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2473"><a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>        <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-2474"><a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>        <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-2475"><a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2476"><a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>    <span class="p">)</span>
</span><span id="__span-0-2477"><a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
</span><span id="__span-0-2478"><a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2479"><a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2480"><a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2481"><a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2482"><a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2483"><a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get Tabs for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2484"><a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-2485"><a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2486"><a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-2487"><a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-2488"><a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>        <span class="p">),</span>
</span><span id="__span-0-2489"><a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_team_channels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get channels of a M365 Team based on the team name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The channel data structure (dictionary) or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': "https://graph.microsoft.com/v1.0/$metadata#teams('951bd036-c6fc-4da4-bb80-1860f5472a2f')/channels",
    '@odata.count': 1,
    'value': [
        {
            'id': '19:yPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1@thread.tacv2',
            'createdDateTime': '2023-08-11T14:11:35.986Z',
            'displayName': 'General',
            'description': 'Procurement',
            'isFavoriteByDefault': None,
            'email': None,
            'tenantId': '417e6e3a-82e6-4aa0-9d47-a7734ca3daea',
            'webUrl': 'https://teams.microsoft.com/l/channel/19%3AyPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2/Procurement?groupId=951bd036-c6fc-4da4-bb80-1860f5472a2f&amp;tenantId=417e6e3a-82e6-4aa0-9d47-a7734ca3daea&amp;allowXTenantAccess=False',
            'membershipType': 'standard'
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2347"><a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_team_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2348"><a id="__codelineno-0-2348" name="__codelineno-0-2348"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get channels of a M365 Team based on the team name.</span>
</span><span id="__span-0-2349"><a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>
</span><span id="__span-0-2350"><a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2351"><a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="sd">        name (str):</span>
</span><span id="__span-0-2352"><a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="sd">            The name of the M365 team.</span>
</span><span id="__span-0-2353"><a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>
</span><span id="__span-0-2354"><a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2355"><a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="sd">        dict:</span>
</span><span id="__span-0-2356"><a id="__codelineno-0-2356" name="__codelineno-0-2356"></a><span class="sd">            The channel data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-2357"><a id="__codelineno-0-2357" name="__codelineno-0-2357"></a>
</span><span id="__span-0-2358"><a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="sd">    Example:</span>
</span><span id="__span-0-2359"><a id="__codelineno-0-2359" name="__codelineno-0-2359"></a><span class="sd">        {</span>
</span><span id="__span-0-2360"><a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#teams(&#39;951bd036-c6fc-4da4-bb80-1860f5472a2f&#39;)/channels&quot;,</span>
</span><span id="__span-0-2361"><a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><span class="sd">            &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2362"><a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-2363"><a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">                {</span>
</span><span id="__span-0-2364"><a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">                    &#39;id&#39;: &#39;19:yPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1@thread.tacv2&#39;,</span>
</span><span id="__span-0-2365"><a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><span class="sd">                    &#39;createdDateTime&#39;: &#39;2023-08-11T14:11:35.986Z&#39;,</span>
</span><span id="__span-0-2366"><a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><span class="sd">                    &#39;displayName&#39;: &#39;General&#39;,</span>
</span><span id="__span-0-2367"><a id="__codelineno-0-2367" name="__codelineno-0-2367"></a><span class="sd">                    &#39;description&#39;: &#39;Procurement&#39;,</span>
</span><span id="__span-0-2368"><a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><span class="sd">                    &#39;isFavoriteByDefault&#39;: None,</span>
</span><span id="__span-0-2369"><a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><span class="sd">                    &#39;email&#39;: None,</span>
</span><span id="__span-0-2370"><a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><span class="sd">                    &#39;tenantId&#39;: &#39;417e6e3a-82e6-4aa0-9d47-a7734ca3daea&#39;,</span>
</span><span id="__span-0-2371"><a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><span class="sd">                    &#39;webUrl&#39;: &#39;https://teams.microsoft.com/l/channel/19%3AyPmPnXoFtvs5jmgL7fG-iXNENVMLsB_WSrxYK-zKakY1%40thread.tacv2/Procurement?groupId=951bd036-c6fc-4da4-bb80-1860f5472a2f&amp;tenantId=417e6e3a-82e6-4aa0-9d47-a7734ca3daea&amp;allowXTenantAccess=False&#39;,</span>
</span><span id="__span-0-2372"><a id="__codelineno-0-2372" name="__codelineno-0-2372"></a><span class="sd">                    &#39;membershipType&#39;: &#39;standard&#39;</span>
</span><span id="__span-0-2373"><a id="__codelineno-0-2373" name="__codelineno-0-2373"></a><span class="sd">                }</span>
</span><span id="__span-0-2374"><a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><span class="sd">            ]</span>
</span><span id="__span-0-2375"><a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><span class="sd">        }</span>
</span><span id="__span-0-2376"><a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>
</span><span id="__span-0-2377"><a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2378"><a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>
</span><span id="__span-0-2379"><a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-2380"><a id="__codelineno-0-2380" name="__codelineno-0-2380"></a>    <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2381"><a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-2382"><a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2383"><a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>
</span><span id="__span-0-2384"><a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels&quot;</span>
</span><span id="__span-0-2385"><a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>
</span><span id="__span-0-2386"><a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2387"><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>
</span><span id="__span-0-2388"><a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2389"><a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>        <span class="s2">&quot;Retrieve channels of Microsoft 365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2390"><a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>        <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2391"><a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2392"><a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>    <span class="p">)</span>
</span><span id="__span-0-2393"><a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>
</span><span id="__span-0-2394"><a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2395"><a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2396"><a id="__codelineno-0-2396" name="__codelineno-0-2396"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2397"><a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2398"><a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2399"><a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get Channels for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2400"><a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-2401"><a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2402"><a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>        <span class="p">),</span>
</span><span id="__span-0-2403"><a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_teams_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_teams_app</span><span class="p">(</span><span class="n">app_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a specific MS Teams app in catalog based on the known (internal) app ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the app (this is NOT the external ID but the internal ID).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="examle" open>
  <summary>Examle</summary>
  <p>{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(appDefinitions())/$entity',
    'id': 'ccabe3fb-316f-40e0-a486-1659682cb8cd',
    'externalId': 'dd4af790-d8ff-47a0-87ad-486318272c7a',
    'displayName': 'Extended ECM',
    'distributionMethod': 'organization',
    'appDefinitions@odata.context': "https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps('ccabe3fb-316f-40e0-a486-1659682cb8cd')/appDefinitions",
    'appDefinitions': [
        {
            'id': 'Y2NhYmUzZmItMzE2Zi00MGUwLWE0ODYtMTY1OTY4MmNiOGNkIyMyNC4yLjAjI1B1Ymxpc2hlZA==',
            'teamsAppId': 'ccabe3fb-316f-40e0-a486-1659682cb8cd',
            'displayName': 'Extended ECM',
            'version': '24.2.0',
            'publishingState': 'published',
            'shortDescription': 'Add a tab for an Extended ECM business workspace.',
            'description': 'View and interact with OpenText Extended ECM business workspaces',
            'lastModifiedDateTime': None,
            'createdBy': None,
            'authorization': {...}
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2573"><a id="__codelineno-0-2573" name="__codelineno-0-2573"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_teams_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2574"><a id="__codelineno-0-2574" name="__codelineno-0-2574"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a specific MS Teams app in catalog based on the known (internal) app ID.</span>
</span><span id="__span-0-2575"><a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>
</span><span id="__span-0-2576"><a id="__codelineno-0-2576" name="__codelineno-0-2576"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2577"><a id="__codelineno-0-2577" name="__codelineno-0-2577"></a><span class="sd">        app_id (str):</span>
</span><span id="__span-0-2578"><a id="__codelineno-0-2578" name="__codelineno-0-2578"></a><span class="sd">            ID of the app (this is NOT the external ID but the internal ID).</span>
</span><span id="__span-0-2579"><a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>
</span><span id="__span-0-2580"><a id="__codelineno-0-2580" name="__codelineno-0-2580"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2581"><a id="__codelineno-0-2581" name="__codelineno-0-2581"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2582"><a id="__codelineno-0-2582" name="__codelineno-0-2582"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2583"><a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>
</span><span id="__span-0-2584"><a id="__codelineno-0-2584" name="__codelineno-0-2584"></a><span class="sd">    Examle:</span>
</span><span id="__span-0-2585"><a id="__codelineno-0-2585" name="__codelineno-0-2585"></a><span class="sd">        {</span>
</span><span id="__span-0-2586"><a id="__codelineno-0-2586" name="__codelineno-0-2586"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(appDefinitions())/$entity&#39;,</span>
</span><span id="__span-0-2587"><a id="__codelineno-0-2587" name="__codelineno-0-2587"></a><span class="sd">            &#39;id&#39;: &#39;ccabe3fb-316f-40e0-a486-1659682cb8cd&#39;,</span>
</span><span id="__span-0-2588"><a id="__codelineno-0-2588" name="__codelineno-0-2588"></a><span class="sd">            &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,</span>
</span><span id="__span-0-2589"><a id="__codelineno-0-2589" name="__codelineno-0-2589"></a><span class="sd">            &#39;displayName&#39;: &#39;Extended ECM&#39;,</span>
</span><span id="__span-0-2590"><a id="__codelineno-0-2590" name="__codelineno-0-2590"></a><span class="sd">            &#39;distributionMethod&#39;: &#39;organization&#39;,</span>
</span><span id="__span-0-2591"><a id="__codelineno-0-2591" name="__codelineno-0-2591"></a><span class="sd">            &#39;appDefinitions@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(&#39;ccabe3fb-316f-40e0-a486-1659682cb8cd&#39;)/appDefinitions&quot;,</span>
</span><span id="__span-0-2592"><a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><span class="sd">            &#39;appDefinitions&#39;: [</span>
</span><span id="__span-0-2593"><a id="__codelineno-0-2593" name="__codelineno-0-2593"></a><span class="sd">                {</span>
</span><span id="__span-0-2594"><a id="__codelineno-0-2594" name="__codelineno-0-2594"></a><span class="sd">                    &#39;id&#39;: &#39;Y2NhYmUzZmItMzE2Zi00MGUwLWE0ODYtMTY1OTY4MmNiOGNkIyMyNC4yLjAjI1B1Ymxpc2hlZA==&#39;,</span>
</span><span id="__span-0-2595"><a id="__codelineno-0-2595" name="__codelineno-0-2595"></a><span class="sd">                    &#39;teamsAppId&#39;: &#39;ccabe3fb-316f-40e0-a486-1659682cb8cd&#39;,</span>
</span><span id="__span-0-2596"><a id="__codelineno-0-2596" name="__codelineno-0-2596"></a><span class="sd">                    &#39;displayName&#39;: &#39;Extended ECM&#39;,</span>
</span><span id="__span-0-2597"><a id="__codelineno-0-2597" name="__codelineno-0-2597"></a><span class="sd">                    &#39;version&#39;: &#39;24.2.0&#39;,</span>
</span><span id="__span-0-2598"><a id="__codelineno-0-2598" name="__codelineno-0-2598"></a><span class="sd">                    &#39;publishingState&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-2599"><a id="__codelineno-0-2599" name="__codelineno-0-2599"></a><span class="sd">                    &#39;shortDescription&#39;: &#39;Add a tab for an Extended ECM business workspace.&#39;,</span>
</span><span id="__span-0-2600"><a id="__codelineno-0-2600" name="__codelineno-0-2600"></a><span class="sd">                    &#39;description&#39;: &#39;View and interact with OpenText Extended ECM business workspaces&#39;,</span>
</span><span id="__span-0-2601"><a id="__codelineno-0-2601" name="__codelineno-0-2601"></a><span class="sd">                    &#39;lastModifiedDateTime&#39;: None,</span>
</span><span id="__span-0-2602"><a id="__codelineno-0-2602" name="__codelineno-0-2602"></a><span class="sd">                    &#39;createdBy&#39;: None,</span>
</span><span id="__span-0-2603"><a id="__codelineno-0-2603" name="__codelineno-0-2603"></a><span class="sd">                    &#39;authorization&#39;: {...}</span>
</span><span id="__span-0-2604"><a id="__codelineno-0-2604" name="__codelineno-0-2604"></a><span class="sd">                }</span>
</span><span id="__span-0-2605"><a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="sd">            ]</span>
</span><span id="__span-0-2606"><a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">        }</span>
</span><span id="__span-0-2607"><a id="__codelineno-0-2607" name="__codelineno-0-2607"></a>
</span><span id="__span-0-2608"><a id="__codelineno-0-2608" name="__codelineno-0-2608"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2609"><a id="__codelineno-0-2609" name="__codelineno-0-2609"></a>
</span><span id="__span-0-2610"><a id="__codelineno-0-2610" name="__codelineno-0-2610"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;AppDefinitions&quot;</span><span class="p">}</span>
</span><span id="__span-0-2611"><a id="__codelineno-0-2611" name="__codelineno-0-2611"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2612"><a id="__codelineno-0-2612" name="__codelineno-0-2612"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_id</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2613"><a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>
</span><span id="__span-0-2614"><a id="__codelineno-0-2614" name="__codelineno-0-2614"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2615"><a id="__codelineno-0-2615" name="__codelineno-0-2615"></a>        <span class="s2">&quot;Get M365 Teams App with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2616"><a id="__codelineno-0-2616" name="__codelineno-0-2616"></a>        <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-2617"><a id="__codelineno-0-2617" name="__codelineno-0-2617"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2618"><a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>    <span class="p">)</span>
</span><span id="__span-0-2619"><a id="__codelineno-0-2619" name="__codelineno-0-2619"></a>
</span><span id="__span-0-2620"><a id="__codelineno-0-2620" name="__codelineno-0-2620"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2621"><a id="__codelineno-0-2621" name="__codelineno-0-2621"></a>
</span><span id="__span-0-2622"><a id="__codelineno-0-2622" name="__codelineno-0-2622"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2623"><a id="__codelineno-0-2623" name="__codelineno-0-2623"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2624"><a id="__codelineno-0-2624" name="__codelineno-0-2624"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2625"><a id="__codelineno-0-2625" name="__codelineno-0-2625"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2626"><a id="__codelineno-0-2626" name="__codelineno-0-2626"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2627"><a id="__codelineno-0-2627" name="__codelineno-0-2627"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 Teams app with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_id</span><span class="p">),</span>
</span><span id="__span-0-2628"><a id="__codelineno-0-2628" name="__codelineno-0-2628"></a>    <span class="p">)</span>
</span><span id="__span-0-2629"><a id="__codelineno-0-2629" name="__codelineno-0-2629"></a>
</span><span id="__span-0-2630"><a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_teams_apps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_teams_apps</span><span class="p">(</span><span class="n">filter_expression</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of MS Teams apps in catalog that match a given filter criterium.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_expression</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(appDefinitions())',
    '@odata.count': 1,
    'value': [
        {
            'id': '2851980b-95dc-4118-a1f5-5ae1894eaaaf',
            'externalId': 'dd4af790-d8ff-47a0-87ad-486318272c7a',
            'displayName': 'OpenText Extended ECM',
            'distributionMethod': 'organization',
            'appDefinitions@odata.context': "https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps('2851980b-95dc-4118-a1f5-5ae1894eaaaf')/appDefinitions",
            'appDefinitions': [
                {
                    'id': 'Mjg1MTk4MGItOTVkYy00MTE4LWExZjUtNWFlMTg5NGVhYWFmIyMyMi40IyNQdWJsaXNoZWQ=',
                    'teamsAppId': '2851980b-95dc-4118-a1f5-5ae1894eaaaf',
                    'displayName': 'OpenText Extended ECM',
                    'version': '22.4',
                    'publishingState': 'published',
                    'shortDescription': 'Add a tab for an Extended ECM business workspace.',
                    'description': 'View and interact with OpenText Extended ECM business workspaces',
                    'lastModifiedDateTime': None,
                    'createdBy': None,
                    'authorization': {
                        'requiredPermissionSet': {...}
                    }
                }
            ]
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2493"><a id="__codelineno-0-2493" name="__codelineno-0-2493"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_teams_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2494"><a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of MS Teams apps in catalog that match a given filter criterium.</span>
</span><span id="__span-0-2495"><a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>
</span><span id="__span-0-2496"><a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2497"><a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="sd">        filter_expression (str, optional):</span>
</span><span id="__span-0-2498"><a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><span class="sd">            Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</span>
</span><span id="__span-0-2499"><a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>
</span><span id="__span-0-2500"><a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2501"><a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2502"><a id="__codelineno-0-2502" name="__codelineno-0-2502"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2503"><a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>
</span><span id="__span-0-2504"><a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="sd">    Example:</span>
</span><span id="__span-0-2505"><a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">        {</span>
</span><span id="__span-0-2506"><a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(appDefinitions())&#39;,</span>
</span><span id="__span-0-2507"><a id="__codelineno-0-2507" name="__codelineno-0-2507"></a><span class="sd">            &#39;@odata.count&#39;: 1,</span>
</span><span id="__span-0-2508"><a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-2509"><a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="sd">                {</span>
</span><span id="__span-0-2510"><a id="__codelineno-0-2510" name="__codelineno-0-2510"></a><span class="sd">                    &#39;id&#39;: &#39;2851980b-95dc-4118-a1f5-5ae1894eaaaf&#39;,</span>
</span><span id="__span-0-2511"><a id="__codelineno-0-2511" name="__codelineno-0-2511"></a><span class="sd">                    &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,</span>
</span><span id="__span-0-2512"><a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="sd">                    &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,</span>
</span><span id="__span-0-2513"><a id="__codelineno-0-2513" name="__codelineno-0-2513"></a><span class="sd">                    &#39;distributionMethod&#39;: &#39;organization&#39;,</span>
</span><span id="__span-0-2514"><a id="__codelineno-0-2514" name="__codelineno-0-2514"></a><span class="sd">                    &#39;appDefinitions@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(&#39;2851980b-95dc-4118-a1f5-5ae1894eaaaf&#39;)/appDefinitions&quot;,</span>
</span><span id="__span-0-2515"><a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><span class="sd">                    &#39;appDefinitions&#39;: [</span>
</span><span id="__span-0-2516"><a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="sd">                        {</span>
</span><span id="__span-0-2517"><a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="sd">                            &#39;id&#39;: &#39;Mjg1MTk4MGItOTVkYy00MTE4LWExZjUtNWFlMTg5NGVhYWFmIyMyMi40IyNQdWJsaXNoZWQ=&#39;,</span>
</span><span id="__span-0-2518"><a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><span class="sd">                            &#39;teamsAppId&#39;: &#39;2851980b-95dc-4118-a1f5-5ae1894eaaaf&#39;,</span>
</span><span id="__span-0-2519"><a id="__codelineno-0-2519" name="__codelineno-0-2519"></a><span class="sd">                            &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,</span>
</span><span id="__span-0-2520"><a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><span class="sd">                            &#39;version&#39;: &#39;22.4&#39;,</span>
</span><span id="__span-0-2521"><a id="__codelineno-0-2521" name="__codelineno-0-2521"></a><span class="sd">                            &#39;publishingState&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-2522"><a id="__codelineno-0-2522" name="__codelineno-0-2522"></a><span class="sd">                            &#39;shortDescription&#39;: &#39;Add a tab for an Extended ECM business workspace.&#39;,</span>
</span><span id="__span-0-2523"><a id="__codelineno-0-2523" name="__codelineno-0-2523"></a><span class="sd">                            &#39;description&#39;: &#39;View and interact with OpenText Extended ECM business workspaces&#39;,</span>
</span><span id="__span-0-2524"><a id="__codelineno-0-2524" name="__codelineno-0-2524"></a><span class="sd">                            &#39;lastModifiedDateTime&#39;: None,</span>
</span><span id="__span-0-2525"><a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><span class="sd">                            &#39;createdBy&#39;: None,</span>
</span><span id="__span-0-2526"><a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><span class="sd">                            &#39;authorization&#39;: {</span>
</span><span id="__span-0-2527"><a id="__codelineno-0-2527" name="__codelineno-0-2527"></a><span class="sd">                                &#39;requiredPermissionSet&#39;: {...}</span>
</span><span id="__span-0-2528"><a id="__codelineno-0-2528" name="__codelineno-0-2528"></a><span class="sd">                            }</span>
</span><span id="__span-0-2529"><a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><span class="sd">                        }</span>
</span><span id="__span-0-2530"><a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><span class="sd">                    ]</span>
</span><span id="__span-0-2531"><a id="__codelineno-0-2531" name="__codelineno-0-2531"></a><span class="sd">                }</span>
</span><span id="__span-0-2532"><a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><span class="sd">            ]</span>
</span><span id="__span-0-2533"><a id="__codelineno-0-2533" name="__codelineno-0-2533"></a><span class="sd">        }</span>
</span><span id="__span-0-2534"><a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>
</span><span id="__span-0-2535"><a id="__codelineno-0-2535" name="__codelineno-0-2535"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2536"><a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>
</span><span id="__span-0-2537"><a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;AppDefinitions&quot;</span><span class="p">}</span>
</span><span id="__span-0-2538"><a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>
</span><span id="__span-0-2539"><a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>    <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2540"><a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>        <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-2541"><a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>
</span><span id="__span-0-2542"><a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2543"><a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2544"><a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>
</span><span id="__span-0-2545"><a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>    <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2546"><a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2547"><a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>            <span class="s2">&quot;Get list of MS Teams Apps using filter -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2548"><a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>            <span class="n">filter_expression</span><span class="p">,</span>
</span><span id="__span-0-2549"><a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2550"><a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>        <span class="p">)</span>
</span><span id="__span-0-2551"><a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>        <span class="n">failure_message</span> <span class="o">=</span> <span class="s2">&quot;Failed to get list of M365 Teams apps using filter -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2552"><a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>            <span class="n">filter_expression</span><span class="p">,</span>
</span><span id="__span-0-2553"><a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>        <span class="p">)</span>
</span><span id="__span-0-2554"><a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2555"><a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2556"><a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>            <span class="s2">&quot;Get list of all MS Teams Apps; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2557"><a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>            <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2558"><a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>        <span class="p">)</span>
</span><span id="__span-0-2559"><a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>        <span class="n">failure_message</span> <span class="o">=</span> <span class="s2">&quot;Failed to get list of M365 Teams apps&quot;</span>
</span><span id="__span-0-2560"><a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>
</span><span id="__span-0-2561"><a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2562"><a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>
</span><span id="__span-0-2563"><a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2564"><a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2565"><a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2566"><a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2567"><a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2568"><a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="n">failure_message</span><span class="p">,</span>
</span><span id="__span-0-2569"><a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_teams_apps_of_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_teams_apps_of_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">,</span> <span class="n">filter_expression</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of MS Teams apps of a M365 team that match a given filter criterium.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 ID of the team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_expression</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2683"><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_teams_apps_of_team</span><span class="p">(</span>
</span><span id="__span-0-2684"><a id="__codelineno-0-2684" name="__codelineno-0-2684"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2685"><a id="__codelineno-0-2685" name="__codelineno-0-2685"></a>    <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2686"><a id="__codelineno-0-2686" name="__codelineno-0-2686"></a>    <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2687"><a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2688"><a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of MS Teams apps of a M365 team that match a given filter criterium.</span>
</span><span id="__span-0-2689"><a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>
</span><span id="__span-0-2690"><a id="__codelineno-0-2690" name="__codelineno-0-2690"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2691"><a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">        team_id (str):</span>
</span><span id="__span-0-2692"><a id="__codelineno-0-2692" name="__codelineno-0-2692"></a><span class="sd">            The M365 ID of the team.</span>
</span><span id="__span-0-2693"><a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">        filter_expression (str, optional):</span>
</span><span id="__span-0-2694"><a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">            Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</span>
</span><span id="__span-0-2695"><a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>
</span><span id="__span-0-2696"><a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2697"><a id="__codelineno-0-2697" name="__codelineno-0-2697"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2698"><a id="__codelineno-0-2698" name="__codelineno-0-2698"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2699"><a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>
</span><span id="__span-0-2700"><a id="__codelineno-0-2700" name="__codelineno-0-2700"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2701"><a id="__codelineno-0-2701" name="__codelineno-0-2701"></a>
</span><span id="__span-0-2702"><a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;teamsAppDefinition&quot;</span><span class="p">}</span>
</span><span id="__span-0-2703"><a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>    <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2704"><a id="__codelineno-0-2704" name="__codelineno-0-2704"></a>        <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-2705"><a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>
</span><span id="__span-0-2706"><a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2707"><a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span> <span class="o">+</span> <span class="s2">&quot;/installedApps?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2708"><a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>
</span><span id="__span-0-2709"><a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2710"><a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>        <span class="s2">&quot;Get list of M365 Teams Apps for M365 Team -&gt; </span><span class="si">%s</span><span class="s2"> using query -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2711"><a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>        <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2712"><a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>        <span class="n">query</span><span class="p">,</span>
</span><span id="__span-0-2713"><a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2714"><a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>    <span class="p">)</span>
</span><span id="__span-0-2715"><a id="__codelineno-0-2715" name="__codelineno-0-2715"></a>
</span><span id="__span-0-2716"><a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2717"><a id="__codelineno-0-2717" name="__codelineno-0-2717"></a>
</span><span id="__span-0-2718"><a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2719"><a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2720"><a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2721"><a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2722"><a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2723"><a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 Teams apps for M365 Team -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2724"><a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-2725"><a id="__codelineno-0-2725" name="__codelineno-0-2725"></a>        <span class="p">),</span>
</span><span id="__span-0-2726"><a id="__codelineno-0-2726" name="__codelineno-0-2726"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_teams_apps_of_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_teams_apps_of_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">filter_expression</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of MS Teams apps of a user that match a given filter criterium.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_expression</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2634"><a id="__codelineno-0-2634" name="__codelineno-0-2634"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_teams_apps_of_user</span><span class="p">(</span>
</span><span id="__span-0-2635"><a id="__codelineno-0-2635" name="__codelineno-0-2635"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2636"><a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2637"><a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>    <span class="n">filter_expression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2638"><a id="__codelineno-0-2638" name="__codelineno-0-2638"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2639"><a id="__codelineno-0-2639" name="__codelineno-0-2639"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of MS Teams apps of a user that match a given filter criterium.</span>
</span><span id="__span-0-2640"><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>
</span><span id="__span-0-2641"><a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2642"><a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-2643"><a id="__codelineno-0-2643" name="__codelineno-0-2643"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user)</span>
</span><span id="__span-0-2644"><a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">        filter_expression (str, optional):</span>
</span><span id="__span-0-2645"><a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">            Filter string see https://learn.microsoft.com/en-us/graph/filter-query-parameter</span>
</span><span id="__span-0-2646"><a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>
</span><span id="__span-0-2647"><a id="__codelineno-0-2647" name="__codelineno-0-2647"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2648"><a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-2649"><a id="__codelineno-0-2649" name="__codelineno-0-2649"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-2650"><a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>
</span><span id="__span-0-2651"><a id="__codelineno-0-2651" name="__codelineno-0-2651"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2652"><a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>
</span><span id="__span-0-2653"><a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$expand&quot;</span><span class="p">:</span> <span class="s2">&quot;teamsAppDefinition&quot;</span><span class="p">}</span>
</span><span id="__span-0-2654"><a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>    <span class="k">if</span> <span class="n">filter_expression</span><span class="p">:</span>
</span><span id="__span-0-2655"><a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>        <span class="n">query</span><span class="p">[</span><span class="s2">&quot;$filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_expression</span>
</span><span id="__span-0-2656"><a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>
</span><span id="__span-0-2657"><a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>    <span class="n">encoded_query</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">doseq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2658"><a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps?&quot;</span> <span class="o">+</span> <span class="n">encoded_query</span>
</span><span id="__span-0-2659"><a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>
</span><span id="__span-0-2660"><a id="__codelineno-0-2660" name="__codelineno-0-2660"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2661"><a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>        <span class="s2">&quot;Get list of M365 Teams Apps for user -&gt; </span><span class="si">%s</span><span class="s2"> using query -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2662"><a id="__codelineno-0-2662" name="__codelineno-0-2662"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2663"><a id="__codelineno-0-2663" name="__codelineno-0-2663"></a>        <span class="n">query</span><span class="p">,</span>
</span><span id="__span-0-2664"><a id="__codelineno-0-2664" name="__codelineno-0-2664"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2665"><a id="__codelineno-0-2665" name="__codelineno-0-2665"></a>    <span class="p">)</span>
</span><span id="__span-0-2666"><a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>
</span><span id="__span-0-2667"><a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2668"><a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>
</span><span id="__span-0-2669"><a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2670"><a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2671"><a id="__codelineno-0-2671" name="__codelineno-0-2671"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2672"><a id="__codelineno-0-2672" name="__codelineno-0-2672"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2673"><a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2674"><a id="__codelineno-0-2674" name="__codelineno-0-2674"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 Teams apps for user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2675"><a id="__codelineno-0-2675" name="__codelineno-0-2675"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-2676"><a id="__codelineno-0-2676" name="__codelineno-0-2676"></a>        <span class="p">),</span>
</span><span id="__span-0-2677"><a id="__codelineno-0-2677" name="__codelineno-0-2677"></a>    <span class="p">)</span>
</span><span id="__span-0-2678"><a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>
</span><span id="__span-0-2679"><a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_user</span><span class="p">(</span><span class="n">user_email</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a M365 User based on its email or ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_email</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 user email.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the M365 user (alternatively to user_email). Optional.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be displayed if the
user is not found.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>User information or None if the user couldn't be retrieved (e.g. because it doesn't exist
or if there is a permission problem).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users/$entity',
    'businessPhones': [],
    'displayName': 'Bob Davis',
    'givenName': 'Bob',
    'id': '72c80809-094f-4e6e-98d4-25a736385d10',
    'jobTitle': None,
    'mail': 'bdavis@M365x61936377.onmicrosoft.com',
    'mobilePhone': None,
    'officeLocation': None,
    'preferredLanguage': None,
    'surname': 'Davis',
    'userPrincipalName': 'bdavis@M365x61936377.onmicrosoft.com'
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span>
<span class="normal"><a href="#__codelineno-0-991">991</a></span>
<span class="normal"><a href="#__codelineno-0-992">992</a></span>
<span class="normal"><a href="#__codelineno-0-993">993</a></span>
<span class="normal"><a href="#__codelineno-0-994">994</a></span>
<span class="normal"><a href="#__codelineno-0-995">995</a></span>
<span class="normal"><a href="#__codelineno-0-996">996</a></span>
<span class="normal"><a href="#__codelineno-0-997">997</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a M365 User based on its email or ID.</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    Args:</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        user_email (str):</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            The M365 user email.</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        user_id (str | None, optional):</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            The ID of the M365 user (alternatively to user_email). Optional.</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">        show_error (bool):</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            Whether or not an error should be displayed if the</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">            user is not found.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        dict:</span>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            User information or None if the user couldn&#39;t be retrieved (e.g. because it doesn&#39;t exist</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            or if there is a permission problem).</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">    Example:</span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        {</span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#users/$entity&#39;,</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            &#39;businessPhones&#39;: [],</span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            &#39;displayName&#39;: &#39;Bob Davis&#39;,</span>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            &#39;givenName&#39;: &#39;Bob&#39;,</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            &#39;id&#39;: &#39;72c80809-094f-4e6e-98d4-25a736385d10&#39;,</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            &#39;jobTitle&#39;: None,</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            &#39;mail&#39;: &#39;bdavis@M365x61936377.onmicrosoft.com&#39;,</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            &#39;mobilePhone&#39;: None,</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            &#39;officeLocation&#39;: None,</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">            &#39;preferredLanguage&#39;: None,</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">            &#39;surname&#39;: &#39;Davis&#39;,</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            &#39;userPrincipalName&#39;: &#39;bdavis@M365x61936377.onmicrosoft.com&#39;</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        }</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="c1"># Some sanity checks:</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="k">if</span> <span class="n">user_email</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;@&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_email</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_email</span><span class="p">):</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="s2">&quot;User email -&gt; </span><span class="si">%s</span><span class="s2"> is not a valid email address!&quot;</span><span class="p">,</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="p">)</span>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="c1"># if there&#39;s an alias in the E-Mail Adress we remove it as</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>    <span class="c1"># MS Graph seems to not support an alias to lookup a user object.</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">if</span> <span class="n">user_email</span> <span class="ow">and</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">user_email</span><span class="p">:</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a>            <span class="s2">&quot;Removing Alias from email address -&gt; </span><span class="si">%s</span><span class="s2"> to determine M365 principal name...&quot;</span><span class="p">,</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="p">)</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="c1"># Find the index of the &#39;+&#39; character</span>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="n">alias_index</span> <span class="o">=</span> <span class="n">user_email</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="c1"># Find the index of the &#39;@&#39; character</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="n">domain_index</span> <span class="o">=</span> <span class="n">user_email</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="c1"># Construct the email address without the alias</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="n">user_email</span> <span class="o">=</span> <span class="n">user_email</span><span class="p">[:</span><span class="n">alias_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">user_email</span><span class="p">[</span><span class="n">domain_index</span><span class="p">:]</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a>            <span class="s2">&quot;M365 user principal name -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a>            <span class="n">user_email</span><span class="p">,</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="p">)</span>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_email</span> <span class="k">if</span> <span class="n">user_email</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">)</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="s2">&quot;Get M365 user -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">user_email</span> <span class="k">if</span> <span class="n">user_email</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="p">)</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_email</span> <span class="k">if</span> <span class="n">user_email</span> <span class="k">else</span> <span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_user_drive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_user_drive</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">me</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the mysite (OneDrive) of the user.</p>
<p>It may be required to do this before certain other operations
are possible. These operations may require that the mydrive
is initialized for that user. If you get errors like
"User's mysite not found." this may be the case.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>me</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should be True if the user itself is accessing the drive.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of user licenses or None if request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
{
    '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#drives/$entity',
    'createdDateTime': '2025-04-10T23:43:26Z',
    'description': '',
    'id': 'b!VsxYN1IbrEqbiwMiba_M7FCkNAhL5LRFnQEZpEYbxDAxvvcvUMAhSqfgWW_4eAUP',
    'lastModifiedDateTime': '2025-04-12T15:50:20Z',
    'name': 'OneDrive',
    'webUrl': 'https://ideateqa-my.sharepoint.com/personal/jbenham_qa_idea-te_eimdemo_com/Documents',
    'driveType': 'business',
    'createdBy': {
        'user': {
            'displayName': 'System Account'
        }
    },
    'lastModifiedBy': {
        'user': {
            'email': 'jbenham@qa.idea-te.eimdemo.com',
            'id': '470060cc-4d9f-439e-8a6e-8d567c5bda80',
            'displayName': 'Jeff Benham'
        }
    },
    'owner': {
        'user': {...}
    },
    'quota': {
        'deleted': 0,
        'remaining': 1099511518137,
        'state': 'normal',
        'total': 1099511627776,
        'used': 109639
    }
}</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_user_drive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">me</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the mysite (OneDrive) of the user.</span>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">    It may be required to do this before certain other operations</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">    are possible. These operations may require that the mydrive</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><span class="sd">    is initialized for that user. If you get errors like</span>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">    &quot;User&#39;s mysite not found.&quot; this may be the case.</span>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">        me (bool, optional):</span>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">            Should be True if the user itself is accessing the drive.</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">        dict:</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">            A list of user licenses or None if request fails.</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">    {</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">        &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#drives/$entity&#39;,</span>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">        &#39;createdDateTime&#39;: &#39;2025-04-10T23:43:26Z&#39;,</span>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">        &#39;description&#39;: &#39;&#39;,</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="sd">        &#39;id&#39;: &#39;b!VsxYN1IbrEqbiwMiba_M7FCkNAhL5LRFnQEZpEYbxDAxvvcvUMAhSqfgWW_4eAUP&#39;,</span>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">        &#39;lastModifiedDateTime&#39;: &#39;2025-04-12T15:50:20Z&#39;,</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">        &#39;name&#39;: &#39;OneDrive&#39;,</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">        &#39;webUrl&#39;: &#39;https://ideateqa-my.sharepoint.com/personal/jbenham_qa_idea-te_eimdemo_com/Documents&#39;,</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">        &#39;driveType&#39;: &#39;business&#39;,</span>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">        &#39;createdBy&#39;: {</span>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">            &#39;user&#39;: {</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">                &#39;displayName&#39;: &#39;System Account&#39;</span>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">            }</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a><span class="sd">        },</span>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a><span class="sd">        &#39;lastModifiedBy&#39;: {</span>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">            &#39;user&#39;: {</span>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">                &#39;email&#39;: &#39;jbenham@qa.idea-te.eimdemo.com&#39;,</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">                &#39;id&#39;: &#39;470060cc-4d9f-439e-8a6e-8d567c5bda80&#39;,</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a><span class="sd">                &#39;displayName&#39;: &#39;Jeff Benham&#39;</span>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a><span class="sd">            }</span>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a><span class="sd">        },</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a><span class="sd">        &#39;owner&#39;: {</span>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><span class="sd">            &#39;user&#39;: {...}</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><span class="sd">        },</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="sd">        &#39;quota&#39;: {</span>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><span class="sd">            &#39;deleted&#39;: 0,</span>
</span><span id="__span-0-1422"><a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="sd">            &#39;remaining&#39;: 1099511518137,</span>
</span><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">            &#39;state&#39;: &#39;normal&#39;,</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">            &#39;total&#39;: 1099511627776,</span>
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">            &#39;used&#39;: 109639</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">        }</span>
</span><span id="__span-0-1427"><a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><span class="sd">    }</span>
</span><span id="__span-0-1428"><a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>
</span><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;meUrl&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">me</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>    <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/drive&quot;</span>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header_user</span><span class="p">()</span> <span class="k">if</span> <span class="n">me</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get mySite (drive) of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_user_licenses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_user_licenses</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the assigned license SKUs of a user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of user licenses or None if request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>{
    '@odata.context': "https://graph.microsoft.com/v1.0/$metadata#users('a5875311-f0a5-486d-a746-bd7372b91115')/licenseDetails",
    'value': [
        {
            'id': '8DRPYHK6IUOra-Nq6L0A7GAn38eBLPdOtXhbU5K1cd8',
            'skuId': 'c7df2760-2c81-4ef7-b578-5b5392b571df',
            'skuPartNumber': 'ENTERPRISEPREMIUM',
            'servicePlans': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, ...]
        }
    ]
}</p>
</details>

            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_user_licenses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the assigned license SKUs of a user.</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">        dict:</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">            A list of user licenses or None if request fails.</span>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">    Example:</span>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">        {</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#users(&#39;a5875311-f0a5-486d-a746-bd7372b91115&#39;)/licenseDetails&quot;,</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            &#39;value&#39;: [</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">                {</span>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">                    &#39;id&#39;: &#39;8DRPYHK6IUOra-Nq6L0A7GAn38eBLPdOtXhbU5K1cd8&#39;,</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">                    &#39;skuId&#39;: &#39;c7df2760-2c81-4ef7-b578-5b5392b571df&#39;,</span>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">                    &#39;skuPartNumber&#39;: &#39;ENTERPRISEPREMIUM&#39;,</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">                    &#39;servicePlans&#39;: [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, ...]</span>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">                }</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            ]</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        }</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/licenseDetails&quot;</span>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get M365 licenses of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_user_photo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_user_photo</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the photo of a M365 user.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be logged if the user
does not have a photo in M365.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bytes</code></td>            <td>
                  <code><span title="bytes">bytes</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image of the user photo or None if the user photo couldn't be retrieved.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_user_photo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the photo of a M365 user.</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">            Whether or not an error should be logged if the user</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">            does not have a photo in M365.</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">        bytes:</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">            Image of the user photo or None if the user photo couldn&#39;t be retrieved.</span>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/photo/$value&quot;</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>    <span class="c1"># Set image as content type:</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">(</span><span class="s2">&quot;image/*&quot;</span><span class="p">)</span>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>        <span class="s2">&quot;Get photo of user -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="p">)</span>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get photo of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>        <span class="n">warning_message</span><span class="o">=</span><span class="s2">&quot;M365 User -&gt; </span><span class="si">{}</span><span class="s2"> does not yet have a photo.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>        <span class="p">),</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># the response is NOT JSON!</span>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>    <span class="p">)</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>  <span class="c1"># this is the actual image - not json!</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_users" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_users</span><span class="p">(</span><span class="n">max_number</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">next_page_url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get list all all users in M365 tenant.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>max_number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum result values (limit).</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>next_page_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MS Graph URL to retrieve the next page of M365 users (pagination).
This is used for the iterator get_users_iterator() below.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Dictionary of all M365 users.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="n">next_page_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get list all all users in M365 tenant.</span>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a>
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">    Args:</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        max_number (int, optional):</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">            The maximum result values (limit).</span>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        next_page_url (str, optional):</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">            The MS Graph URL to retrieve the next page of M365 users (pagination).</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">            This is used for the iterator get_users_iterator() below.</span>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">            Dictionary of all M365 users.</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="n">next_page_url</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="s2">&quot;Get list of all M365 users</span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="s2">&quot; (paged)&quot;</span> <span class="k">if</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="p">)</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;$top&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_number</span><span class="p">)}</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to get list of M365 users!&quot;</span><span class="p">,</span>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="p">)</span>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.get_users_iterator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_users_iterator</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get an iterator object that can be used to traverse all M365 users.</p>
<p>Returning a generator avoids loading a large number of nodes into memory at once. Instead you
can iterate over the potential large list of users.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>users = m365_object.get_users_iterator()
for user in users:
    logger.info("Traversing M365 user -&gt; '%s'...", user.get("displayName", "<undefined name>"))</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>iter</code></td>            <td>
                  <code><span title="iter">iter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A generator yielding one M365 user per iteration.
If the REST API fails, returns no value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_users_iterator</span><span class="p">(</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">iter</span><span class="p">:</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an iterator object that can be used to traverse all M365 users.</span>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">    Returning a generator avoids loading a large number of nodes into memory at once. Instead you</span>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    can iterate over the potential large list of users.</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    Example usage:</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        users = m365_object.get_users_iterator()</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        for user in users:</span>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">            logger.info(&quot;Traversing M365 user -&gt; &#39;%s&#39;...&quot;, user.get(&quot;displayName&quot;, &quot;&lt;undefined name&gt;&quot;))</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        iter:</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">            A generator yielding one M365 user per iteration.</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">            If the REST API fails, returns no value.</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="n">next_page_url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_users</span><span class="p">(</span>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a>            <span class="n">next_page_url</span><span class="o">=</span><span class="n">next_page_url</span><span class="p">,</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="p">)</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>            <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="k">return</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a>        <span class="c1"># Yield users one at a time:</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="k">yield from</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="c1"># See if we have an additional result page.</span>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="c1"># If not terminate the iterator and return</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="c1"># no value.</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="n">next_page_url</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.nextLink&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">next_page_url</span><span class="p">:</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a>            <span class="c1"># Don&#39;t return None! Plain return is what we need for iterators.</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a>            <span class="c1"># Natural Termination: If the generator does not yield, it behaves</span>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="c1"># like an empty iterable when used in a loop or converted to a list:</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="k">return</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.has_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_team</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a M365 Group has a M365 Team connected or not.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns True if a Team is assigned and False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1998"><a id="__codelineno-0-1998" name="__codelineno-0-1998"></a><span class="k">def</span><span class="w"> </span><span class="nf">has_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1999"><a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a M365 Group has a M365 Team connected or not.</span>
</span><span id="__span-0-2000"><a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
</span><span id="__span-0-2001"><a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2002"><a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><span class="sd">        group_name (str):</span>
</span><span id="__span-0-2003"><a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">            The name of the M365 group.</span>
</span><span id="__span-0-2004"><a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>
</span><span id="__span-0-2005"><a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2006"><a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><span class="sd">        bool:</span>
</span><span id="__span-0-2007"><a id="__codelineno-0-2007" name="__codelineno-0-2007"></a><span class="sd">            Returns True if a Team is assigned and False otherwise.</span>
</span><span id="__span-0-2008"><a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
</span><span id="__span-0-2009"><a id="__codelineno-0-2009" name="__codelineno-0-2009"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2010"><a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>
</span><span id="__span-0-2011"><a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2012"><a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>    <span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2013"><a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_id</span><span class="p">:</span>
</span><span id="__span-0-2014"><a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2015"><a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>            <span class="s2">&quot;M365 Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found! Cannot check if it has a M365 Team.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2016"><a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2017"><a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>        <span class="p">)</span>
</span><span id="__span-0-2018"><a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2019"><a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>
</span><span id="__span-0-2020"><a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">group_id</span> <span class="o">+</span> <span class="s2">&quot;/team&quot;</span>
</span><span id="__span-0-2021"><a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-2022"><a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>
</span><span id="__span-0-2023"><a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2024"><a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>        <span class="s2">&quot;Check if M365 Group -&gt; </span><span class="si">%s</span><span class="s2"> has a M365 Team connected; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2025"><a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>        <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2026"><a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2027"><a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>    <span class="p">)</span>
</span><span id="__span-0-2028"><a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>
</span><span id="__span-0-2029"><a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2030"><a id="__codelineno-0-2030" name="__codelineno-0-2030"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2031"><a id="__codelineno-0-2031" name="__codelineno-0-2031"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-2032"><a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2033"><a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2034"><a id="__codelineno-0-2034" name="__codelineno-0-2034"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to check if M365 Group -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; has a M365 Team connected&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2035"><a id="__codelineno-0-2035" name="__codelineno-0-2035"></a>            <span class="n">group_name</span><span class="p">,</span>
</span><span id="__span-0-2036"><a id="__codelineno-0-2036" name="__codelineno-0-2036"></a>        <span class="p">),</span>
</span><span id="__span-0-2037"><a id="__codelineno-0-2037" name="__codelineno-0-2037"></a>        <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2038"><a id="__codelineno-0-2038" name="__codelineno-0-2038"></a>        <span class="n">show_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2039"><a id="__codelineno-0-2039" name="__codelineno-0-2039"></a>    <span class="p">)</span>
</span><span id="__span-0-2040"><a id="__codelineno-0-2040" name="__codelineno-0-2040"></a>
</span><span id="__span-0-2041"><a id="__codelineno-0-2041" name="__codelineno-0-2041"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>  <span class="c1"># Group has a Team assigned!</span>
</span><span id="__span-0-2042"><a id="__codelineno-0-2042" name="__codelineno-0-2042"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has a M365 Team connected.&quot;</span><span class="p">,</span> <span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2043"><a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-0-2044"><a id="__codelineno-0-2044" name="__codelineno-0-2044"></a>    <span class="k">elif</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>  <span class="c1"># Group does not have a Team assigned!</span>
</span><span id="__span-0-2045"><a id="__codelineno-0-2045" name="__codelineno-0-2045"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Group -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; has no M365 Team connected.&quot;</span><span class="p">,</span> <span class="n">group_name</span><span class="p">)</span>
</span><span id="__span-0-2046"><a id="__codelineno-0-2046" name="__codelineno-0-2046"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-0-2047"><a id="__codelineno-0-2047" name="__codelineno-0-2047"></a>
</span><span id="__span-0-2048"><a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>    <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.is_member" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_member</span><span class="p">(</span><span class="n">group_id</span><span class="p">,</span> <span class="n">member_id</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check whether a M365 user is already in a M365 group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>member_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (member).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not an error should be logged if the user
is not a member of the group.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the user is in the group. False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1792"><a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">member_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-1793"><a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether a M365 user is already in a M365 group.</span>
</span><span id="__span-0-1794"><a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>
</span><span id="__span-0-1795"><a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1796"><a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">        group_id (str):</span>
</span><span id="__span-0-1797"><a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">            The M365 GUID of the group.</span>
</span><span id="__span-0-1798"><a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><span class="sd">        member_id (str):</span>
</span><span id="__span-0-1799"><a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">            The M365 GUID of the user (member).</span>
</span><span id="__span-0-1800"><a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">        show_error (bool):</span>
</span><span id="__span-0-1801"><a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">            Whether or not an error should be logged if the user</span>
</span><span id="__span-0-1802"><a id="__codelineno-0-1802" name="__codelineno-0-1802"></a><span class="sd">            is not a member of the group.</span>
</span><span id="__span-0-1803"><a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>
</span><span id="__span-0-1804"><a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1805"><a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">        bool:</span>
</span><span id="__span-0-1806"><a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">            True if the user is in the group. False otherwise.</span>
</span><span id="__span-0-1807"><a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>
</span><span id="__span-0-1808"><a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1809"><a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>
</span><span id="__span-0-1810"><a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>    <span class="c1"># don&#39;t encode this URL - this has not been working!!</span>
</span><span id="__span-0-1811"><a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;groupsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">group_id</span><span class="si">}</span><span class="s2">/members?$filter=id eq &#39;</span><span class="si">{</span><span class="n">member_id</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-1812"><a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1813"><a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>
</span><span id="__span-0-1814"><a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1815"><a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>        <span class="s2">&quot;Check if user -&gt; </span><span class="si">%s</span><span class="s2"> is in group -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1816"><a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>        <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1817"><a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>        <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1818"><a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1819"><a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>    <span class="p">)</span>
</span><span id="__span-0-1820"><a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>
</span><span id="__span-0-1821"><a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1822"><a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1823"><a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span id="__span-0-1824"><a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1825"><a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1826"><a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to check if M365 user -&gt; </span><span class="si">{}</span><span class="s2"> is in M365 group -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1827"><a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>            <span class="n">member_id</span><span class="p">,</span>
</span><span id="__span-0-1828"><a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>            <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-1829"><a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>        <span class="p">),</span>
</span><span id="__span-0-1830"><a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>        <span class="n">show_error</span><span class="o">=</span><span class="n">show_error</span><span class="p">,</span>
</span><span id="__span-0-1831"><a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>    <span class="p">)</span>
</span><span id="__span-0-1832"><a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
</span><span id="__span-0-1833"><a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.lookup_result_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lookup_result_value</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">return_key</span><span class="p">,</span> <span class="n">sub_dict_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Look up a property value for a provided key-value pair of a REST response.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The REST response from an OTCS REST call, containing property data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Property name (key) to match in the response.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to find in the item with the matching key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the dictionary key whose value should be returned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_dict_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Some MS Graph API calls include nested dict structures that can
be requested with an "expand" query parameter. In such
a case we use the sub_dict_name to access it.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None:
The value of the property specified by "return_key" if found,
or None if the lookup fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="k">def</span><span class="w"> </span><span class="nf">lookup_result_value</span><span class="p">(</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="n">response</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="n">return_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">sub_dict_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up a property value for a provided key-value pair of a REST response.</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">    Args:</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">        response (dict):</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            The REST response from an OTCS REST call, containing property data.</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        key (str):</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">            Property name (key) to match in the response.</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        value (str):</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            Value to find in the item with the matching key.</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        return_key (str):</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            Name of the dictionary key whose value should be returned.</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">        sub_dict_name (str):</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            Some MS Graph API calls include nested dict structures that can</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            be requested with an &quot;expand&quot; query parameter. In such</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            a case we use the sub_dict_name to access it.</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        str | None:</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            The value of the property specified by &quot;return_key&quot; if found,</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            or None if the lookup fails.</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="c1"># check if results is a list or a dict (both is possible -</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="c1"># dependent on the actual REST API):</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="c1"># result is a dict - we don&#39;t need index value:</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">and</span> <span class="n">sub_dict_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">results</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">return_key</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="n">return_key</span><span class="p">]</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="c1"># result is a list - we need index value</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="k">if</span> <span class="n">sub_dict_name</span> <span class="ow">and</span> <span class="n">sub_dict_name</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">sub_dict_name</span><span class="p">]</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">return_key</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">return_key</span><span class="p">]</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="s2">&quot;Result needs to be a list or dictionary but it is of type -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">results</span><span class="p">)),</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="p">)</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.parse_request_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response_object</span><span class="p">,</span> <span class="n">additional_error_message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">show_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the request response (JSon) to a Python dict in a safe way.</p>
<p>It first tries to load the response.text via json.loads() that produces a
dict output. Only if response.text is not set or is empty it just converts the
response_object to a dict using the vars() built-in method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>response_object</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This is reponse object delivered by the request call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>additional_error_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use a more specific error message in case of an error.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_error</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True: write an error to the log file
False: write a warning to the log file</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>API response information or None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_request_response</span><span class="p">(</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">response_object</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span><span class="p">,</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">additional_error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">show_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the request response (JSon) to a Python dict in a safe way.</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    It first tries to load the response.text via json.loads() that produces a</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    dict output. Only if response.text is not set or is empty it just converts the</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">    response_object to a dict using the vars() built-in method.</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Args:</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        response_object (object):</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">            This is reponse object delivered by the request call.</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        additional_error_message (str, optional):</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">            Use a more specific error message in case of an error.</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        show_error (bool, optional):</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            True: write an error to the log file</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            False: write a warning to the log file</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        dict:</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">            API response information or None in case of an error.</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response_object</span><span class="p">:</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">dict_object</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response_object</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="n">response_object</span><span class="o">.</span><span class="n">text</span> <span class="k">else</span> <span class="nb">vars</span><span class="p">(</span><span class="n">response_object</span><span class="p">)</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="k">if</span> <span class="n">additional_error_message</span><span class="p">:</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Cannot decode response as JSon. </span><span class="si">{}</span><span class="s2">; error -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>                <span class="n">additional_error_message</span><span class="p">,</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>                <span class="n">exception</span><span class="p">,</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="p">)</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Cannot decode response as JSon; error -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="n">exception</span><span class="p">,</span>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="p">)</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="k">if</span> <span class="n">show_error</span><span class="p">:</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">return</span> <span class="n">dict_object</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.publish_sharepoint_page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Publish a page of a SharePoint site.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site the page should be published on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the page to be published.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True = Success, False = Error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-4933">4933</a></span>
<span class="normal"><a href="#__codelineno-0-4934">4934</a></span>
<span class="normal"><a href="#__codelineno-0-4935">4935</a></span>
<span class="normal"><a href="#__codelineno-0-4936">4936</a></span>
<span class="normal"><a href="#__codelineno-0-4937">4937</a></span>
<span class="normal"><a href="#__codelineno-0-4938">4938</a></span>
<span class="normal"><a href="#__codelineno-0-4939">4939</a></span>
<span class="normal"><a href="#__codelineno-0-4940">4940</a></span>
<span class="normal"><a href="#__codelineno-0-4941">4941</a></span>
<span class="normal"><a href="#__codelineno-0-4942">4942</a></span>
<span class="normal"><a href="#__codelineno-0-4943">4943</a></span>
<span class="normal"><a href="#__codelineno-0-4944">4944</a></span>
<span class="normal"><a href="#__codelineno-0-4945">4945</a></span>
<span class="normal"><a href="#__codelineno-0-4946">4946</a></span>
<span class="normal"><a href="#__codelineno-0-4947">4947</a></span>
<span class="normal"><a href="#__codelineno-0-4948">4948</a></span>
<span class="normal"><a href="#__codelineno-0-4949">4949</a></span>
<span class="normal"><a href="#__codelineno-0-4950">4950</a></span>
<span class="normal"><a href="#__codelineno-0-4951">4951</a></span>
<span class="normal"><a href="#__codelineno-0-4952">4952</a></span>
<span class="normal"><a href="#__codelineno-0-4953">4953</a></span>
<span class="normal"><a href="#__codelineno-0-4954">4954</a></span>
<span class="normal"><a href="#__codelineno-0-4955">4955</a></span>
<span class="normal"><a href="#__codelineno-0-4956">4956</a></span>
<span class="normal"><a href="#__codelineno-0-4957">4957</a></span>
<span class="normal"><a href="#__codelineno-0-4958">4958</a></span>
<span class="normal"><a href="#__codelineno-0-4959">4959</a></span>
<span class="normal"><a href="#__codelineno-0-4960">4960</a></span>
<span class="normal"><a href="#__codelineno-0-4961">4961</a></span>
<span class="normal"><a href="#__codelineno-0-4962">4962</a></span>
<span class="normal"><a href="#__codelineno-0-4963">4963</a></span>
<span class="normal"><a href="#__codelineno-0-4964">4964</a></span>
<span class="normal"><a href="#__codelineno-0-4965">4965</a></span>
<span class="normal"><a href="#__codelineno-0-4966">4966</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4933"><a id="__codelineno-0-4933" name="__codelineno-0-4933"></a><span class="k">def</span><span class="w"> </span><span class="nf">publish_sharepoint_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-4934"><a id="__codelineno-0-4934" name="__codelineno-0-4934"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Publish a page of a SharePoint site.</span>
</span><span id="__span-0-4935"><a id="__codelineno-0-4935" name="__codelineno-0-4935"></a>
</span><span id="__span-0-4936"><a id="__codelineno-0-4936" name="__codelineno-0-4936"></a><span class="sd">    Args:</span>
</span><span id="__span-0-4937"><a id="__codelineno-0-4937" name="__codelineno-0-4937"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-4938"><a id="__codelineno-0-4938" name="__codelineno-0-4938"></a><span class="sd">            The ID of the SharePoint site the page should be published on.</span>
</span><span id="__span-0-4939"><a id="__codelineno-0-4939" name="__codelineno-0-4939"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-4940"><a id="__codelineno-0-4940" name="__codelineno-0-4940"></a><span class="sd">            The ID of the page to be published.</span>
</span><span id="__span-0-4941"><a id="__codelineno-0-4941" name="__codelineno-0-4941"></a>
</span><span id="__span-0-4942"><a id="__codelineno-0-4942" name="__codelineno-0-4942"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-4943"><a id="__codelineno-0-4943" name="__codelineno-0-4943"></a><span class="sd">        bool:</span>
</span><span id="__span-0-4944"><a id="__codelineno-0-4944" name="__codelineno-0-4944"></a><span class="sd">            True = Success, False = Error.</span>
</span><span id="__span-0-4945"><a id="__codelineno-0-4945" name="__codelineno-0-4945"></a>
</span><span id="__span-0-4946"><a id="__codelineno-0-4946" name="__codelineno-0-4946"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-4947"><a id="__codelineno-0-4947" name="__codelineno-0-4947"></a>
</span><span id="__span-0-4948"><a id="__codelineno-0-4948" name="__codelineno-0-4948"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-4949"><a id="__codelineno-0-4949" name="__codelineno-0-4949"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">site_id</span> <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span> <span class="o">+</span> <span class="n">page_id</span> <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/publish&quot;</span>
</span><span id="__span-0-4950"><a id="__codelineno-0-4950" name="__codelineno-0-4950"></a>    <span class="p">)</span>
</span><span id="__span-0-4951"><a id="__codelineno-0-4951" name="__codelineno-0-4951"></a>
</span><span id="__span-0-4952"><a id="__codelineno-0-4952" name="__codelineno-0-4952"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-4953"><a id="__codelineno-0-4953" name="__codelineno-0-4953"></a>
</span><span id="__span-0-4954"><a id="__codelineno-0-4954" name="__codelineno-0-4954"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-4955"><a id="__codelineno-0-4955" name="__codelineno-0-4955"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-4956"><a id="__codelineno-0-4956" name="__codelineno-0-4956"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-4957"><a id="__codelineno-0-4957" name="__codelineno-0-4957"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-4958"><a id="__codelineno-0-4958" name="__codelineno-0-4958"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-4959"><a id="__codelineno-0-4959" name="__codelineno-0-4959"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot publish SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-4960"><a id="__codelineno-0-4960" name="__codelineno-0-4960"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-4961"><a id="__codelineno-0-4961" name="__codelineno-0-4961"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-4962"><a id="__codelineno-0-4962" name="__codelineno-0-4962"></a>        <span class="p">),</span>
</span><span id="__span-0-4963"><a id="__codelineno-0-4963" name="__codelineno-0-4963"></a>        <span class="n">parse_request_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-4964"><a id="__codelineno-0-4964" name="__codelineno-0-4964"></a>    <span class="p">)</span>
</span><span id="__span-0-4965"><a id="__codelineno-0-4965" name="__codelineno-0-4965"></a>
</span><span id="__span-0-4966"><a id="__codelineno-0-4966" name="__codelineno-0-4966"></a>    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.purge_deleted_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">purge_deleted_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Purge a single deleted user or group.</p>
<p>This requires elevated permissions that are typically
not available via Graph API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>item_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the item to purge.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1963"><a id="__codelineno-0-1963" name="__codelineno-0-1963"></a><span class="k">def</span><span class="w"> </span><span class="nf">purge_deleted_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1964"><a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Purge a single deleted user or group.</span>
</span><span id="__span-0-1965"><a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>
</span><span id="__span-0-1966"><a id="__codelineno-0-1966" name="__codelineno-0-1966"></a><span class="sd">    This requires elevated permissions that are typically</span>
</span><span id="__span-0-1967"><a id="__codelineno-0-1967" name="__codelineno-0-1967"></a><span class="sd">    not available via Graph API.</span>
</span><span id="__span-0-1968"><a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>
</span><span id="__span-0-1969"><a id="__codelineno-0-1969" name="__codelineno-0-1969"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1970"><a id="__codelineno-0-1970" name="__codelineno-0-1970"></a><span class="sd">        item_id (str):</span>
</span><span id="__span-0-1971"><a id="__codelineno-0-1971" name="__codelineno-0-1971"></a><span class="sd">            The M365 GUID of the item to purge.</span>
</span><span id="__span-0-1972"><a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>
</span><span id="__span-0-1973"><a id="__codelineno-0-1973" name="__codelineno-0-1973"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1974"><a id="__codelineno-0-1974" name="__codelineno-0-1974"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1975"><a id="__codelineno-0-1975" name="__codelineno-0-1975"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-1976"><a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>
</span><span id="__span-0-1977"><a id="__codelineno-0-1977" name="__codelineno-0-1977"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1978"><a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>
</span><span id="__span-0-1979"><a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/deletedItems/&quot;</span> <span class="o">+</span> <span class="n">item_id</span>
</span><span id="__span-0-1980"><a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1981"><a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>
</span><span id="__span-0-1982"><a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1983"><a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>        <span class="s2">&quot;Purging deleted item -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1984"><a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>        <span class="n">item_id</span><span class="p">,</span>
</span><span id="__span-0-1985"><a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1986"><a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>    <span class="p">)</span>
</span><span id="__span-0-1987"><a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>
</span><span id="__span-0-1988"><a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1989"><a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1990"><a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-1991"><a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1992"><a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1993"><a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to purge deleted item -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item_id</span><span class="p">),</span>
</span><span id="__span-0-1994"><a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.purge_deleted_items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">purge_deleted_items</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Purge all deleted users and groups.</p>
<p>Purging users and groups requires administrative rights that typically
are not provided in Contoso example org.</p>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1928"><a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><span class="k">def</span><span class="w"> </span><span class="nf">purge_deleted_items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1929"><a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Purge all deleted users and groups.</span>
</span><span id="__span-0-1930"><a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>
</span><span id="__span-0-1931"><a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">    Purging users and groups requires administrative rights that typically</span>
</span><span id="__span-0-1932"><a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">    are not provided in Contoso example org.</span>
</span><span id="__span-0-1933"><a id="__codelineno-0-1933" name="__codelineno-0-1933"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1934"><a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>
</span><span id="__span-0-1935"><a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1936"><a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>
</span><span id="__span-0-1937"><a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/deletedItems/microsoft.graph.group&quot;</span>
</span><span id="__span-0-1938"><a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-0-1939"><a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1940"><a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1941"><a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1942"><a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>    <span class="p">)</span>
</span><span id="__span-0-1943"><a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>    <span class="n">deleted_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-0-1944"><a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>
</span><span id="__span-0-1945"><a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">deleted_groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-0-1946"><a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>        <span class="n">group_id</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-1947"><a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge_deleted_item</span><span class="p">(</span><span class="n">group_id</span><span class="p">)</span>
</span><span id="__span-0-1948"><a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>
</span><span id="__span-0-1949"><a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;directoryUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/deletedItems/microsoft.graph.user&quot;</span>
</span><span id="__span-0-1950"><a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-0-1951"><a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1952"><a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1953"><a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1954"><a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>    <span class="p">)</span>
</span><span id="__span-0-1955"><a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>    <span class="n">deleted_users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_request_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-0-1956"><a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>
</span><span id="__span-0-1957"><a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">deleted_users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-0-1958"><a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>        <span class="n">user_id</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-1959"><a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge_deleted_item</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.remove_teams_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_teams_app</span><span class="p">(</span><span class="n">app_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove MS Teams App from the app catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Microsoft 365 GUID of the MS Teams app.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2870">2870</a></span>
<span class="normal"><a href="#__codelineno-0-2871">2871</a></span>
<span class="normal"><a href="#__codelineno-0-2872">2872</a></span>
<span class="normal"><a href="#__codelineno-0-2873">2873</a></span>
<span class="normal"><a href="#__codelineno-0-2874">2874</a></span>
<span class="normal"><a href="#__codelineno-0-2875">2875</a></span>
<span class="normal"><a href="#__codelineno-0-2876">2876</a></span>
<span class="normal"><a href="#__codelineno-0-2877">2877</a></span>
<span class="normal"><a href="#__codelineno-0-2878">2878</a></span>
<span class="normal"><a href="#__codelineno-0-2879">2879</a></span>
<span class="normal"><a href="#__codelineno-0-2880">2880</a></span>
<span class="normal"><a href="#__codelineno-0-2881">2881</a></span>
<span class="normal"><a href="#__codelineno-0-2882">2882</a></span>
<span class="normal"><a href="#__codelineno-0-2883">2883</a></span>
<span class="normal"><a href="#__codelineno-0-2884">2884</a></span>
<span class="normal"><a href="#__codelineno-0-2885">2885</a></span>
<span class="normal"><a href="#__codelineno-0-2886">2886</a></span>
<span class="normal"><a href="#__codelineno-0-2887">2887</a></span>
<span class="normal"><a href="#__codelineno-0-2888">2888</a></span>
<span class="normal"><a href="#__codelineno-0-2889">2889</a></span>
<span class="normal"><a href="#__codelineno-0-2890">2890</a></span>
<span class="normal"><a href="#__codelineno-0-2891">2891</a></span>
<span class="normal"><a href="#__codelineno-0-2892">2892</a></span>
<span class="normal"><a href="#__codelineno-0-2893">2893</a></span>
<span class="normal"><a href="#__codelineno-0-2894">2894</a></span>
<span class="normal"><a href="#__codelineno-0-2895">2895</a></span>
<span class="normal"><a href="#__codelineno-0-2896">2896</a></span>
<span class="normal"><a href="#__codelineno-0-2897">2897</a></span>
<span class="normal"><a href="#__codelineno-0-2898">2898</a></span>
<span class="normal"><a href="#__codelineno-0-2899">2899</a></span>
<span class="normal"><a href="#__codelineno-0-2900">2900</a></span>
<span class="normal"><a href="#__codelineno-0-2901">2901</a></span>
<span class="normal"><a href="#__codelineno-0-2902">2902</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2870"><a id="__codelineno-0-2870" name="__codelineno-0-2870"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_teams_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2871"><a id="__codelineno-0-2871" name="__codelineno-0-2871"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove MS Teams App from the app catalog.</span>
</span><span id="__span-0-2872"><a id="__codelineno-0-2872" name="__codelineno-0-2872"></a>
</span><span id="__span-0-2873"><a id="__codelineno-0-2873" name="__codelineno-0-2873"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2874"><a id="__codelineno-0-2874" name="__codelineno-0-2874"></a><span class="sd">        app_id (str):</span>
</span><span id="__span-0-2875"><a id="__codelineno-0-2875" name="__codelineno-0-2875"></a><span class="sd">            The Microsoft 365 GUID of the MS Teams app.</span>
</span><span id="__span-0-2876"><a id="__codelineno-0-2876" name="__codelineno-0-2876"></a>
</span><span id="__span-0-2877"><a id="__codelineno-0-2877" name="__codelineno-0-2877"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2878"><a id="__codelineno-0-2878" name="__codelineno-0-2878"></a>
</span><span id="__span-0-2879"><a id="__codelineno-0-2879" name="__codelineno-0-2879"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_id</span>
</span><span id="__span-0-2880"><a id="__codelineno-0-2880" name="__codelineno-0-2880"></a>    <span class="c1"># Here we need the credentials of an authenticated user!</span>
</span><span id="__span-0-2881"><a id="__codelineno-0-2881" name="__codelineno-0-2881"></a>    <span class="c1"># (not the application credentials (client_id, client_secret))</span>
</span><span id="__span-0-2882"><a id="__codelineno-0-2882" name="__codelineno-0-2882"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header_user</span><span class="p">()</span>
</span><span id="__span-0-2883"><a id="__codelineno-0-2883" name="__codelineno-0-2883"></a>
</span><span id="__span-0-2884"><a id="__codelineno-0-2884" name="__codelineno-0-2884"></a>    <span class="c1"># Make the DELETE request to remove the app from the app catalog</span>
</span><span id="__span-0-2885"><a id="__codelineno-0-2885" name="__codelineno-0-2885"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="__span-0-2886"><a id="__codelineno-0-2886" name="__codelineno-0-2886"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2887"><a id="__codelineno-0-2887" name="__codelineno-0-2887"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2888"><a id="__codelineno-0-2888" name="__codelineno-0-2888"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2889"><a id="__codelineno-0-2889" name="__codelineno-0-2889"></a>    <span class="p">)</span>
</span><span id="__span-0-2890"><a id="__codelineno-0-2890" name="__codelineno-0-2890"></a>
</span><span id="__span-0-2891"><a id="__codelineno-0-2891" name="__codelineno-0-2891"></a>    <span class="c1"># Check the status code of the response</span>
</span><span id="__span-0-2892"><a id="__codelineno-0-2892" name="__codelineno-0-2892"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
</span><span id="__span-0-2893"><a id="__codelineno-0-2893" name="__codelineno-0-2893"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2894"><a id="__codelineno-0-2894" name="__codelineno-0-2894"></a>            <span class="s2">&quot;The M365 Teams app with ID -&gt; </span><span class="si">%s</span><span class="s2"> has been successfully removed from the app catalog.&quot;</span><span class="p">,</span>
</span><span id="__span-0-2895"><a id="__codelineno-0-2895" name="__codelineno-0-2895"></a>            <span class="n">app_id</span><span class="p">,</span>
</span><span id="__span-0-2896"><a id="__codelineno-0-2896" name="__codelineno-0-2896"></a>        <span class="p">)</span>
</span><span id="__span-0-2897"><a id="__codelineno-0-2897" name="__codelineno-0-2897"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2898"><a id="__codelineno-0-2898" name="__codelineno-0-2898"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2899"><a id="__codelineno-0-2899" name="__codelineno-0-2899"></a>            <span class="s2">&quot;An error occurred while removing the M365 Teams app from the M365 app catalog. Status code -&gt; </span><span class="si">%s</span><span class="s2">. Error message -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2900"><a id="__codelineno-0-2900" name="__codelineno-0-2900"></a>            <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span><span id="__span-0-2901"><a id="__codelineno-0-2901" name="__codelineno-0-2901"></a>            <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
</span><span id="__span-0-2902"><a id="__codelineno-0-2902" name="__codelineno-0-2902"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.remove_teams_app_from_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_teams_app_from_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">app_installation_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove a M365 Teams app from a M365 user.</p>
<p>See: https://learn.microsoft.com/en-us/graph/api/userteamwork-delete-installedapps?view=graph-rest-1.0&amp;tabs=http</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact name of the app.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_installation_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The installation ID of the app. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3064">3064</a></span>
<span class="normal"><a href="#__codelineno-0-3065">3065</a></span>
<span class="normal"><a href="#__codelineno-0-3066">3066</a></span>
<span class="normal"><a href="#__codelineno-0-3067">3067</a></span>
<span class="normal"><a href="#__codelineno-0-3068">3068</a></span>
<span class="normal"><a href="#__codelineno-0-3069">3069</a></span>
<span class="normal"><a href="#__codelineno-0-3070">3070</a></span>
<span class="normal"><a href="#__codelineno-0-3071">3071</a></span>
<span class="normal"><a href="#__codelineno-0-3072">3072</a></span>
<span class="normal"><a href="#__codelineno-0-3073">3073</a></span>
<span class="normal"><a href="#__codelineno-0-3074">3074</a></span>
<span class="normal"><a href="#__codelineno-0-3075">3075</a></span>
<span class="normal"><a href="#__codelineno-0-3076">3076</a></span>
<span class="normal"><a href="#__codelineno-0-3077">3077</a></span>
<span class="normal"><a href="#__codelineno-0-3078">3078</a></span>
<span class="normal"><a href="#__codelineno-0-3079">3079</a></span>
<span class="normal"><a href="#__codelineno-0-3080">3080</a></span>
<span class="normal"><a href="#__codelineno-0-3081">3081</a></span>
<span class="normal"><a href="#__codelineno-0-3082">3082</a></span>
<span class="normal"><a href="#__codelineno-0-3083">3083</a></span>
<span class="normal"><a href="#__codelineno-0-3084">3084</a></span>
<span class="normal"><a href="#__codelineno-0-3085">3085</a></span>
<span class="normal"><a href="#__codelineno-0-3086">3086</a></span>
<span class="normal"><a href="#__codelineno-0-3087">3087</a></span>
<span class="normal"><a href="#__codelineno-0-3088">3088</a></span>
<span class="normal"><a href="#__codelineno-0-3089">3089</a></span>
<span class="normal"><a href="#__codelineno-0-3090">3090</a></span>
<span class="normal"><a href="#__codelineno-0-3091">3091</a></span>
<span class="normal"><a href="#__codelineno-0-3092">3092</a></span>
<span class="normal"><a href="#__codelineno-0-3093">3093</a></span>
<span class="normal"><a href="#__codelineno-0-3094">3094</a></span>
<span class="normal"><a href="#__codelineno-0-3095">3095</a></span>
<span class="normal"><a href="#__codelineno-0-3096">3096</a></span>
<span class="normal"><a href="#__codelineno-0-3097">3097</a></span>
<span class="normal"><a href="#__codelineno-0-3098">3098</a></span>
<span class="normal"><a href="#__codelineno-0-3099">3099</a></span>
<span class="normal"><a href="#__codelineno-0-3100">3100</a></span>
<span class="normal"><a href="#__codelineno-0-3101">3101</a></span>
<span class="normal"><a href="#__codelineno-0-3102">3102</a></span>
<span class="normal"><a href="#__codelineno-0-3103">3103</a></span>
<span class="normal"><a href="#__codelineno-0-3104">3104</a></span>
<span class="normal"><a href="#__codelineno-0-3105">3105</a></span>
<span class="normal"><a href="#__codelineno-0-3106">3106</a></span>
<span class="normal"><a href="#__codelineno-0-3107">3107</a></span>
<span class="normal"><a href="#__codelineno-0-3108">3108</a></span>
<span class="normal"><a href="#__codelineno-0-3109">3109</a></span>
<span class="normal"><a href="#__codelineno-0-3110">3110</a></span>
<span class="normal"><a href="#__codelineno-0-3111">3111</a></span>
<span class="normal"><a href="#__codelineno-0-3112">3112</a></span>
<span class="normal"><a href="#__codelineno-0-3113">3113</a></span>
<span class="normal"><a href="#__codelineno-0-3114">3114</a></span>
<span class="normal"><a href="#__codelineno-0-3115">3115</a></span>
<span class="normal"><a href="#__codelineno-0-3116">3116</a></span>
<span class="normal"><a href="#__codelineno-0-3117">3117</a></span>
<span class="normal"><a href="#__codelineno-0-3118">3118</a></span>
<span class="normal"><a href="#__codelineno-0-3119">3119</a></span>
<span class="normal"><a href="#__codelineno-0-3120">3120</a></span>
<span class="normal"><a href="#__codelineno-0-3121">3121</a></span>
<span class="normal"><a href="#__codelineno-0-3122">3122</a></span>
<span class="normal"><a href="#__codelineno-0-3123">3123</a></span>
<span class="normal"><a href="#__codelineno-0-3124">3124</a></span>
<span class="normal"><a href="#__codelineno-0-3125">3125</a></span>
<span class="normal"><a href="#__codelineno-0-3126">3126</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3064"><a id="__codelineno-0-3064" name="__codelineno-0-3064"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_teams_app_from_user</span><span class="p">(</span>
</span><span id="__span-0-3065"><a id="__codelineno-0-3065" name="__codelineno-0-3065"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3066"><a id="__codelineno-0-3066" name="__codelineno-0-3066"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3067"><a id="__codelineno-0-3067" name="__codelineno-0-3067"></a>    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3068"><a id="__codelineno-0-3068" name="__codelineno-0-3068"></a>    <span class="n">app_installation_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3069"><a id="__codelineno-0-3069" name="__codelineno-0-3069"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3070"><a id="__codelineno-0-3070" name="__codelineno-0-3070"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove a M365 Teams app from a M365 user.</span>
</span><span id="__span-0-3071"><a id="__codelineno-0-3071" name="__codelineno-0-3071"></a>
</span><span id="__span-0-3072"><a id="__codelineno-0-3072" name="__codelineno-0-3072"></a><span class="sd">       See: https://learn.microsoft.com/en-us/graph/api/userteamwork-delete-installedapps?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-3073"><a id="__codelineno-0-3073" name="__codelineno-0-3073"></a>
</span><span id="__span-0-3074"><a id="__codelineno-0-3074" name="__codelineno-0-3074"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3075"><a id="__codelineno-0-3075" name="__codelineno-0-3075"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-3076"><a id="__codelineno-0-3076" name="__codelineno-0-3076"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-3077"><a id="__codelineno-0-3077" name="__codelineno-0-3077"></a><span class="sd">        app_name (str):</span>
</span><span id="__span-0-3078"><a id="__codelineno-0-3078" name="__codelineno-0-3078"></a><span class="sd">            The exact name of the app.</span>
</span><span id="__span-0-3079"><a id="__codelineno-0-3079" name="__codelineno-0-3079"></a><span class="sd">        app_installation_id (str | None):</span>
</span><span id="__span-0-3080"><a id="__codelineno-0-3080" name="__codelineno-0-3080"></a><span class="sd">            The installation ID of the app. Default is None.</span>
</span><span id="__span-0-3081"><a id="__codelineno-0-3081" name="__codelineno-0-3081"></a>
</span><span id="__span-0-3082"><a id="__codelineno-0-3082" name="__codelineno-0-3082"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3083"><a id="__codelineno-0-3083" name="__codelineno-0-3083"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3084"><a id="__codelineno-0-3084" name="__codelineno-0-3084"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-3085"><a id="__codelineno-0-3085" name="__codelineno-0-3085"></a>
</span><span id="__span-0-3086"><a id="__codelineno-0-3086" name="__codelineno-0-3086"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3087"><a id="__codelineno-0-3087" name="__codelineno-0-3087"></a>
</span><span id="__span-0-3088"><a id="__codelineno-0-3088" name="__codelineno-0-3088"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3089"><a id="__codelineno-0-3089" name="__codelineno-0-3089"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps_of_user</span><span class="p">(</span>
</span><span id="__span-0-3090"><a id="__codelineno-0-3090" name="__codelineno-0-3090"></a>            <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3091"><a id="__codelineno-0-3091" name="__codelineno-0-3091"></a>            <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(teamsAppDefinition/displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3092"><a id="__codelineno-0-3092" name="__codelineno-0-3092"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3093"><a id="__codelineno-0-3093" name="__codelineno-0-3093"></a>            <span class="p">),</span>
</span><span id="__span-0-3094"><a id="__codelineno-0-3094" name="__codelineno-0-3094"></a>        <span class="p">)</span>
</span><span id="__span-0-3095"><a id="__codelineno-0-3095" name="__codelineno-0-3095"></a>        <span class="c1"># Retrieve the installation specific App ID - this is different from thew App catalalog ID!!</span>
</span><span id="__span-0-3096"><a id="__codelineno-0-3096" name="__codelineno-0-3096"></a>        <span class="n">app_installation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3097"><a id="__codelineno-0-3097" name="__codelineno-0-3097"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3098"><a id="__codelineno-0-3098" name="__codelineno-0-3098"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3099"><a id="__codelineno-0-3099" name="__codelineno-0-3099"></a>            <span class="s2">&quot;M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found for user with ID -&gt; </span><span class="si">%s</span><span class="s2">. Cannot remove app from this user!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3100"><a id="__codelineno-0-3100" name="__codelineno-0-3100"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3101"><a id="__codelineno-0-3101" name="__codelineno-0-3101"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3102"><a id="__codelineno-0-3102" name="__codelineno-0-3102"></a>        <span class="p">)</span>
</span><span id="__span-0-3103"><a id="__codelineno-0-3103" name="__codelineno-0-3103"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3104"><a id="__codelineno-0-3104" name="__codelineno-0-3104"></a>
</span><span id="__span-0-3105"><a id="__codelineno-0-3105" name="__codelineno-0-3105"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps/&quot;</span> <span class="o">+</span> <span class="n">app_installation_id</span>
</span><span id="__span-0-3106"><a id="__codelineno-0-3106" name="__codelineno-0-3106"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3107"><a id="__codelineno-0-3107" name="__codelineno-0-3107"></a>
</span><span id="__span-0-3108"><a id="__codelineno-0-3108" name="__codelineno-0-3108"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3109"><a id="__codelineno-0-3109" name="__codelineno-0-3109"></a>        <span class="s2">&quot;Remove M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) from M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3110"><a id="__codelineno-0-3110" name="__codelineno-0-3110"></a>        <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3111"><a id="__codelineno-0-3111" name="__codelineno-0-3111"></a>        <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3112"><a id="__codelineno-0-3112" name="__codelineno-0-3112"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3113"><a id="__codelineno-0-3113" name="__codelineno-0-3113"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3114"><a id="__codelineno-0-3114" name="__codelineno-0-3114"></a>    <span class="p">)</span>
</span><span id="__span-0-3115"><a id="__codelineno-0-3115" name="__codelineno-0-3115"></a>
</span><span id="__span-0-3116"><a id="__codelineno-0-3116" name="__codelineno-0-3116"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3117"><a id="__codelineno-0-3117" name="__codelineno-0-3117"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3118"><a id="__codelineno-0-3118" name="__codelineno-0-3118"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="__span-0-3119"><a id="__codelineno-0-3119" name="__codelineno-0-3119"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3120"><a id="__codelineno-0-3120" name="__codelineno-0-3120"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3121"><a id="__codelineno-0-3121" name="__codelineno-0-3121"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to remove M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) from M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3122"><a id="__codelineno-0-3122" name="__codelineno-0-3122"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3123"><a id="__codelineno-0-3123" name="__codelineno-0-3123"></a>            <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3124"><a id="__codelineno-0-3124" name="__codelineno-0-3124"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3125"><a id="__codelineno-0-3125" name="__codelineno-0-3125"></a>        <span class="p">),</span>
</span><span id="__span-0-3126"><a id="__codelineno-0-3126" name="__codelineno-0-3126"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.request_header" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">request_header</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the request header used for Application calls.</p>
<p>Consists of Bearer access token and Content Type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>content_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The content type for the request. Default is "application/json".</p>
              </div>
            </td>
            <td>
                  <code>&#39;application/json&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The request header values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="k">def</span><span class="w"> </span><span class="nf">request_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the request header used for Application calls.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Consists of Bearer access token and Content Type.</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Args:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        content_type (str, optional):</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            The content type for the request. Default is &quot;application/json&quot;.</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        dict:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            The request header values.</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_access_token</span><span class="p">),</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="n">content_type</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="p">}</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">return</span> <span class="n">request_header</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.request_header_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">request_header_user</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the request header used for user specific calls.</p>
<p>Consists of Bearer access token and Content Type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>content_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The content type for the request.</p>
              </div>
            </td>
            <td>
                  <code>&#39;application/json&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The request header values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="k">def</span><span class="w"> </span><span class="nf">request_header_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the request header used for user specific calls.</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    Consists of Bearer access token and Content Type.</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Args:</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        content_type (str, optional):</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            The content type for the request.</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        dict:</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            The request header values.</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="n">content_type</span><span class="p">,</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="p">}</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span><span class="p">:</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No M365 user is authenticated! Cannot include Bearer token in request header!&quot;</span><span class="p">)</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">request_header</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bearer </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_user_access_token</span><span class="p">)</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">return</span> <span class="n">request_header</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.update_app_registration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_app_registration</span><span class="p">(</span><span class="n">app_registration_id</span><span class="p">,</span> <span class="n">app_registration_name</span><span class="p">,</span> <span class="n">api_permissions</span><span class="p">,</span> <span class="n">supported_account_type</span><span class="o">=</span><span class="s1">&#39;AzureADMyOrg&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update an Azure App Registration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_registration_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the existing App Registration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_registration_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the App Registration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_permissions</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API permissions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>supported_account_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of account that is supposed to use
the App Registration.</p>
              </div>
            </td>
            <td>
                  <code>&#39;AzureADMyOrg&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>App Registration data or None of the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3848">3848</a></span>
<span class="normal"><a href="#__codelineno-0-3849">3849</a></span>
<span class="normal"><a href="#__codelineno-0-3850">3850</a></span>
<span class="normal"><a href="#__codelineno-0-3851">3851</a></span>
<span class="normal"><a href="#__codelineno-0-3852">3852</a></span>
<span class="normal"><a href="#__codelineno-0-3853">3853</a></span>
<span class="normal"><a href="#__codelineno-0-3854">3854</a></span>
<span class="normal"><a href="#__codelineno-0-3855">3855</a></span>
<span class="normal"><a href="#__codelineno-0-3856">3856</a></span>
<span class="normal"><a href="#__codelineno-0-3857">3857</a></span>
<span class="normal"><a href="#__codelineno-0-3858">3858</a></span>
<span class="normal"><a href="#__codelineno-0-3859">3859</a></span>
<span class="normal"><a href="#__codelineno-0-3860">3860</a></span>
<span class="normal"><a href="#__codelineno-0-3861">3861</a></span>
<span class="normal"><a href="#__codelineno-0-3862">3862</a></span>
<span class="normal"><a href="#__codelineno-0-3863">3863</a></span>
<span class="normal"><a href="#__codelineno-0-3864">3864</a></span>
<span class="normal"><a href="#__codelineno-0-3865">3865</a></span>
<span class="normal"><a href="#__codelineno-0-3866">3866</a></span>
<span class="normal"><a href="#__codelineno-0-3867">3867</a></span>
<span class="normal"><a href="#__codelineno-0-3868">3868</a></span>
<span class="normal"><a href="#__codelineno-0-3869">3869</a></span>
<span class="normal"><a href="#__codelineno-0-3870">3870</a></span>
<span class="normal"><a href="#__codelineno-0-3871">3871</a></span>
<span class="normal"><a href="#__codelineno-0-3872">3872</a></span>
<span class="normal"><a href="#__codelineno-0-3873">3873</a></span>
<span class="normal"><a href="#__codelineno-0-3874">3874</a></span>
<span class="normal"><a href="#__codelineno-0-3875">3875</a></span>
<span class="normal"><a href="#__codelineno-0-3876">3876</a></span>
<span class="normal"><a href="#__codelineno-0-3877">3877</a></span>
<span class="normal"><a href="#__codelineno-0-3878">3878</a></span>
<span class="normal"><a href="#__codelineno-0-3879">3879</a></span>
<span class="normal"><a href="#__codelineno-0-3880">3880</a></span>
<span class="normal"><a href="#__codelineno-0-3881">3881</a></span>
<span class="normal"><a href="#__codelineno-0-3882">3882</a></span>
<span class="normal"><a href="#__codelineno-0-3883">3883</a></span>
<span class="normal"><a href="#__codelineno-0-3884">3884</a></span>
<span class="normal"><a href="#__codelineno-0-3885">3885</a></span>
<span class="normal"><a href="#__codelineno-0-3886">3886</a></span>
<span class="normal"><a href="#__codelineno-0-3887">3887</a></span>
<span class="normal"><a href="#__codelineno-0-3888">3888</a></span>
<span class="normal"><a href="#__codelineno-0-3889">3889</a></span>
<span class="normal"><a href="#__codelineno-0-3890">3890</a></span>
<span class="normal"><a href="#__codelineno-0-3891">3891</a></span>
<span class="normal"><a href="#__codelineno-0-3892">3892</a></span>
<span class="normal"><a href="#__codelineno-0-3893">3893</a></span>
<span class="normal"><a href="#__codelineno-0-3894">3894</a></span>
<span class="normal"><a href="#__codelineno-0-3895">3895</a></span>
<span class="normal"><a href="#__codelineno-0-3896">3896</a></span>
<span class="normal"><a href="#__codelineno-0-3897">3897</a></span>
<span class="normal"><a href="#__codelineno-0-3898">3898</a></span>
<span class="normal"><a href="#__codelineno-0-3899">3899</a></span>
<span class="normal"><a href="#__codelineno-0-3900">3900</a></span>
<span class="normal"><a href="#__codelineno-0-3901">3901</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3848"><a id="__codelineno-0-3848" name="__codelineno-0-3848"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_app_registration</span><span class="p">(</span>
</span><span id="__span-0-3849"><a id="__codelineno-0-3849" name="__codelineno-0-3849"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3850"><a id="__codelineno-0-3850" name="__codelineno-0-3850"></a>    <span class="n">app_registration_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3851"><a id="__codelineno-0-3851" name="__codelineno-0-3851"></a>    <span class="n">app_registration_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3852"><a id="__codelineno-0-3852" name="__codelineno-0-3852"></a>    <span class="n">api_permissions</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="__span-0-3853"><a id="__codelineno-0-3853" name="__codelineno-0-3853"></a>    <span class="n">supported_account_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AzureADMyOrg&quot;</span><span class="p">,</span>
</span><span id="__span-0-3854"><a id="__codelineno-0-3854" name="__codelineno-0-3854"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-3855"><a id="__codelineno-0-3855" name="__codelineno-0-3855"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update an Azure App Registration.</span>
</span><span id="__span-0-3856"><a id="__codelineno-0-3856" name="__codelineno-0-3856"></a>
</span><span id="__span-0-3857"><a id="__codelineno-0-3857" name="__codelineno-0-3857"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3858"><a id="__codelineno-0-3858" name="__codelineno-0-3858"></a><span class="sd">        app_registration_id (str):</span>
</span><span id="__span-0-3859"><a id="__codelineno-0-3859" name="__codelineno-0-3859"></a><span class="sd">            The ID of the existing App Registration.</span>
</span><span id="__span-0-3860"><a id="__codelineno-0-3860" name="__codelineno-0-3860"></a><span class="sd">        app_registration_name (str):</span>
</span><span id="__span-0-3861"><a id="__codelineno-0-3861" name="__codelineno-0-3861"></a><span class="sd">            The name of the App Registration.</span>
</span><span id="__span-0-3862"><a id="__codelineno-0-3862" name="__codelineno-0-3862"></a><span class="sd">        api_permissions (list):</span>
</span><span id="__span-0-3863"><a id="__codelineno-0-3863" name="__codelineno-0-3863"></a><span class="sd">            The API permissions.</span>
</span><span id="__span-0-3864"><a id="__codelineno-0-3864" name="__codelineno-0-3864"></a><span class="sd">        supported_account_type (str, optional):</span>
</span><span id="__span-0-3865"><a id="__codelineno-0-3865" name="__codelineno-0-3865"></a><span class="sd">            The type of account that is supposed to use</span>
</span><span id="__span-0-3866"><a id="__codelineno-0-3866" name="__codelineno-0-3866"></a><span class="sd">            the App Registration.</span>
</span><span id="__span-0-3867"><a id="__codelineno-0-3867" name="__codelineno-0-3867"></a>
</span><span id="__span-0-3868"><a id="__codelineno-0-3868" name="__codelineno-0-3868"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3869"><a id="__codelineno-0-3869" name="__codelineno-0-3869"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3870"><a id="__codelineno-0-3870" name="__codelineno-0-3870"></a><span class="sd">            App Registration data or None of the request fails.</span>
</span><span id="__span-0-3871"><a id="__codelineno-0-3871" name="__codelineno-0-3871"></a>
</span><span id="__span-0-3872"><a id="__codelineno-0-3872" name="__codelineno-0-3872"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3873"><a id="__codelineno-0-3873" name="__codelineno-0-3873"></a>
</span><span id="__span-0-3874"><a id="__codelineno-0-3874" name="__codelineno-0-3874"></a>    <span class="c1"># Define the request body to create the App Registration</span>
</span><span id="__span-0-3875"><a id="__codelineno-0-3875" name="__codelineno-0-3875"></a>    <span class="n">app_registration_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3876"><a id="__codelineno-0-3876" name="__codelineno-0-3876"></a>        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3877"><a id="__codelineno-0-3877" name="__codelineno-0-3877"></a>        <span class="s2">&quot;requiredResourceAccess&quot;</span><span class="p">:</span> <span class="n">api_permissions</span><span class="p">,</span>
</span><span id="__span-0-3878"><a id="__codelineno-0-3878" name="__codelineno-0-3878"></a>        <span class="s2">&quot;signInAudience&quot;</span><span class="p">:</span> <span class="n">supported_account_type</span><span class="p">,</span>
</span><span id="__span-0-3879"><a id="__codelineno-0-3879" name="__codelineno-0-3879"></a>    <span class="p">}</span>
</span><span id="__span-0-3880"><a id="__codelineno-0-3880" name="__codelineno-0-3880"></a>
</span><span id="__span-0-3881"><a id="__codelineno-0-3881" name="__codelineno-0-3881"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;applicationsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_registration_id</span>
</span><span id="__span-0-3882"><a id="__codelineno-0-3882" name="__codelineno-0-3882"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3883"><a id="__codelineno-0-3883" name="__codelineno-0-3883"></a>
</span><span id="__span-0-3884"><a id="__codelineno-0-3884" name="__codelineno-0-3884"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3885"><a id="__codelineno-0-3885" name="__codelineno-0-3885"></a>        <span class="s2">&quot;Update App Registration -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">); calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3886"><a id="__codelineno-0-3886" name="__codelineno-0-3886"></a>        <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3887"><a id="__codelineno-0-3887" name="__codelineno-0-3887"></a>        <span class="n">app_registration_id</span><span class="p">,</span>
</span><span id="__span-0-3888"><a id="__codelineno-0-3888" name="__codelineno-0-3888"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3889"><a id="__codelineno-0-3889" name="__codelineno-0-3889"></a>    <span class="p">)</span>
</span><span id="__span-0-3890"><a id="__codelineno-0-3890" name="__codelineno-0-3890"></a>
</span><span id="__span-0-3891"><a id="__codelineno-0-3891" name="__codelineno-0-3891"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3892"><a id="__codelineno-0-3892" name="__codelineno-0-3892"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3893"><a id="__codelineno-0-3893" name="__codelineno-0-3893"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-3894"><a id="__codelineno-0-3894" name="__codelineno-0-3894"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3895"><a id="__codelineno-0-3895" name="__codelineno-0-3895"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">app_registration_data</span><span class="p">,</span>
</span><span id="__span-0-3896"><a id="__codelineno-0-3896" name="__codelineno-0-3896"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3897"><a id="__codelineno-0-3897" name="__codelineno-0-3897"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot update App Registration -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3898"><a id="__codelineno-0-3898" name="__codelineno-0-3898"></a>            <span class="n">app_registration_name</span><span class="p">,</span>
</span><span id="__span-0-3899"><a id="__codelineno-0-3899" name="__codelineno-0-3899"></a>            <span class="n">app_registration_id</span><span class="p">,</span>
</span><span id="__span-0-3900"><a id="__codelineno-0-3900" name="__codelineno-0-3900"></a>        <span class="p">),</span>
</span><span id="__span-0-3901"><a id="__codelineno-0-3901" name="__codelineno-0-3901"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.update_sharepoint_webpart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_sharepoint_webpart</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="p">,</span> <span class="n">webpart_id</span><span class="p">,</span> <span class="n">update_data</span><span class="p">,</span> <span class="n">republish</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update a data of a specific web part on a SharePoint page.</p>
<p>Any data elements not provided for the update will remain unchanged!</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint site.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the SharePoint page containing the web part.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>webpart_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the web part to update.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with the updated data items that will be used
to update the "data" structure of the webpart.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>republish</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the page is republished to make the section active.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
The updated web part. None in case of an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5652">5652</a></span>
<span class="normal"><a href="#__codelineno-0-5653">5653</a></span>
<span class="normal"><a href="#__codelineno-0-5654">5654</a></span>
<span class="normal"><a href="#__codelineno-0-5655">5655</a></span>
<span class="normal"><a href="#__codelineno-0-5656">5656</a></span>
<span class="normal"><a href="#__codelineno-0-5657">5657</a></span>
<span class="normal"><a href="#__codelineno-0-5658">5658</a></span>
<span class="normal"><a href="#__codelineno-0-5659">5659</a></span>
<span class="normal"><a href="#__codelineno-0-5660">5660</a></span>
<span class="normal"><a href="#__codelineno-0-5661">5661</a></span>
<span class="normal"><a href="#__codelineno-0-5662">5662</a></span>
<span class="normal"><a href="#__codelineno-0-5663">5663</a></span>
<span class="normal"><a href="#__codelineno-0-5664">5664</a></span>
<span class="normal"><a href="#__codelineno-0-5665">5665</a></span>
<span class="normal"><a href="#__codelineno-0-5666">5666</a></span>
<span class="normal"><a href="#__codelineno-0-5667">5667</a></span>
<span class="normal"><a href="#__codelineno-0-5668">5668</a></span>
<span class="normal"><a href="#__codelineno-0-5669">5669</a></span>
<span class="normal"><a href="#__codelineno-0-5670">5670</a></span>
<span class="normal"><a href="#__codelineno-0-5671">5671</a></span>
<span class="normal"><a href="#__codelineno-0-5672">5672</a></span>
<span class="normal"><a href="#__codelineno-0-5673">5673</a></span>
<span class="normal"><a href="#__codelineno-0-5674">5674</a></span>
<span class="normal"><a href="#__codelineno-0-5675">5675</a></span>
<span class="normal"><a href="#__codelineno-0-5676">5676</a></span>
<span class="normal"><a href="#__codelineno-0-5677">5677</a></span>
<span class="normal"><a href="#__codelineno-0-5678">5678</a></span>
<span class="normal"><a href="#__codelineno-0-5679">5679</a></span>
<span class="normal"><a href="#__codelineno-0-5680">5680</a></span>
<span class="normal"><a href="#__codelineno-0-5681">5681</a></span>
<span class="normal"><a href="#__codelineno-0-5682">5682</a></span>
<span class="normal"><a href="#__codelineno-0-5683">5683</a></span>
<span class="normal"><a href="#__codelineno-0-5684">5684</a></span>
<span class="normal"><a href="#__codelineno-0-5685">5685</a></span>
<span class="normal"><a href="#__codelineno-0-5686">5686</a></span>
<span class="normal"><a href="#__codelineno-0-5687">5687</a></span>
<span class="normal"><a href="#__codelineno-0-5688">5688</a></span>
<span class="normal"><a href="#__codelineno-0-5689">5689</a></span>
<span class="normal"><a href="#__codelineno-0-5690">5690</a></span>
<span class="normal"><a href="#__codelineno-0-5691">5691</a></span>
<span class="normal"><a href="#__codelineno-0-5692">5692</a></span>
<span class="normal"><a href="#__codelineno-0-5693">5693</a></span>
<span class="normal"><a href="#__codelineno-0-5694">5694</a></span>
<span class="normal"><a href="#__codelineno-0-5695">5695</a></span>
<span class="normal"><a href="#__codelineno-0-5696">5696</a></span>
<span class="normal"><a href="#__codelineno-0-5697">5697</a></span>
<span class="normal"><a href="#__codelineno-0-5698">5698</a></span>
<span class="normal"><a href="#__codelineno-0-5699">5699</a></span>
<span class="normal"><a href="#__codelineno-0-5700">5700</a></span>
<span class="normal"><a href="#__codelineno-0-5701">5701</a></span>
<span class="normal"><a href="#__codelineno-0-5702">5702</a></span>
<span class="normal"><a href="#__codelineno-0-5703">5703</a></span>
<span class="normal"><a href="#__codelineno-0-5704">5704</a></span>
<span class="normal"><a href="#__codelineno-0-5705">5705</a></span>
<span class="normal"><a href="#__codelineno-0-5706">5706</a></span>
<span class="normal"><a href="#__codelineno-0-5707">5707</a></span>
<span class="normal"><a href="#__codelineno-0-5708">5708</a></span>
<span class="normal"><a href="#__codelineno-0-5709">5709</a></span>
<span class="normal"><a href="#__codelineno-0-5710">5710</a></span>
<span class="normal"><a href="#__codelineno-0-5711">5711</a></span>
<span class="normal"><a href="#__codelineno-0-5712">5712</a></span>
<span class="normal"><a href="#__codelineno-0-5713">5713</a></span>
<span class="normal"><a href="#__codelineno-0-5714">5714</a></span>
<span class="normal"><a href="#__codelineno-0-5715">5715</a></span>
<span class="normal"><a href="#__codelineno-0-5716">5716</a></span>
<span class="normal"><a href="#__codelineno-0-5717">5717</a></span>
<span class="normal"><a href="#__codelineno-0-5718">5718</a></span>
<span class="normal"><a href="#__codelineno-0-5719">5719</a></span>
<span class="normal"><a href="#__codelineno-0-5720">5720</a></span>
<span class="normal"><a href="#__codelineno-0-5721">5721</a></span>
<span class="normal"><a href="#__codelineno-0-5722">5722</a></span>
<span class="normal"><a href="#__codelineno-0-5723">5723</a></span>
<span class="normal"><a href="#__codelineno-0-5724">5724</a></span>
<span class="normal"><a href="#__codelineno-0-5725">5725</a></span>
<span class="normal"><a href="#__codelineno-0-5726">5726</a></span>
<span class="normal"><a href="#__codelineno-0-5727">5727</a></span>
<span class="normal"><a href="#__codelineno-0-5728">5728</a></span>
<span class="normal"><a href="#__codelineno-0-5729">5729</a></span>
<span class="normal"><a href="#__codelineno-0-5730">5730</a></span>
<span class="normal"><a href="#__codelineno-0-5731">5731</a></span>
<span class="normal"><a href="#__codelineno-0-5732">5732</a></span>
<span class="normal"><a href="#__codelineno-0-5733">5733</a></span>
<span class="normal"><a href="#__codelineno-0-5734">5734</a></span>
<span class="normal"><a href="#__codelineno-0-5735">5735</a></span>
<span class="normal"><a href="#__codelineno-0-5736">5736</a></span>
<span class="normal"><a href="#__codelineno-0-5737">5737</a></span>
<span class="normal"><a href="#__codelineno-0-5738">5738</a></span>
<span class="normal"><a href="#__codelineno-0-5739">5739</a></span>
<span class="normal"><a href="#__codelineno-0-5740">5740</a></span>
<span class="normal"><a href="#__codelineno-0-5741">5741</a></span>
<span class="normal"><a href="#__codelineno-0-5742">5742</a></span>
<span class="normal"><a href="#__codelineno-0-5743">5743</a></span>
<span class="normal"><a href="#__codelineno-0-5744">5744</a></span>
<span class="normal"><a href="#__codelineno-0-5745">5745</a></span>
<span class="normal"><a href="#__codelineno-0-5746">5746</a></span>
<span class="normal"><a href="#__codelineno-0-5747">5747</a></span>
<span class="normal"><a href="#__codelineno-0-5748">5748</a></span>
<span class="normal"><a href="#__codelineno-0-5749">5749</a></span>
<span class="normal"><a href="#__codelineno-0-5750">5750</a></span>
<span class="normal"><a href="#__codelineno-0-5751">5751</a></span>
<span class="normal"><a href="#__codelineno-0-5752">5752</a></span>
<span class="normal"><a href="#__codelineno-0-5753">5753</a></span>
<span class="normal"><a href="#__codelineno-0-5754">5754</a></span>
<span class="normal"><a href="#__codelineno-0-5755">5755</a></span>
<span class="normal"><a href="#__codelineno-0-5756">5756</a></span>
<span class="normal"><a href="#__codelineno-0-5757">5757</a></span>
<span class="normal"><a href="#__codelineno-0-5758">5758</a></span>
<span class="normal"><a href="#__codelineno-0-5759">5759</a></span>
<span class="normal"><a href="#__codelineno-0-5760">5760</a></span>
<span class="normal"><a href="#__codelineno-0-5761">5761</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5652"><a id="__codelineno-0-5652" name="__codelineno-0-5652"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_sharepoint_webpart</span><span class="p">(</span>
</span><span id="__span-0-5653"><a id="__codelineno-0-5653" name="__codelineno-0-5653"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-5654"><a id="__codelineno-0-5654" name="__codelineno-0-5654"></a>    <span class="n">site_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5655"><a id="__codelineno-0-5655" name="__codelineno-0-5655"></a>    <span class="n">page_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5656"><a id="__codelineno-0-5656" name="__codelineno-0-5656"></a>    <span class="n">webpart_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-5657"><a id="__codelineno-0-5657" name="__codelineno-0-5657"></a>    <span class="n">update_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="__span-0-5658"><a id="__codelineno-0-5658" name="__codelineno-0-5658"></a>    <span class="n">republish</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5659"><a id="__codelineno-0-5659" name="__codelineno-0-5659"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5660"><a id="__codelineno-0-5660" name="__codelineno-0-5660"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update a data of a specific web part on a SharePoint page.</span>
</span><span id="__span-0-5661"><a id="__codelineno-0-5661" name="__codelineno-0-5661"></a>
</span><span id="__span-0-5662"><a id="__codelineno-0-5662" name="__codelineno-0-5662"></a><span class="sd">    Any data elements not provided for the update will remain unchanged!</span>
</span><span id="__span-0-5663"><a id="__codelineno-0-5663" name="__codelineno-0-5663"></a>
</span><span id="__span-0-5664"><a id="__codelineno-0-5664" name="__codelineno-0-5664"></a><span class="sd">    Args:</span>
</span><span id="__span-0-5665"><a id="__codelineno-0-5665" name="__codelineno-0-5665"></a><span class="sd">        site_id (str):</span>
</span><span id="__span-0-5666"><a id="__codelineno-0-5666" name="__codelineno-0-5666"></a><span class="sd">            The ID of the SharePoint site.</span>
</span><span id="__span-0-5667"><a id="__codelineno-0-5667" name="__codelineno-0-5667"></a><span class="sd">        page_id (str):</span>
</span><span id="__span-0-5668"><a id="__codelineno-0-5668" name="__codelineno-0-5668"></a><span class="sd">            The ID of the SharePoint page containing the web part.</span>
</span><span id="__span-0-5669"><a id="__codelineno-0-5669" name="__codelineno-0-5669"></a><span class="sd">        webpart_id (str):</span>
</span><span id="__span-0-5670"><a id="__codelineno-0-5670" name="__codelineno-0-5670"></a><span class="sd">            The ID of the web part to update.</span>
</span><span id="__span-0-5671"><a id="__codelineno-0-5671" name="__codelineno-0-5671"></a><span class="sd">        update_data (dict):</span>
</span><span id="__span-0-5672"><a id="__codelineno-0-5672" name="__codelineno-0-5672"></a><span class="sd">            A dictionary with the updated data items that will be used</span>
</span><span id="__span-0-5673"><a id="__codelineno-0-5673" name="__codelineno-0-5673"></a><span class="sd">            to update the &quot;data&quot; structure of the webpart.</span>
</span><span id="__span-0-5674"><a id="__codelineno-0-5674" name="__codelineno-0-5674"></a><span class="sd">        republish (bool, optional):</span>
</span><span id="__span-0-5675"><a id="__codelineno-0-5675" name="__codelineno-0-5675"></a><span class="sd">            If True, the page is republished to make the section active.</span>
</span><span id="__span-0-5676"><a id="__codelineno-0-5676" name="__codelineno-0-5676"></a>
</span><span id="__span-0-5677"><a id="__codelineno-0-5677" name="__codelineno-0-5677"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-5678"><a id="__codelineno-0-5678" name="__codelineno-0-5678"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-5679"><a id="__codelineno-0-5679" name="__codelineno-0-5679"></a><span class="sd">            The updated web part. None in case of an error.</span>
</span><span id="__span-0-5680"><a id="__codelineno-0-5680" name="__codelineno-0-5680"></a>
</span><span id="__span-0-5681"><a id="__codelineno-0-5681" name="__codelineno-0-5681"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-5682"><a id="__codelineno-0-5682" name="__codelineno-0-5682"></a>
</span><span id="__span-0-5683"><a id="__codelineno-0-5683" name="__codelineno-0-5683"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deep_merge</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-0-5684"><a id="__codelineno-0-5684" name="__codelineno-0-5684"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively merges source dictionary into destination dictionary.</span>
</span><span id="__span-0-5685"><a id="__codelineno-0-5685" name="__codelineno-0-5685"></a>
</span><span id="__span-0-5686"><a id="__codelineno-0-5686" name="__codelineno-0-5686"></a><span class="sd">        If a key exists in both, the value from destination is kept unless</span>
</span><span id="__span-0-5687"><a id="__codelineno-0-5687" name="__codelineno-0-5687"></a><span class="sd">        both values are dictionaries, in which case they are merged recursively.</span>
</span><span id="__span-0-5688"><a id="__codelineno-0-5688" name="__codelineno-0-5688"></a>
</span><span id="__span-0-5689"><a id="__codelineno-0-5689" name="__codelineno-0-5689"></a><span class="sd">        Args:</span>
</span><span id="__span-0-5690"><a id="__codelineno-0-5690" name="__codelineno-0-5690"></a><span class="sd">            source (dict):</span>
</span><span id="__span-0-5691"><a id="__codelineno-0-5691" name="__codelineno-0-5691"></a><span class="sd">                The dictionary with the current data values. Will be</span>
</span><span id="__span-0-5692"><a id="__codelineno-0-5692" name="__codelineno-0-5692"></a><span class="sd">                used if not updated data is in update_data for the particular key.</span>
</span><span id="__span-0-5693"><a id="__codelineno-0-5693" name="__codelineno-0-5693"></a><span class="sd">            destination (dict):</span>
</span><span id="__span-0-5694"><a id="__codelineno-0-5694" name="__codelineno-0-5694"></a><span class="sd">                The dictionary to merge into, which takes precedence.</span>
</span><span id="__span-0-5695"><a id="__codelineno-0-5695" name="__codelineno-0-5695"></a>
</span><span id="__span-0-5696"><a id="__codelineno-0-5696" name="__codelineno-0-5696"></a><span class="sd">        Returns:</span>
</span><span id="__span-0-5697"><a id="__codelineno-0-5697" name="__codelineno-0-5697"></a><span class="sd">            dict: The merged dictionary.</span>
</span><span id="__span-0-5698"><a id="__codelineno-0-5698" name="__codelineno-0-5698"></a>
</span><span id="__span-0-5699"><a id="__codelineno-0-5699" name="__codelineno-0-5699"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-5700"><a id="__codelineno-0-5700" name="__codelineno-0-5700"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-5701"><a id="__codelineno-0-5701" name="__codelineno-0-5701"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">destination</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-5702"><a id="__codelineno-0-5702" name="__codelineno-0-5702"></a>                <span class="c1"># Recursively merge dictionaries if both values are dictionaries</span>
</span><span id="__span-0-5703"><a id="__codelineno-0-5703" name="__codelineno-0-5703"></a>                <span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">deep_merge</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="__span-0-5704"><a id="__codelineno-0-5704" name="__codelineno-0-5704"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-5705"><a id="__codelineno-0-5705" name="__codelineno-0-5705"></a>                <span class="c1"># If key does not exist in destination, use value from source</span>
</span><span id="__span-0-5706"><a id="__codelineno-0-5706" name="__codelineno-0-5706"></a>                <span class="n">destination</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-5707"><a id="__codelineno-0-5707" name="__codelineno-0-5707"></a>        <span class="k">return</span> <span class="n">destination</span>
</span><span id="__span-0-5708"><a id="__codelineno-0-5708" name="__codelineno-0-5708"></a>
</span><span id="__span-0-5709"><a id="__codelineno-0-5709" name="__codelineno-0-5709"></a>    <span class="c1"># end deep_merge()</span>
</span><span id="__span-0-5710"><a id="__codelineno-0-5710" name="__codelineno-0-5710"></a>
</span><span id="__span-0-5711"><a id="__codelineno-0-5711" name="__codelineno-0-5711"></a>    <span class="n">webpart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sharepoint_webpart</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">,</span> <span class="n">webpart_id</span><span class="o">=</span><span class="n">webpart_id</span><span class="p">)</span>
</span><span id="__span-0-5712"><a id="__codelineno-0-5712" name="__codelineno-0-5712"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">webpart</span><span class="p">:</span>
</span><span id="__span-0-5713"><a id="__codelineno-0-5713" name="__codelineno-0-5713"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-5714"><a id="__codelineno-0-5714" name="__codelineno-0-5714"></a>            <span class="s2">&quot;Cannot find web part for site ID -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;, page -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;, webpart ID -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-5715"><a id="__codelineno-0-5715" name="__codelineno-0-5715"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5716"><a id="__codelineno-0-5716" name="__codelineno-0-5716"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5717"><a id="__codelineno-0-5717" name="__codelineno-0-5717"></a>            <span class="n">webpart_id</span><span class="p">,</span>
</span><span id="__span-0-5718"><a id="__codelineno-0-5718" name="__codelineno-0-5718"></a>        <span class="p">)</span>
</span><span id="__span-0-5719"><a id="__codelineno-0-5719" name="__codelineno-0-5719"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-5720"><a id="__codelineno-0-5720" name="__codelineno-0-5720"></a>    <span class="n">webpart_type_id</span> <span class="o">=</span> <span class="n">webpart</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;webPartType&quot;</span><span class="p">)</span>
</span><span id="__span-0-5721"><a id="__codelineno-0-5721" name="__codelineno-0-5721"></a>    <span class="n">webpart_type_name</span> <span class="o">=</span> <span class="n">webpart</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;@odata.type&quot;</span><span class="p">)</span>
</span><span id="__span-0-5722"><a id="__codelineno-0-5722" name="__codelineno-0-5722"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">webpart</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</span><span id="__span-0-5723"><a id="__codelineno-0-5723" name="__codelineno-0-5723"></a>
</span><span id="__span-0-5724"><a id="__codelineno-0-5724" name="__codelineno-0-5724"></a>    <span class="c1"># Fill update_data with missing keys from data</span>
</span><span id="__span-0-5725"><a id="__codelineno-0-5725" name="__codelineno-0-5725"></a>    <span class="n">update_data</span> <span class="o">=</span> <span class="n">deep_merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>  <span class="c1"># Merges, giving precedence to update_data</span>
</span><span id="__span-0-5726"><a id="__codelineno-0-5726" name="__codelineno-0-5726"></a>
</span><span id="__span-0-5727"><a id="__codelineno-0-5727" name="__codelineno-0-5727"></a>    <span class="c1"># Construct the payload to update the specific property</span>
</span><span id="__span-0-5728"><a id="__codelineno-0-5728" name="__codelineno-0-5728"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-5729"><a id="__codelineno-0-5729" name="__codelineno-0-5729"></a>        <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="n">webpart_type_name</span><span class="p">,</span>  <span class="c1"># likle &quot;#microsoft.graph.standardWebPart&quot; - this is mandatory!</span>
</span><span id="__span-0-5730"><a id="__codelineno-0-5730" name="__codelineno-0-5730"></a>        <span class="s2">&quot;webPartType&quot;</span><span class="p">:</span> <span class="n">webpart_type_id</span><span class="p">,</span>  <span class="c1"># this is mandatory!</span>
</span><span id="__span-0-5731"><a id="__codelineno-0-5731" name="__codelineno-0-5731"></a>        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">update_data</span><span class="p">,</span>
</span><span id="__span-0-5732"><a id="__codelineno-0-5732" name="__codelineno-0-5732"></a>    <span class="p">}</span>
</span><span id="__span-0-5733"><a id="__codelineno-0-5733" name="__codelineno-0-5733"></a>
</span><span id="__span-0-5734"><a id="__codelineno-0-5734" name="__codelineno-0-5734"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-5735"><a id="__codelineno-0-5735" name="__codelineno-0-5735"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;sitesUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-5736"><a id="__codelineno-0-5736" name="__codelineno-0-5736"></a>        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="__span-0-5737"><a id="__codelineno-0-5737" name="__codelineno-0-5737"></a>        <span class="o">+</span> <span class="n">site_id</span>
</span><span id="__span-0-5738"><a id="__codelineno-0-5738" name="__codelineno-0-5738"></a>        <span class="o">+</span> <span class="s2">&quot;/pages/&quot;</span>
</span><span id="__span-0-5739"><a id="__codelineno-0-5739" name="__codelineno-0-5739"></a>        <span class="o">+</span> <span class="n">page_id</span>
</span><span id="__span-0-5740"><a id="__codelineno-0-5740" name="__codelineno-0-5740"></a>        <span class="o">+</span> <span class="s2">&quot;/microsoft.graph.sitePage/webparts/&quot;</span>
</span><span id="__span-0-5741"><a id="__codelineno-0-5741" name="__codelineno-0-5741"></a>        <span class="o">+</span> <span class="n">webpart_id</span>
</span><span id="__span-0-5742"><a id="__codelineno-0-5742" name="__codelineno-0-5742"></a>    <span class="p">)</span>
</span><span id="__span-0-5743"><a id="__codelineno-0-5743" name="__codelineno-0-5743"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-5744"><a id="__codelineno-0-5744" name="__codelineno-0-5744"></a>
</span><span id="__span-0-5745"><a id="__codelineno-0-5745" name="__codelineno-0-5745"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-5746"><a id="__codelineno-0-5746" name="__codelineno-0-5746"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-5747"><a id="__codelineno-0-5747" name="__codelineno-0-5747"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-5748"><a id="__codelineno-0-5748" name="__codelineno-0-5748"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="__span-0-5749"><a id="__codelineno-0-5749" name="__codelineno-0-5749"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-5750"><a id="__codelineno-0-5750" name="__codelineno-0-5750"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-5751"><a id="__codelineno-0-5751" name="__codelineno-0-5751"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Cannot update SharePoint webpart -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; on SharePoint page -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; for Sharepoint site -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-5752"><a id="__codelineno-0-5752" name="__codelineno-0-5752"></a>            <span class="n">webpart_id</span><span class="p">,</span>
</span><span id="__span-0-5753"><a id="__codelineno-0-5753" name="__codelineno-0-5753"></a>            <span class="n">page_id</span><span class="p">,</span>
</span><span id="__span-0-5754"><a id="__codelineno-0-5754" name="__codelineno-0-5754"></a>            <span class="n">site_id</span><span class="p">,</span>
</span><span id="__span-0-5755"><a id="__codelineno-0-5755" name="__codelineno-0-5755"></a>        <span class="p">),</span>
</span><span id="__span-0-5756"><a id="__codelineno-0-5756" name="__codelineno-0-5756"></a>    <span class="p">)</span>
</span><span id="__span-0-5757"><a id="__codelineno-0-5757" name="__codelineno-0-5757"></a>    <span class="c1"># Check if the page should be republished:</span>
</span><span id="__span-0-5758"><a id="__codelineno-0-5758" name="__codelineno-0-5758"></a>    <span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">republish</span><span class="p">:</span>
</span><span id="__span-0-5759"><a id="__codelineno-0-5759" name="__codelineno-0-5759"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">publish_sharepoint_page</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">page_id</span><span class="o">=</span><span class="n">page_id</span><span class="p">)</span>
</span><span id="__span-0-5760"><a id="__codelineno-0-5760" name="__codelineno-0-5760"></a>
</span><span id="__span-0-5761"><a id="__codelineno-0-5761" name="__codelineno-0-5761"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.update_teams_app_of_channel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_teams_app_of_channel</span><span class="p">(</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">tab_name</span><span class="p">,</span> <span class="n">app_url</span><span class="p">,</span> <span class="n">cs_node_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update an existing tab for Extended ECM app in an M365 Team channel.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the M365 Team.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the channel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tab_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tab.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The web URL of the app.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cs_node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node ID of the target workspace or container in Content Server.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return data structure (dictionary) or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3334">3334</a></span>
<span class="normal"><a href="#__codelineno-0-3335">3335</a></span>
<span class="normal"><a href="#__codelineno-0-3336">3336</a></span>
<span class="normal"><a href="#__codelineno-0-3337">3337</a></span>
<span class="normal"><a href="#__codelineno-0-3338">3338</a></span>
<span class="normal"><a href="#__codelineno-0-3339">3339</a></span>
<span class="normal"><a href="#__codelineno-0-3340">3340</a></span>
<span class="normal"><a href="#__codelineno-0-3341">3341</a></span>
<span class="normal"><a href="#__codelineno-0-3342">3342</a></span>
<span class="normal"><a href="#__codelineno-0-3343">3343</a></span>
<span class="normal"><a href="#__codelineno-0-3344">3344</a></span>
<span class="normal"><a href="#__codelineno-0-3345">3345</a></span>
<span class="normal"><a href="#__codelineno-0-3346">3346</a></span>
<span class="normal"><a href="#__codelineno-0-3347">3347</a></span>
<span class="normal"><a href="#__codelineno-0-3348">3348</a></span>
<span class="normal"><a href="#__codelineno-0-3349">3349</a></span>
<span class="normal"><a href="#__codelineno-0-3350">3350</a></span>
<span class="normal"><a href="#__codelineno-0-3351">3351</a></span>
<span class="normal"><a href="#__codelineno-0-3352">3352</a></span>
<span class="normal"><a href="#__codelineno-0-3353">3353</a></span>
<span class="normal"><a href="#__codelineno-0-3354">3354</a></span>
<span class="normal"><a href="#__codelineno-0-3355">3355</a></span>
<span class="normal"><a href="#__codelineno-0-3356">3356</a></span>
<span class="normal"><a href="#__codelineno-0-3357">3357</a></span>
<span class="normal"><a href="#__codelineno-0-3358">3358</a></span>
<span class="normal"><a href="#__codelineno-0-3359">3359</a></span>
<span class="normal"><a href="#__codelineno-0-3360">3360</a></span>
<span class="normal"><a href="#__codelineno-0-3361">3361</a></span>
<span class="normal"><a href="#__codelineno-0-3362">3362</a></span>
<span class="normal"><a href="#__codelineno-0-3363">3363</a></span>
<span class="normal"><a href="#__codelineno-0-3364">3364</a></span>
<span class="normal"><a href="#__codelineno-0-3365">3365</a></span>
<span class="normal"><a href="#__codelineno-0-3366">3366</a></span>
<span class="normal"><a href="#__codelineno-0-3367">3367</a></span>
<span class="normal"><a href="#__codelineno-0-3368">3368</a></span>
<span class="normal"><a href="#__codelineno-0-3369">3369</a></span>
<span class="normal"><a href="#__codelineno-0-3370">3370</a></span>
<span class="normal"><a href="#__codelineno-0-3371">3371</a></span>
<span class="normal"><a href="#__codelineno-0-3372">3372</a></span>
<span class="normal"><a href="#__codelineno-0-3373">3373</a></span>
<span class="normal"><a href="#__codelineno-0-3374">3374</a></span>
<span class="normal"><a href="#__codelineno-0-3375">3375</a></span>
<span class="normal"><a href="#__codelineno-0-3376">3376</a></span>
<span class="normal"><a href="#__codelineno-0-3377">3377</a></span>
<span class="normal"><a href="#__codelineno-0-3378">3378</a></span>
<span class="normal"><a href="#__codelineno-0-3379">3379</a></span>
<span class="normal"><a href="#__codelineno-0-3380">3380</a></span>
<span class="normal"><a href="#__codelineno-0-3381">3381</a></span>
<span class="normal"><a href="#__codelineno-0-3382">3382</a></span>
<span class="normal"><a href="#__codelineno-0-3383">3383</a></span>
<span class="normal"><a href="#__codelineno-0-3384">3384</a></span>
<span class="normal"><a href="#__codelineno-0-3385">3385</a></span>
<span class="normal"><a href="#__codelineno-0-3386">3386</a></span>
<span class="normal"><a href="#__codelineno-0-3387">3387</a></span>
<span class="normal"><a href="#__codelineno-0-3388">3388</a></span>
<span class="normal"><a href="#__codelineno-0-3389">3389</a></span>
<span class="normal"><a href="#__codelineno-0-3390">3390</a></span>
<span class="normal"><a href="#__codelineno-0-3391">3391</a></span>
<span class="normal"><a href="#__codelineno-0-3392">3392</a></span>
<span class="normal"><a href="#__codelineno-0-3393">3393</a></span>
<span class="normal"><a href="#__codelineno-0-3394">3394</a></span>
<span class="normal"><a href="#__codelineno-0-3395">3395</a></span>
<span class="normal"><a href="#__codelineno-0-3396">3396</a></span>
<span class="normal"><a href="#__codelineno-0-3397">3397</a></span>
<span class="normal"><a href="#__codelineno-0-3398">3398</a></span>
<span class="normal"><a href="#__codelineno-0-3399">3399</a></span>
<span class="normal"><a href="#__codelineno-0-3400">3400</a></span>
<span class="normal"><a href="#__codelineno-0-3401">3401</a></span>
<span class="normal"><a href="#__codelineno-0-3402">3402</a></span>
<span class="normal"><a href="#__codelineno-0-3403">3403</a></span>
<span class="normal"><a href="#__codelineno-0-3404">3404</a></span>
<span class="normal"><a href="#__codelineno-0-3405">3405</a></span>
<span class="normal"><a href="#__codelineno-0-3406">3406</a></span>
<span class="normal"><a href="#__codelineno-0-3407">3407</a></span>
<span class="normal"><a href="#__codelineno-0-3408">3408</a></span>
<span class="normal"><a href="#__codelineno-0-3409">3409</a></span>
<span class="normal"><a href="#__codelineno-0-3410">3410</a></span>
<span class="normal"><a href="#__codelineno-0-3411">3411</a></span>
<span class="normal"><a href="#__codelineno-0-3412">3412</a></span>
<span class="normal"><a href="#__codelineno-0-3413">3413</a></span>
<span class="normal"><a href="#__codelineno-0-3414">3414</a></span>
<span class="normal"><a href="#__codelineno-0-3415">3415</a></span>
<span class="normal"><a href="#__codelineno-0-3416">3416</a></span>
<span class="normal"><a href="#__codelineno-0-3417">3417</a></span>
<span class="normal"><a href="#__codelineno-0-3418">3418</a></span>
<span class="normal"><a href="#__codelineno-0-3419">3419</a></span>
<span class="normal"><a href="#__codelineno-0-3420">3420</a></span>
<span class="normal"><a href="#__codelineno-0-3421">3421</a></span>
<span class="normal"><a href="#__codelineno-0-3422">3422</a></span>
<span class="normal"><a href="#__codelineno-0-3423">3423</a></span>
<span class="normal"><a href="#__codelineno-0-3424">3424</a></span>
<span class="normal"><a href="#__codelineno-0-3425">3425</a></span>
<span class="normal"><a href="#__codelineno-0-3426">3426</a></span>
<span class="normal"><a href="#__codelineno-0-3427">3427</a></span>
<span class="normal"><a href="#__codelineno-0-3428">3428</a></span>
<span class="normal"><a href="#__codelineno-0-3429">3429</a></span>
<span class="normal"><a href="#__codelineno-0-3430">3430</a></span>
<span class="normal"><a href="#__codelineno-0-3431">3431</a></span>
<span class="normal"><a href="#__codelineno-0-3432">3432</a></span>
<span class="normal"><a href="#__codelineno-0-3433">3433</a></span>
<span class="normal"><a href="#__codelineno-0-3434">3434</a></span>
<span class="normal"><a href="#__codelineno-0-3435">3435</a></span>
<span class="normal"><a href="#__codelineno-0-3436">3436</a></span>
<span class="normal"><a href="#__codelineno-0-3437">3437</a></span>
<span class="normal"><a href="#__codelineno-0-3438">3438</a></span>
<span class="normal"><a href="#__codelineno-0-3439">3439</a></span>
<span class="normal"><a href="#__codelineno-0-3440">3440</a></span>
<span class="normal"><a href="#__codelineno-0-3441">3441</a></span>
<span class="normal"><a href="#__codelineno-0-3442">3442</a></span>
<span class="normal"><a href="#__codelineno-0-3443">3443</a></span>
<span class="normal"><a href="#__codelineno-0-3444">3444</a></span>
<span class="normal"><a href="#__codelineno-0-3445">3445</a></span>
<span class="normal"><a href="#__codelineno-0-3446">3446</a></span>
<span class="normal"><a href="#__codelineno-0-3447">3447</a></span>
<span class="normal"><a href="#__codelineno-0-3448">3448</a></span>
<span class="normal"><a href="#__codelineno-0-3449">3449</a></span>
<span class="normal"><a href="#__codelineno-0-3450">3450</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3334"><a id="__codelineno-0-3334" name="__codelineno-0-3334"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_teams_app_of_channel</span><span class="p">(</span>
</span><span id="__span-0-3335"><a id="__codelineno-0-3335" name="__codelineno-0-3335"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3336"><a id="__codelineno-0-3336" name="__codelineno-0-3336"></a>    <span class="n">team_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3337"><a id="__codelineno-0-3337" name="__codelineno-0-3337"></a>    <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3338"><a id="__codelineno-0-3338" name="__codelineno-0-3338"></a>    <span class="n">tab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3339"><a id="__codelineno-0-3339" name="__codelineno-0-3339"></a>    <span class="n">app_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3340"><a id="__codelineno-0-3340" name="__codelineno-0-3340"></a>    <span class="n">cs_node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3341"><a id="__codelineno-0-3341" name="__codelineno-0-3341"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3342"><a id="__codelineno-0-3342" name="__codelineno-0-3342"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update an existing tab for Extended ECM app in an M365 Team channel.</span>
</span><span id="__span-0-3343"><a id="__codelineno-0-3343" name="__codelineno-0-3343"></a>
</span><span id="__span-0-3344"><a id="__codelineno-0-3344" name="__codelineno-0-3344"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3345"><a id="__codelineno-0-3345" name="__codelineno-0-3345"></a><span class="sd">        team_name (str):</span>
</span><span id="__span-0-3346"><a id="__codelineno-0-3346" name="__codelineno-0-3346"></a><span class="sd">            The name of the M365 Team.</span>
</span><span id="__span-0-3347"><a id="__codelineno-0-3347" name="__codelineno-0-3347"></a><span class="sd">        channel_name (str):</span>
</span><span id="__span-0-3348"><a id="__codelineno-0-3348" name="__codelineno-0-3348"></a><span class="sd">            The name of the channel.</span>
</span><span id="__span-0-3349"><a id="__codelineno-0-3349" name="__codelineno-0-3349"></a><span class="sd">        tab_name (str):</span>
</span><span id="__span-0-3350"><a id="__codelineno-0-3350" name="__codelineno-0-3350"></a><span class="sd">            The name of the tab.</span>
</span><span id="__span-0-3351"><a id="__codelineno-0-3351" name="__codelineno-0-3351"></a><span class="sd">        app_url (str):</span>
</span><span id="__span-0-3352"><a id="__codelineno-0-3352" name="__codelineno-0-3352"></a><span class="sd">            The web URL of the app.</span>
</span><span id="__span-0-3353"><a id="__codelineno-0-3353" name="__codelineno-0-3353"></a><span class="sd">        cs_node_id (int):</span>
</span><span id="__span-0-3354"><a id="__codelineno-0-3354" name="__codelineno-0-3354"></a><span class="sd">            The node ID of the target workspace or container in Content Server.</span>
</span><span id="__span-0-3355"><a id="__codelineno-0-3355" name="__codelineno-0-3355"></a>
</span><span id="__span-0-3356"><a id="__codelineno-0-3356" name="__codelineno-0-3356"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3357"><a id="__codelineno-0-3357" name="__codelineno-0-3357"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3358"><a id="__codelineno-0-3358" name="__codelineno-0-3358"></a><span class="sd">            Return data structure (dictionary) or None if the request fails.</span>
</span><span id="__span-0-3359"><a id="__codelineno-0-3359" name="__codelineno-0-3359"></a>
</span><span id="__span-0-3360"><a id="__codelineno-0-3360" name="__codelineno-0-3360"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3361"><a id="__codelineno-0-3361" name="__codelineno-0-3361"></a>
</span><span id="__span-0-3362"><a id="__codelineno-0-3362" name="__codelineno-0-3362"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3363"><a id="__codelineno-0-3363" name="__codelineno-0-3363"></a>    <span class="n">team_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3364"><a id="__codelineno-0-3364" name="__codelineno-0-3364"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">team_id</span><span class="p">:</span>
</span><span id="__span-0-3365"><a id="__codelineno-0-3365" name="__codelineno-0-3365"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3366"><a id="__codelineno-0-3366" name="__codelineno-0-3366"></a>
</span><span id="__span-0-3367"><a id="__codelineno-0-3367" name="__codelineno-0-3367"></a>    <span class="c1"># Get the channels of the M365 Team:</span>
</span><span id="__span-0-3368"><a id="__codelineno-0-3368" name="__codelineno-0-3368"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channels</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">team_name</span><span class="p">)</span>
</span><span id="__span-0-3369"><a id="__codelineno-0-3369" name="__codelineno-0-3369"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3370"><a id="__codelineno-0-3370" name="__codelineno-0-3370"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3371"><a id="__codelineno-0-3371" name="__codelineno-0-3371"></a>
</span><span id="__span-0-3372"><a id="__codelineno-0-3372" name="__codelineno-0-3372"></a>    <span class="c1"># Look the channel by name and then retrieve its ID:</span>
</span><span id="__span-0-3373"><a id="__codelineno-0-3373" name="__codelineno-0-3373"></a>    <span class="n">channel</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3374"><a id="__codelineno-0-3374" name="__codelineno-0-3374"></a>        <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">),</span>
</span><span id="__span-0-3375"><a id="__codelineno-0-3375" name="__codelineno-0-3375"></a>        <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3376"><a id="__codelineno-0-3376" name="__codelineno-0-3376"></a>    <span class="p">)</span>
</span><span id="__span-0-3377"><a id="__codelineno-0-3377" name="__codelineno-0-3377"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
</span><span id="__span-0-3378"><a id="__codelineno-0-3378" name="__codelineno-0-3378"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3379"><a id="__codelineno-0-3379" name="__codelineno-0-3379"></a>            <span class="s2">&quot;Cannot find Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; for M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39;!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3380"><a id="__codelineno-0-3380" name="__codelineno-0-3380"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3381"><a id="__codelineno-0-3381" name="__codelineno-0-3381"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3382"><a id="__codelineno-0-3382" name="__codelineno-0-3382"></a>        <span class="p">)</span>
</span><span id="__span-0-3383"><a id="__codelineno-0-3383" name="__codelineno-0-3383"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3384"><a id="__codelineno-0-3384" name="__codelineno-0-3384"></a>    <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3385"><a id="__codelineno-0-3385" name="__codelineno-0-3385"></a>
</span><span id="__span-0-3386"><a id="__codelineno-0-3386" name="__codelineno-0-3386"></a>    <span class="c1"># Get the tabs of the M365 Team channel:</span>
</span><span id="__span-0-3387"><a id="__codelineno-0-3387" name="__codelineno-0-3387"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_team_channel_tabs</span><span class="p">(</span><span class="n">team_name</span><span class="o">=</span><span class="n">team_name</span><span class="p">,</span> <span class="n">channel_name</span><span class="o">=</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="__span-0-3388"><a id="__codelineno-0-3388" name="__codelineno-0-3388"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-3389"><a id="__codelineno-0-3389" name="__codelineno-0-3389"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3390"><a id="__codelineno-0-3390" name="__codelineno-0-3390"></a>
</span><span id="__span-0-3391"><a id="__codelineno-0-3391" name="__codelineno-0-3391"></a>    <span class="c1"># Look the tab by name and then retrieve its ID:</span>
</span><span id="__span-0-3392"><a id="__codelineno-0-3392" name="__codelineno-0-3392"></a>    <span class="n">tab</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="__span-0-3393"><a id="__codelineno-0-3393" name="__codelineno-0-3393"></a>        <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab_name</span><span class="p">),</span>
</span><span id="__span-0-3394"><a id="__codelineno-0-3394" name="__codelineno-0-3394"></a>        <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3395"><a id="__codelineno-0-3395" name="__codelineno-0-3395"></a>    <span class="p">)</span>
</span><span id="__span-0-3396"><a id="__codelineno-0-3396" name="__codelineno-0-3396"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tab</span><span class="p">:</span>
</span><span id="__span-0-3397"><a id="__codelineno-0-3397" name="__codelineno-0-3397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3398"><a id="__codelineno-0-3398" name="__codelineno-0-3398"></a>            <span class="s2">&quot;Cannot find Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; on M365 Team -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">)!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3399"><a id="__codelineno-0-3399" name="__codelineno-0-3399"></a>            <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3400"><a id="__codelineno-0-3400" name="__codelineno-0-3400"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3401"><a id="__codelineno-0-3401" name="__codelineno-0-3401"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3402"><a id="__codelineno-0-3402" name="__codelineno-0-3402"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3403"><a id="__codelineno-0-3403" name="__codelineno-0-3403"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3404"><a id="__codelineno-0-3404" name="__codelineno-0-3404"></a>        <span class="p">)</span>
</span><span id="__span-0-3405"><a id="__codelineno-0-3405" name="__codelineno-0-3405"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3406"><a id="__codelineno-0-3406" name="__codelineno-0-3406"></a>    <span class="n">tab_id</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="__span-0-3407"><a id="__codelineno-0-3407" name="__codelineno-0-3407"></a>
</span><span id="__span-0-3408"><a id="__codelineno-0-3408" name="__codelineno-0-3408"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3409"><a id="__codelineno-0-3409" name="__codelineno-0-3409"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/channels/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/tabs/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tab_id</span><span class="p">)</span>
</span><span id="__span-0-3410"><a id="__codelineno-0-3410" name="__codelineno-0-3410"></a>    <span class="p">)</span>
</span><span id="__span-0-3411"><a id="__codelineno-0-3411" name="__codelineno-0-3411"></a>
</span><span id="__span-0-3412"><a id="__codelineno-0-3412" name="__codelineno-0-3412"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3413"><a id="__codelineno-0-3413" name="__codelineno-0-3413"></a>
</span><span id="__span-0-3414"><a id="__codelineno-0-3414" name="__codelineno-0-3414"></a>    <span class="c1"># Create tab configuration payload:</span>
</span><span id="__span-0-3415"><a id="__codelineno-0-3415" name="__codelineno-0-3415"></a>    <span class="n">tab_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3416"><a id="__codelineno-0-3416" name="__codelineno-0-3416"></a>        <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-3417"><a id="__codelineno-0-3417" name="__codelineno-0-3417"></a>            <span class="s2">&quot;entityId&quot;</span><span class="p">:</span> <span class="n">cs_node_id</span><span class="p">,</span>  <span class="c1"># Unique identifier for the tab</span>
</span><span id="__span-0-3418"><a id="__codelineno-0-3418" name="__codelineno-0-3418"></a>            <span class="s2">&quot;contentUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span><span class="p">,</span>
</span><span id="__span-0-3419"><a id="__codelineno-0-3419" name="__codelineno-0-3419"></a>            <span class="s2">&quot;removeUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-3420"><a id="__codelineno-0-3420" name="__codelineno-0-3420"></a>            <span class="s2">&quot;websiteUrl&quot;</span><span class="p">:</span> <span class="n">app_url</span> <span class="o">+</span> <span class="s2">&quot;&amp;showBW=true&amp;title=&quot;</span> <span class="o">+</span> <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3421"><a id="__codelineno-0-3421" name="__codelineno-0-3421"></a>        <span class="p">},</span>
</span><span id="__span-0-3422"><a id="__codelineno-0-3422" name="__codelineno-0-3422"></a>    <span class="p">}</span>
</span><span id="__span-0-3423"><a id="__codelineno-0-3423" name="__codelineno-0-3423"></a>
</span><span id="__span-0-3424"><a id="__codelineno-0-3424" name="__codelineno-0-3424"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3425"><a id="__codelineno-0-3425" name="__codelineno-0-3425"></a>        <span class="s2">&quot;Update Tab -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of Channel -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) for Microsoft 365 Teams -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) with configuration -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3426"><a id="__codelineno-0-3426" name="__codelineno-0-3426"></a>        <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3427"><a id="__codelineno-0-3427" name="__codelineno-0-3427"></a>        <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3428"><a id="__codelineno-0-3428" name="__codelineno-0-3428"></a>        <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3429"><a id="__codelineno-0-3429" name="__codelineno-0-3429"></a>        <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3430"><a id="__codelineno-0-3430" name="__codelineno-0-3430"></a>        <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3431"><a id="__codelineno-0-3431" name="__codelineno-0-3431"></a>        <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3432"><a id="__codelineno-0-3432" name="__codelineno-0-3432"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">tab_config</span><span class="p">),</span>
</span><span id="__span-0-3433"><a id="__codelineno-0-3433" name="__codelineno-0-3433"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3434"><a id="__codelineno-0-3434" name="__codelineno-0-3434"></a>    <span class="p">)</span>
</span><span id="__span-0-3435"><a id="__codelineno-0-3435" name="__codelineno-0-3435"></a>
</span><span id="__span-0-3436"><a id="__codelineno-0-3436" name="__codelineno-0-3436"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3437"><a id="__codelineno-0-3437" name="__codelineno-0-3437"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3438"><a id="__codelineno-0-3438" name="__codelineno-0-3438"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-3439"><a id="__codelineno-0-3439" name="__codelineno-0-3439"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3440"><a id="__codelineno-0-3440" name="__codelineno-0-3440"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">tab_config</span><span class="p">,</span>
</span><span id="__span-0-3441"><a id="__codelineno-0-3441" name="__codelineno-0-3441"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3442"><a id="__codelineno-0-3442" name="__codelineno-0-3442"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update Tab -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) for M365 Team -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) and Channel -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3443"><a id="__codelineno-0-3443" name="__codelineno-0-3443"></a>            <span class="n">tab_name</span><span class="p">,</span>
</span><span id="__span-0-3444"><a id="__codelineno-0-3444" name="__codelineno-0-3444"></a>            <span class="n">tab_id</span><span class="p">,</span>
</span><span id="__span-0-3445"><a id="__codelineno-0-3445" name="__codelineno-0-3445"></a>            <span class="n">team_name</span><span class="p">,</span>
</span><span id="__span-0-3446"><a id="__codelineno-0-3446" name="__codelineno-0-3446"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3447"><a id="__codelineno-0-3447" name="__codelineno-0-3447"></a>            <span class="n">channel_name</span><span class="p">,</span>
</span><span id="__span-0-3448"><a id="__codelineno-0-3448" name="__codelineno-0-3448"></a>            <span class="n">channel_id</span><span class="p">,</span>
</span><span id="__span-0-3449"><a id="__codelineno-0-3449" name="__codelineno-0-3449"></a>        <span class="p">),</span>
</span><span id="__span-0-3450"><a id="__codelineno-0-3450" name="__codelineno-0-3450"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.update_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">updated_settings</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update selected properties of an M365 user.</p>
<p>Documentation on user properties is here: https://learn.microsoft.com/en-us/graph/api/user-update</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the user (can also be email). This is also the unique identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>updated_settings</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new data to update the user with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the M365 Graph API  or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updated_settings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update selected properties of an M365 user.</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    Documentation on user properties is here: https://learn.microsoft.com/en-us/graph/api/user-update</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">            The ID of the user (can also be email). This is also the unique identifier.</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        updated_settings (dict):</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">            The new data to update the user with.</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">            Response of the M365 Graph API  or None if the call fails.</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>        <span class="s2">&quot;Updating M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2"> with -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">updated_settings</span><span class="p">),</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>    <span class="p">)</span>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>        <span class="n">json_data</span><span class="o">=</span><span class="n">updated_settings</span><span class="p">,</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update M365 user -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; with -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>            <span class="n">updated_settings</span><span class="p">,</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>        <span class="p">),</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.update_user_photo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_user_photo</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update the M365 user photo.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>photo_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file system path with the location of the photo file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of Graph REST API or None if the user photo couldn't be updated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_user_photo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the M365 user photo.</span>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">        photo_path (str):</span>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">            The file system path with the location of the photo file.</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">            Response of Graph REST API or None if the user photo couldn&#39;t be updated.</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/photo/$value&quot;</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>    <span class="c1"># Set image as content type:</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">(</span><span class="s2">&quot;image/*&quot;</span><span class="p">)</span>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>    <span class="c1"># Check if the photo file exists</span>
</span><span id="__span-0-1338"><a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">photo_path</span><span class="p">):</span>
</span><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Photo file -&gt; </span><span class="si">%s</span><span class="s2"> not found!&quot;</span><span class="p">,</span> <span class="n">photo_path</span><span class="p">)</span>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>        <span class="c1"># Read the photo file as binary data</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">photo_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image_file</span><span class="p">:</span>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>            <span class="n">photo_data</span> <span class="o">=</span> <span class="n">image_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>        <span class="c1"># Handle any errors that occurred while reading the photo file</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="s2">&quot;Error reading photo file -&gt; </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>            <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>        <span class="p">)</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">photo_data</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>        <span class="s2">&quot;Update M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2"> with photo -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>        <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>    <span class="p">)</span>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update M365 user with ID -&gt; </span><span class="si">{}</span><span class="s2"> with photo -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>            <span class="n">photo_path</span><span class="p">,</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>        <span class="p">),</span>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.upgrade_teams_app_of_team" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upgrade_teams_app_of_team</span><span class="p">(</span><span class="n">team_id</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upgrade a MS teams app for a specific team.</p>
<p>The call will fail if the team does not already have the app assigned.
So this needs to be checked before calling this method.</p>
<p>THIS IS CURRENTLY NOT WORKING AS EXPECTED.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>team_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact name of the app.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3177">3177</a></span>
<span class="normal"><a href="#__codelineno-0-3178">3178</a></span>
<span class="normal"><a href="#__codelineno-0-3179">3179</a></span>
<span class="normal"><a href="#__codelineno-0-3180">3180</a></span>
<span class="normal"><a href="#__codelineno-0-3181">3181</a></span>
<span class="normal"><a href="#__codelineno-0-3182">3182</a></span>
<span class="normal"><a href="#__codelineno-0-3183">3183</a></span>
<span class="normal"><a href="#__codelineno-0-3184">3184</a></span>
<span class="normal"><a href="#__codelineno-0-3185">3185</a></span>
<span class="normal"><a href="#__codelineno-0-3186">3186</a></span>
<span class="normal"><a href="#__codelineno-0-3187">3187</a></span>
<span class="normal"><a href="#__codelineno-0-3188">3188</a></span>
<span class="normal"><a href="#__codelineno-0-3189">3189</a></span>
<span class="normal"><a href="#__codelineno-0-3190">3190</a></span>
<span class="normal"><a href="#__codelineno-0-3191">3191</a></span>
<span class="normal"><a href="#__codelineno-0-3192">3192</a></span>
<span class="normal"><a href="#__codelineno-0-3193">3193</a></span>
<span class="normal"><a href="#__codelineno-0-3194">3194</a></span>
<span class="normal"><a href="#__codelineno-0-3195">3195</a></span>
<span class="normal"><a href="#__codelineno-0-3196">3196</a></span>
<span class="normal"><a href="#__codelineno-0-3197">3197</a></span>
<span class="normal"><a href="#__codelineno-0-3198">3198</a></span>
<span class="normal"><a href="#__codelineno-0-3199">3199</a></span>
<span class="normal"><a href="#__codelineno-0-3200">3200</a></span>
<span class="normal"><a href="#__codelineno-0-3201">3201</a></span>
<span class="normal"><a href="#__codelineno-0-3202">3202</a></span>
<span class="normal"><a href="#__codelineno-0-3203">3203</a></span>
<span class="normal"><a href="#__codelineno-0-3204">3204</a></span>
<span class="normal"><a href="#__codelineno-0-3205">3205</a></span>
<span class="normal"><a href="#__codelineno-0-3206">3206</a></span>
<span class="normal"><a href="#__codelineno-0-3207">3207</a></span>
<span class="normal"><a href="#__codelineno-0-3208">3208</a></span>
<span class="normal"><a href="#__codelineno-0-3209">3209</a></span>
<span class="normal"><a href="#__codelineno-0-3210">3210</a></span>
<span class="normal"><a href="#__codelineno-0-3211">3211</a></span>
<span class="normal"><a href="#__codelineno-0-3212">3212</a></span>
<span class="normal"><a href="#__codelineno-0-3213">3213</a></span>
<span class="normal"><a href="#__codelineno-0-3214">3214</a></span>
<span class="normal"><a href="#__codelineno-0-3215">3215</a></span>
<span class="normal"><a href="#__codelineno-0-3216">3216</a></span>
<span class="normal"><a href="#__codelineno-0-3217">3217</a></span>
<span class="normal"><a href="#__codelineno-0-3218">3218</a></span>
<span class="normal"><a href="#__codelineno-0-3219">3219</a></span>
<span class="normal"><a href="#__codelineno-0-3220">3220</a></span>
<span class="normal"><a href="#__codelineno-0-3221">3221</a></span>
<span class="normal"><a href="#__codelineno-0-3222">3222</a></span>
<span class="normal"><a href="#__codelineno-0-3223">3223</a></span>
<span class="normal"><a href="#__codelineno-0-3224">3224</a></span>
<span class="normal"><a href="#__codelineno-0-3225">3225</a></span>
<span class="normal"><a href="#__codelineno-0-3226">3226</a></span>
<span class="normal"><a href="#__codelineno-0-3227">3227</a></span>
<span class="normal"><a href="#__codelineno-0-3228">3228</a></span>
<span class="normal"><a href="#__codelineno-0-3229">3229</a></span>
<span class="normal"><a href="#__codelineno-0-3230">3230</a></span>
<span class="normal"><a href="#__codelineno-0-3231">3231</a></span>
<span class="normal"><a href="#__codelineno-0-3232">3232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3177"><a id="__codelineno-0-3177" name="__codelineno-0-3177"></a><span class="k">def</span><span class="w"> </span><span class="nf">upgrade_teams_app_of_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3178"><a id="__codelineno-0-3178" name="__codelineno-0-3178"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upgrade a MS teams app for a specific team.</span>
</span><span id="__span-0-3179"><a id="__codelineno-0-3179" name="__codelineno-0-3179"></a>
</span><span id="__span-0-3180"><a id="__codelineno-0-3180" name="__codelineno-0-3180"></a><span class="sd">    The call will fail if the team does not already have the app assigned.</span>
</span><span id="__span-0-3181"><a id="__codelineno-0-3181" name="__codelineno-0-3181"></a><span class="sd">    So this needs to be checked before calling this method.</span>
</span><span id="__span-0-3182"><a id="__codelineno-0-3182" name="__codelineno-0-3182"></a>
</span><span id="__span-0-3183"><a id="__codelineno-0-3183" name="__codelineno-0-3183"></a><span class="sd">    THIS IS CURRENTLY NOT WORKING AS EXPECTED.</span>
</span><span id="__span-0-3184"><a id="__codelineno-0-3184" name="__codelineno-0-3184"></a>
</span><span id="__span-0-3185"><a id="__codelineno-0-3185" name="__codelineno-0-3185"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3186"><a id="__codelineno-0-3186" name="__codelineno-0-3186"></a><span class="sd">        team_id (str):</span>
</span><span id="__span-0-3187"><a id="__codelineno-0-3187" name="__codelineno-0-3187"></a><span class="sd">            M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-3188"><a id="__codelineno-0-3188" name="__codelineno-0-3188"></a><span class="sd">        app_name (str):</span>
</span><span id="__span-0-3189"><a id="__codelineno-0-3189" name="__codelineno-0-3189"></a><span class="sd">            The exact name of the app.</span>
</span><span id="__span-0-3190"><a id="__codelineno-0-3190" name="__codelineno-0-3190"></a>
</span><span id="__span-0-3191"><a id="__codelineno-0-3191" name="__codelineno-0-3191"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3192"><a id="__codelineno-0-3192" name="__codelineno-0-3192"></a><span class="sd">        dict:</span>
</span><span id="__span-0-3193"><a id="__codelineno-0-3193" name="__codelineno-0-3193"></a><span class="sd">            The response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-3194"><a id="__codelineno-0-3194" name="__codelineno-0-3194"></a>
</span><span id="__span-0-3195"><a id="__codelineno-0-3195" name="__codelineno-0-3195"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3196"><a id="__codelineno-0-3196" name="__codelineno-0-3196"></a>
</span><span id="__span-0-3197"><a id="__codelineno-0-3197" name="__codelineno-0-3197"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps_of_team</span><span class="p">(</span>
</span><span id="__span-0-3198"><a id="__codelineno-0-3198" name="__codelineno-0-3198"></a>        <span class="n">team_id</span><span class="o">=</span><span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3199"><a id="__codelineno-0-3199" name="__codelineno-0-3199"></a>        <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(teamsAppDefinition/displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app_name</span><span class="p">),</span>
</span><span id="__span-0-3200"><a id="__codelineno-0-3200" name="__codelineno-0-3200"></a>    <span class="p">)</span>
</span><span id="__span-0-3201"><a id="__codelineno-0-3201" name="__codelineno-0-3201"></a>    <span class="c1"># Retrieve the installation specific App ID - this is different from thew App catalalog ID!!</span>
</span><span id="__span-0-3202"><a id="__codelineno-0-3202" name="__codelineno-0-3202"></a>    <span class="n">app_installation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3203"><a id="__codelineno-0-3203" name="__codelineno-0-3203"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3204"><a id="__codelineno-0-3204" name="__codelineno-0-3204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3205"><a id="__codelineno-0-3205" name="__codelineno-0-3205"></a>            <span class="s2">&quot;M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found for M365 Team with ID -&gt; </span><span class="si">%s</span><span class="s2">. Cannot upgrade app for this team!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3206"><a id="__codelineno-0-3206" name="__codelineno-0-3206"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3207"><a id="__codelineno-0-3207" name="__codelineno-0-3207"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3208"><a id="__codelineno-0-3208" name="__codelineno-0-3208"></a>        <span class="p">)</span>
</span><span id="__span-0-3209"><a id="__codelineno-0-3209" name="__codelineno-0-3209"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3210"><a id="__codelineno-0-3210" name="__codelineno-0-3210"></a>
</span><span id="__span-0-3211"><a id="__codelineno-0-3211" name="__codelineno-0-3211"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">team_id</span> <span class="o">+</span> <span class="s2">&quot;/installedApps/&quot;</span> <span class="o">+</span> <span class="n">app_installation_id</span> <span class="o">+</span> <span class="s2">&quot;/upgrade&quot;</span>
</span><span id="__span-0-3212"><a id="__codelineno-0-3212" name="__codelineno-0-3212"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3213"><a id="__codelineno-0-3213" name="__codelineno-0-3213"></a>
</span><span id="__span-0-3214"><a id="__codelineno-0-3214" name="__codelineno-0-3214"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3215"><a id="__codelineno-0-3215" name="__codelineno-0-3215"></a>        <span class="s2">&quot;Upgrade app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of M365 team with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3216"><a id="__codelineno-0-3216" name="__codelineno-0-3216"></a>        <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3217"><a id="__codelineno-0-3217" name="__codelineno-0-3217"></a>        <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3218"><a id="__codelineno-0-3218" name="__codelineno-0-3218"></a>        <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3219"><a id="__codelineno-0-3219" name="__codelineno-0-3219"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3220"><a id="__codelineno-0-3220" name="__codelineno-0-3220"></a>    <span class="p">)</span>
</span><span id="__span-0-3221"><a id="__codelineno-0-3221" name="__codelineno-0-3221"></a>
</span><span id="__span-0-3222"><a id="__codelineno-0-3222" name="__codelineno-0-3222"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3223"><a id="__codelineno-0-3223" name="__codelineno-0-3223"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3224"><a id="__codelineno-0-3224" name="__codelineno-0-3224"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3225"><a id="__codelineno-0-3225" name="__codelineno-0-3225"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3226"><a id="__codelineno-0-3226" name="__codelineno-0-3226"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3227"><a id="__codelineno-0-3227" name="__codelineno-0-3227"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to upgrade M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) of M365 team with ID -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3228"><a id="__codelineno-0-3228" name="__codelineno-0-3228"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3229"><a id="__codelineno-0-3229" name="__codelineno-0-3229"></a>            <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3230"><a id="__codelineno-0-3230" name="__codelineno-0-3230"></a>            <span class="n">team_id</span><span class="p">,</span>
</span><span id="__span-0-3231"><a id="__codelineno-0-3231" name="__codelineno-0-3231"></a>        <span class="p">),</span>
</span><span id="__span-0-3232"><a id="__codelineno-0-3232" name="__codelineno-0-3232"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.upgrade_teams_app_of_user" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upgrade_teams_app_of_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">app_installation_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upgrade a MS teams app for a user.</p>
<p>The call will fail if the user does not already have the app assigned.
So this needs to be checked before calling this method.</p>
<p>See: https://learn.microsoft.com/en-us/graph/api/userteamwork-teamsappinstallation-upgrade?view=graph-rest-1.0&amp;tabs=http</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The M365 GUID of the user (can also be the M365 email of the user).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact name of the app.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_installation_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the app installation for the user. This is neither the internal nor
external app ID. It is specific for each user and app.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API call or None if the call fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2992">2992</a></span>
<span class="normal"><a href="#__codelineno-0-2993">2993</a></span>
<span class="normal"><a href="#__codelineno-0-2994">2994</a></span>
<span class="normal"><a href="#__codelineno-0-2995">2995</a></span>
<span class="normal"><a href="#__codelineno-0-2996">2996</a></span>
<span class="normal"><a href="#__codelineno-0-2997">2997</a></span>
<span class="normal"><a href="#__codelineno-0-2998">2998</a></span>
<span class="normal"><a href="#__codelineno-0-2999">2999</a></span>
<span class="normal"><a href="#__codelineno-0-3000">3000</a></span>
<span class="normal"><a href="#__codelineno-0-3001">3001</a></span>
<span class="normal"><a href="#__codelineno-0-3002">3002</a></span>
<span class="normal"><a href="#__codelineno-0-3003">3003</a></span>
<span class="normal"><a href="#__codelineno-0-3004">3004</a></span>
<span class="normal"><a href="#__codelineno-0-3005">3005</a></span>
<span class="normal"><a href="#__codelineno-0-3006">3006</a></span>
<span class="normal"><a href="#__codelineno-0-3007">3007</a></span>
<span class="normal"><a href="#__codelineno-0-3008">3008</a></span>
<span class="normal"><a href="#__codelineno-0-3009">3009</a></span>
<span class="normal"><a href="#__codelineno-0-3010">3010</a></span>
<span class="normal"><a href="#__codelineno-0-3011">3011</a></span>
<span class="normal"><a href="#__codelineno-0-3012">3012</a></span>
<span class="normal"><a href="#__codelineno-0-3013">3013</a></span>
<span class="normal"><a href="#__codelineno-0-3014">3014</a></span>
<span class="normal"><a href="#__codelineno-0-3015">3015</a></span>
<span class="normal"><a href="#__codelineno-0-3016">3016</a></span>
<span class="normal"><a href="#__codelineno-0-3017">3017</a></span>
<span class="normal"><a href="#__codelineno-0-3018">3018</a></span>
<span class="normal"><a href="#__codelineno-0-3019">3019</a></span>
<span class="normal"><a href="#__codelineno-0-3020">3020</a></span>
<span class="normal"><a href="#__codelineno-0-3021">3021</a></span>
<span class="normal"><a href="#__codelineno-0-3022">3022</a></span>
<span class="normal"><a href="#__codelineno-0-3023">3023</a></span>
<span class="normal"><a href="#__codelineno-0-3024">3024</a></span>
<span class="normal"><a href="#__codelineno-0-3025">3025</a></span>
<span class="normal"><a href="#__codelineno-0-3026">3026</a></span>
<span class="normal"><a href="#__codelineno-0-3027">3027</a></span>
<span class="normal"><a href="#__codelineno-0-3028">3028</a></span>
<span class="normal"><a href="#__codelineno-0-3029">3029</a></span>
<span class="normal"><a href="#__codelineno-0-3030">3030</a></span>
<span class="normal"><a href="#__codelineno-0-3031">3031</a></span>
<span class="normal"><a href="#__codelineno-0-3032">3032</a></span>
<span class="normal"><a href="#__codelineno-0-3033">3033</a></span>
<span class="normal"><a href="#__codelineno-0-3034">3034</a></span>
<span class="normal"><a href="#__codelineno-0-3035">3035</a></span>
<span class="normal"><a href="#__codelineno-0-3036">3036</a></span>
<span class="normal"><a href="#__codelineno-0-3037">3037</a></span>
<span class="normal"><a href="#__codelineno-0-3038">3038</a></span>
<span class="normal"><a href="#__codelineno-0-3039">3039</a></span>
<span class="normal"><a href="#__codelineno-0-3040">3040</a></span>
<span class="normal"><a href="#__codelineno-0-3041">3041</a></span>
<span class="normal"><a href="#__codelineno-0-3042">3042</a></span>
<span class="normal"><a href="#__codelineno-0-3043">3043</a></span>
<span class="normal"><a href="#__codelineno-0-3044">3044</a></span>
<span class="normal"><a href="#__codelineno-0-3045">3045</a></span>
<span class="normal"><a href="#__codelineno-0-3046">3046</a></span>
<span class="normal"><a href="#__codelineno-0-3047">3047</a></span>
<span class="normal"><a href="#__codelineno-0-3048">3048</a></span>
<span class="normal"><a href="#__codelineno-0-3049">3049</a></span>
<span class="normal"><a href="#__codelineno-0-3050">3050</a></span>
<span class="normal"><a href="#__codelineno-0-3051">3051</a></span>
<span class="normal"><a href="#__codelineno-0-3052">3052</a></span>
<span class="normal"><a href="#__codelineno-0-3053">3053</a></span>
<span class="normal"><a href="#__codelineno-0-3054">3054</a></span>
<span class="normal"><a href="#__codelineno-0-3055">3055</a></span>
<span class="normal"><a href="#__codelineno-0-3056">3056</a></span>
<span class="normal"><a href="#__codelineno-0-3057">3057</a></span>
<span class="normal"><a href="#__codelineno-0-3058">3058</a></span>
<span class="normal"><a href="#__codelineno-0-3059">3059</a></span>
<span class="normal"><a href="#__codelineno-0-3060">3060</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2992"><a id="__codelineno-0-2992" name="__codelineno-0-2992"></a><span class="k">def</span><span class="w"> </span><span class="nf">upgrade_teams_app_of_user</span><span class="p">(</span>
</span><span id="__span-0-2993"><a id="__codelineno-0-2993" name="__codelineno-0-2993"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2994"><a id="__codelineno-0-2994" name="__codelineno-0-2994"></a>    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2995"><a id="__codelineno-0-2995" name="__codelineno-0-2995"></a>    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2996"><a id="__codelineno-0-2996" name="__codelineno-0-2996"></a>    <span class="n">app_installation_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-2997"><a id="__codelineno-0-2997" name="__codelineno-0-2997"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2998"><a id="__codelineno-0-2998" name="__codelineno-0-2998"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upgrade a MS teams app for a user.</span>
</span><span id="__span-0-2999"><a id="__codelineno-0-2999" name="__codelineno-0-2999"></a>
</span><span id="__span-0-3000"><a id="__codelineno-0-3000" name="__codelineno-0-3000"></a><span class="sd">    The call will fail if the user does not already have the app assigned.</span>
</span><span id="__span-0-3001"><a id="__codelineno-0-3001" name="__codelineno-0-3001"></a><span class="sd">    So this needs to be checked before calling this method.</span>
</span><span id="__span-0-3002"><a id="__codelineno-0-3002" name="__codelineno-0-3002"></a>
</span><span id="__span-0-3003"><a id="__codelineno-0-3003" name="__codelineno-0-3003"></a><span class="sd">    See: https://learn.microsoft.com/en-us/graph/api/userteamwork-teamsappinstallation-upgrade?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-3004"><a id="__codelineno-0-3004" name="__codelineno-0-3004"></a>
</span><span id="__span-0-3005"><a id="__codelineno-0-3005" name="__codelineno-0-3005"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3006"><a id="__codelineno-0-3006" name="__codelineno-0-3006"></a><span class="sd">        user_id (str):</span>
</span><span id="__span-0-3007"><a id="__codelineno-0-3007" name="__codelineno-0-3007"></a><span class="sd">            The M365 GUID of the user (can also be the M365 email of the user).</span>
</span><span id="__span-0-3008"><a id="__codelineno-0-3008" name="__codelineno-0-3008"></a><span class="sd">        app_name (str):</span>
</span><span id="__span-0-3009"><a id="__codelineno-0-3009" name="__codelineno-0-3009"></a><span class="sd">            The exact name of the app.</span>
</span><span id="__span-0-3010"><a id="__codelineno-0-3010" name="__codelineno-0-3010"></a><span class="sd">        app_installation_id (str | None, optional):</span>
</span><span id="__span-0-3011"><a id="__codelineno-0-3011" name="__codelineno-0-3011"></a><span class="sd">            The ID of the app installation for the user. This is neither the internal nor</span>
</span><span id="__span-0-3012"><a id="__codelineno-0-3012" name="__codelineno-0-3012"></a><span class="sd">            external app ID. It is specific for each user and app.</span>
</span><span id="__span-0-3013"><a id="__codelineno-0-3013" name="__codelineno-0-3013"></a>
</span><span id="__span-0-3014"><a id="__codelineno-0-3014" name="__codelineno-0-3014"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3015"><a id="__codelineno-0-3015" name="__codelineno-0-3015"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-3016"><a id="__codelineno-0-3016" name="__codelineno-0-3016"></a><span class="sd">            Response of the MS Graph API call or None if the call fails.</span>
</span><span id="__span-0-3017"><a id="__codelineno-0-3017" name="__codelineno-0-3017"></a>
</span><span id="__span-0-3018"><a id="__codelineno-0-3018" name="__codelineno-0-3018"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3019"><a id="__codelineno-0-3019" name="__codelineno-0-3019"></a>
</span><span id="__span-0-3020"><a id="__codelineno-0-3020" name="__codelineno-0-3020"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3021"><a id="__codelineno-0-3021" name="__codelineno-0-3021"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teams_apps_of_user</span><span class="p">(</span>
</span><span id="__span-0-3022"><a id="__codelineno-0-3022" name="__codelineno-0-3022"></a>            <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3023"><a id="__codelineno-0-3023" name="__codelineno-0-3023"></a>            <span class="n">filter_expression</span><span class="o">=</span><span class="s2">&quot;contains(teamsAppDefinition/displayName, &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3024"><a id="__codelineno-0-3024" name="__codelineno-0-3024"></a>                <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3025"><a id="__codelineno-0-3025" name="__codelineno-0-3025"></a>            <span class="p">),</span>
</span><span id="__span-0-3026"><a id="__codelineno-0-3026" name="__codelineno-0-3026"></a>        <span class="p">)</span>
</span><span id="__span-0-3027"><a id="__codelineno-0-3027" name="__codelineno-0-3027"></a>        <span class="c1"># Retrieve the installation specific App ID - this is different from thew App catalalog ID!!</span>
</span><span id="__span-0-3028"><a id="__codelineno-0-3028" name="__codelineno-0-3028"></a>        <span class="n">app_installation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_value</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3029"><a id="__codelineno-0-3029" name="__codelineno-0-3029"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_installation_id</span><span class="p">:</span>
</span><span id="__span-0-3030"><a id="__codelineno-0-3030" name="__codelineno-0-3030"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-3031"><a id="__codelineno-0-3031" name="__codelineno-0-3031"></a>            <span class="s2">&quot;M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; not found for user with ID -&gt; </span><span class="si">%s</span><span class="s2">. Cannot upgrade app for this user!&quot;</span><span class="p">,</span>
</span><span id="__span-0-3032"><a id="__codelineno-0-3032" name="__codelineno-0-3032"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3033"><a id="__codelineno-0-3033" name="__codelineno-0-3033"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3034"><a id="__codelineno-0-3034" name="__codelineno-0-3034"></a>        <span class="p">)</span>
</span><span id="__span-0-3035"><a id="__codelineno-0-3035" name="__codelineno-0-3035"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-3036"><a id="__codelineno-0-3036" name="__codelineno-0-3036"></a>
</span><span id="__span-0-3037"><a id="__codelineno-0-3037" name="__codelineno-0-3037"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-3038"><a id="__codelineno-0-3038" name="__codelineno-0-3038"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;usersUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">user_id</span> <span class="o">+</span> <span class="s2">&quot;/teamwork/installedApps/&quot;</span> <span class="o">+</span> <span class="n">app_installation_id</span> <span class="o">+</span> <span class="s2">&quot;/upgrade&quot;</span>
</span><span id="__span-0-3039"><a id="__codelineno-0-3039" name="__codelineno-0-3039"></a>    <span class="p">)</span>
</span><span id="__span-0-3040"><a id="__codelineno-0-3040" name="__codelineno-0-3040"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header</span><span class="p">()</span>
</span><span id="__span-0-3041"><a id="__codelineno-0-3041" name="__codelineno-0-3041"></a>
</span><span id="__span-0-3042"><a id="__codelineno-0-3042" name="__codelineno-0-3042"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3043"><a id="__codelineno-0-3043" name="__codelineno-0-3043"></a>        <span class="s2">&quot;Upgrade M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) of M365 user with ID -&gt; </span><span class="si">%s</span><span class="s2">; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3044"><a id="__codelineno-0-3044" name="__codelineno-0-3044"></a>        <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3045"><a id="__codelineno-0-3045" name="__codelineno-0-3045"></a>        <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3046"><a id="__codelineno-0-3046" name="__codelineno-0-3046"></a>        <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3047"><a id="__codelineno-0-3047" name="__codelineno-0-3047"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3048"><a id="__codelineno-0-3048" name="__codelineno-0-3048"></a>    <span class="p">)</span>
</span><span id="__span-0-3049"><a id="__codelineno-0-3049" name="__codelineno-0-3049"></a>
</span><span id="__span-0-3050"><a id="__codelineno-0-3050" name="__codelineno-0-3050"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-3051"><a id="__codelineno-0-3051" name="__codelineno-0-3051"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-3052"><a id="__codelineno-0-3052" name="__codelineno-0-3052"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-3053"><a id="__codelineno-0-3053" name="__codelineno-0-3053"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-3054"><a id="__codelineno-0-3054" name="__codelineno-0-3054"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-3055"><a id="__codelineno-0-3055" name="__codelineno-0-3055"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to upgrade M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (</span><span class="si">{}</span><span class="s2">) of M365 user -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-3056"><a id="__codelineno-0-3056" name="__codelineno-0-3056"></a>            <span class="n">app_name</span><span class="p">,</span>
</span><span id="__span-0-3057"><a id="__codelineno-0-3057" name="__codelineno-0-3057"></a>            <span class="n">app_installation_id</span><span class="p">,</span>
</span><span id="__span-0-3058"><a id="__codelineno-0-3058" name="__codelineno-0-3058"></a>            <span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-0-3059"><a id="__codelineno-0-3059" name="__codelineno-0-3059"></a>        <span class="p">),</span>
</span><span id="__span-0-3060"><a id="__codelineno-0-3060" name="__codelineno-0-3060"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.upload_outlook_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_outlook_app</span><span class="p">(</span><span class="n">app_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload the M365 Outlook Add-In as "Integrated" App to M365 Admin Center.</p>
<p>TODO: THIS IS CURRENTLY NOT IMPLEMENTED DUE TO MISSING MS GRAPH API SUPPORT!</p>
<p>https://admin.microsoft.com/#/Settings/IntegratedApps</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to manifest file in local file system. Needs to be
downloaded before.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict | None:
Response of the MS Graph API or None if the request fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3692">3692</a></span>
<span class="normal"><a href="#__codelineno-0-3693">3693</a></span>
<span class="normal"><a href="#__codelineno-0-3694">3694</a></span>
<span class="normal"><a href="#__codelineno-0-3695">3695</a></span>
<span class="normal"><a href="#__codelineno-0-3696">3696</a></span>
<span class="normal"><a href="#__codelineno-0-3697">3697</a></span>
<span class="normal"><a href="#__codelineno-0-3698">3698</a></span>
<span class="normal"><a href="#__codelineno-0-3699">3699</a></span>
<span class="normal"><a href="#__codelineno-0-3700">3700</a></span>
<span class="normal"><a href="#__codelineno-0-3701">3701</a></span>
<span class="normal"><a href="#__codelineno-0-3702">3702</a></span>
<span class="normal"><a href="#__codelineno-0-3703">3703</a></span>
<span class="normal"><a href="#__codelineno-0-3704">3704</a></span>
<span class="normal"><a href="#__codelineno-0-3705">3705</a></span>
<span class="normal"><a href="#__codelineno-0-3706">3706</a></span>
<span class="normal"><a href="#__codelineno-0-3707">3707</a></span>
<span class="normal"><a href="#__codelineno-0-3708">3708</a></span>
<span class="normal"><a href="#__codelineno-0-3709">3709</a></span>
<span class="normal"><a href="#__codelineno-0-3710">3710</a></span>
<span class="normal"><a href="#__codelineno-0-3711">3711</a></span>
<span class="normal"><a href="#__codelineno-0-3712">3712</a></span>
<span class="normal"><a href="#__codelineno-0-3713">3713</a></span>
<span class="normal"><a href="#__codelineno-0-3714">3714</a></span>
<span class="normal"><a href="#__codelineno-0-3715">3715</a></span>
<span class="normal"><a href="#__codelineno-0-3716">3716</a></span>
<span class="normal"><a href="#__codelineno-0-3717">3717</a></span>
<span class="normal"><a href="#__codelineno-0-3718">3718</a></span>
<span class="normal"><a href="#__codelineno-0-3719">3719</a></span>
<span class="normal"><a href="#__codelineno-0-3720">3720</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3692"><a id="__codelineno-0-3692" name="__codelineno-0-3692"></a><span class="k">def</span><span class="w"> </span><span class="nf">upload_outlook_app</span><span class="p">(</span>
</span><span id="__span-0-3693"><a id="__codelineno-0-3693" name="__codelineno-0-3693"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3694"><a id="__codelineno-0-3694" name="__codelineno-0-3694"></a>    <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-3695"><a id="__codelineno-0-3695" name="__codelineno-0-3695"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3696"><a id="__codelineno-0-3696" name="__codelineno-0-3696"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload the M365 Outlook Add-In as &quot;Integrated&quot; App to M365 Admin Center.</span>
</span><span id="__span-0-3697"><a id="__codelineno-0-3697" name="__codelineno-0-3697"></a>
</span><span id="__span-0-3698"><a id="__codelineno-0-3698" name="__codelineno-0-3698"></a><span class="sd">    TODO: THIS IS CURRENTLY NOT IMPLEMENTED DUE TO MISSING MS GRAPH API SUPPORT!</span>
</span><span id="__span-0-3699"><a id="__codelineno-0-3699" name="__codelineno-0-3699"></a>
</span><span id="__span-0-3700"><a id="__codelineno-0-3700" name="__codelineno-0-3700"></a><span class="sd">    https://admin.microsoft.com/#/Settings/IntegratedApps</span>
</span><span id="__span-0-3701"><a id="__codelineno-0-3701" name="__codelineno-0-3701"></a>
</span><span id="__span-0-3702"><a id="__codelineno-0-3702" name="__codelineno-0-3702"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3703"><a id="__codelineno-0-3703" name="__codelineno-0-3703"></a><span class="sd">        app_path (str):</span>
</span><span id="__span-0-3704"><a id="__codelineno-0-3704" name="__codelineno-0-3704"></a><span class="sd">            Path to manifest file in local file system. Needs to be</span>
</span><span id="__span-0-3705"><a id="__codelineno-0-3705" name="__codelineno-0-3705"></a><span class="sd">            downloaded before.</span>
</span><span id="__span-0-3706"><a id="__codelineno-0-3706" name="__codelineno-0-3706"></a>
</span><span id="__span-0-3707"><a id="__codelineno-0-3707" name="__codelineno-0-3707"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3708"><a id="__codelineno-0-3708" name="__codelineno-0-3708"></a><span class="sd">        dict | None:</span>
</span><span id="__span-0-3709"><a id="__codelineno-0-3709" name="__codelineno-0-3709"></a><span class="sd">            Response of the MS Graph API or None if the request fails.</span>
</span><span id="__span-0-3710"><a id="__codelineno-0-3710" name="__codelineno-0-3710"></a>
</span><span id="__span-0-3711"><a id="__codelineno-0-3711" name="__codelineno-0-3711"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3712"><a id="__codelineno-0-3712" name="__codelineno-0-3712"></a>
</span><span id="__span-0-3713"><a id="__codelineno-0-3713" name="__codelineno-0-3713"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-3714"><a id="__codelineno-0-3714" name="__codelineno-0-3714"></a>        <span class="s2">&quot;Install Outlook Add-in from -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; (NOT IMPLEMENTED)&quot;</span><span class="p">,</span>
</span><span id="__span-0-3715"><a id="__codelineno-0-3715" name="__codelineno-0-3715"></a>        <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-3716"><a id="__codelineno-0-3716" name="__codelineno-0-3716"></a>    <span class="p">)</span>
</span><span id="__span-0-3717"><a id="__codelineno-0-3717" name="__codelineno-0-3717"></a>
</span><span id="__span-0-3718"><a id="__codelineno-0-3718" name="__codelineno-0-3718"></a>    <span class="n">response</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-3719"><a id="__codelineno-0-3719" name="__codelineno-0-3719"></a>
</span><span id="__span-0-3720"><a id="__codelineno-0-3720" name="__codelineno-0-3720"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyxecm_customizer.m365.M365.upload_teams_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_teams_app</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="n">update_existing_app</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">app_catalog_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload a new app package to the catalog of MS Teams apps.</p>
<p>This is not possible with client secret credentials
but requires a token of a user authenticated with username + password.
See https://learn.microsoft.com/en-us/graph/api/teamsapp-publish
(permissions table on that page).</p>
<p>For updates see: https://learn.microsoft.com/en-us/graph/api/teamsapp-update?view=graph-rest-1.0&amp;tabs=http</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path (with directory) to the app package to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_existing_app</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to update an existing app with the same name.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_catalog_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique ID of the app. It is the ID the app has in
the catalog - which is different from ID an app gets
after installation (which is tenant specific).</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response of the MS GRAPH API REST call or None if the request fails
The responses are different depending if it is an install or upgrade!!</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example return for upgrades ("teamsAppId" is the "internal" ID of the app):
    {
        '@odata.context': "https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps('3f749cca-8cb0-4925-9fa0-ba7aca2014af')/appDefinitions/$entity",
        'id': 'M2Y3NDljY2EtOGNiMC00OTI1LTlmYTAtYmE3YWNhMjAxNGFmIyMyNC4yLjAjI1B1Ymxpc2hlZA==',
        'teamsAppId': '3f749cca-8cb0-4925-9fa0-ba7aca2014af',
        'displayName': 'IDEA-TE - Extended ECM 24.2.0',
        'version': '24.2.0',
        'publishingState': 'published',
        'shortDescription': 'Add a tab for an Extended ECM business workspace.',
        'description': 'View and interact with OpenText Extended ECM business workspaces',
        'lastModifiedDateTime': None,
        'createdBy': None,
        'authorization': {
            'requiredPermissionSet': {...}
        }
    }</p>
<div class="language-text highlight"><pre><span></span><code>Example return for new installations (&quot;id&quot; is the &quot;internal&quot; ID of the app):
{
    &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps/$entity&#39;,
    &#39;id&#39;: &#39;6c672afd-37fc-46c6-8365-d499aba3808b&#39;,
    &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,
    &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,
    &#39;distributionMethod&#39;: &#39;organization&#39;
}
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>packages/pyxecm/src/pyxecm_customizer/m365.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2756">2756</a></span>
<span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span>
<span class="normal"><a href="#__codelineno-0-2764">2764</a></span>
<span class="normal"><a href="#__codelineno-0-2765">2765</a></span>
<span class="normal"><a href="#__codelineno-0-2766">2766</a></span>
<span class="normal"><a href="#__codelineno-0-2767">2767</a></span>
<span class="normal"><a href="#__codelineno-0-2768">2768</a></span>
<span class="normal"><a href="#__codelineno-0-2769">2769</a></span>
<span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span>
<span class="normal"><a href="#__codelineno-0-2807">2807</a></span>
<span class="normal"><a href="#__codelineno-0-2808">2808</a></span>
<span class="normal"><a href="#__codelineno-0-2809">2809</a></span>
<span class="normal"><a href="#__codelineno-0-2810">2810</a></span>
<span class="normal"><a href="#__codelineno-0-2811">2811</a></span>
<span class="normal"><a href="#__codelineno-0-2812">2812</a></span>
<span class="normal"><a href="#__codelineno-0-2813">2813</a></span>
<span class="normal"><a href="#__codelineno-0-2814">2814</a></span>
<span class="normal"><a href="#__codelineno-0-2815">2815</a></span>
<span class="normal"><a href="#__codelineno-0-2816">2816</a></span>
<span class="normal"><a href="#__codelineno-0-2817">2817</a></span>
<span class="normal"><a href="#__codelineno-0-2818">2818</a></span>
<span class="normal"><a href="#__codelineno-0-2819">2819</a></span>
<span class="normal"><a href="#__codelineno-0-2820">2820</a></span>
<span class="normal"><a href="#__codelineno-0-2821">2821</a></span>
<span class="normal"><a href="#__codelineno-0-2822">2822</a></span>
<span class="normal"><a href="#__codelineno-0-2823">2823</a></span>
<span class="normal"><a href="#__codelineno-0-2824">2824</a></span>
<span class="normal"><a href="#__codelineno-0-2825">2825</a></span>
<span class="normal"><a href="#__codelineno-0-2826">2826</a></span>
<span class="normal"><a href="#__codelineno-0-2827">2827</a></span>
<span class="normal"><a href="#__codelineno-0-2828">2828</a></span>
<span class="normal"><a href="#__codelineno-0-2829">2829</a></span>
<span class="normal"><a href="#__codelineno-0-2830">2830</a></span>
<span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span>
<span class="normal"><a href="#__codelineno-0-2837">2837</a></span>
<span class="normal"><a href="#__codelineno-0-2838">2838</a></span>
<span class="normal"><a href="#__codelineno-0-2839">2839</a></span>
<span class="normal"><a href="#__codelineno-0-2840">2840</a></span>
<span class="normal"><a href="#__codelineno-0-2841">2841</a></span>
<span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span>
<span class="normal"><a href="#__codelineno-0-2851">2851</a></span>
<span class="normal"><a href="#__codelineno-0-2852">2852</a></span>
<span class="normal"><a href="#__codelineno-0-2853">2853</a></span>
<span class="normal"><a href="#__codelineno-0-2854">2854</a></span>
<span class="normal"><a href="#__codelineno-0-2855">2855</a></span>
<span class="normal"><a href="#__codelineno-0-2856">2856</a></span>
<span class="normal"><a href="#__codelineno-0-2857">2857</a></span>
<span class="normal"><a href="#__codelineno-0-2858">2858</a></span>
<span class="normal"><a href="#__codelineno-0-2859">2859</a></span>
<span class="normal"><a href="#__codelineno-0-2860">2860</a></span>
<span class="normal"><a href="#__codelineno-0-2861">2861</a></span>
<span class="normal"><a href="#__codelineno-0-2862">2862</a></span>
<span class="normal"><a href="#__codelineno-0-2863">2863</a></span>
<span class="normal"><a href="#__codelineno-0-2864">2864</a></span>
<span class="normal"><a href="#__codelineno-0-2865">2865</a></span>
<span class="normal"><a href="#__codelineno-0-2866">2866</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2756"><a id="__codelineno-0-2756" name="__codelineno-0-2756"></a><span class="k">def</span><span class="w"> </span><span class="nf">upload_teams_app</span><span class="p">(</span>
</span><span id="__span-0-2757"><a id="__codelineno-0-2757" name="__codelineno-0-2757"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2758"><a id="__codelineno-0-2758" name="__codelineno-0-2758"></a>    <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-2759"><a id="__codelineno-0-2759" name="__codelineno-0-2759"></a>    <span class="n">update_existing_app</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2760"><a id="__codelineno-0-2760" name="__codelineno-0-2760"></a>    <span class="n">app_catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2761"><a id="__codelineno-0-2761" name="__codelineno-0-2761"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2762"><a id="__codelineno-0-2762" name="__codelineno-0-2762"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload a new app package to the catalog of MS Teams apps.</span>
</span><span id="__span-0-2763"><a id="__codelineno-0-2763" name="__codelineno-0-2763"></a>
</span><span id="__span-0-2764"><a id="__codelineno-0-2764" name="__codelineno-0-2764"></a><span class="sd">    This is not possible with client secret credentials</span>
</span><span id="__span-0-2765"><a id="__codelineno-0-2765" name="__codelineno-0-2765"></a><span class="sd">    but requires a token of a user authenticated with username + password.</span>
</span><span id="__span-0-2766"><a id="__codelineno-0-2766" name="__codelineno-0-2766"></a><span class="sd">    See https://learn.microsoft.com/en-us/graph/api/teamsapp-publish</span>
</span><span id="__span-0-2767"><a id="__codelineno-0-2767" name="__codelineno-0-2767"></a><span class="sd">    (permissions table on that page).</span>
</span><span id="__span-0-2768"><a id="__codelineno-0-2768" name="__codelineno-0-2768"></a>
</span><span id="__span-0-2769"><a id="__codelineno-0-2769" name="__codelineno-0-2769"></a><span class="sd">    For updates see: https://learn.microsoft.com/en-us/graph/api/teamsapp-update?view=graph-rest-1.0&amp;tabs=http</span>
</span><span id="__span-0-2770"><a id="__codelineno-0-2770" name="__codelineno-0-2770"></a>
</span><span id="__span-0-2771"><a id="__codelineno-0-2771" name="__codelineno-0-2771"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2772"><a id="__codelineno-0-2772" name="__codelineno-0-2772"></a><span class="sd">        app_path (str):</span>
</span><span id="__span-0-2773"><a id="__codelineno-0-2773" name="__codelineno-0-2773"></a><span class="sd">            The file path (with directory) to the app package to upload.</span>
</span><span id="__span-0-2774"><a id="__codelineno-0-2774" name="__codelineno-0-2774"></a><span class="sd">        update_existing_app (bool, optional):</span>
</span><span id="__span-0-2775"><a id="__codelineno-0-2775" name="__codelineno-0-2775"></a><span class="sd">            Whether or not to update an existing app with the same name.</span>
</span><span id="__span-0-2776"><a id="__codelineno-0-2776" name="__codelineno-0-2776"></a><span class="sd">        app_catalog_id (str, optional):</span>
</span><span id="__span-0-2777"><a id="__codelineno-0-2777" name="__codelineno-0-2777"></a><span class="sd">            The unique ID of the app. It is the ID the app has in</span>
</span><span id="__span-0-2778"><a id="__codelineno-0-2778" name="__codelineno-0-2778"></a><span class="sd">            the catalog - which is different from ID an app gets</span>
</span><span id="__span-0-2779"><a id="__codelineno-0-2779" name="__codelineno-0-2779"></a><span class="sd">            after installation (which is tenant specific).</span>
</span><span id="__span-0-2780"><a id="__codelineno-0-2780" name="__codelineno-0-2780"></a>
</span><span id="__span-0-2781"><a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2782"><a id="__codelineno-0-2782" name="__codelineno-0-2782"></a><span class="sd">        dict:</span>
</span><span id="__span-0-2783"><a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">            Response of the MS GRAPH API REST call or None if the request fails</span>
</span><span id="__span-0-2784"><a id="__codelineno-0-2784" name="__codelineno-0-2784"></a><span class="sd">            The responses are different depending if it is an install or upgrade!!</span>
</span><span id="__span-0-2785"><a id="__codelineno-0-2785" name="__codelineno-0-2785"></a>
</span><span id="__span-0-2786"><a id="__codelineno-0-2786" name="__codelineno-0-2786"></a><span class="sd">    Example return for upgrades (&quot;teamsAppId&quot; is the &quot;internal&quot; ID of the app):</span>
</span><span id="__span-0-2787"><a id="__codelineno-0-2787" name="__codelineno-0-2787"></a><span class="sd">        {</span>
</span><span id="__span-0-2788"><a id="__codelineno-0-2788" name="__codelineno-0-2788"></a><span class="sd">            &#39;@odata.context&#39;: &quot;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps(&#39;3f749cca-8cb0-4925-9fa0-ba7aca2014af&#39;)/appDefinitions/$entity&quot;,</span>
</span><span id="__span-0-2789"><a id="__codelineno-0-2789" name="__codelineno-0-2789"></a><span class="sd">            &#39;id&#39;: &#39;M2Y3NDljY2EtOGNiMC00OTI1LTlmYTAtYmE3YWNhMjAxNGFmIyMyNC4yLjAjI1B1Ymxpc2hlZA==&#39;,</span>
</span><span id="__span-0-2790"><a id="__codelineno-0-2790" name="__codelineno-0-2790"></a><span class="sd">            &#39;teamsAppId&#39;: &#39;3f749cca-8cb0-4925-9fa0-ba7aca2014af&#39;,</span>
</span><span id="__span-0-2791"><a id="__codelineno-0-2791" name="__codelineno-0-2791"></a><span class="sd">            &#39;displayName&#39;: &#39;IDEA-TE - Extended ECM 24.2.0&#39;,</span>
</span><span id="__span-0-2792"><a id="__codelineno-0-2792" name="__codelineno-0-2792"></a><span class="sd">            &#39;version&#39;: &#39;24.2.0&#39;,</span>
</span><span id="__span-0-2793"><a id="__codelineno-0-2793" name="__codelineno-0-2793"></a><span class="sd">            &#39;publishingState&#39;: &#39;published&#39;,</span>
</span><span id="__span-0-2794"><a id="__codelineno-0-2794" name="__codelineno-0-2794"></a><span class="sd">            &#39;shortDescription&#39;: &#39;Add a tab for an Extended ECM business workspace.&#39;,</span>
</span><span id="__span-0-2795"><a id="__codelineno-0-2795" name="__codelineno-0-2795"></a><span class="sd">            &#39;description&#39;: &#39;View and interact with OpenText Extended ECM business workspaces&#39;,</span>
</span><span id="__span-0-2796"><a id="__codelineno-0-2796" name="__codelineno-0-2796"></a><span class="sd">            &#39;lastModifiedDateTime&#39;: None,</span>
</span><span id="__span-0-2797"><a id="__codelineno-0-2797" name="__codelineno-0-2797"></a><span class="sd">            &#39;createdBy&#39;: None,</span>
</span><span id="__span-0-2798"><a id="__codelineno-0-2798" name="__codelineno-0-2798"></a><span class="sd">            &#39;authorization&#39;: {</span>
</span><span id="__span-0-2799"><a id="__codelineno-0-2799" name="__codelineno-0-2799"></a><span class="sd">                &#39;requiredPermissionSet&#39;: {...}</span>
</span><span id="__span-0-2800"><a id="__codelineno-0-2800" name="__codelineno-0-2800"></a><span class="sd">            }</span>
</span><span id="__span-0-2801"><a id="__codelineno-0-2801" name="__codelineno-0-2801"></a><span class="sd">        }</span>
</span><span id="__span-0-2802"><a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>
</span><span id="__span-0-2803"><a id="__codelineno-0-2803" name="__codelineno-0-2803"></a><span class="sd">        Example return for new installations (&quot;id&quot; is the &quot;internal&quot; ID of the app):</span>
</span><span id="__span-0-2804"><a id="__codelineno-0-2804" name="__codelineno-0-2804"></a><span class="sd">        {</span>
</span><span id="__span-0-2805"><a id="__codelineno-0-2805" name="__codelineno-0-2805"></a><span class="sd">            &#39;@odata.context&#39;: &#39;https://graph.microsoft.com/v1.0/$metadata#appCatalogs/teamsApps/$entity&#39;,</span>
</span><span id="__span-0-2806"><a id="__codelineno-0-2806" name="__codelineno-0-2806"></a><span class="sd">            &#39;id&#39;: &#39;6c672afd-37fc-46c6-8365-d499aba3808b&#39;,</span>
</span><span id="__span-0-2807"><a id="__codelineno-0-2807" name="__codelineno-0-2807"></a><span class="sd">            &#39;externalId&#39;: &#39;dd4af790-d8ff-47a0-87ad-486318272c7a&#39;,</span>
</span><span id="__span-0-2808"><a id="__codelineno-0-2808" name="__codelineno-0-2808"></a><span class="sd">            &#39;displayName&#39;: &#39;OpenText Extended ECM&#39;,</span>
</span><span id="__span-0-2809"><a id="__codelineno-0-2809" name="__codelineno-0-2809"></a><span class="sd">            &#39;distributionMethod&#39;: &#39;organization&#39;</span>
</span><span id="__span-0-2810"><a id="__codelineno-0-2810" name="__codelineno-0-2810"></a><span class="sd">        }</span>
</span><span id="__span-0-2811"><a id="__codelineno-0-2811" name="__codelineno-0-2811"></a>
</span><span id="__span-0-2812"><a id="__codelineno-0-2812" name="__codelineno-0-2812"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2813"><a id="__codelineno-0-2813" name="__codelineno-0-2813"></a>
</span><span id="__span-0-2814"><a id="__codelineno-0-2814" name="__codelineno-0-2814"></a>    <span class="k">if</span> <span class="n">update_existing_app</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">app_catalog_id</span><span class="p">:</span>
</span><span id="__span-0-2815"><a id="__codelineno-0-2815" name="__codelineno-0-2815"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2816"><a id="__codelineno-0-2816" name="__codelineno-0-2816"></a>            <span class="s2">&quot;To update an existing M365 Teams app in the app catalog you need to provide the existing App catalog ID!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2817"><a id="__codelineno-0-2817" name="__codelineno-0-2817"></a>        <span class="p">)</span>
</span><span id="__span-0-2818"><a id="__codelineno-0-2818" name="__codelineno-0-2818"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2819"><a id="__codelineno-0-2819" name="__codelineno-0-2819"></a>
</span><span id="__span-0-2820"><a id="__codelineno-0-2820" name="__codelineno-0-2820"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">app_path</span><span class="p">):</span>
</span><span id="__span-0-2821"><a id="__codelineno-0-2821" name="__codelineno-0-2821"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;M365 Teams app file -&gt; </span><span class="si">%s</span><span class="s2"> does not exist!&quot;</span><span class="p">,</span> <span class="n">app_path</span><span class="p">)</span>
</span><span id="__span-0-2822"><a id="__codelineno-0-2822" name="__codelineno-0-2822"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2823"><a id="__codelineno-0-2823" name="__codelineno-0-2823"></a>
</span><span id="__span-0-2824"><a id="__codelineno-0-2824" name="__codelineno-0-2824"></a>    <span class="c1"># Ensure that the app file is a zip file</span>
</span><span id="__span-0-2825"><a id="__codelineno-0-2825" name="__codelineno-0-2825"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
</span><span id="__span-0-2826"><a id="__codelineno-0-2826" name="__codelineno-0-2826"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;M365 Teams app file -&gt; </span><span class="si">%s</span><span class="s2"> must be a zip file!&quot;</span><span class="p">,</span> <span class="n">app_path</span><span class="p">)</span>
</span><span id="__span-0-2827"><a id="__codelineno-0-2827" name="__codelineno-0-2827"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2828"><a id="__codelineno-0-2828" name="__codelineno-0-2828"></a>
</span><span id="__span-0-2829"><a id="__codelineno-0-2829" name="__codelineno-0-2829"></a>    <span class="n">request_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s2">&quot;teamsAppsUrl&quot;</span><span class="p">]</span>
</span><span id="__span-0-2830"><a id="__codelineno-0-2830" name="__codelineno-0-2830"></a>    <span class="c1"># If we want to upgrade an existing app we add the app ID and</span>
</span><span id="__span-0-2831"><a id="__codelineno-0-2831" name="__codelineno-0-2831"></a>    <span class="c1"># the specific endpoint:</span>
</span><span id="__span-0-2832"><a id="__codelineno-0-2832" name="__codelineno-0-2832"></a>    <span class="k">if</span> <span class="n">update_existing_app</span><span class="p">:</span>
</span><span id="__span-0-2833"><a id="__codelineno-0-2833" name="__codelineno-0-2833"></a>        <span class="n">request_url</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">app_catalog_id</span> <span class="o">+</span> <span class="s2">&quot;/appDefinitions&quot;</span>
</span><span id="__span-0-2834"><a id="__codelineno-0-2834" name="__codelineno-0-2834"></a>
</span><span id="__span-0-2835"><a id="__codelineno-0-2835" name="__codelineno-0-2835"></a>    <span class="c1"># Here we need the credentials of an authenticated user!</span>
</span><span id="__span-0-2836"><a id="__codelineno-0-2836" name="__codelineno-0-2836"></a>    <span class="c1"># (not the application credentials (client_id, client_secret))</span>
</span><span id="__span-0-2837"><a id="__codelineno-0-2837" name="__codelineno-0-2837"></a>    <span class="n">request_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_header_user</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;application/zip&quot;</span><span class="p">)</span>
</span><span id="__span-0-2838"><a id="__codelineno-0-2838" name="__codelineno-0-2838"></a>
</span><span id="__span-0-2839"><a id="__codelineno-0-2839" name="__codelineno-0-2839"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-2840"><a id="__codelineno-0-2840" name="__codelineno-0-2840"></a>        <span class="n">app_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-0-2841"><a id="__codelineno-0-2841" name="__codelineno-0-2841"></a>
</span><span id="__span-0-2842"><a id="__codelineno-0-2842" name="__codelineno-0-2842"></a>    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">app_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
</span><span id="__span-0-2843"><a id="__codelineno-0-2843" name="__codelineno-0-2843"></a>        <span class="c1"># Ensure that the app file contains a manifest.json file</span>
</span><span id="__span-0-2844"><a id="__codelineno-0-2844" name="__codelineno-0-2844"></a>        <span class="k">if</span> <span class="s2">&quot;manifest.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">z</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
</span><span id="__span-0-2845"><a id="__codelineno-0-2845" name="__codelineno-0-2845"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="__span-0-2846"><a id="__codelineno-0-2846" name="__codelineno-0-2846"></a>                <span class="s2">&quot;M365 Teams app file -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; does not contain a manifest.json file!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2847"><a id="__codelineno-0-2847" name="__codelineno-0-2847"></a>                <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-2848"><a id="__codelineno-0-2848" name="__codelineno-0-2848"></a>            <span class="p">)</span>
</span><span id="__span-0-2849"><a id="__codelineno-0-2849" name="__codelineno-0-2849"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-0-2850"><a id="__codelineno-0-2850" name="__codelineno-0-2850"></a>
</span><span id="__span-0-2851"><a id="__codelineno-0-2851" name="__codelineno-0-2851"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="__span-0-2852"><a id="__codelineno-0-2852" name="__codelineno-0-2852"></a>        <span class="s2">&quot;Upload M365 Teams app -&gt; &#39;</span><span class="si">%s</span><span class="s2">&#39; to the MS Teams catalog; calling -&gt; </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-2853"><a id="__codelineno-0-2853" name="__codelineno-0-2853"></a>        <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-2854"><a id="__codelineno-0-2854" name="__codelineno-0-2854"></a>        <span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2855"><a id="__codelineno-0-2855" name="__codelineno-0-2855"></a>    <span class="p">)</span>
</span><span id="__span-0-2856"><a id="__codelineno-0-2856" name="__codelineno-0-2856"></a>
</span><span id="__span-0-2857"><a id="__codelineno-0-2857" name="__codelineno-0-2857"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_request</span><span class="p">(</span>
</span><span id="__span-0-2858"><a id="__codelineno-0-2858" name="__codelineno-0-2858"></a>        <span class="n">url</span><span class="o">=</span><span class="n">request_url</span><span class="p">,</span>
</span><span id="__span-0-2859"><a id="__codelineno-0-2859" name="__codelineno-0-2859"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span id="__span-0-2860"><a id="__codelineno-0-2860" name="__codelineno-0-2860"></a>        <span class="n">headers</span><span class="o">=</span><span class="n">request_header</span><span class="p">,</span>
</span><span id="__span-0-2861"><a id="__codelineno-0-2861" name="__codelineno-0-2861"></a>        <span class="n">data</span><span class="o">=</span><span class="n">app_data</span><span class="p">,</span>
</span><span id="__span-0-2862"><a id="__codelineno-0-2862" name="__codelineno-0-2862"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">REQUEST_TIMEOUT</span><span class="p">,</span>
</span><span id="__span-0-2863"><a id="__codelineno-0-2863" name="__codelineno-0-2863"></a>        <span class="n">failure_message</span><span class="o">=</span><span class="s2">&quot;Failed to update existing M365 Teams app -&gt; &#39;</span><span class="si">{}</span><span class="s2">&#39; (may be because it is not a new version)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-0-2864"><a id="__codelineno-0-2864" name="__codelineno-0-2864"></a>            <span class="n">app_path</span><span class="p">,</span>
</span><span id="__span-0-2865"><a id="__codelineno-0-2865" name="__codelineno-0-2865"></a>        <span class="p">),</span>
</span><span id="__span-0-2866"><a id="__codelineno-0-2866" name="__codelineno-0-2866"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.copy", "content.tabs.link", "content.tooltips"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>